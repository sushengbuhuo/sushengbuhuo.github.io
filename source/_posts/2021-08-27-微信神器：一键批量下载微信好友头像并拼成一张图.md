---
title: 微信神器：一键批量下载微信好友头像并拼成一张图
date: 2021-08-27 20:17:53
tags:
- 公众号
---

> 苏生不惑第`279` 篇原创文章，将本公众号设为`星标`，第一时间看最新文章。

之前分享过[一键生成你的微信社交数据报告](https://mp.weixin.qq.com/s/V8Aj7ekW3xYaBHj7vQW-rw)，不过很多人的微信不能登录网页版微信。
 ![image.png](https://upload-images.jianshu.io/upload_images/23152173-cd57b9da9b829e72.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
会提示这个：`为了你的帐号安全，此微信号不能登录网页微信。你可以使用Windows微信或Mac微信在电脑端登录。Windows微信下载地址：https://pc.weixin.qq.com Mac微信下载地址：https://mac.weixin.qq.com`，不过现在有桌面版微信可以登录了，今天就是通过登录桌面版微信下载微信好友头像并拼图。
```js
import itchat,os
from math import sqrt
from PIL import Image
path = os.getcwd() + '\\wechat_pics\\'
numbers = input('请输入要下载的微信好友头像数量，默认为500：')
if numbers == '':
	numbers = 500
# print(path)
#https://github.com/yizhihuamao/ItChat
def save_avatar(path):
	if not os.path.exists(path):
		os.mkdir(path)
	itchat.auto_login(hotReload=False, enableCmdQR=2)
	num = 0
	for friend in itchat.get_friends(update=True)[0:]:
		if num > int(numbers):
			break
		#查看好友微信名、备注名、性别（1：男 2：女 0：性别不详）、省份、个性签名
		print(friend['NickName'],friend['RemarkName'],friend['Sex'],friend['Province'],friend['Signature'])
		img = itchat.get_head_img(userName=friend["UserName"])
		img_path = path + friend['NickName'] + "_" + friend['RemarkName'] + ".jpg"
		try:
			with open(img_path,'wb') as f:
				f.write(img)
				num+=1
		except Exception as e:
			print(repr(e))
	#itchat.run()
def joint_avatar(path):	
	pathList = []
	for item in os.listdir(path):
	    imgPath = os.path.join(path,item)
	    pathList.append(imgPath)
	total = len(pathList)#图片总数
	line = int(sqrt(total))
	NewImage = Image.new('RGB', (128*line,128*line))
	x = y = 0
	for item in pathList:
	    try:
	        img = Image.open(item)
	        img = img.resize((128,128),Image.ANTIALIAS)
	        NewImage.paste(img, (x * 128 , y * 128))
	        x += 1
	    except IOError:
	        print("图片读取失败:%s" % (item))
	        x -= 1
	    if x == line:
	        x = 0
	        y += 1
	    if (x+line*y) == line*line:
	        break
	NewImage.save("wechat_friends.jpg")
save_avatar(path)
joint_avatar(path)
```
先在公众号后台回复 `拼图` 获取软件，打开软件提示输入要下载的微信好友头像数量，默认为500个，因为有些人的微信好友有五六千人，如果全下载可能会失败。
![image.png](https://upload-images.jianshu.io/upload_images/23152173-c41115d4a5bdce36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
如果cmd窗口太小无法显示二维码，可以安装个cmder软件，我之前文章分享过这个工具

用微信扫码登录下，登录成功后可以看到微信已经是桌面登录。
![image.png](https://upload-images.jianshu.io/upload_images/23152173-f57ca261717ede57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
![image.png](https://upload-images.jianshu.io/upload_images/23152173-335d13129e66fd1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

不过会踢掉你现在登录的电脑端微信，没关系，待会再用。
![image.png](https://upload-images.jianshu.io/upload_images/23152173-15b5a4758fa06cfd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

之后就开始下载你的微信好友头像了。
![image.png](https://upload-images.jianshu.io/upload_images/23152173-b367a00d23eb7967.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
我有3000多微信好友，下载了十几分钟，下载的头像在wechat_pics目录（有200多MB），最后合成的拼图为wechat_friends.jpg，有10MB这么大，效果：
![image.png](https://upload-images.jianshu.io/upload_images/23152173-b837eb30950e0eb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

把合成的拼图发到朋友圈有可能是你点赞评论数最高的一条。
![image.png](https://upload-images.jianshu.io/upload_images/23152173-ec6876930f4f7b8b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

我把合并图片的功能单独打包了下，将要合成的图片放在pictures目录，打开软件会合成一张pictures.jpg，比如合成16张周杰伦的图片。
![jay.png](https://upload-images.jianshu.io/upload_images/23152173-75e135898d415704.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
另外之前还分享过朋友圈九宫格图片分割工具[如何发一条九宫格图片的朋友圈](https://mp.weixin.qq.com/s/AD7RAJm8p30LMdrgjy1CVw)
![image.png](https://upload-images.jianshu.io/upload_images/23152173-c9d5103a5c7a904f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

最近原创文章：

[每天定时签到腾讯/爱奇艺/网易云音乐/b站/a站/百度贴吧/天翼云盘等网站](https://mp.weixin.qq.com/s/Xn5sexW0YGYcA4XgE0LvBw)

[那些有趣/实用的 Chrome 扩展神器系列（五）](https://mp.weixin.qq.com/s/HpWuKUkTvct8zQ0jAMWOQw)

[2021 年 8 月一键修改微信运动步数](https://mp.weixin.qq.com/s/yTkI315tFKgxqDL0wFEJgg)

[又一音乐神器APP，免费听全网音乐](https://mp.weixin.qq.com/s/Kjv_4g49dkjOdJbetZsOOw)

[实用 Windows 软件系列分享（三）](https://mp.weixin.qq.com/s/k7fEby1rh7zF-Yog-ftrhQ)

[分享几个实用的微信小程序](https://mp.weixin.qq.com/s/-wbquQDEg36DRUvw1vMxOw)

[实用油猴脚本推荐，让你的谷歌浏览器更强大（三）](https://mp.weixin.qq.com/s/Yh2xfd2cpL8WbPjsxC3CMg)

[又一视频下载神器，批量下载腾讯/优酷/爱奇艺/b站/抖音视频](https://mp.weixin.qq.com/s/LajCXCBUN-V1PKZ40SXmqA)

[每天自动签到京东获取京豆，自动升级b站和网易云音乐](https://mp.weixin.qq.com/s/tljcmHeMYRUesX7nuDoX0g)

[微信又更新了，分享几个实用的微信神器](https://mp.weixin.qq.com/s/C2ht6VHwAVv76uYEw7mG_A)

[阿里云盘分享来了，告别下载限速的百度网盘](https://mp.weixin.qq.com/s/vDj7kxc-am5ud57cCBvUuQ)

[实用 Windows 软件系列分享（二）](https://mp.weixin.qq.com/s/-dZL8i7o-kRARLToCR3lwQ)

[2021 上半年公众号苏生不惑近百篇原创文章整理](https://mp.weixin.qq.com/s/bCWJvS8HtD2fxjcDwiVZlQ)

[新买了台笔记本电脑，分享些实用的Windows软件](https://mp.weixin.qq.com/s/o_V1kISe-zl9fdcCFZJZPg)

[2021 电子书搜索网站/工具，找电子书不再愁](https://mp.weixin.qq.com/s/HPAThXlfYECuZhTL6lUYWA)

[玩转谷歌/百度搜索](https://mp.weixin.qq.com/s/_QvGRwtR4J5o2luMrwATEA)

[找壁纸不用愁了：壁纸网站/APP/工具合集](https://mp.weixin.qq.com/s/YLRFPDMZJNl515eAfMSyJw)

>  如果文章对你有帮助还请 `点赞/在看/分享` 三连支持下， 感谢各位！

### 公众号苏生不惑
![扫描二维码关注或搜索微信susheng_buhuo](https://upload-images.jianshu.io/upload_images/23152173-61c280d775baf3e6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
